import{A as Bn,B as Vn,C as jo,D as Uo,E as $o,F as Ho,G as Ln,H as Nn,I as Go,a as On,b as ko,c as Me,d as En,e as Do,f as kn,g as Io,h as To,i as Ao,j as Fo,k as zo,l as Ro,m as Bo,n as Vo,o as Dn,p as Lo,q as No,r as In,u as Tn,w as An,x as Fn,y as zn,z as Rn}from"./chunk-AXGZGPTE.js";import{c as Yo,d as qo,e as Xo,f as Jo,i as ye}from"./chunk-45THETJ6.js";import{c as vn,d as Wt,f as ut,g as Kt}from"./chunk-PT2JM3JA.js";import{b as Co,c as bo,g as G,i as Wo,j as Ko}from"./chunk-4Q2FHIQY.js";import{a as Ne}from"./chunk-TZNZ53SR.js";import"./chunk-6DYDZLAU.js";import"./chunk-JB3SIN2M.js";import{D as xe,a as xn,b as he,c as pe,f as ge,h as Pn,i as Mn,j as fo,k as Gt,l as Ve,m as Le,n as yn,o as wn,q as Sn,r as Qe,t as ho,u as et,w as N,x as _o,y as Ai,z as Ye}from"./chunk-Y7A6MJVW.js";import{b as ee}from"./chunk-ZO574LIR.js";import{a as xr,e as Eo}from"./chunk-JAFV3UXJ.js";import{A as Ht,B as bn,C as mo,G as vo,J as xo,T as Po,V as Mo,W as yo,Y as wo,ba as So,ca as Oo,f as go,h as Ze,i as oe,ia as Yt,j as B,k as pt,l as gt,m as Cn,o as uo,p as Oe,q as Te,r as _e,x as rn,y as Ti,z as an}from"./chunk-DILZRO5C.js";import{$ as H,$b as g,Ac as $t,B as fn,Ba as Qi,D as dt,Eb as oo,F as hn,Fb as Be,Gb as we,H as Yi,Hb as Se,I as _n,Jb as ro,Jc as fe,Kb as ao,Lb as p,Mb as o,Nb as a,O as qi,Ob as h,Qc as po,Sb as re,Tb as ae,U as Xi,Ua as eo,Va as ce,Vb as y,Xa as Lt,Ya as to,Za as l,Zb as u,aa as Bt,ac as so,bc as lo,c as ki,da as X,db as V,dc as $e,ea as P,ec as He,f as be,fb as no,fc as We,g as de,gc as Ut,ha as Ji,hc as q,ic as k,j as Hi,ja as m,jc as co,k as Wi,ka as f,kb as F,kc as c,l as un,la as ve,lb as Nt,lc as x,m as ct,ma as Vt,mc as S,nb as io,nc as ue,oc as j,p as Di,pc as U,q as Ki,qb as b,qc as $,r as mn,sb as W,tb as jt,uc as Ii,xc as L,y as Gi,ya as Je,yc as J,za as Zi,zc as me}from"./chunk-2NYEL3ZQ.js";import{a as K,b as Z,h as vr,j as C}from"./chunk-TWZW5B45.js";function jn(r){window.webkit?.messageHandlers?.iosHandler&&window.webkit.messageHandlers.iosHandler.postMessage(r)}function sn(){return/iPhone|iPad|iPod/.test(navigator.userAgent)&&!!window.webkit?.messageHandlers?.iosHandler}function Zo(){jn("requestGeminiAuth")}function Qo(){jn("isGeminiAuthAvailable")}function er(){jn("signOut")}function tr(){jn("test")}var mt=class r{_platform;constructor(){this._platform=this.detectPlatform()}detectPlatform(){return sn()?"ios":ye()&&/Android/.test(navigator.userAgent)?"android":"web"}get platform(){return this._platform}isIOS(){return this._platform==="ios"}isAndroid(){return this._platform==="android"}isWeb(){return this._platform==="web"}isMobileApp(){return this.isIOS()||this.isAndroid()}isNative(){return this.isMobileApp()}getDebugInfo(){return{platform:this._platform,userAgent:navigator.userAgent,hasWebKit:!!window.webkit,hasAndroidBridge:typeof window<"u",isIOS:this.isIOS(),isAndroid:this.isAndroid(),isMobileApp:this.isMobileApp()}}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Un=class r{constructor(t){this.ngZone=t;this.registerMessageHandler()}messageSubject=new be;message$=this.messageSubject.asObservable();registerMessageHandler(){sn()&&(window.onIOSMessage=(t,e)=>{this.ngZone.run(()=>{this.messageSubject.next({type:t,data:e})})})}requestAuth(){Zo()}checkLoginStatus(){Qo()}signOut(){er()}test(){tr()}isAvailable(){return sn()}static \u0275fac=function(e){return new(e||r)(X(jt))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ae=class r{constructor(t,e){this.ngZone=t;this.snackbar=e;this.registerMessageHandler(),this.checkPendingOAuthCallback(),ye()&&(this.requestDeviceInfoFromAndroid(),this.requestStoredTokens()),this.addDebugLog("success","Android \uBE0C\uB9BF\uC9C0 \uC11C\uBE44\uC2A4 \uCD08\uAE30\uD654 \uC644\uB8CC")}messageSubject=new be;message$=this.messageSubject.asObservable();deviceInfoSubject=new de(null);oauthCallbackSubject=new be;authTokensSubject=new be;authErrorSubject=new be;myPageClosedSubject=new be;userTokenInfoSubject=new de(null);tokensSubject=new be;authStatusSubject=new be;refreshTokenRequestSubject=new be;overlayClosedSubject=new be;clientInfoSubject=new de(null);clientRegisteredSubject=new be;clientRegisterErrorSubject=new be;headersResponseSubject=new be;menuNavigationRequestedSubject=new be;deviceInfo$=this.deviceInfoSubject.asObservable();oauthCallback$=this.oauthCallbackSubject.asObservable();authTokens$=this.authTokensSubject.asObservable();authError$=this.authErrorSubject.asObservable();myPageClosed$=this.myPageClosedSubject.asObservable();userTokenInfo$=this.userTokenInfoSubject.asObservable();tokens$=this.tokensSubject.asObservable();authStatus$=this.authStatusSubject.asObservable();refreshTokenRequest$=this.refreshTokenRequestSubject.asObservable();overlayClosed$=this.overlayClosedSubject.asObservable();clientInfo$=this.clientInfoSubject.asObservable();clientRegistered$=this.clientRegisteredSubject.asObservable();clientRegisterError$=this.clientRegisterErrorSubject.asObservable();headersResponse$=this.headersResponseSubject.asObservable();menuNavigationRequested$=this.menuNavigationRequestedSubject.asObservable();debugInfo={oauthCallbacks:[],lastOAuthCallback:null,backendTokens:null,deviceInfo:null,userTokenInfo:null,logs:[]};registerMessageHandler(){ye()&&(window.onAndroidMessage=(t,e)=>{this.ngZone.run(()=>{switch(console.log(`\u{1F4E9} [Android \u2192 Angular] ${t}:`,e),this.addDebugLog("info",`Android \uBA54\uC2DC\uC9C0 \uC218\uC2E0: ${t}`,e),this.messageSubject.next({type:t,data:e}),t){case"authTokens":this.handleAuthTokens(e);break;case"authError":this.handleAuthError(e);break;case"oauthCallback":this.handleOAuthCallback(e);break;case"oauthError":this.handleOAuthError(e);break;case"deviceInfo":this.handleDeviceInfo(e);break;case"signOutComplete":this.handleSignOutComplete();break;case"myPageClosed":this.handleMyPageClosed(e);break;case"clientRegistered":this.handleClientRegistered(e);break;case"clientRegisterError":this.handleClientRegisterError(e);break;case"clientInfo":this.handleClientInfoResponse(e);break;case"headers":this.handleHeadersResponse(e);break;case"tokens":this.handleTokensResponse(e);break;case"authStatus":this.handleAuthStatusResponse(e);break;case"refreshTokenRequest":this.handleRefreshTokenRequest(e);break;case"overlayClosed":this.handleOverlayClosed();break;case"authTokensSaved":this.handleAuthTokensSaved(e);break;case"storedTokens":this.handleStoredTokens(e);break;case"menuNavigationRequested":this.handleMenuNavigationRequested(e);break;default:console.warn("\u26A0\uFE0F \uC54C \uC218 \uC5C6\uB294 \uBA54\uC2DC\uC9C0 \uD0C0\uC785:",t)}})},console.log("\u2705 Android \uBE0C\uB9BF\uC9C0 \uCD08\uAE30\uD654 \uC644\uB8CC (window.onAndroidMessage \uC9C1\uC811 \uD638\uCD9C \uBC29\uC2DD)"))}checkPendingOAuthCallback(){if(ye())try{let t=localStorage.getItem("androidOAuthCallback");if(t){console.log("\u{1F4BE} localStorage\uC5D0\uC11C OAuth \uBCF5\uAD6C"),this.addDebugLog("info","localStorage\uC5D0\uC11C OAuth \uB370\uC774\uD130 \uBCF5\uAD6C");let e=JSON.parse(t);localStorage.removeItem("androidOAuthCallback"),this.ngZone.run(()=>{this.handleOAuthCallback(e)})}}catch(t){console.error("\u274C localStorage \uD655\uC778 \uC2E4\uD328:",t),this.addDebugLog("error","localStorage OAuth \uBCF5\uAD6C \uC2E4\uD328",t)}}handleOAuthCallback(t){console.log("\u{1F510} ============ OAuth \uCF5C\uBC31 \uC218\uC2E0 ============"),console.log("\u{1F4CB} \uC804\uCCB4 \uB370\uC774\uD130:",t),t.timestamp||(t.timestamp=Date.now());let e;if(t.redirectUri&&!t.fullUrl){console.log("\u{1F504} Android \uD615\uC2DD \uB370\uC774\uD130 \uAC10\uC9C0 \u2192 OAuthCallbackData\uB85C \uBCC0\uD658");try{e={fullUrl:`${t.redirectUri}?code=${t.code}&state=${t.state||""}`,domain:new URL(t.redirectUri).origin,provider:t.provider,state:t.state||null,code:t.code,scope:t.scope||null,authuser:t.authuser||null,prompt:t.prompt||null,error:t.error||null,timestamp:t.timestamp,redirectUri:t.redirectUri}}catch(n){console.error("\u274C redirectUri \uD30C\uC2F1 \uC2E4\uD328:",n),e={fullUrl:t.redirectUri||"",domain:"https://dev.ezlab.im",provider:t.provider,state:t.state||null,code:t.code,scope:null,authuser:null,prompt:null,error:null,timestamp:t.timestamp,redirectUri:t.redirectUri}}}else e=t;console.log("\u{1F4CC} OAuth \uCF5C\uBC31 \uC0C1\uC138 \uC815\uBCF4:"),console.log("  - fullUrl:",e.fullUrl),console.log("  - domain:",e.domain||"\uC5C6\uC74C"),console.log("  - provider:",e.provider||"\uC5C6\uC74C"),console.log("  - state:",e.state?`${e.state.substring(0,30)}...`:"\uC5C6\uC74C"),console.log("  - code:",e.code?`${e.code.substring(0,30)}...`:"\uC5C6\uC74C"),console.log("  - scope:",e.scope||"\uC5C6\uC74C"),console.log("  - authuser:",e.authuser||"\uC5C6\uC74C"),console.log("  - prompt:",e.prompt||"\uC5C6\uC74C"),console.log("  - error:",e.error||"\uC5C6\uC74C"),console.log("  - timestamp:",new Date(e.timestamp).toLocaleString()),console.log("\u{1F510} ========================================="),this.debugInfo.oauthCallbacks.push(e),this.debugInfo.lastOAuthCallback=e,e.error?(this.snackbar.showError(`\u274C \uB85C\uADF8\uC778 \uC2E4\uD328: ${e.error}`),this.addDebugLog("error","OAuth \uC5D0\uB7EC",{error:e.error,fullUrl:e.fullUrl,provider:e.provider})):e.code?(this.snackbar.showSuccess("\u2705 \uB85C\uADF8\uC778 \uC815\uBCF4 \uC218\uC2E0 \uC644\uB8CC"),this.addDebugLog("success",`OAuth \uCF5C\uBC31 \uC218\uC2E0 (${e.provider||"unknown"})`,{provider:e.provider,domain:e.domain,codeLength:e.code.length,scope:e.scope,authuser:e.authuser,prompt:e.prompt,hasState:!!e.state})):this.addDebugLog("warning","OAuth \uCF5C\uBC31 \uC218\uC2E0 (code \uC5C6\uC74C)",e),this.oauthCallbackSubject.next(e)}handleDeviceInfo(t){if(console.log("\u{1F4E6} \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4 \uC218\uC2E0:",t),t.code&&t.provider){console.log("\u{1F510} OAuth \uCF5C\uBC31 \uB370\uC774\uD130 \uAC10\uC9C0 (deviceInfo\uB85C \uC804\uC1A1\uB428)"),console.log("\u{1F4CB} \uC6D0\uBCF8 \uB370\uC774\uD130:",t);let n={fullUrl:t.redirectUri||`https://dev.ezlab.im/auth/callback/${t.provider}?code=${t.code}&state=${t.state||""}`,domain:t.redirectUri?new URL(t.redirectUri).origin:"https://dev.ezlab.im",provider:t.provider,state:t.state||null,code:t.code,scope:t.scope||null,authuser:t.authuser||null,prompt:t.prompt||null,error:t.error||null,timestamp:t.timestamp||Date.now(),redirectUri:t.redirectUri||null};console.log("\u2705 \uBCC0\uD658\uB41C OAuth \uB370\uC774\uD130:",n),this.handleOAuthCallback(n);return}let e=t;this.debugInfo.deviceInfo=e,this.deviceInfoSubject.next(e),this.addDebugLog("info","\uB514\uBC14\uC774\uC2A4 \uC815\uBCF4 \uC218\uC2E0",e),e.clientInfo&&(console.log("\u{1F4CB} \uD074\uB77C\uC774\uC5B8\uD2B8 \uC815\uBCF4 \uC218\uC2E0:",e.clientInfo),this.clientInfoSubject.next(e.clientInfo),this.addDebugLog("info","\uD074\uB77C\uC774\uC5B8\uD2B8 \uC815\uBCF4 \uC218\uC2E0",e.clientInfo)),this.applyDeviceLayout(e),e.oauthCallback&&(console.log("\u{1F510} OAuth \uCF5C\uBC31 \uB370\uC774\uD130 \uAC10\uC9C0 (deviceInfo \uB0B4):",e.oauthCallback),this.handleOAuthCallback(e.oauthCallback))}applyDeviceLayout(t){console.log("\u{1F3A8} [Layout] \uB514\uBC14\uC774\uC2A4 \uB808\uC774\uC544\uC6C3 \uC801\uC6A9 \uC2DC\uC791"),console.log("\u{1F534} [Layout] hasNotch:",t.hasNotch);let e=t.hasNotch?20:0,n=t.hasNotch?40:0;console.log("\u{1F4BE} [Layout] \uC801\uC6A9\uD560 \uAC12:",{statusBarHeight:e,navigationBarHeight:n}),document.documentElement.style.setProperty("--android-status-bar-height",`${e}px`),document.documentElement.style.setProperty("--android-navigation-bar-height",`${n}px`),document.documentElement.style.setProperty("--safe-area-top",`${e}px`),document.documentElement.style.setProperty("--safe-area-bottom",`${n}px`),document.documentElement.style.setProperty("--status-bar-height",`${e}px`),document.documentElement.style.setProperty("--navigation-bar-height",`${n}px`);try{localStorage.setItem("androidStatusBarHeight",e.toString()),localStorage.setItem("androidNavigationBarHeight",n.toString()),console.log("\u2705 [Layout] CSS \uBCC0\uC218 \uC801\uC6A9 \uBC0F localStorage \uC800\uC7A5 \uC644\uB8CC")}catch(i){console.error("\u274C [Layout] localStorage \uC800\uC7A5 \uC2E4\uD328:",i)}}handleOAuthError(t){console.error("\u274C OAuth \uC5D0\uB7EC:",t),this.snackbar.showError(`\u274C \uB85C\uADF8\uC778 \uC2E4\uD328: ${t.error||"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958"}`),this.addDebugLog("error","OAuth \uC5D0\uB7EC",t)}handleAuthTokens(t){console.log("\u{1F510} ============ JWT \uD1A0\uD070 \uC218\uC2E0 (Android) ============"),console.log("\u{1F4CB} \uC804\uCCB4 \uB370\uC774\uD130:",t),console.log("\u{1F4CC} \uD1A0\uD070 \uC0C1\uC138 \uC815\uBCF4:"),console.log("  - Provider:",t.provider),console.log("  - Access Token:",t.accessToken?.substring(0,50)+"..."),console.log("  - Refresh Token:",t.refreshToken?.substring(0,50)+"..."),console.log("  - Access Expires:",t.accessExpiresAt),console.log("  - Refresh Expires:",t.refreshExpiresAt),console.log("\u{1F510} ================================================"),this.saveBackendTokenInfo({accessToken:t.accessToken,refreshToken:t.refreshToken,accessExpiresAt:t.accessExpiresAt,refreshExpiresAt:t.refreshExpiresAt},t.provider),this.snackbar.showSuccess("\u2705 Android\uC5D0\uC11C \uB85C\uADF8\uC778 \uD1A0\uD070 \uC218\uC2E0 \uC644\uB8CC"),this.addDebugLog("success",`JWT \uD1A0\uD070 \uC218\uC2E0 (${t.provider})`,{provider:t.provider,accessTokenPrefix:t.accessToken?.substring(0,30)+"...",accessExpiresAt:t.accessExpiresAt,refreshExpiresAt:t.refreshExpiresAt}),this.authTokensSubject.next(t)}handleAuthError(t){console.error("\u274C \uC778\uC99D \uC5D0\uB7EC (Android):",t),this.snackbar.showError(`\u274C \uB85C\uADF8\uC778 \uC2E4\uD328: ${t.error}`),this.addDebugLog("error","\uC778\uC99D \uC5D0\uB7EC",t),this.authErrorSubject.next(t)}handleSignOutComplete(){console.log("\u2705 \uB85C\uADF8\uC544\uC6C3 \uC644\uB8CC (Android)"),this.snackbar.showInfo("\uB85C\uADF8\uC544\uC6C3\uB418\uC5C8\uC2B5\uB2C8\uB2E4"),this.addDebugLog("info","\uB85C\uADF8\uC544\uC6C3 \uC644\uB8CC"),this.debugInfo.backendTokens=null}addDebugLog(t,e,n){let i={timestamp:new Date,type:t,message:e,data:n};this.debugInfo.logs.unshift(i),this.debugInfo.logs.length>100&&(this.debugInfo.logs=this.debugInfo.logs.slice(0,100)),console.log(`[${t.toUpperCase()}] ${e}`,n||"")}requestAuth(){Yo()}checkLoginStatus(){qo()}signOut(){Xo()}test(){Jo()}isAvailable(){return ye()}getDeviceInfo(){return this.deviceInfoSubject.value}saveBackendTokenInfo(t,e){this.debugInfo.backendTokens={accessToken:t.access_token||t.accessToken||"",refreshToken:t.refresh_token||t.refreshToken||"",accessExpiresAt:this.formatExpiresAt(t.access_expires_at||t.accessExpiresAt||""),refreshExpiresAt:this.formatExpiresAt(t.refresh_expires_at||t.refreshExpiresAt||""),receivedAt:Date.now(),provider:e},this.addDebugLog("success","\uBC31\uC5D4\uB4DC \uD1A0\uD070 \uC218\uC2E0 \uC644\uB8CC",{provider:e,accessTokenPrefix:this.debugInfo.backendTokens.accessToken?.substring(0,30)+"...",refreshTokenPrefix:this.debugInfo.backendTokens.refreshToken?.substring(0,30)+"...",accessExpiresAt:this.debugInfo.backendTokens.accessExpiresAt,refreshExpiresAt:this.debugInfo.backendTokens.refreshExpiresAt}),console.log("\u{1F4BE} \uBC31\uC5D4\uB4DC \uD1A0\uD070 \uB514\uBC84\uADF8 \uC815\uBCF4 \uC800\uC7A5 \uC644\uB8CC"),console.log("  - Provider:",e),console.log("  - Access Token:",this.debugInfo.backendTokens.accessToken?.substring(0,50)+"..."),console.log("  - Access Expires:",this.debugInfo.backendTokens.accessExpiresAt),console.log("  - Refresh Token:",this.debugInfo.backendTokens.refreshToken?.substring(0,50)+"..."),console.log("  - Refresh Expires:",this.debugInfo.backendTokens.refreshExpiresAt)}formatExpiresAt(t){if(!t||t.length!==14)return t;let e=t.substring(0,4),n=t.substring(4,6),i=t.substring(6,8),s=t.substring(8,10),d=t.substring(10,12),_=t.substring(12,14);return`${e}-${n}-${i} ${s}:${d}:${_}`}getDebugInfo(){return K({},this.debugInfo)}getLastOAuthCallback(){return this.debugInfo.lastOAuthCallback}getOAuthCallbackHistory(){return[...this.debugInfo.oauthCallbacks]}getDebugLogs(){return[...this.debugInfo.logs]}clearDebugInfo(){this.debugInfo={oauthCallbacks:[],lastOAuthCallback:null,backendTokens:null,deviceInfo:this.debugInfo.deviceInfo,userTokenInfo:this.debugInfo.userTokenInfo,logs:[]},this.addDebugLog("info","\uB514\uBC84\uADF8 \uC815\uBCF4 \uCD08\uAE30\uD654\uB428")}getTokens(){console.log("\u{1F4E4} Android\uC5D0 \uD1A0\uD070 \uC870\uD68C \uC694\uCCAD"),this.addDebugLog("info","\uD1A0\uD070 \uC870\uD68C \uC694\uCCAD"),this.send("getTokens",{})}getAuthStatus(){console.log("\u{1F4E4} Android\uC5D0 \uC778\uC99D \uC0C1\uD0DC \uC870\uD68C \uC694\uCCAD"),this.addDebugLog("info","\uC778\uC99D \uC0C1\uD0DC \uC870\uD68C \uC694\uCCAD"),this.send("getAuthStatus",{})}requestRefreshToken(){console.log("\u{1F4E4} Android\uC5D0 Refresh Token \uC694\uCCAD"),this.addDebugLog("info","Refresh Token \uC694\uCCAD"),this.send("refreshToken",{})}closeOverlay(){console.log("\u{1F4E4} \uC624\uBC84\uB808\uC774 \uB2EB\uAE30 \uC694\uCCAD"),this.addDebugLog("info","\uC624\uBC84\uB808\uC774 \uB2EB\uAE30 \uC694\uCCAD"),this.send("closeOverlay",{})}openLoginWebView(t=100,e=200){this.addDebugLog("info","\uB85C\uADF8\uC778 WebView \uC5F4\uAE30 \uC694\uCCAD",{headerHeight:t,bottomHeight:e}),this.send("openLoginWebView",{headerHeight:t,bottomHeight:e})}openMyPage(t,e=100,n=200){let i="https://dev.ezlab.im/ko/mypage?client_type=mo";this.addDebugLog("info","\uB9C8\uC774\uD398\uC774\uC9C0 WebView \uC5F4\uAE30 \uC694\uCCAD",{url:i,headerHeight:e,bottomHeight:n}),this.send("openMyPage",{url:i,accessToken:t,headerHeight:e,bottomHeight:n})}closeWebView(t){this.addDebugLog("info","WebView \uB2EB\uAE30 \uC694\uCCAD",{reason:t||"unknown"}),this.send("closeWebView",{reason:t||"user-navigation"})}saveTokensToAndroid(t,e,n,i,s){let d={access_token:t,refresh_token:e,access_expires_at:n,refresh_expires_at:i,provider:s};console.log("\u{1F4E4} Android\uC5D0 \uD1A0\uD070 \uC800\uC7A5 \uC694\uCCAD:",{provider:s,access_expires_at:n,refresh_expires_at:i}),this.send("saveTokens",d),this.addDebugLog("info","Android\uC5D0 \uD1A0\uD070 \uC800\uC7A5 \uC694\uCCAD",d)}send(t,e){window.sendToAndroid?(window.sendToAndroid(t,e),console.log(`\u{1F4E4} [Angular \u2192 Android] ${t}:`,e)):console.warn(`\u26A0\uFE0F sendToAndroid \uD568\uC218 \uC5C6\uC74C - Android Bridge\uAC00 \uC900\uBE44\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4. action: ${t}`)}handleMyPageClosed(t){console.log("\u{1F4E6} \uB9C8\uC774\uD398\uC774\uC9C0 WebView \uB2EB\uD798:",t),this.addDebugLog("info","\uB9C8\uC774\uD398\uC774\uC9C0 WebView \uB2EB\uD798",t),this.myPageClosedSubject.next(t)}handleTokensResponse(t){console.log("\u{1F4E6} \uD1A0\uD070 \uC815\uBCF4 \uC218\uC2E0:",{isAuthenticated:t.isAuthenticated,provider:t.provider,isAccessTokenExpired:t.isAccessTokenExpired,isRefreshTokenExpired:t.isRefreshTokenExpired,remainingSeconds:t.remainingSeconds}),this.addDebugLog("info","\uD1A0\uD070 \uC815\uBCF4 \uC218\uC2E0",t),this.tokensSubject.next(t)}handleAuthStatusResponse(t){console.log("\u{1F4E6} \uC778\uC99D \uC0C1\uD0DC \uC218\uC2E0:",{isAuthenticated:t.isAuthenticated,provider:t.provider,isAccessTokenExpired:t.isAccessTokenExpired,remainingSeconds:t.remainingSeconds}),this.addDebugLog("info","\uC778\uC99D \uC0C1\uD0DC \uC218\uC2E0",t),this.authStatusSubject.next(t)}handleRefreshTokenRequest(t){t.success?(console.log("\u{1F4E6} Refresh Token \uC218\uC2E0 (\uAC31\uC2E0\uC6A9):",{provider:t.provider,hasToken:!!t.refreshToken}),this.addDebugLog("info","Refresh Token \uC218\uC2E0",t)):(console.error("\u274C Refresh Token \uC694\uCCAD \uC2E4\uD328:",t.error,t.message),this.addDebugLog("error","Refresh Token \uC694\uCCAD \uC2E4\uD328",t)),this.refreshTokenRequestSubject.next(t)}handleOverlayClosed(){console.log("\u{1F4E6} \uC624\uBC84\uB808\uC774 \uB2EB\uD798"),this.addDebugLog("info","\uC624\uBC84\uB808\uC774 \uB2EB\uD798"),this.overlayClosedSubject.next()}handleAuthTokensSaved(t){console.log("\u2705 \uD1A0\uD070 \uC800\uC7A5 \uC644\uB8CC:",t),this.addDebugLog("success","\uD1A0\uD070 \uC800\uC7A5 \uC644\uB8CC",t)}requestStoredTokens(){console.log("\u{1F4E4} Android\uC5D0 \uC800\uC7A5\uB41C \uD1A0\uD070 \uC815\uBCF4 \uC694\uCCAD (\uC571 \uCD08\uAE30\uD654)"),this.addDebugLog("info","\uC800\uC7A5\uB41C \uD1A0\uD070 \uC815\uBCF4 \uC694\uCCAD"),this.send("getStoredTokens",{})}handleStoredTokens(t){let e=Z(K({},t),{receivedAt:Date.now()});console.log("\u{1F4E6} [\uC571 \uCD08\uAE30\uD654] \uC800\uC7A5\uB41C \uD1A0\uD070 \uC815\uBCF4 \uC218\uC2E0:",{isAuthenticated:e.isAuthenticated,provider:e.provider,hasAccessToken:!!e.accessToken,hasRefreshToken:!!e.refreshToken,isAccessTokenExpired:e.isAccessTokenExpired,isRefreshTokenExpired:e.isRefreshTokenExpired,remainingSeconds:e.remainingSeconds}),this.debugInfo.userTokenInfo=e,this.addDebugLog("success","\uC800\uC7A5\uB41C \uD1A0\uD070 \uC815\uBCF4 \uC218\uC2E0 (\uB85C\uADF8\uC778 \uC0C1\uD0DC \uBCF5\uC6D0)",e),this.userTokenInfoSubject.next(e),e.isAuthenticated?e.isAccessTokenExpired&&!e.isRefreshTokenExpired?(console.log("\u26A0\uFE0F Access Token \uB9CC\uB8CC\uB428 - \uAC31\uC2E0 \uD544\uC694"),this.addDebugLog("warning","Access Token \uB9CC\uB8CC - \uAC31\uC2E0 \uD544\uC694")):e.isRefreshTokenExpired?(console.log("\u274C Refresh Token \uB9CC\uB8CC\uB428 - \uC7AC\uB85C\uADF8\uC778 \uD544\uC694"),this.addDebugLog("error","Refresh Token \uB9CC\uB8CC - \uC7AC\uB85C\uADF8\uC778 \uD544\uC694")):(console.log("\u2705 \uC720\uD6A8\uD55C \uD1A0\uD070\uC73C\uB85C \uB85C\uADF8\uC778 \uC0C1\uD0DC \uBCF5\uC6D0\uB428"),this.addDebugLog("success","\uB85C\uADF8\uC778 \uC0C1\uD0DC \uBCF5\uC6D0 \uC644\uB8CC")):(console.log("\u2139\uFE0F \uC800\uC7A5\uB41C \uC778\uC99D \uC815\uBCF4 \uC5C6\uC74C - \uBE44\uB85C\uADF8\uC778 \uC0C1\uD0DC"),this.addDebugLog("info","\uC800\uC7A5\uB41C \uC778\uC99D \uC815\uBCF4 \uC5C6\uC74C"))}getUserTokenInfo(){return this.userTokenInfoSubject.value}handleMenuNavigationRequested(t){console.log("\u{1F9ED} [\uBA54\uB274 \uB124\uBE44\uAC8C\uC774\uC158] Android\uC5D0\uC11C \uC694\uCCAD\uBC1B\uC74C:",t),this.ngZone.run(()=>{this.menuNavigationRequestedSubject.next(t)}),this.addDebugLog("info","\uBA54\uB274 \uB124\uBE44\uAC8C\uC774\uC158 \uC694\uCCAD \uC218\uC2E0",t)}navigateToMenu(t,e,n){console.log("\u{1F9ED} [\uBA54\uB274 \uB124\uBE44\uAC8C\uC774\uC158] Android\uB85C \uC804\uC1A1:",{menuId:t,route:e,params:n}),this.send("navigateToMenu",{menuId:t,route:e,params:n}),this.addDebugLog("info","Android\uB85C \uBA54\uB274 \uB124\uBE44\uAC8C\uC774\uC158 \uC804\uC1A1",{menuId:t,route:e})}isLoggedIn(){let t=this.userTokenInfoSubject.value;return t?.isAuthenticated===!0&&!t?.isRefreshTokenExpired}needsTokenRefresh(){let t=this.userTokenInfoSubject.value;return t?.isAuthenticated===!0&&t?.isAccessTokenExpired===!0&&t?.isRefreshTokenExpired===!1}updateUserTokenInfo(t){let e=this.userTokenInfoSubject.value,n={isAuthenticated:t.isAuthenticated??e?.isAuthenticated??!1,accessToken:t.accessToken??e?.accessToken??null,refreshToken:t.refreshToken??e?.refreshToken??null,provider:t.provider??e?.provider??null,accessExpiresAt:t.accessExpiresAt??e?.accessExpiresAt??null,refreshExpiresAt:t.refreshExpiresAt??e?.refreshExpiresAt??null,isAccessTokenExpired:t.isAccessTokenExpired??e?.isAccessTokenExpired??!1,isRefreshTokenExpired:t.isRefreshTokenExpired??e?.isRefreshTokenExpired??!1,remainingSeconds:t.remainingSeconds??e?.remainingSeconds??0,receivedAt:Date.now()};this.debugInfo.userTokenInfo=n,this.userTokenInfoSubject.next(n),this.addDebugLog("info","\uC720\uC800 \uD1A0\uD070 \uC815\uBCF4 \uAC31\uC2E0",n)}clearUserTokenInfo(){let t={isAuthenticated:!1,accessToken:null,refreshToken:null,provider:null,accessExpiresAt:null,refreshExpiresAt:null,isAccessTokenExpired:!1,isRefreshTokenExpired:!1,remainingSeconds:0,receivedAt:Date.now()};this.debugInfo.userTokenInfo=t,this.userTokenInfoSubject.next(t),this.addDebugLog("info","\uC720\uC800 \uD1A0\uD070 \uC815\uBCF4 \uCD08\uAE30\uD654 (\uB85C\uADF8\uC544\uC6C3)")}handleClientRegistered(t){console.log("\u2705 \uD074\uB77C\uC774\uC5B8\uD2B8 \uB4F1\uB85D \uC644\uB8CC:",t),this.addDebugLog("success","\uD074\uB77C\uC774\uC5B8\uD2B8 \uB4F1\uB85D \uC644\uB8CC",t),t.clientInfo&&this.clientInfoSubject.next(t.clientInfo),this.clientRegisteredSubject.next(t),t.isNewRegistration?console.log("\u{1F195} \uC2E0\uADDC \uD074\uB77C\uC774\uC5B8\uD2B8 \uB4F1\uB85D - Client ID:",t.clientId):console.log("\u{1F4CB} \uAE30\uC874 \uD074\uB77C\uC774\uC5B8\uD2B8 - Client ID:",t.clientId)}handleClientRegisterError(t){console.error("\u274C \uD074\uB77C\uC774\uC5B8\uD2B8 \uB4F1\uB85D \uC2E4\uD328:",t),this.addDebugLog("error","\uD074\uB77C\uC774\uC5B8\uD2B8 \uB4F1\uB85D \uC2E4\uD328",t),this.clientRegisterErrorSubject.next(t)}handleClientInfoResponse(t){console.log("\u{1F4CB} \uD074\uB77C\uC774\uC5B8\uD2B8 \uC815\uBCF4 \uC751\uB2F5:",t),this.addDebugLog("info","\uD074\uB77C\uC774\uC5B8\uD2B8 \uC815\uBCF4 \uC751\uB2F5",t),t.clientInfo&&this.clientInfoSubject.next(t.clientInfo)}handleHeadersResponse(t){console.log("\u{1F4CB} \uD5E4\uB354 \uC815\uBCF4 \uC751\uB2F5:",t),this.addDebugLog("info","\uD5E4\uB354 \uC815\uBCF4 \uC751\uB2F5",t),this.headersResponseSubject.next(t)}requestClientInfo(){console.log("\u{1F4E4} \uD074\uB77C\uC774\uC5B8\uD2B8 \uC815\uBCF4 \uC694\uCCAD"),this.send("getClientInfo",{})}requestClientRegistration(){console.log("\u{1F4E4} \uD074\uB77C\uC774\uC5B8\uD2B8 \uB4F1\uB85D \uC694\uCCAD"),this.send("registerClient",{})}requestHeaders(t=!1){console.log("\u{1F4E4} \uD5E4\uB354 \uC815\uBCF4 \uC694\uCCAD (includeAuth:",t,")"),this.send("getHeaders",{includeAuth:t})}getClientId(){return this.clientInfoSubject.value?.clientId??null}isClientRegistered(){return this.clientInfoSubject.value?.isRegistered??!1}getClientInfo(){return this.clientInfoSubject.value}getApiHeaders(){let t=this.clientInfoSubject.value;return t?{"X-Device-Id":t.deviceId,"X-Client-Id":t.clientId??"","X-Client-OS":t.clientOS,"X-Platform":t.platform,"X-Client-Version":t.clientVersion}:(console.warn("\u26A0\uFE0F ClientInfo\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. Android\uC5D0\uC11C \uC544\uC9C1 \uC804\uB2EC\uBC1B\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4."),{})}isAndroid(){return/android/i.test(navigator.userAgent)}requestDeviceInfoFromAndroid(){console.log("\u{1F4F1} [AndroidBridge] \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4 \uC790\uB3D9 \uC694\uCCAD \uC2DC\uC791"),this.send("getDeviceInfo",{})}static \u0275fac=function(e){return new(e||r)(X(jt),X(G))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Hn=class r{constructor(t,e,n){this.platform=t;this.iosBridge=e;this.androidBridge=n;this.message$=this.getMessageStream()}message$;getMessageStream(){return this.platform.isIOS()?this.iosBridge.message$:this.platform.isAndroid()?this.androidBridge.message$:Hi}getMessages(){return this.message$}requestAuth(){this.platform.isIOS()?this.iosBridge.requestAuth():this.platform.isAndroid()&&this.androidBridge.requestAuth()}checkLoginStatus(){this.platform.isIOS()?this.iosBridge.checkLoginStatus():this.platform.isAndroid()&&this.androidBridge.checkLoginStatus()}checkAuthStatus(){this.checkLoginStatus()}signOut(){this.platform.isIOS()?this.iosBridge.signOut():this.platform.isAndroid()&&this.androidBridge.signOut()}test(){this.platform.isIOS()?this.iosBridge.test():this.platform.isAndroid()&&this.androidBridge.test()}isAvailable(){return this.platform.isIOS()?this.iosBridge.isAvailable():this.platform.isAndroid()?this.androidBridge.isAvailable():!1}getPlatformInfo(){return{type:this.platform.platform,isAvailable:this.isAvailable(),debugInfo:this.platform.getDebugInfo()}}static \u0275fac=function(e){return new(e||r)(X(mt),X(Un),X(Ae))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var ft=class r{constructor(t,e,n,i){this.http=t;this.ngZone=e;this.nativeBridge=n;this.platform=i;this.registerNativeCallbacks()}CLIENT_ID=Ye.googleOAuth?.clientId||"";REDIRECT_URI=Ye.googleOAuth?.redirectUri||`${window.location.origin}`;SCOPE="openid profile email";nativeAuthSubject=new be;nativeAuth$=this.nativeAuthSubject.asObservable();currentPurpose="apiKey";registerNativeCallbacks(){this.platform.isNative()&&this.nativeBridge.getMessages().subscribe({next:({type:t,data:e})=>{this.ngZone.run(()=>{switch(t){case"authSuccess":let n={success:!0,accessToken:e.token||"",refreshToken:"",expiresIn:3600,userInfo:{email:"",name:"",picture:"",sub:""},geminiApiKey:e.token||"",purpose:this.currentPurpose};this.nativeAuthSubject.next(n);break;case"authError":let i={success:!1,accessToken:"",refreshToken:"",userInfo:{email:"",name:"",picture:"",sub:""},geminiApiKey:"",error:e.error,purpose:this.currentPurpose};this.nativeAuthSubject.next(i);break;case"authStatus":break;case"signOutComplete":break;case"testResponse":break;default:}})},error:t=>{}})}isNativeAuthAvailable(){return this.platform.isNative()}isNativeLoggedIn(){return this.isNativeAuthAvailable()&&this.nativeBridge.checkAuthStatus(),!1}nativeSignOut(){this.isNativeAuthAvailable()&&this.nativeBridge.signOut()}startGoogleLogin(t="apiKey"){if(this.currentPurpose=t,this.isNativeAuthAvailable()){try{this.nativeBridge.requestAuth(),this.platform.isAndroid()||this.platform.isIOS()}catch{}return}let e=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${encodeURIComponent(this.CLIENT_ID)}&redirect_uri=${encodeURIComponent(this.REDIRECT_URI)}&response_type=token id_token&scope=${encodeURIComponent(this.SCOPE)}&nonce=${Date.now()}&prompt=consent`;window.location.href=e}exchangeCodeForToken(t){return this.http.post(`${Ye.apiUrl}/api/auth/google/callback`,{code:t,redirectUri:this.REDIRECT_URI})}refreshAccessToken(t){return this.http.post(`${Ye.apiUrl}/api/auth/google/refresh`,{refreshToken:t})}exchangeCodeForTokenDirect(t){let e="https://oauth2.googleapis.com/token",n=new URLSearchParams({code:t,client_id:this.CLIENT_ID,redirect_uri:this.REDIRECT_URI,grant_type:"authorization_code"});return new ki(i=>{this.http.post(e,n.toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).subscribe({next:s=>{this.getUserInfo(s.access_token).subscribe({next:d=>{i.next({success:!0,accessToken:s.access_token,refreshToken:s.refresh_token,expiresIn:s.expires_in,userInfo:d,geminiApiKey:s.access_token}),i.complete()},error:d=>{i.error(d)}})},error:s=>{i.error(s)}})})}getUserInfo(t){return this.http.get("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${t}`}})}exchangeCodeForTokenMock(t){return new ki(e=>{setTimeout(()=>{e.next({success:!0,accessToken:"mock_access_token",refreshToken:"mock_refresh_token",userInfo:{email:"test@gmail.com",name:"Test User",picture:"",sub:"mock_user_id"},geminiApiKey:"U2FsdGVkX1/GYCp1tiIZj/HoDuhpEQZVfTh2jatdUtSrni+TI2JZn4qaeHt47QlrljuamiQjTm7ZU3ZDnnM+Jw=="}),e.complete()},1e3)})}static \u0275fac=function(e){return new(e||r)(X(Ht),X(jt),X(Hn),X(mt))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var qt=class r{constructor(t){this.http=t}API_BASE_URL="https://dev-api.ezlab.im";AUTH_LOGIN_ENDPOINT="/auth/login";TOKEN_STORAGE_KEY="ezm_backend_tokens";CLIENT_ID="ezm-mobile-app";CLIENT_VERSION="1.0.0";loginWithOAuthCode(t,e){return C(this,null,function*(){try{console.log("\u{1F510} \uBC31\uC5D4\uB4DC \uB85C\uADF8\uC778 API \uD638\uCD9C \uC2DC\uC791"),console.log("  - Provider:",t.provider),console.log("  - Domain:",t.domain),console.log("  - Code:",t.code?.substring(0,20)+"...");let n=this.getDeviceInfo(),i=e||this.generateDeviceId(),s=this.buildRequestHeaders(i),d=this.buildRequestBody(t,i);console.log("\u{1F4E4} API \uC694\uCCAD \uC815\uBCF4:"),console.log("  - URL:",`${this.API_BASE_URL}${this.AUTH_LOGIN_ENDPOINT}`),console.log("  - Headers:",s),console.log("  - Body:",Z(K({},d),{code:d.code.substring(0,20)+"..."}));let _=yield this.http.post(`${this.API_BASE_URL}${this.AUTH_LOGIN_ENDPOINT}`,d,{headers:s}).toPromise();if(!_)throw new Error("API \uC751\uB2F5\uC774 \uC5C6\uC2B5\uB2C8\uB2E4");return console.log("\u2705 \uBC31\uC5D4\uB4DC \uB85C\uADF8\uC778 \uC131\uACF5"),console.log("  - Access Token:",_.data.access_token.substring(0,30)+"..."),console.log("  - Access Expires:",_.data.access_expires_at),console.log("  - Refresh Expires:",_.data.refresh_expires_at),this.saveTokens(_,t.provider||"google"),_}catch(n){throw console.error("\u274C \uBC31\uC5D4\uB4DC \uB85C\uADF8\uC778 \uC2E4\uD328:",n),n.error&&console.error("  - \uC11C\uBC84 \uC751\uB2F5:",n.error),n.status&&console.error("  - HTTP Status:",n.status),n}})}buildRequestHeaders(t){let e=this.getDeviceInfo(),n={"Content-Type":"application/json","X-Client-Id":this.CLIENT_ID,"X-Client-OS":e.os,"X-Platform":e.platform,"X-Client-Version":this.CLIENT_VERSION};return t&&(n["X-Device-Id"]=t),new rn(n)}buildRequestBody(t,e){let n="GOOGLE";if(t.provider){let i=t.provider.toLowerCase();i==="kakao"?n="KAKAO":i==="naver"&&(n="NAVER")}return{type:n,code:t.code||"",redirect_uri:this.getRedirectUri(t)}}getDeviceInfo(){let t=navigator.userAgent.toLowerCase();return t.includes("android")?{os:"ANDROID",platform:"MOBILE",deviceType:"MOBILE_ANDROID"}:t.includes("iphone")||t.includes("ipad")?{os:"IOS",platform:"MOBILE",deviceType:"MOBILE_IOS"}:t.includes("mac")?{os:"MACOS",platform:"DESKTOP",deviceType:"DESKTOP_MAC"}:t.includes("win")?{os:"WINDOWS",platform:"DESKTOP",deviceType:"DESKTOP_WINDOWS"}:{os:"LINUX",platform:"WEB",deviceType:"WEB"}}generateDeviceId(){let t="ezm_device_id",e=localStorage.getItem(t);return e||(e=`ezm-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,localStorage.setItem(t,e),console.log("\u{1F194} \uC0C8 \uB514\uBC14\uC774\uC2A4 ID \uC0DD\uC131:",e)),e}getRedirectUri(t){if(t.redirectUri)return console.log("\u{1F3AF} redirect_uri: Android \uC804\uB2EC\uAC12 \uC0AC\uC6A9:",t.redirectUri),t.redirectUri;try{let i=new URL(t.fullUrl).searchParams.get("redirect_uri");if(i)return console.log("\u{1F3AF} redirect_uri: fullUrl\uC5D0\uC11C \uCD94\uCD9C:",i),i}catch{console.warn("redirect_uri \uCD94\uCD9C \uC2E4\uD328")}if(t.domain){let n=`${t.domain}/auth/callback/${t.provider||"google"}`;return console.log("\u{1F3AF} redirect_uri: domain \uAE30\uBC18 \uC870\uD569:",n),n}let e=Ye.googleOAuth?.redirectUri||`${window.location.origin}/ezm/auth/google/callback`;return console.log("\u{1F3AF} redirect_uri: \uAE30\uBCF8\uAC12 \uC0AC\uC6A9:",e),e}saveTokens(t,e){let n={accessToken:t.data.access_token,refreshToken:t.data.refresh_token,accessExpiresAt:t.data.access_expires_at,refreshExpiresAt:t.data.refresh_expires_at,loginType:e,savedAt:Date.now()};localStorage.setItem(this.TOKEN_STORAGE_KEY,JSON.stringify(n)),console.log("\u{1F4BE} \uBC31\uC5D4\uB4DC \uD1A0\uD070 \uC800\uC7A5 \uC644\uB8CC")}getStoredTokens(){try{let t=localStorage.getItem(this.TOKEN_STORAGE_KEY);if(!t)return null;let e=JSON.parse(t);if(this.isTokenExpired(e.accessExpiresAt)){if(console.log("\u26A0\uFE0F Access Token \uB9CC\uB8CC\uB428"),this.isTokenExpired(e.refreshExpiresAt))return console.log("\u274C Refresh Token\uB3C4 \uB9CC\uB8CC\uB428 - \uC7AC\uB85C\uADF8\uC778 \uD544\uC694"),this.clearTokens(),null;console.log("\u{1F504} Refresh Token\uC73C\uB85C \uAC31\uC2E0 \uD544\uC694")}return e}catch(t){return console.error("\u274C \uD1A0\uD070 \uC77D\uAE30 \uC2E4\uD328:",t),null}}isTokenExpired(t){try{let e=parseInt(t.substring(0,4)),n=parseInt(t.substring(4,6))-1,i=parseInt(t.substring(6,8)),s=parseInt(t.substring(8,10)),d=parseInt(t.substring(10,12)),_=parseInt(t.substring(12,14)),v=new Date(e,n,i,s,d,_);return new Date>=v}catch(e){return console.error("\u274C \uB9CC\uB8CC \uC2DC\uAC04 \uD30C\uC2F1 \uC2E4\uD328:",e),!0}}clearTokens(){localStorage.removeItem(this.TOKEN_STORAGE_KEY),console.log("\u{1F5D1}\uFE0F \uBC31\uC5D4\uB4DC \uD1A0\uD070 \uC0AD\uC81C \uC644\uB8CC")}getAccessToken(){return this.getStoredTokens()?.accessToken||null}refreshAccessToken(){return C(this,null,function*(){let t=this.getStoredTokens();if(!t||!t.refreshToken)return console.error("\u274C Refresh Token \uC5C6\uC74C"),null;try{return console.log("\u{1F504} Access Token \uAC31\uC2E0 \uC694\uCCAD"),console.log("\u26A0\uFE0F Refresh Token API \uBBF8\uAD6C\uD604 - \uC7AC\uB85C\uADF8\uC778 \uD544\uC694"),null}catch(e){return console.error("\u274C Access Token \uAC31\uC2E0 \uC2E4\uD328:",e),this.clearTokens(),null}})}getUserInfo(){return C(this,null,function*(){try{let t=this.getAccessToken();if(!t)return console.error("\u274C Access Token \uC5C6\uC74C - \uB85C\uADF8\uC778 \uD544\uC694"),null;console.log("\u{1F464} \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uC870\uD68C API \uD638\uCD9C");let e=this.generateDeviceId(),n=this.getDeviceInfo(),i=new rn({"Content-Type":"application/json",Authorization:`Bearer ${t}`,"X-Device-Id":e,"X-Client-Id":this.CLIENT_ID,"X-Client-OS":n.os,"X-Platform":n.platform,"X-Client-Version":this.CLIENT_VERSION});console.log("\u{1F4E4} API \uC694\uCCAD \uC815\uBCF4:"),console.log("  - URL:",`${this.API_BASE_URL}/auth/user-info`);let s=yield this.http.get(`${this.API_BASE_URL}/auth/user-info`,{headers:i}).toPromise();if(!s)throw new Error("API \uC751\uB2F5\uC774 \uC5C6\uC2B5\uB2C8\uB2E4");return s.success?(console.log("\u2705 \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uC870\uD68C \uC131\uACF5"),console.log("  - User ID:",s.data.id),console.log("  - Email:",s.data.email),console.log("  - Nickname:",s.data.nickname),console.log("  - Social Type:",s.data.social_type),console.log("  - Referral Code:",s.data.referral_code),console.log("  - Linked Accounts:",s.data.linked_accounts?.length||0),s):(console.error("\u274C \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uC870\uD68C \uC2E4\uD328:",s.message),null)}catch(t){return console.error("\u274C \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uC870\uD68C \uC2E4\uD328:",t),t.status===401&&(console.log("\u26A0\uFE0F \uD1A0\uD070 \uB9CC\uB8CC - \uC7AC\uB85C\uADF8\uC778 \uD544\uC694"),yield this.refreshAccessToken())?this.getUserInfo():null}})}static \u0275fac=function(e){return new(e||r)(X(Ht))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ce=class r{constructor(t,e,n,i,s,d){this.router=t;this.googleOAuth=e;this.geminiApiManager=n;this.androidBridge=i;this.snackbar=s;this.authApi=d;setTimeout(()=>{let _=this.checkAuth(),v=sessionStorage.getItem(this.GUEST_KEY)==="true";this.isAuthenticatedSubject.next(_),this.isGuestModeSubject.next(v),this.loadUserProfile(),_&&this.checkSessionExpiry()},0),this.initializeOAuthListener()}STORAGE_KEY="ez_reader_mobile_auth_token";SESSION_KEY="ez_reader_mobile_session_timestamp";GUEST_KEY="ez_reader_mobile_guest";USER_PROFILE_KEY="ezm_user_profile";LOGIN_TYPE_KEY="ezm_login_type";SESSION_DURATION=480*60*1e3;isAuthenticatedSubject=new de(!1);isAuthenticated$=this.isAuthenticatedSubject.asObservable();isGuestModeSubject=new de(!1);isGuestMode$=this.isGuestModeSubject.asObservable();userProfileSubject=new de(null);userProfile$=this.userProfileSubject.asObservable();AUTH_HASH=this.simpleHash("admin1234");EZ_AUTH_HASH=this.simpleHash("admin1234");initializeOAuthListener(){this.androidBridge.userTokenInfo$.subscribe({next:t=>{t&&t.isAuthenticated&&(console.log("\u{1F513} Android\uC5D0\uC11C \uC800\uC7A5\uB41C \uB85C\uADF8\uC778 \uC0C1\uD0DC \uBCF5\uC6D0 \uC911..."),this.restoreLoginStateFromAndroid(t))},error:t=>{console.error("userTokenInfo \uAD6C\uB3C5 \uC5D0\uB7EC:",t)}}),this.androidBridge.authTokens$.subscribe({next:t=>{t&&this.handleAuthTokensFromAndroid(t)},error:t=>{console.error("authTokens \uAD6C\uB3C5 \uC5D0\uB7EC:",t)}}),this.androidBridge.authError$.subscribe({next:t=>{t&&(console.error("\u274C Android \uC778\uC99D \uC5D0\uB7EC:",t.error),this.showError(`\uB85C\uADF8\uC778 \uC2E4\uD328: ${t.error}`),sessionStorage.removeItem("lastProcessedOAuthCode"))},error:t=>{console.error("authError \uAD6C\uB3C5 \uC5D0\uB7EC:",t)}}),this.androidBridge.oauthCallback$.subscribe({next:t=>{t&&this.handleOAuthCallback(t)},error:t=>{console.error("OAuth \uCF5C\uBC31 \uAD6C\uB3C5 \uC5D0\uB7EC:",t)}})}restoreLoginStateFromAndroid(t){return C(this,null,function*(){if(console.log("\u{1F4F1} Android \uC800\uC7A5 \uD1A0\uD070 \uC815\uBCF4:",t),this.isAuthenticatedSubject.value){console.log("\u26A0\uFE0F \uC774\uBBF8 \uB85C\uADF8\uC778\uB418\uC5B4 \uC788\uC74C - \uBCF5\uC6D0 \uC2A4\uD0B5");return}if(t.needsRefresh){console.log("\u26A0\uFE0F \uD1A0\uD070\uC774 \uB9CC\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uC7AC\uB85C\uADF8\uC778\uC774 \uD544\uC694\uD569\uB2C8\uB2E4."),this.snackbar.showWarning("\uB85C\uADF8\uC778\uC774 \uB9CC\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uB2E4\uC2DC \uB85C\uADF8\uC778\uD574\uC8FC\uC138\uC694.");return}try{let e={accessToken:t.accessToken,refreshToken:t.refreshToken,accessExpiresAt:t.accessExpiresAt,refreshExpiresAt:t.refreshExpiresAt,loginType:t.loginType,savedAt:Date.now()};localStorage.setItem("ezm_backend_tokens",JSON.stringify(e)),console.log("\u{1F4BE} \uBC31\uC5D4\uB4DC \uD1A0\uD070 \uBCF5\uC6D0 \uC644\uB8CC");let n=Date.now().toString();sessionStorage.setItem(this.STORAGE_KEY,"authenticated"),sessionStorage.setItem(this.SESSION_KEY,n),sessionStorage.setItem(this.LOGIN_TYPE_KEY,t.loginType||"google"),sessionStorage.removeItem(this.GUEST_KEY);let s={userId:this.extractUserIdFromJwt(t.accessToken),email:t.email||"user@example.com",name:t.name||"User",picture:t.picture||"",loginType:t.loginType||"google",lastLoginAt:new Date};sessionStorage.setItem(this.USER_PROFILE_KEY,JSON.stringify(s)),this.userProfileSubject.next(s),this.isAuthenticatedSubject.next(!0),console.log("\u2705 \uB85C\uADF8\uC778 \uC0C1\uD0DC \uBCF5\uC6D0 \uC644\uB8CC"),console.log("\u{1F464} \uC784\uC2DC \uC0AC\uC6A9\uC790 \uC815\uBCF4:",s),this.snackbar.showSuccess("\uB85C\uADF8\uC778 \uC0C1\uD0DC\uAC00 \uBCF5\uC6D0\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),yield this.fetchAndUpdateUserInfo()}catch(e){console.error("\u274C \uB85C\uADF8\uC778 \uC0C1\uD0DC \uBCF5\uC6D0 \uC2E4\uD328:",e),this.snackbar.showError("\uB85C\uADF8\uC778 \uC0C1\uD0DC \uBCF5\uC6D0\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}handleAuthTokensFromAndroid(t){return C(this,null,function*(){if(console.log("\u{1F510} Android\uC5D0\uC11C JWT \uD1A0\uD070 \uC218\uC2E0"),sessionStorage.getItem("lastProcessedAuthToken")===t.accessToken?.substring(0,50)){console.log("\u26A0\uFE0F \uAC19\uC740 \uD1A0\uD070\uC73C\uB85C \uC774\uBBF8 \uCC98\uB9AC\uB428 - \uBB34\uC2DC");return}sessionStorage.setItem("lastProcessedAuthToken",t.accessToken?.substring(0,50)||""),console.log("\u{1F3C1} \uD1A0\uD070 \uCC98\uB9AC \uC2DC\uC791");try{if(!t.accessToken||!t.refreshToken)throw new Error("\uD1A0\uD070 \uB370\uC774\uD130\uAC00 \uC62C\uBC14\uB974\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4");this.snackbar.showInfo("\u{1F512} \uD1A0\uD070 \uC800\uC7A5 \uC911...");let n={success:!0,data:{accessToken:t.accessToken,refreshToken:t.refreshToken,accessExpiresAt:t.accessExpiresAt,refreshExpiresAt:t.refreshExpiresAt}},i={accessToken:t.accessToken,refreshToken:t.refreshToken,accessExpiresAt:t.accessExpiresAt,refreshExpiresAt:t.refreshExpiresAt,loginType:t.provider,savedAt:Date.now()};localStorage.setItem("ezm_backend_tokens",JSON.stringify(i)),console.log("\u{1F4BE} \uBC31\uC5D4\uB4DC \uD1A0\uD070 \uC800\uC7A5 \uC644\uB8CC"),this.androidBridge.saveBackendTokenInfo(n.data,t.provider);let s=Date.now().toString();sessionStorage.setItem(this.STORAGE_KEY,"authenticated"),sessionStorage.setItem(this.SESSION_KEY,s),sessionStorage.setItem(this.LOGIN_TYPE_KEY,t.provider),sessionStorage.removeItem(this.GUEST_KEY);let d={userId:this.extractUserIdFromJwt(t.accessToken),email:"user@example.com",name:"User",picture:"",loginType:t.provider,lastLoginAt:new Date};sessionStorage.setItem(this.USER_PROFILE_KEY,JSON.stringify(d)),this.userProfileSubject.next(d),this.isAuthenticatedSubject.next(!0),console.log("\u2705 Android \uD1A0\uD070 \uCC98\uB9AC \uC644\uB8CC"),console.log("\u{1F4CA} \uD1A0\uD070 \uC815\uBCF4:"),console.log("  - Provider:",t.provider),console.log("  - Access Token:",t.accessToken.substring(0,50)+"..."),console.log("  - Refresh Token:",t.refreshToken.substring(0,50)+"..."),console.log("  - Access Expires:",t.accessExpiresAt),console.log("  - Refresh Expires:",t.refreshExpiresAt),console.log("\u{1F4A1} \uB514\uBC84\uADF8 \uC815\uBCF4\uC5D0\uC11C \uC804\uCCB4 \uD1A0\uD070\uC744 \uD655\uC778\uD558\uC138\uC694."),yield this.fetchAndUpdateUserInfo(),this.snackbar.showSuccess("\u2705 \uB85C\uADF8\uC778 \uC131\uACF5! (Android \uD1A0\uD070)"),setTimeout(()=>{this.router.navigate(["/ezm/home"])},1e3)}catch(n){console.error("\u274C Android \uD1A0\uD070 \uCC98\uB9AC \uC2E4\uD328:",n),this.snackbar.showError(`\u274C ${n.message||"\uD1A0\uD070 \uCC98\uB9AC \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."}`),sessionStorage.removeItem("lastProcessedOAuthCode")}})}extractUserIdFromJwt(t){try{let e=t.split(".")[1];return JSON.parse(atob(e)).sub||"unknown"}catch(e){return console.error("JWT \uB514\uCF54\uB529 \uC2E4\uD328:",e),"unknown"}}fetchAndUpdateUserInfo(){return C(this,null,function*(){try{console.log("\u{1F464} \uBC31\uC5D4\uB4DC\uC5D0\uC11C \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uAC00\uC838\uC624\uAE30..."),this.snackbar.showInfo("\u{1F464} \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uAC00\uC838\uC624\uB294 \uC911...");let t=yield this.authApi.getUserInfo();if(t&&t.success){let e=t.data;console.log("\u2705 \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uC870\uD68C \uC131\uACF5:",e);let n=this.userProfileSubject.value,i={userId:String(e.id),email:e.email,name:e.nickname||n?.name||"User",picture:e.profile_image_url||n?.picture,loginType:n?.loginType||"google",lastLoginAt:new Date,backendUserId:e.id,socialType:e.social_type,nickname:e.nickname,profileImageUrl:e.profile_image_url,referralCode:e.referral_code,linkedAccounts:e.linked_accounts?.map(s=>({type:s.type,email:s.email,can_unlink:s.can_unlink})),needsReferralInput:e.needs_referral_input};sessionStorage.setItem(this.USER_PROFILE_KEY,JSON.stringify(i)),this.userProfileSubject.next(i),console.log("\u2705 \uC0AC\uC6A9\uC790 \uD504\uB85C\uD544 \uC5C5\uB370\uC774\uD2B8 \uC644\uB8CC:",i),this.snackbar.showSuccess(`\u{1F44B} ${i.nickname||i.email}\uB2D8 \uD658\uC601\uD569\uB2C8\uB2E4!`)}else console.warn("\u26A0\uFE0F \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uC870\uD68C \uC2E4\uD328 - \uAE30\uBCF8 \uD504\uB85C\uD544 \uC720\uC9C0")}catch(t){console.error("\u274C \uC0AC\uC6A9\uC790 \uC815\uBCF4 \uC870\uD68C \uC2E4\uD328:",t)}})}handleOAuthCallback(t){return C(this,null,function*(){if(console.log("\u{1F510} OAuth \uCF5C\uBC31 \uCC98\uB9AC \uC2DC\uC791"),console.log("\u{1F4CB} oauthData:",{code:t.code?.substring(0,30)+"...",provider:t.provider,redirectUri:t.redirectUri}),sessionStorage.getItem("lastProcessedOAuthCode")===t.code){console.log("\u26A0\uFE0F \uAC19\uC740 OAuth code\uB85C \uC774\uBBF8 \uCC98\uB9AC\uB428 - \uBB34\uC2DC");return}if(sessionStorage.setItem("lastProcessedOAuthCode",t.code||""),console.log("\u{1F3C1} OAuth \uCC98\uB9AC \uC2DC\uC791 (code \uC800\uC7A5\uB428)"),t.error){console.error("\u274C OAuth \uC5D0\uB7EC:",t.error),this.showError(`\uB85C\uADF8\uC778 \uC2E4\uD328: ${t.error}`),sessionStorage.removeItem("lastProcessedOAuthCode");return}if(!t.code){console.error("\u274C Authorization code \uC5C6\uC74C"),this.showError("\uB85C\uADF8\uC778 \uC815\uBCF4\uAC00 \uC62C\uBC14\uB974\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4."),sessionStorage.removeItem("lastProcessedOAuthCode");return}try{console.log("\u{1F504} \uBC31\uC5D4\uB4DC \uB85C\uADF8\uC778 API \uD638\uCD9C:",{code:t.code.substring(0,20)+"..."}),this.snackbar.showInfo("\u{1F504} 1\uB2E8\uACC4: Authorization Code \uAC80\uC99D \uC911..."),this.snackbar.showInfo("\u{1F504} 2\uB2E8\uACC4: \uBC31\uC5D4\uB4DC \uC11C\uBC84\uC640 \uD1B5\uC2E0 \uC911...");let n=yield this.authApi.loginWithOAuthCode(t);if(n&&n.success){console.log("\u2705 \uBC31\uC5D4\uB4DC \uB85C\uADF8\uC778 \uC131\uACF5"),this.snackbar.showInfo("\u{1F504} 3\uB2E8\uACC4: \uD1A0\uD070 \uC218\uC2E0 \uC644\uB8CC, \uC800\uC7A5 \uC911..."),this.androidBridge.saveBackendTokenInfo(n.data,t.provider||"google"),this.androidBridge.saveTokensToAndroid(n.data.access_token,n.data.refresh_token,n.data.access_expires_at,n.data.refresh_expires_at,t.provider||"google");let i=Date.now().toString();sessionStorage.setItem(this.STORAGE_KEY,"authenticated"),sessionStorage.setItem(this.SESSION_KEY,i),sessionStorage.setItem(this.LOGIN_TYPE_KEY,t.provider||"google"),sessionStorage.removeItem(this.GUEST_KEY);let s={userId:"user-from-jwt",email:"user@example.com",name:"User",picture:"",loginType:t.provider||"google",lastLoginAt:new Date};sessionStorage.setItem(this.USER_PROFILE_KEY,JSON.stringify(s)),this.userProfileSubject.next(s),this.isAuthenticatedSubject.next(!0),console.log("\u2705 OAuth \uB85C\uADF8\uC778 \uC644\uB8CC"),console.log("\u{1F4CA} \uD1A0\uD070 \uC815\uBCF4:"),console.log("  - Access Token:",n.data.access_token.substring(0,50)+"..."),console.log("  - Refresh Token:",n.data.refresh_token.substring(0,50)+"..."),console.log("  - Access Expires:",n.data.access_expires_at),console.log("  - Refresh Expires:",n.data.refresh_expires_at),console.log("\u{1F4A1} \uB514\uBC84\uADF8 \uC815\uBCF4\uC5D0\uC11C \uC804\uCCB4 \uD1A0\uD070\uC744 \uD655\uC778\uD558\uC138\uC694."),yield this.fetchAndUpdateUserInfo(),this.snackbar.showSuccess("\u2705 \uB85C\uADF8\uC778 \uC131\uACF5! \uB514\uBC84\uADF8 \uC815\uBCF4\uC5D0\uC11C \uD1A0\uD070 \uD655\uC778 \uAC00\uB2A5"),setTimeout(()=>{this.router.navigate(["/ezm/home"])},1e3)}else console.error("\u274C \uBC31\uC5D4\uB4DC \uB85C\uADF8\uC778 \uC2E4\uD328"),this.showError("\u274C \uB85C\uADF8\uC778 \uCC98\uB9AC \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."),sessionStorage.removeItem("lastProcessedOAuthCode")}catch(n){console.error("\u274C \uBC31\uC5D4\uB4DC \uB85C\uADF8\uC778 \uC2E4\uD328:",n);let i="\uB85C\uADF8\uC778 \uCC98\uB9AC \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.";n.error?.message?i=n.error.message:n.message&&(i=n.message),this.snackbar.showError(`\u274C ${i}`),sessionStorage.removeItem("lastProcessedOAuthCode")}})}showError(t){this.snackbar.showError(t)}startGoogleLogin(){console.log("\u{1F510} Android \uB85C\uADF8\uC778 WebView \uC5F4\uAE30 \uC694\uCCAD"),this.androidBridge.openLoginWebView(),this.snackbar.showInfo("\u{1F510} \uB85C\uADF8\uC778 \uCC3D\uC744 \uC5EC\uB294 \uC911...")}login(t,e){let n=this.simpleHash(t+e),i=Ye.ezMode?this.EZ_AUTH_HASH:this.AUTH_HASH;if(n===i){let s=Date.now().toString();sessionStorage.setItem(this.STORAGE_KEY,"authenticated"),sessionStorage.setItem(this.SESSION_KEY,s),sessionStorage.setItem(this.LOGIN_TYPE_KEY,"local"),sessionStorage.removeItem(this.GUEST_KEY);let d={userId:t,email:`${t}@local`,name:t,loginType:"local",lastLoginAt:new Date};return sessionStorage.setItem(this.USER_PROFILE_KEY,JSON.stringify(d)),this.userProfileSubject.next(d),this.isAuthenticatedSubject.next(!0),this.isGuestModeSubject.next(!1),!0}return!1}loginWithGoogle(t){return C(this,null,function*(){try{let e=yield this.googleOAuth.exchangeCodeForTokenDirect(t).toPromise();if(e&&e.success){let n=Date.now().toString();sessionStorage.setItem(this.STORAGE_KEY,"authenticated"),sessionStorage.setItem(this.SESSION_KEY,n),sessionStorage.setItem(this.LOGIN_TYPE_KEY,"google"),sessionStorage.removeItem(this.GUEST_KEY);let i={userId:e.userInfo.sub,email:e.userInfo.email,name:e.userInfo.name,picture:e.userInfo.picture,loginType:"google",lastLoginAt:new Date};return sessionStorage.setItem(this.USER_PROFILE_KEY,JSON.stringify(i)),this.userProfileSubject.next(i),yield this.geminiApiManager.setApiKey(e.accessToken,e.userInfo.sub,e.userInfo.email,!1),this.isAuthenticatedSubject.next(!0),this.isGuestModeSubject.next(!1),!0}return!1}catch{return!1}})}loginWithGoogleToken(t,e){return C(this,null,function*(){try{let n=Date.now().toString();sessionStorage.setItem(this.STORAGE_KEY,"authenticated"),sessionStorage.setItem(this.SESSION_KEY,n),sessionStorage.setItem(this.LOGIN_TYPE_KEY,"google"),sessionStorage.removeItem(this.GUEST_KEY);let i={userId:e.sub,email:e.email,name:e.name,picture:e.picture,loginType:"google",lastLoginAt:new Date};return sessionStorage.setItem(this.USER_PROFILE_KEY,JSON.stringify(i)),this.userProfileSubject.next(i),yield this.geminiApiManager.setApiKey(t,e.sub,e.email,!1),this.isAuthenticatedSubject.next(!0),this.isGuestModeSubject.next(!1),!0}catch{return!1}})}loadUserProfile(){let t=sessionStorage.getItem(this.USER_PROFILE_KEY);if(t)try{let e=JSON.parse(t);this.userProfileSubject.next(e)}catch{}}getUserProfile(){return this.userProfileSubject.value}getLoginType(){return sessionStorage.getItem(this.LOGIN_TYPE_KEY)}logout(){return C(this,null,function*(){try{sessionStorage.removeItem(this.STORAGE_KEY),sessionStorage.removeItem(this.SESSION_KEY),sessionStorage.removeItem(this.GUEST_KEY),sessionStorage.removeItem(this.USER_PROFILE_KEY),sessionStorage.removeItem(this.LOGIN_TYPE_KEY),localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem(this.SESSION_KEY),localStorage.removeItem(this.USER_PROFILE_KEY),localStorage.removeItem(this.LOGIN_TYPE_KEY),this.isAuthenticatedSubject.next(!1),this.isGuestModeSubject.next(!1),this.userProfileSubject.next(null),yield this.geminiApiManager.clearApiKey();let t=this.getLoginType();(t==="google"||t==="google-android")&&t==="google-android"&&this.googleOAuth.nativeSignOut(),this.router?this.router.navigate(["/ezm/login"]).catch(e=>{window.location.href="/ezm/login"}):window.location.href="/ezm/login"}catch{window.location.hash="#/ezm/login"}})}isAuthenticated(){return this.checkAuth()}setGuestMode(t){this.isGuestModeSubject.next(t),t?sessionStorage.setItem(this.GUEST_KEY,"true"):sessionStorage.removeItem(this.GUEST_KEY)}isGuest(){return this.isGuestModeSubject.value||sessionStorage.getItem(this.GUEST_KEY)==="true"}checkAuth(){let t=sessionStorage.getItem(this.STORAGE_KEY),e=sessionStorage.getItem(this.SESSION_KEY);if(!t||!e)return!1;let n=parseInt(e,10);return Date.now()-n>this.SESSION_DURATION?(sessionStorage.removeItem(this.STORAGE_KEY),sessionStorage.removeItem(this.SESSION_KEY),!1):t==="authenticated"}checkSessionExpiry(){setInterval(()=>{!this.checkAuth()&&this.isAuthenticatedSubject.value&&this.logout()},6e4)}simpleHash(t){let e=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);e=(e<<5)-e+i,e=e&e}return Math.abs(e).toString(16).padStart(16,"0")}static \u0275fac=function(e){return new(e||r)(X(N),X(ft),X(Ne),X(Ae),X(G),X(qt))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var ht=class r{constructor(){this.setupMessageListener()}isNativeEncryptionAvailable(){return!!(window.webkit?.messageHandlers?.pdfEncryption||window.AndroidBridge?.postMessage)}encryptPdf(t,e,n){return C(this,null,function*(){return new Promise((i,s)=>{let d=`encrypt_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,_=w=>{let M=w.data;M.type==="PDF_ENCRYPT_RESPONSE"&&M.callbackId===d&&(window.removeEventListener("message",_),M.success?i(M.encryptedPdfBase64):s(new Error(M.error||"\uC554\uD638\uD654 \uC2E4\uD328")))};window.addEventListener("message",_);let v={type:"PDF_ENCRYPT_REQUEST",callbackId:d,data:{pdfBase64:t,password:e,permissions:n}};try{if(window.webkit?.messageHandlers?.pdfEncryption)window.webkit.messageHandlers.pdfEncryption.postMessage(v);else if(window.AndroidBridge?.postMessage)window.AndroidBridge.postMessage(JSON.stringify(v));else{window.removeEventListener("message",_),s(new Error("\uB124\uC774\uD2F0\uBE0C \uBE0C\uB9BF\uC9C0\uB97C \uC0AC\uC6A9\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."));return}}catch(w){window.removeEventListener("message",_),s(w);return}setTimeout(()=>{window.removeEventListener("message",_),s(new Error("\uC554\uD638\uD654 \uD0C0\uC784\uC544\uC6C3 (30\uCD08 \uCD08\uACFC)"))},3e4)})})}setupMessageListener(){window.AndroidBridge&&(window.onNativeMessage=t=>{try{let e=JSON.parse(t);window.postMessage(e,"*")}catch(e){console.error("\u274C Native \uBA54\uC2DC\uC9C0 \uD30C\uC2F1 \uC2E4\uD328:",e)}})}decryptPdf(t,e){return C(this,null,function*(){return new Promise((n,i)=>{let s=`decrypt_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,d=v=>{let w=v.data;w.type==="PDF_DECRYPT_RESPONSE"&&w.callbackId===s&&(window.removeEventListener("message",d),w.success?n(w.encryptedPdfBase64):i(new Error(w.error||"\uBCF5\uD638\uD654 \uC2E4\uD328")))};window.addEventListener("message",d);let _={type:"PDF_DECRYPT_REQUEST",callbackId:s,data:{encryptedPdfBase64:t,password:e}};try{if(window.webkit?.messageHandlers?.pdfEncryption)window.webkit.messageHandlers.pdfEncryption.postMessage(_);else if(window.AndroidBridge?.postMessage)window.AndroidBridge.postMessage(JSON.stringify(_));else{window.removeEventListener("message",d),i(new Error("\uB124\uC774\uD2F0\uBE0C \uBE0C\uB9BF\uC9C0\uB97C \uC0AC\uC6A9\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."));return}}catch(v){window.removeEventListener("message",d),i(v);return}setTimeout(()=>{window.removeEventListener("message",d),i(new Error("\uBCF5\uD638\uD654 \uD0C0\uC784\uC544\uC6C3"))},3e4)})})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ke=class r{passwordCache=new Map;modalResolver=null;isModalOpen=!1;currentDocument=null;currentOptions={};modalState={isOpen:!1,document:null,options:{},password:"",showPassword:!1,isLoading:!1,errorMessage:"",attemptCount:0,maxAttempts:5};pdfEncryptionService=P(ht);constructor(){}isEncrypted(t){return t.isEncrypted===!0}verifyPassword(t){return C(this,null,function*(){if(!this.isEncrypted(t))return{success:!0};let e=yield this.tryAutoDecrypt(t);return e?.success?e:this.showPasswordModal(t)})}verifyMultiplePasswords(t){return C(this,null,function*(){let e=[],n=t.filter(s=>this.isEncrypted(s));if(n.length===0)return{allSuccess:!0,results:t.map(s=>({docId:s.id,fileName:s.fileName||s.title,success:!0})),cancelled:!1};for(let s=0;s<n.length;s++){let d=n[s],_=yield this.tryAutoDecrypt(d);if(_?.success){e.push({docId:d.id,fileName:d.fileName||d.title,success:!0,decryptedBase64:_.decryptedBase64,password:_.password});continue}let v=yield this.showPasswordModal(d,{current:s+1,total:n.length,allowSkip:!1,allowCancel:!0,rememberPassword:!0});if(v.cancelled)return{allSuccess:!1,results:e,cancelled:!0};if(e.push({docId:d.id,fileName:d.fileName||d.title,success:v.success,decryptedBase64:v.decryptedBase64,password:v.password,error:v.error}),!v.success)return{allSuccess:!1,results:e,cancelled:!1}}let i=t.filter(s=>!this.isEncrypted(s));for(let s of i)e.push({docId:s.id,fileName:s.fileName||s.title,success:!0});return{allSuccess:!0,results:e,cancelled:!1}})}tryAutoDecrypt(t){return C(this,null,function*(){let e=this.passwordCache.get(t.id);if(!e)return null;try{if(!this.pdfEncryptionService.isNativeEncryptionAvailable())return t.encryptionMetadata?.password===e?{success:!0,decryptedBase64:t.originalPdfBase64||t.pdfBase64,password:e}:(this.passwordCache.delete(t.id),null);let n=t.originalPdfBase64||t.pdfBase64;return n?{success:!0,decryptedBase64:yield this.pdfEncryptionService.decryptPdf(n,e),password:e}:null}catch{return this.passwordCache.delete(t.id),null}})}showPasswordModal(t,e={}){return new Promise(n=>{this.modalResolver=n,this.currentDocument=t,this.currentOptions=e,this.modalState={isOpen:!0,document:t,options:e,password:"",showPassword:!1,isLoading:!1,errorMessage:"",attemptCount:0,maxAttempts:5},this.isModalOpen=!0})}submitPassword(t,e=!1){return C(this,null,function*(){if(!(!this.currentDocument||!this.modalResolver)){this.modalState.isLoading=!0,this.modalState.errorMessage="";try{let n;if(this.pdfEncryptionService.isNativeEncryptionAvailable()){let i=this.currentDocument.originalPdfBase64||this.currentDocument.pdfBase64;if(!i)throw new Error("PDF \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");n=yield this.pdfEncryptionService.decryptPdf(i,t)}else{if(this.currentDocument.encryptionMetadata?.password!==t)throw new Error("\uBE44\uBC00\uBC88\uD638\uAC00 \uD2C0\uB838\uC2B5\uB2C8\uB2E4.");n=this.currentDocument.originalPdfBase64||this.currentDocument.pdfBase64||""}e&&this.passwordCache.set(this.currentDocument.id,t),this.closeModal({success:!0,decryptedBase64:n,password:t})}catch{this.modalState.attemptCount++,this.modalState.attemptCount>=this.modalState.maxAttempts?this.closeModal({success:!1,error:`\uCD5C\uB300 \uC2DC\uB3C4 \uD69F\uC218(${this.modalState.maxAttempts}\uD68C)\uB97C \uCD08\uACFC\uD588\uC2B5\uB2C8\uB2E4.`}):(this.modalState.errorMessage=`\uBE44\uBC00\uBC88\uD638\uAC00 \uD2C0\uB838\uC2B5\uB2C8\uB2E4. (${this.modalState.attemptCount}/${this.modalState.maxAttempts}\uD68C)`,this.modalState.isLoading=!1)}}})}cancelModal(){this.closeModal({success:!1,cancelled:!0})}closeModal(t){this.modalState.isOpen=!1,this.modalState.isLoading=!1,this.isModalOpen=!1,this.modalResolver&&(this.modalResolver(t),this.modalResolver=null),this.currentDocument=null,this.currentOptions={}}clearPasswordCache(){this.passwordCache.clear()}removePasswordFromCache(t){this.passwordCache.delete(t)}togglePasswordVisibility(){this.modalState.showPassword=!this.modalState.showPassword}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var le=class r{pendingActionSubject=new de(null);pendingAction$=this.pendingActionSubject.asObservable();lastOrigin="home";viewerReturnState=null;router=P(N);constructor(){}setPendingAction(t){t.origin&&(this.lastOrigin=t.origin),this.pendingActionSubject.next(t)}getPendingAction(){return this.pendingActionSubject.value}clearPendingAction(){this.pendingActionSubject.next(null)}hasPendingAction(){return this.pendingActionSubject.value!==null}setOrigin(t){this.lastOrigin=t}setViewerReturnState(t){this.viewerReturnState=t,this.lastOrigin="viewer"}getViewerReturnState(){return this.viewerReturnState}clearViewerReturnState(){this.viewerReturnState=null}getOrigin(){return this.lastOrigin}navigateToOrigin(){switch(this.lastOrigin){case"tools":this.router.navigate(["/ezm/tools"]);break;case"viewer":if(this.viewerReturnState){let{docId:t,page:e}=this.viewerReturnState,n={docId:t};e&&(n.page=e),this.router.navigate(["/ezm/viewer"],{queryParams:n}),this.viewerReturnState=null}else this.router.navigate(["/ezm"]);break;case"home":case"myfiles":default:this.router.navigate(["/ezm"]);break}this.lastOrigin="home"}navigateToResult(t){t?this.router.navigate(["/ezm/myfiles",t]):this.navigateToOrigin(),this.lastOrigin="home"}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var _t=class r{constructor(){}addKoreanFont(t){return C(this,null,function*(){try{let n=yield fetch("fonts/NotoSansKR-Regular.ttf");if(!n.ok){console.warn("\uD55C\uAE00 \uD3F0\uD2B8 \uB85C\uB4DC \uC2E4\uD328, \uAE30\uBCF8 \uD3F0\uD2B8 \uC0AC\uC6A9");return}let i=yield n.arrayBuffer(),s=this.arrayBufferToBase64(i);t.addFileToVFS("NotoSansKR-Regular.ttf",s),t.addFont("NotoSansKR-Regular.ttf","NotoSansKR","normal"),t.setFont("NotoSansKR")}catch(e){console.warn("\uD55C\uAE00 \uD3F0\uD2B8 \uCD94\uAC00 \uC2E4\uD328:",e)}})}arrayBufferToBase64(t){let e=new Uint8Array(t),n="";for(let i=0;i<e.byteLength;i++)n+=String.fromCharCode(e[i]);return btoa(n)}imageToPdf(t,e){return C(this,null,function*(){try{let n=window.PDFLib;if(!n)throw new Error("PDF-lib \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4. \uD398\uC774\uC9C0\uB97C \uC0C8\uB85C\uACE0\uCE68\uD574\uC8FC\uC138\uC694.");let i=yield n.PDFDocument.create();for(let d of t){let _=yield d.arrayBuffer(),v;try{d.type==="image/png"||d.name.toLowerCase().endsWith(".png")?v=yield i.embedPng(_):d.type==="image/jpeg"||d.type==="image/jpg"||d.name.toLowerCase().endsWith(".jpg")||d.name.toLowerCase().endsWith(".jpeg")?v=yield i.embedJpg(_):v=yield this.convertToSupportedFormat(d,i)}catch(ie){console.warn(`\uC774\uBBF8\uC9C0 \uC784\uBCA0\uB4DC \uC2E4\uD328, Canvas \uBCC0\uD658 \uC2DC\uB3C4: ${d.name}`,ie),v=yield this.convertToSupportedFormat(d,i)}let{width:w,height:M}=this.calculatePageSize(v.width,v.height,e),O=i.addPage([w,M]),E=e?.margin||20,D=w-E*2,T=M-E*2,I=v.width/v.height,z=D/T,A,Y;I>z?(A=D,Y=D/I):(Y=T,A=T*I);let Q=(w-A)/2,te=(M-Y)/2;O.drawImage(v,{x:Q,y:te,width:A,height:Y})}return yield i.save()}catch(n){throw console.error("\u274C \uC774\uBBF8\uC9C0 \u2192 PDF \uBCC0\uD658 \uC2E4\uD328:",n),new Error("\uC774\uBBF8\uC9C0\uB97C PDF\uB85C \uBCC0\uD658\uD558\uB294 \uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4: "+(n?.message||n))}})}excelToPdf(t,e){return C(this,null,function*(){try{let n=yield import("./chunk-7LW56JTG.js"),{jsPDF:i}=yield import("./chunk-HL77PWLD.js"),s=(yield import("./chunk-M7Y23PCR.js")).default,d=yield t.arrayBuffer(),_=n.read(d,{type:"array"}),v=e?.includeAllSheets?_.SheetNames:[e?.sheetName||_.SheetNames[0]],w=new i("p","mm","a4");yield this.addKoreanFont(w);let M=!0;for(let E of v){let D=_.Sheets[E],T=n.utils.sheet_to_html(D),I=document.createElement("div");I.innerHTML=T,I.style.position="absolute",I.style.left="-9999px",I.style.padding="20px",I.style.backgroundColor="white";let z=I.querySelector("table");z&&(z.style.borderCollapse="collapse",z.style.width="100%",z.style.fontFamily="Arial, sans-serif",z.style.fontSize="12px",z.querySelectorAll("td, th").forEach(ze=>{ze.style.border="1px solid #ddd",ze.style.padding="8px",ze.style.textAlign="left"}),z.querySelectorAll("th").forEach(ze=>{ze.style.backgroundColor="#f2f2f2",ze.style.fontWeight="bold"})),document.body.appendChild(I);let A=yield s(I,{scale:2,backgroundColor:"#ffffff",logging:!1}),Y=A.toDataURL("image/png");M||w.addPage(),M=!1;let Q=190,te=A.height*Q/A.width,ie=277,Ie=te,qe=0;for(w.addImage(Y,"PNG",10,10,Q,te),Ie-=ie;Ie>0;)qe=Ie-te,w.addPage(),w.addImage(Y,"PNG",10,qe,Q,te),Ie-=ie;document.body.removeChild(I)}let O=w.output("arraybuffer");return new Uint8Array(O)}catch(n){throw console.error("\u274C Excel \u2192 PDF \uBCC0\uD658 \uC2E4\uD328:",n),new Error("Excel \uD30C\uC77C\uC744 PDF\uB85C \uBCC0\uD658\uD558\uB294 \uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4: "+(n?.message||n))}})}wordToPdf(t){return C(this,null,function*(){try{let e=yield import("./chunk-7ZF7OAKT.js"),{jsPDF:n}=yield import("./chunk-HL77PWLD.js"),i=(yield import("./chunk-M7Y23PCR.js")).default,s=yield t.arrayBuffer(),d=yield e.convertToHtml({arrayBuffer:s}),_=d.value;d.messages.length>0&&console.warn("Word \uBCC0\uD658 \uACBD\uACE0:",d.messages);let v=document.createElement("div");v.innerHTML=_,v.style.width="800px",v.style.padding="40px",v.style.backgroundColor="white",v.style.fontFamily="Arial, sans-serif",v.style.fontSize="14px",v.style.lineHeight="1.6",v.style.color="#333",v.style.position="absolute",v.style.left="-9999px",document.body.appendChild(v);let w=yield i(v,{scale:2,backgroundColor:"#ffffff",logging:!1}),M=w.toDataURL("image/png"),O=new n("p","mm","a4");yield this.addKoreanFont(O);let E=190,D=w.height*E/w.width,T=277,I=D,z=0;for(O.addImage(M,"PNG",10,10,E,D),I-=T;I>0;)z=I-D,O.addPage(),O.addImage(M,"PNG",10,z,E,D),I-=T;document.body.removeChild(v);let A=O.output("arraybuffer");return new Uint8Array(A)}catch(e){throw console.error("\u274C Word \u2192 PDF \uBCC0\uD658 \uC2E4\uD328:",e),new Error("Word \uD30C\uC77C\uC744 PDF\uB85C \uBCC0\uD658\uD558\uB294 \uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4: "+(e?.message||e))}})}powerPointToPdf(t){return C(this,null,function*(){try{let e=(yield import("./chunk-NCXHHQMY.js")).default,{jsPDF:n}=yield import("./chunk-HL77PWLD.js"),i=yield t.arrayBuffer(),s=yield e.loadAsync(i),d=[];if(s.forEach((M,O)=>{M.startsWith("ppt/slides/slide")&&M.endsWith(".xml")&&d.push(M)}),d.sort((M,O)=>{let E=parseInt(M.match(/slide(\d+)\.xml/)?.[1]||"0"),D=parseInt(O.match(/slide(\d+)\.xml/)?.[1]||"0");return E-D}),d.length===0){let M=[];if(s.forEach((E,D)=>{E.startsWith("ppt/media/")&&(E.endsWith(".png")||E.endsWith(".jpg")||E.endsWith(".jpeg")||E.endsWith(".emf")||E.endsWith(".wmf"))&&M.push(E)}),M.length===0)throw new Error("PPTX \uD30C\uC77C\uC5D0\uC11C \uC2AC\uB77C\uC774\uB4DC\uB098 \uC774\uBBF8\uC9C0\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");let O=[];for(let E of M){let D=s.file(E);if(D){let T=yield D.async("blob"),I=E.split("/").pop()||"image.png";O.push(new File([T],I,{type:T.type}))}}return yield this.imageToPdf(O)}let _=new n("l","mm","a4");yield this.addKoreanFont(_);let v=!0;for(let M=0;M<d.length;M++){let O=s.file(d[M]);if(!O)continue;let T=((yield O.async("string")).match(/<a:t>([^<]+)<\/a:t>/g)||[]).map(z=>z.replace(/<a:t>|<\/a:t>/g,"").trim()).filter(z=>z.length>0);v||_.addPage(),v=!1,_.setFontSize(24),_.setTextColor(51,51,51),_.text(`Slide ${M+1}`,20,20);let I=40;_.setFontSize(14);for(let z of T){if(I>180)break;let A=_.splitTextToSize(z,240);for(let Y of A){if(I>180)break;_.text(Y,20,I),I+=7}I+=3}T.length===0&&(_.setFontSize(12),_.setTextColor(150,150,150),_.text("(\uD14D\uC2A4\uD2B8 \uB0B4\uC6A9 \uC5C6\uC74C)",20,40))}let w=_.output("arraybuffer");return new Uint8Array(w)}catch(e){throw console.error("\u274C PowerPoint \u2192 PDF \uBCC0\uD658 \uC2E4\uD328:",e),new Error("PowerPoint \uD30C\uC77C\uC744 PDF\uB85C \uBCC0\uD658\uD558\uB294 \uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4: "+(e?.message||e))}})}multipleImagesToPdf(t){return C(this,null,function*(){return this.imageToPdf(t)})}calculatePageSize(t,e,n){if(n?.pageSize==="Auto"){let d=n?.margin||20,_=Math.min((595-d*2)/t,(842-d*2)/e);return{width:t*_+d*2,height:e*_+d*2}}return n?.orientation==="landscape"?{width:842,height:595}:{width:595,height:842}}convertToSupportedFormat(t,e){return C(this,null,function*(){return new Promise((n,i)=>{let s=new Image;s.onload=()=>C(null,null,function*(){try{let d=document.createElement("canvas");d.width=s.width,d.height=s.height;let _=d.getContext("2d");if(!_){i(new Error("Canvas context\uB97C \uC0DD\uC131\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."));return}_.drawImage(s,0,0),d.toBlob(v=>C(null,null,function*(){if(v)try{let w=yield v.arrayBuffer(),M=yield e.embedPng(w);n(M)}catch(w){i(w)}else i(new Error("Canvas to Blob \uBCC0\uD658 \uC2E4\uD328"))}),"image/png")}catch(d){i(d)}}),s.onerror=()=>i(new Error("\uC774\uBBF8\uC9C0 \uB85C\uB4DC \uC2E4\uD328")),s.src=URL.createObjectURL(t)})})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var je=class r{pick(){return C(this,arguments,function*(t={}){return console.log("[FilePickerService] pick() called with options:",t),new Promise(e=>{let n=document.createElement("input");n.type="file",n.multiple=t.multiple??!1,n.accept=t.accept??"*/*",console.log("[FilePickerService] Input created - multiple:",n.multiple,"accept:",n.accept),t.source==="camera"&&(n.capture=t.capture??"environment"),n.onchange=i=>C(this,null,function*(){console.log("[FilePickerService] onchange triggered, event:",i);try{let s=i.target.files;console.log("[FilePickerService] Raw files from input:",s,"length:",s?.length);let d=n.multiple?Array.from(i.target.files||[]):i.target.files?.[0]?[i.target.files[0]]:[];console.log("[FilePickerService] Processed selectedFiles:",d.length,d.map(v=>({name:v.name,type:v.type,size:v.size})));let _=this.validateFiles(d,t);if(console.log("[FilePickerService] Validation result:",_),!_.success){console.warn("[FilePickerService] Validation failed:",_.error),t.onError&&t.onError(_.error),e(_);return}t.onFilesSelected?(console.log("[FilePickerService] Calling onFilesSelected callback with",d.length,"files"),yield t.onFilesSelected(d),console.log("[FilePickerService] onFilesSelected callback completed")):console.warn("[FilePickerService] No onFilesSelected callback provided"),console.log("[FilePickerService] Resolving with success"),e({files:d,success:!0})}catch(s){console.error("[FilePickerService] Error in onchange handler:",s);let d=s instanceof Error?s.message:"\uD30C\uC77C \uC120\uD0DD \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.";t.onError&&t.onError(d),e({files:[],success:!1,error:d})}}),n.oncancel=()=>{console.log("[FilePickerService] File selection cancelled"),e({files:[],success:!1,error:"\uD30C\uC77C \uC120\uD0DD\uC774 \uCDE8\uC18C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."})},console.log("[FilePickerService] Triggering input.click()"),n.click()})})}validateFiles(t,e){if(e.minFiles&&t.length<e.minFiles)return{files:[],success:!1,error:`\uCD5C\uC18C ${e.minFiles}\uAC1C\uC758 \uD30C\uC77C\uC744 \uC120\uD0DD\uD574\uC57C \uD569\uB2C8\uB2E4.`};if(e.maxFiles&&t.length>e.maxFiles)return{files:[],success:!1,error:`\uCD5C\uB300 ${e.maxFiles}\uAC1C\uC758 \uD30C\uC77C\uB9CC \uC120\uD0DD\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.`};if(e.maxFileSize&&t.find(i=>i.size>e.maxFileSize)){let i=(e.maxFileSize/1024/1024).toFixed(1);return{files:[],success:!1,error:`\uD30C\uC77C \uD06C\uAE30\uB294 ${i}MB\uB97C \uCD08\uACFC\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.`}}return{files:t,success:!0}}static getAcceptString(t){return{pdf:".pdf,application/pdf",image:"image/*,.jpg,.jpeg,.png,.gif,.bmp,.webp",excel:".xlsx,.xls,.csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",word:".docx,.doc,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/msword",ppt:".pptx,.ppt,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.ms-powerpoint",all:".pdf,.jpg,.jpeg,.png,.gif,.xlsx,.xls,.docx,.pptx"}[t]||"*/*"}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Xt=class r{constructor(t){this.indexedDbService=t}snapshot=null;isInitialized=!1;cacheUpdated$=new de(null);get hasCache(){return this.isInitialized&&this.snapshot!==null}get onCacheUpdated(){return this.cacheUpdated$.asObservable()}getSnapshot(){return this.snapshot}updateSnapshot(t,e){this.snapshot={folders:[...t],documents:[...e],lastUpdated:new Date},this.isInitialized=!0,this.cacheUpdated$.next(this.snapshot)}invalidate(){this.snapshot=null,this.isInitialized=!1,this.cacheUpdated$.next(null)}addDocument(t){if(!this.snapshot)return;let e=this.snapshot.documents.findIndex(n=>n.id===t.id);e>=0?this.snapshot.documents[e]=t:this.snapshot.documents.unshift(t),this.snapshot.lastUpdated=new Date,this.cacheUpdated$.next(this.snapshot)}removeDocument(t){if(!this.snapshot)return;let e=this.snapshot.documents.findIndex(n=>n.id===t);e>=0&&(this.snapshot.documents.splice(e,1),this.snapshot.lastUpdated=new Date,this.cacheUpdated$.next(this.snapshot))}moveDocument(t,e){this.snapshot&&(e!==null&&this.removeDocument(t),this.updateFolderCounts())}addDocumentToHome(t){return C(this,null,function*(){if(this.snapshot)try{let e=yield this.indexedDbService.getDocumentById(t);e&&this.addDocument(e)}catch(e){console.error("\uBB38\uC11C \uB85C\uB4DC \uC2E4\uD328:",e)}})}addFolder(t){if(!this.snapshot)return;let e=this.snapshot.folders.findIndex(n=>n.id===t.id);e>=0?this.snapshot.folders[e]=t:this.snapshot.folders.push(t),this.snapshot.lastUpdated=new Date,this.cacheUpdated$.next(this.snapshot)}removeFolder(t){if(!this.snapshot)return;let e=this.snapshot.folders.findIndex(n=>n.id===t);e>=0&&(this.snapshot.folders.splice(e,1),this.snapshot.lastUpdated=new Date,this.cacheUpdated$.next(this.snapshot))}toggleFavorite(t){if(!this.snapshot)return;let e=this.snapshot.documents.find(n=>n.id===t);e&&(e.isFavorite=!e.isFavorite,this.snapshot.lastUpdated=new Date,this.cacheUpdated$.next(this.snapshot))}updateFolderCounts(){return C(this,null,function*(){if(this.snapshot){for(let t of this.snapshot.folders)try{let e=yield this.indexedDbService.getFolderDocumentCount(t.id);t.fileCount=e}catch{}this.cacheUpdated$.next(this.snapshot)}})}refreshInBackground(){return C(this,null,function*(){try{let[t,e]=yield Promise.all([this.indexedDbService.getFolders(null),this.indexedDbService.getFolderContentsMetadataOnly(null)]);for(let i of t){let s=yield this.indexedDbService.getFolderDocumentCount(i.id);i.fileCount=s}return this.detectChanges(t,e)?(this.updateSnapshot(t,e),!0):!1}catch(t){return console.error("\uBC31\uADF8\uB77C\uC6B4\uB4DC \uCE90\uC2DC \uAC31\uC2E0 \uC2E4\uD328:",t),!1}})}detectChanges(t,e){if(!this.snapshot||this.snapshot.folders.length!==t.length||this.snapshot.documents.length!==e.length)return!0;let n=new Set(this.snapshot.documents.map(s=>s.id)),i=new Set(e.map(s=>s.id));for(let s of i)if(!n.has(s))return!0;return!1}static \u0275fac=function(e){return new(e||r)(X(ee))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ct=class r{state$=new de({isLoading:!1,type:"spinner",progress:0,message:""});get isLoading$(){return new de(this.state$.value.isLoading).asObservable()}get state(){return this.state$.asObservable()}get currentState(){return this.state$.value}showSpinner(t="\uB85C\uB529 \uC911..."){this.state$.next({isLoading:!0,type:"spinner",progress:0,message:t})}showProgress(t="\uCC98\uB9AC \uC911...",e=0){this.state$.next({isLoading:!0,type:"progress",progress:e,message:t})}updateProgress(t,e){let n=this.state$.value;this.state$.next(Z(K({},n),{progress:Math.min(100,Math.max(0,t)),message:e??n.message}))}updateMessage(t){let e=this.state$.value;this.state$.next(Z(K({},e),{message:t}))}hide(){this.state$.next({isLoading:!1,type:"spinner",progress:0,message:""})}wrapAsync(t,e="\uCC98\uB9AC \uC911...",n="spinner"){return C(this,null,function*(){try{return n==="spinner"?this.showSpinner(e):this.showProgress(e),yield t()}finally{this.hide()}})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Sr=["*"];function Or(r,t){if(r&1){let e=y();o(0,"div",5),u("click",function(){m(e);let i=g();return f(i.setState("collapsed"))}),a()}}var Pe=class r{constructor(t,e){this.cdr=t;this.el=e}isInitialized=!1;get sheetState(){return this._sheetState}set sheetState(t){this._sheetState!==t&&(this._sheetState=t,this.updateBodyScroll(),this.cdr.markForCheck())}_sheetState="collapsed";sheetStateChange=new W;close=new W;isDragging=!1;dragStartY=0;dragStartHeight=0;ngAfterViewInit(){setTimeout(()=>{this.isInitialized=!0;let t=this.el.nativeElement.querySelector(".bottom-sheet");t?t.classList.add("initialized"):console.error("\u274C BottomSheet .bottom-sheet \uC694\uC18C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC74C")},50)}setState(t){this.sheetState!==t&&(this.sheetState=t,this.sheetStateChange.emit(t),this.cdr.markForCheck(),t==="collapsed"&&this.close.emit())}updateBodyScroll(){this.sheetState==="collapsed"?document.body.style.overflow="auto":document.body.style.overflow="hidden"}onDragHandleTouchStart(t){this.isDragging=!0,this.dragStartY=t.touches[0].clientY;let e=this.el.nativeElement.querySelector(".bottom-sheet");e&&(this.dragStartHeight=e.offsetHeight);let n=this.el.nativeElement.querySelector(".handle-bar");n&&n.classList.add("dragging"),t.stopPropagation()}onDragHandleTouchMove(t){if(!this.isDragging)return;let e=t.touches[0].clientY,n=this.dragStartY-e,i=this.dragStartHeight+n,s=window.innerHeight*.9;i=Math.max(60,Math.min(i,s));let _=this.el.nativeElement.querySelector(".bottom-sheet");_&&(_.style.transition="none",_.style.height=`${i}px`,_.style.maxHeight=`${i}px`,_.style.transform="translateY(0)"),t.preventDefault(),t.stopPropagation()}onDragHandleTouchEnd(t){this.isDragging=!1;let e=this.el.nativeElement.querySelector(".handle-bar");e&&e.classList.remove("dragging");let n=this.el.nativeElement.querySelector(".bottom-sheet");if(!n)return;let i=n.offsetHeight,s=window.innerHeight,d=s*.5,_=s*.7;n.style.transition="",n.style.height="",n.style.maxHeight="",n.style.transform="";let v;if(i<d/1.5)v="collapsed";else if(i>=_)v="full";else if(i<d*1.2)v="half";else{let w=Math.abs(i-d),M=Math.abs(i-s*.9);v=w<M?"half":"full"}this.setState(v)}static \u0275fac=function(e){return new(e||r)(V(fe),V(Qi))};static \u0275cmp=F({type:r,selectors:[["app-bottom-sheet"]],inputs:{sheetState:"sheetState"},outputs:{sheetStateChange:"sheetStateChange",close:"close"},ngContentSelectors:Sr,decls:6,vars:7,consts:[["class","sheet-overlay",3,"click",4,"ngIf"],[1,"bottom-sheet"],[1,"drag-handle",3,"touchstart","touchmove","touchend"],[1,"handle-bar"],[1,"sheet-content"],[1,"sheet-overlay",3,"click"]],template:function(e,n){e&1&&(so(),b(0,Or,1,0,"div",0),o(1,"div",1)(2,"div",2),u("touchstart",function(s){return n.onDragHandleTouchStart(s)})("touchmove",function(s){return n.onDragHandleTouchMove(s)})("touchend",function(s){return n.onDragHandleTouchEnd(s)}),h(3,"div",3),a(),o(4,"div",4),lo(5),a()()),e&2&&(p("ngIf",n.sheetState!=="collapsed"),l(),k("collapsed",n.sheetState==="collapsed")("half",n.sheetState==="half")("full",n.sheetState==="full"))},dependencies:[_e,B],styles:[".sheet-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .2s ease;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.bottom-sheet[_ngcontent-%COMP%]{position:fixed;left:0;right:0;bottom:0;background:#fff;color:#333;border-radius:16px 16px 0 0;box-shadow:0 -2px 16px #00000026;z-index:1001;transition:transform .3s cubic-bezier(.4,0,.2,1),max-height .3s cubic-bezier(.4,0,.2,1);max-height:90vh;display:flex;flex-direction:column}.bottom-sheet.collapsed[_ngcontent-%COMP%]{transform:translateY(100%)}.bottom-sheet[_ngcontent-%COMP%]:not(.initialized){transition:none!important}.bottom-sheet.half[_ngcontent-%COMP%]{transform:translateY(0);max-height:50vh}.bottom-sheet.full[_ngcontent-%COMP%]{transform:translateY(0);max-height:90vh}.bottom-sheet[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;height:20px;display:flex;justify-content:center;align-items:center;cursor:ns-resize;z-index:10}.bottom-sheet[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]   .handle-bar[_ngcontent-%COMP%]{width:40px;height:4px;background-color:#ccc;border-radius:2px;transition:background-color .2s ease}.bottom-sheet[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]   .handle-bar.dragging[_ngcontent-%COMP%]{background-color:#2196f3}.bottom-sheet[_ngcontent-%COMP%]   .sheet-content[_ngcontent-%COMP%]{padding-top:20px;padding-bottom:calc(60px + var(--android-navigation-bar-height, 0px));overflow-y:auto;flex-grow:1}"],changeDetection:0})};function Er(r,t){if(r&1){let e=y();o(0,"div",2),u("click",function(){m(e);let i=g();return f(i.onOverlayClick())}),o(1,"div",3),u("click",function(i){return m(e),f(i.stopPropagation())}),o(2,"div",4)(3,"h3",5),c(4),a()(),o(5,"div",6)(6,"input",7,0),$("ngModelChange",function(i){m(e);let s=g();return U(s.inputValue,i)||(s.inputValue=i),f(i)}),u("keyup.enter",function(){m(e);let i=g();return f(i.onConfirm())})("keyup.escape",function(){m(e);let i=g();return f(i.onCancel())}),a()(),o(8,"div",8)(9,"button",9),u("click",function(){m(e);let i=g();return f(i.onCancel())}),c(10," \uCDE8\uC18C "),a(),o(11,"button",10),u("click",function(){m(e);let i=g();return f(i.onConfirm())}),c(12," \uD655\uC778 "),a()()()()}if(r&2){let e=g();l(4),x(e.title),l(2),j("ngModel",e.inputValue),p("placeholder",e.placeholder),l(5),p("disabled",!e.inputValue.trim())}}var bt=class r{isOpen=!1;title="\uC785\uB825";placeholder="\uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694";initialValue="";confirm=new W;cancel=new W;isOpenChange=new W;inputValue="";ngOnChanges(){this.isOpen&&this.initialValue?this.inputValue=this.initialValue:this.isOpen&&(this.inputValue="")}onConfirm(){this.inputValue.trim()&&(this.confirm.emit(this.inputValue.trim()),this.close())}onCancel(){this.cancel.emit(),this.close()}onOverlayClick(){this.onCancel()}close(){this.isOpen=!1,this.inputValue="",this.isOpenChange.emit(!1)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["app-input-dialog"]],inputs:{isOpen:"isOpen",title:"title",placeholder:"placeholder",initialValue:"initialValue"},outputs:{confirm:"confirm",cancel:"cancel",isOpenChange:"isOpenChange"},features:[Je],decls:1,vars:1,consts:[["inputField",""],["class","dialog-overlay",3,"click",4,"ngIf"],[1,"dialog-overlay",3,"click"],[1,"dialog-content",3,"click"],[1,"dialog-header"],[1,"dialog-title"],[1,"dialog-body"],["type","text",1,"dialog-input",3,"ngModelChange","keyup.enter","keyup.escape","ngModel","placeholder"],[1,"dialog-footer"],[1,"dialog-btn","cancel-btn",3,"click"],[1,"dialog-btn","confirm-btn",3,"click","disabled"]],template:function(e,n){e&1&&b(0,Er,13,4,"div",1),e&2&&p("ngIf",n.isOpen)},dependencies:[_e,B,Qe,he,pe,ge],styles:[".dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:10000;animation:_ngcontent-%COMP%_fadeIn .2s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.dialog-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:90%;max-width:400px;box-shadow:0 4px 20px #00000026;animation:_ngcontent-%COMP%_slideUp .2s ease}@keyframes _ngcontent-%COMP%_slideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.dialog-header[_ngcontent-%COMP%]{padding:20px 20px 16px;border-bottom:1px solid #e5e7eb}.dialog-title[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#222}.dialog-body[_ngcontent-%COMP%]{padding:20px}.dialog-input[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:1px solid #d1d5db;border-radius:8px;font-size:16px;outline:none;transition:border-color .2s ease}.dialog-input[_ngcontent-%COMP%]:focus{border-color:#2196f3;box-shadow:0 0 0 3px #2196f31a}.dialog-footer[_ngcontent-%COMP%]{padding:16px 20px 20px;display:flex;gap:12px;justify-content:flex-end}.dialog-btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.cancel-btn[_ngcontent-%COMP%]{background:#f3f4f6;color:#6b7280}.cancel-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb}.confirm-btn[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.confirm-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#1976d2}.confirm-btn[_ngcontent-%COMP%]:disabled{background:#d1d5db;cursor:not-allowed}"],changeDetection:0})};function kr(r,t){if(r&1){let e=y();o(0,"button",1),u("click",function(){m(e);let i=g();return f(i.onClick())}),h(1,"img",2),a()}}var vt=class r{visible=!0;folderId=null;autoOpen=!0;multiple=!1;fileAdded=new W;filesAdded=new W;router=P(N);indexedDbService=P(ee);snackbar=P(G);filePicker=P(je);onClick(){return C(this,null,function*(){yield this.openFileDialog()})}openFileDialog(){return C(this,null,function*(){yield this.filePicker.pick({multiple:this.multiple,accept:je.getAcceptString("pdf"),onFilesSelected:t=>C(this,null,function*(){if(t.length===0){this.snackbar.showWarning("\uC120\uD0DD\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}t.length===1?this.snackbar.showInfo("\uD30C\uC77C \uC5C5\uB85C\uB4DC \uC911..."):this.snackbar.showInfo(`${t.length}\uAC1C \uD30C\uC77C \uC5C5\uB85C\uB4DC \uC911...`);let e=[];for(let n of t){let i=yield this.handleFileUpload(n);i&&e.push(i)}if(e.length>0&&(t.length===1?this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4."):this.snackbar.showSuccess(`${e.length}\uAC1C \uD30C\uC77C\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),e.length===1&&this.fileAdded.emit(e[0]),this.filesAdded.emit(e),this.autoOpen&&e.length>0)){let n=e[0];yield this.openDocument(n)}}),onError:t=>{this.snackbar.showError(t||"\uD30C\uC77C \uC5C5\uB85C\uB4DC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})})}handleFileUpload(t){return C(this,null,function*(){try{let e=yield this.fileToBase64(t),n=t.name.split(".").pop()?.toLowerCase()||"",i=t.type==="application/pdf"||n==="pdf",s=!1;return i&&(s=yield this.checkPdfEncryption(e)),yield this.saveDocument(t,e,s)}catch(e){return console.error("\uD30C\uC77C \uC5C5\uB85C\uB4DC \uC2E4\uD328:",e),null}})}saveDocument(t,e,n){return C(this,null,function*(){let i=t.name.split(".").pop()?.toLowerCase()||"",s=t.type==="application/pdf"||i==="pdf",d={id:this.generateDocumentId(),title:t.name.replace(/\.[^/.]+$/,""),fileName:t.name,pages:[],elementCount:0,version:"1.0",folderId:this.folderId,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:"viewer",fileSize:t.size,isEncrypted:n};return s?d.pdfBase64=e:(d.originalFileData=e,d.mimeType=t.type),yield this.indexedDbService.saveDocument(d),d})}openDocument(t){return C(this,null,function*(){this.router.navigate(["/ezm/viewer",t.id])})}checkPdfEncryption(t){return C(this,null,function*(){try{let e=window["pdfjs-dist/build/pdf"]||window.pdfjsLib;if(!e)return!1;let n=atob(t.replace(/^data:application\/pdf;base64,/,"")),i=new Uint8Array(n.length);for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s);try{return yield e.getDocument({data:i}).promise,!1}catch(s){return s.name==="PasswordException"}}catch{return!1}})}fileToBase64(t){return new Promise((e,n)=>{let i=new FileReader;i.onload=()=>{let s=i.result,d=s.includes(",")?s.split(",")[1]:s;e(d)},i.onerror=n,i.readAsDataURL(t)})}generateDocumentId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-fab"]],inputs:{visible:"visible",folderId:"folderId",autoOpen:"autoOpen",multiple:"multiple"},outputs:{fileAdded:"fileAdded",filesAdded:"filesAdded"},decls:1,vars:1,consts:[["class","fab-button",3,"click",4,"ngIf"],[1,"fab-button",3,"click"],["src","images/icons/btn-plus.svg","alt","\uCD94\uAC00","width","86","height","86"]],template:function(e,n){e&1&&b(0,kr,2,0,"button",0),e&2&&p("ngIf",n.visible)},dependencies:[_e,B],styles:[".fab-button[_ngcontent-%COMP%]{position:fixed;right:20px;bottom:calc(80px + var(--android-navigation-bar-height, 0px));width:auto;height:auto;border:none;background:transparent;padding:0;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:50;transition:all .2s}.fab-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block}.fab-button[_ngcontent-%COMP%]:active{transform:scale(.95)}"]})};function Dr(r,t){r&1&&(re(0),h(1,"div",5),ae())}function Ir(r,t){if(r&1&&(re(0),o(1,"div",6),h(2,"div",7),L(3,"async"),a(),o(4,"span",8),c(5),L(6,"async"),L(7,"number"),a(),ae()),r&2){let e,n,i=g(2);l(2),q("width",(e=J(3,3,i.loadingService.state))==null?null:e.progress,"%"),l(3),S("",me(7,7,(n=J(6,5,i.loadingService.state))==null?null:n.progress,"1.0-0"),"%")}}function Tr(r,t){if(r&1&&(o(0,"div",1)(1,"div",2),b(2,Dr,2,0,"ng-container",3),L(3,"async"),b(4,Ir,8,10,"ng-container",3),L(5,"async"),o(6,"span",4),c(7),L(8,"async"),a()()()),r&2){let e,n,i,s=g();l(2),p("ngIf",((e=J(3,3,s.loadingService.state))==null?null:e.type)==="spinner"),l(2),p("ngIf",((n=J(5,5,s.loadingService.state))==null?null:n.type)==="progress"),l(3),x((i=J(8,7,s.loadingService.state))==null?null:i.message)}}var xt=class r{loadingService=P(Ct);static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-loading-overlay"]],decls:2,vars:3,consts:[["class","loading-overlay",4,"ngIf"],[1,"loading-overlay"],[1,"loading-content"],[4,"ngIf"],[1,"loading-message"],[1,"spinner"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"]],template:function(e,n){if(e&1&&(b(0,Tr,9,9,"div",0),L(1,"async")),e&2){let i;p("ngIf",(i=J(1,1,n.loadingService.state))==null?null:i.isLoading)}},dependencies:[_e,B,uo,Te],styles:[".loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:9999;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.loading-content[_ngcontent-%COMP%]{background:#fff;padding:24px 32px;border-radius:16px;display:flex;flex-direction:column;align-items:center;gap:16px;min-width:200px;box-shadow:0 4px 20px #00000026}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #f0f0f0;border-top-color:#ef5350;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#f0f0f0;border-radius:4px;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#ef5350,#ff7043);border-radius:4px;transition:width .3s ease}.progress-text[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#ef5350}.loading-message[_ngcontent-%COMP%]{font-size:14px;color:#666;text-align:center}"]})};function Ar(r,t){r&1&&(o(0,"div",3),h(1,"div",4),o(2,"div",5),h(3,"div",6)(4,"div",7),a()())}function Fr(r,t){if(r&1&&(o(0,"div",1),b(1,Ar,5,0,"div",2),a()),r&2){let e=g();l(),p("ngForOf",e.items)}}function zr(r,t){r&1&&(o(0,"div",9),h(1,"div",10),o(2,"div",5),h(3,"div",6)(4,"div",7),a()())}function Rr(r,t){if(r&1&&(o(0,"div",1),b(1,zr,5,0,"div",8),a()),r&2){let e=g();l(),p("ngForOf",e.items)}}function Br(r,t){r&1&&(o(0,"div",12),h(1,"div",10),o(2,"div",5),h(3,"div",6)(4,"div",7),a()())}function Vr(r,t){if(r&1&&(o(0,"div",1),b(1,Br,5,0,"div",11),a()),r&2){let e=g();l(),p("ngForOf",e.items)}}function Lr(r,t){r&1&&(o(0,"div",14),h(1,"div",15),o(2,"div",5),h(3,"div",6)(4,"div",7),a()())}function Nr(r,t){if(r&1&&(o(0,"div",1),b(1,Lr,5,0,"div",13),a()),r&2){let e=g();l(),p("ngForOf",e.items)}}function jr(r,t){r&1&&h(0,"div",17)}function Ur(r,t){if(r&1&&(o(0,"div",1),b(1,jr,1,0,"div",16),a()),r&2){let e=g();l(),p("ngForOf",e.items)}}var tt=class r{type="list";count=3;get items(){return Array(this.count).fill(0)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-shimmer-skeleton"]],inputs:{type:"type",count:"count"},decls:5,vars:5,consts:[["class","skeleton-container",4,"ngIf"],[1,"skeleton-container"],["class","skeleton-item folder-skeleton",4,"ngFor","ngForOf"],[1,"skeleton-item","folder-skeleton"],[1,"skeleton-icon","folder-icon-skeleton","shimmer"],[1,"skeleton-content"],[1,"skeleton-title","shimmer"],[1,"skeleton-subtitle","shimmer"],["class","skeleton-item file-skeleton",4,"ngFor","ngForOf"],[1,"skeleton-item","file-skeleton"],[1,"skeleton-icon","file-icon-skeleton","shimmer"],["class","skeleton-item file-myfiles-skeleton",4,"ngFor","ngForOf"],[1,"skeleton-item","file-myfiles-skeleton"],["class","skeleton-item list-skeleton",4,"ngFor","ngForOf"],[1,"skeleton-item","list-skeleton"],[1,"skeleton-icon","shimmer"],["class","skeleton-card shimmer",4,"ngFor","ngForOf"],[1,"skeleton-card","shimmer"]],template:function(e,n){e&1&&b(0,Fr,2,1,"div",0)(1,Rr,2,1,"div",0)(2,Vr,2,1,"div",0)(3,Nr,2,1,"div",0)(4,Ur,2,1,"div",0),e&2&&(p("ngIf",n.type==="folder"),l(),p("ngIf",n.type==="file"),l(),p("ngIf",n.type==="file-myfiles"),l(),p("ngIf",n.type==="list"),l(),p("ngIf",n.type==="card"))},dependencies:[_e,oe,B],styles:["@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:-200% 0}to{background-position:200% 0}}.shimmer[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e8e8e8,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite}.skeleton-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.skeleton-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;border-bottom:1px solid #f0f0f0;box-sizing:border-box}.skeleton-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.folder-skeleton[_ngcontent-%COMP%]{height:64px;padding:12px 0}.folder-skeleton[_ngcontent-%COMP%]   .folder-icon-skeleton[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;flex-shrink:0}.file-skeleton[_ngcontent-%COMP%]{height:72px;padding:8px 0}.file-skeleton[_ngcontent-%COMP%]   .file-icon-skeleton[_ngcontent-%COMP%]{width:48px;height:56px;border-radius:4px;flex-shrink:0}.file-myfiles-skeleton[_ngcontent-%COMP%]{height:80px;padding:12px 16px}.file-myfiles-skeleton[_ngcontent-%COMP%]   .file-icon-skeleton[_ngcontent-%COMP%]{width:48px;height:56px;border-radius:4px;flex-shrink:0}.list-skeleton[_ngcontent-%COMP%]{height:64px;padding:12px 0}.list-skeleton[_ngcontent-%COMP%]   .skeleton-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;flex-shrink:0}.skeleton-content[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;justify-content:center;gap:6px}.skeleton-content[_ngcontent-%COMP%]   .skeleton-title[_ngcontent-%COMP%]{height:15px;width:60%;max-width:180px;border-radius:4px}.skeleton-content[_ngcontent-%COMP%]   .skeleton-subtitle[_ngcontent-%COMP%]{height:12px;width:40%;max-width:120px;border-radius:4px}.skeleton-card[_ngcontent-%COMP%]{height:120px;border-radius:12px;margin-bottom:12px}"]})};var Pt=class r{sheetState="collapsed";criteria="date";order="desc";sheetStateChange=new W;sortApply=new W;close=new W;tempCriteria="date";tempOrder="desc";ngOnChanges(){this.tempCriteria=this.criteria,this.tempOrder=this.order}onSheetStateChange(t){this.sheetStateChange.emit(t)}onClose(){this.sheetStateChange.emit("collapsed"),this.close.emit()}onCancel(){this.tempCriteria=this.criteria,this.tempOrder=this.order,this.onClose()}onConfirm(){this.sortApply.emit({criteria:this.tempCriteria,order:this.tempOrder}),this.onClose()}open(){this.tempCriteria=this.criteria,this.tempOrder=this.order,this.sheetStateChange.emit("full")}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-sort-bottom-sheet"]],inputs:{sheetState:"sheetState",criteria:"criteria",order:"order"},outputs:{sheetStateChange:"sheetStateChange",sortApply:"sortApply",close:"close"},features:[Je],decls:42,vars:7,consts:[[3,"sheetStateChange","close","sheetState"],[1,"sort-sheet-content"],[1,"sort-sheet-title"],[1,"sort-options"],[1,"sort-option"],["type","radio","name","sortCriteria","value","title",3,"ngModelChange","ngModel"],[1,"radio-mark"],["type","radio","name","sortCriteria","value","type",3,"ngModelChange","ngModel"],["type","radio","name","sortCriteria","value","date",3,"ngModelChange","ngModel"],["type","radio","name","sortCriteria","value","size",3,"ngModelChange","ngModel"],[1,"sort-divider"],["type","radio","name","sortOrder","value","asc",3,"ngModelChange","ngModel"],["type","radio","name","sortOrder","value","desc",3,"ngModelChange","ngModel"],[1,"sort-buttons"],[1,"btn-cancel",3,"click"],[1,"btn-confirm",3,"click"]],template:function(e,n){e&1&&(o(0,"app-bottom-sheet",0),u("sheetStateChange",function(s){return n.onSheetStateChange(s)})("close",function(){return n.onClose()}),o(1,"div",1)(2,"h3",2),c(3,"\uC815\uB82C \uAE30\uC900"),a(),o(4,"div",3)(5,"label",4)(6,"span"),c(7,"\uC81C\uBAA9"),a(),o(8,"input",5),$("ngModelChange",function(s){return U(n.tempCriteria,s)||(n.tempCriteria=s),s}),a(),h(9,"span",6),a(),o(10,"label",4)(11,"span"),c(12,"\uC720\uD615"),a(),o(13,"input",7),$("ngModelChange",function(s){return U(n.tempCriteria,s)||(n.tempCriteria=s),s}),a(),h(14,"span",6),a(),o(15,"label",4)(16,"span"),c(17,"\uB0A0\uC9DC (\uCD5C\uADFC \uBCF8 \uD30C\uC77C)"),a(),o(18,"input",8),$("ngModelChange",function(s){return U(n.tempCriteria,s)||(n.tempCriteria=s),s}),a(),h(19,"span",6),a(),o(20,"label",4)(21,"span"),c(22,"\uD06C\uAE30"),a(),o(23,"input",9),$("ngModelChange",function(s){return U(n.tempCriteria,s)||(n.tempCriteria=s),s}),a(),h(24,"span",6),a()(),h(25,"div",10),o(26,"div",3)(27,"label",4)(28,"span"),c(29,"\uC624\uB984\uCC28\uC21C"),a(),o(30,"input",11),$("ngModelChange",function(s){return U(n.tempOrder,s)||(n.tempOrder=s),s}),a(),h(31,"span",6),a(),o(32,"label",4)(33,"span"),c(34,"\uB0B4\uB9BC\uCC28\uC21C"),a(),o(35,"input",12),$("ngModelChange",function(s){return U(n.tempOrder,s)||(n.tempOrder=s),s}),a(),h(36,"span",6),a()(),o(37,"div",13)(38,"button",14),u("click",function(){return n.onCancel()}),c(39,"\uCDE8\uC18C"),a(),o(40,"button",15),u("click",function(){return n.onConfirm()}),c(41,"\uD655\uC778"),a()()()()),e&2&&(p("sheetState",n.sheetState),l(8),j("ngModel",n.tempCriteria),l(5),j("ngModel",n.tempCriteria),l(5),j("ngModel",n.tempCriteria),l(5),j("ngModel",n.tempCriteria),l(7),j("ngModel",n.tempOrder),l(5),j("ngModel",n.tempOrder))},dependencies:[_e,Qe,he,Mn,pe,ge,Pe],styles:['.sort-sheet-content[_ngcontent-%COMP%]{padding:20px}.sort-sheet-content[_ngcontent-%COMP%]   .sort-sheet-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin-bottom:16px}.sort-sheet-content[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]{display:flex;flex-direction:column}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:14px 0;cursor:pointer}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:15px;color:#333}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]   .radio-mark[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid #ddd;border-radius:50%;position:relative;flex-shrink:0}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + .radio-mark[_ngcontent-%COMP%]{border-color:#ef5350}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + .radio-mark[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:10px;height:10px;background:#ef5350;border-radius:50%}.sort-sheet-content[_ngcontent-%COMP%]   .sort-divider[_ngcontent-%COMP%]{height:1px;background:#eee;margin:8px 0}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:20px}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:14px;border-radius:8px;font-size:15px;font-weight:500;cursor:pointer}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:#f5f5f5;border:none;color:#666}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:active{background:#e8e8e8}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{background:#ef5350;border:none;color:#fff}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:active{background:#e53935}']})};var cr={nav:{home:"\uD648",tools:"\uB3C4\uAD6C",files:"\uB0B4\uD30C\uC77C",favorites:"\uC990\uACA8\uCC3E\uAE30",profile:"\uB0B4\uC815\uBCF4"},settings:{title:"\uC124\uC815",snackbar:"\uC2A4\uB0B5\uBC14 \uC54C\uB9BC",language:"\uC5B8\uC5B4\uC120\uD0DD",getApiKey:"Google\uC5D0\uC11C API \uD0A4 \uAC00\uC838\uC624\uAE30",removeApiKey:"API \uD0A4 \uC0AD\uC81C",login:"\uB85C\uADF8\uC778",logout:"\uB85C\uADF8\uC544\uC6C3",privacy:"\uAC1C\uC778\uC815\uBCF4 \uCC98\uB9AC \uBC29\uCE68",support:"\uACE0\uAC1D\uC9C0\uC6D0",version:"\uBC84\uC804 \uC815\uBCF4",loginRequired:"\uB85C\uADF8\uC778\uC774 \uD544\uC694\uD569\uB2C8\uB2E4",loginDescription:"\uB85C\uADF8\uC778\uD558\uC5EC \uC11C\uBE44\uC2A4\uB97C \uC774\uC6A9\uD558\uC138\uC694",apiKeyLabel:"Gemini API Key",apiKeyMissing:"API \uD0A4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4",apiKeyDescription:"AI \uAE30\uB2A5\uC744 \uC0AC\uC6A9\uD558\uB824\uBA74 Google\uC5D0\uC11C API \uD0A4\uB97C \uAC00\uC838\uC640\uC57C \uD569\uB2C8\uB2E4",googleLogin:"Google \uB85C\uADF8\uC778",localLogin:"\uB85C\uCEEC \uB85C\uADF8\uC778",guest:"\uAC8C\uC2A4\uD2B8",aiSettings:"AI \uC124\uC815",aiAuthStatus:"AI \uC778\uC99D \uC0C1\uD0DC",authMethod:"\uC778\uC99D \uBC29\uBC95",googleOAuth:"Google OAuth",geminiApiKey:"Gemini API \uD0A4",noAuth:"\uC778\uC99D \uC5C6\uC74C",noAuthDesc:"AI \uAE30\uB2A5\uC744 \uC0AC\uC6A9\uD558\uB824\uBA74 \uC778\uC99D\uC774 \uD544\uC694\uD569\uB2C8\uB2E4",googleAuthTitle:"Google \uACC4\uC815\uC73C\uB85C \uC778\uC99D",googleAuthDesc:"Google OAuth\uB97C \uD1B5\uD574 AI \uAE30\uB2A5 \uC0AC\uC6A9",geminiInputTitle:"Gemini API \uD0A4 \uC9C1\uC811 \uC785\uB825",geminiInputDesc:"Google AI Studio\uC5D0\uC11C \uBC1C\uAE09\uBC1B\uC740 \uD0A4 \uC785\uB825",testKeyTitle:"\uD14C\uC2A4\uD2B8 API \uD0A4 \uC0AC\uC6A9",testKeyDesc:"\uAC1C\uBC1C/\uD14C\uC2A4\uD2B8\uC6A9 Gemini API \uD0A4 \uC790\uB3D9 \uC124\uC815",authModeSection:"\uC0AC\uC6A9\uD560 \uC778\uC99D \uBC29\uC2DD",useOAuthToken:"OAuth \uD1A0\uD070 \uC0AC\uC6A9",oauthQuotaDesc:"Google \uACC4\uC815 \uD560\uB2F9\uB7C9 \uC0AC\uC6A9",authManagement:"\uC778\uC99D \uC815\uBCF4 \uAD00\uB9AC",deleteAllAuth:"\uBAA8\uB4E0 \uC778\uC99D \uC815\uBCF4 \uC0AD\uC81C",active:"\uD65C\uC131",inactive:"\uBBF8\uC124\uC815",apiKeyManagement:"API \uD0A4 \uAD00\uB9AC",googleAuthKey:"Google \uC778\uC99D \uD0A4",oauthUsing:"OAuth \uD1A0\uD070 (\uC0AC\uC6A9 \uC911: ",testDevUsing:"\uD14C\uC2A4\uD2B8/\uAC1C\uBC1C\uC6A9 (\uC0AC\uC6A9 \uC911: ",deleteApiKey:"API \uD0A4 \uC0AD\uC81C",privacyTitle:"\uAC1C\uC778\uC815\uBCF4 \uCC98\uB9AC \uBC29\uCE68",privacyIntro:"EzReader\uB294 \uC0AC\uC6A9\uC790\uC758 \uAC1C\uC778\uC815\uBCF4\uB97C \uC18C\uC911\uD788 \uC5EC\uAE30\uBA70, \uAD00\uB828 \uBC95\uB839\uC744 \uC900\uC218\uD569\uB2C8\uB2E4.",privacyCollect:"\uC218\uC9D1\uD558\uB294 \uAC1C\uC778\uC815\uBCF4",privacyCollectContent:`- Google \uACC4\uC815 \uC778\uC99D \uC2DC \uC774\uBA54\uC77C \uC8FC\uC18C
- \uC571 \uC0AC\uC6A9 \uAE30\uB85D \uBC0F \uC124\uC815`,privacyPurpose:"\uAC1C\uC778\uC815\uBCF4 \uC774\uC6A9 \uBAA9\uC801",privacyPurposeContent:`- AI \uAE30\uB2A5 \uC81C\uACF5\uC744 \uC704\uD55C \uC778\uC99D
- \uC11C\uBE44\uC2A4 \uAC1C\uC120 \uBC0F \uC0AC\uC6A9\uC790 \uC9C0\uC6D0`,privacyPeriod:"\uAC1C\uC778\uC815\uBCF4 \uBCF4\uC720 \uAE30\uAC04",privacyPeriodContent:"- \uD68C\uC6D0 \uD0C8\uD1F4 \uC2DC\uAE4C\uC9C0 \uB610\uB294 \uBC95\uB839\uC5D0\uC11C \uC815\uD55C \uAE30\uAC04",supportTitle:"\uACE0\uAC1D\uC9C0\uC6D0",supportInquiry:"\uBB38\uC758\uD558\uAE30",supportDesc:"\uC11C\uBE44\uC2A4 \uC774\uC6A9 \uC911 \uBB38\uC81C\uAC00 \uC788\uC73C\uC2DC\uBA74 \uC544\uB798\uB85C \uC5F0\uB77D\uD574 \uC8FC\uC138\uC694.",supportHours:"\uC6B4\uC601\uC2DC\uAC04: \uD3C9\uC77C 09:00 ~ 18:00",versionTitle:"\uBC84\uC804 \uC815\uBCF4",versionLabel:"\uBC84\uC804",copyright:"\xA9 2024 EzReader. All rights reserved.",deviceInfo:"\uB514\uBC14\uC774\uC2A4 \uC815\uBCF4",manufacturer:"\uC81C\uC870\uC0AC",model:"\uBAA8\uB378\uBA85",screenSize:"\uD654\uBA74 \uD06C\uAE30",status:"\uC0C1\uD0DC",nativePending:"Native \uC751\uB2F5 \uB300\uAE30 \uC911 (\uAE30\uBCF8\uAC12)",notch:"\uB178\uCE58",hasNotch:"\uC788\uC74C",noNotch:"\uC5C6\uC74C",layoutAdjust:"\uB808\uC774\uC544\uC6C3 \uC870\uC815",statusBarHeight:"\uC0C1\uD0DC\uBC14 \uB192\uC774",navBarHeight:"\uB124\uBE44\uAC8C\uC774\uC158\uBC14 \uB192\uC774",applyLayout:"\uB808\uC774\uC544\uC6C3 \uC801\uC6A9"},home:{search:"\uAC80\uC0C9",pdfOpen:"\uAD6C\uC131",pdfConvert:"\uBD84\uD560",pdfMerge:"\uBCD1\uD569",recentFiles:"\uCD5C\uADFC \uBCF8 \uD30C\uC77C",noRecentFiles:"\uCD5C\uADFC \uBCF8 \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"},tools:{title:"\uB3C4\uAD6C",aiFeatures:"AI \uAE30\uB2A5",aiSummary:"AI \uC694\uC57D",aiTranslate:"AI \uBC88\uC5ED",aiAnalysis:"PDF \uBD84\uC11D",fromPdf:"PDF\uB97C \uBB38\uC11C\uB85C \uBCC0\uD658",pdfToImage:"PDF \u2192 \uC774\uBBF8\uC9C0",pdfToExcel:"PDF \u2192 Excel",pdfToWord:"PDF \u2192 Word",pdfToJpg:"PDF \u2192 JPG",toPdf:"\uBB38\uC11C\uB97C PDF\uB85C \uBCC0\uD658",imageToPdf:"\uC774\uBBF8\uC9C0 \u2192 PDF",wordToPdf:"Word \u2192 PDF",excelToPdf:"Excel \u2192 PDF",pptToPdf:"PPT \u2192 PDF",pdfTools:"PDF \uB3C4\uAD6C",documentTools:"\uBB38\uC11C \uAE30\uB2A5",merge:"\uBCD1\uD569",split:"\uBD84\uD560",rotate:"\uD68C\uC804",organize:"\uAD6C\uC131",pageNumber:"\uD398\uC774\uC9C0 \uBC88\uD638",watermark:"\uC6CC\uD130\uB9C8\uD06C",security:"\uBCF4\uC548",encrypt:"\uC554\uD638\uD654",decrypt:"\uBCF5\uD638\uD654",create:"\uB9CC\uB4E4\uAE30",edit:"\uD3B8\uC9D1"},files:{title:"\uB0B4\uD30C\uC77C",noFiles:"\uC800\uC7A5\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4",uploadFirst:"PDF \uD30C\uC77C\uC744 \uC5C5\uB85C\uB4DC\uD558\uAC70\uB098 \uC0DD\uC131\uD574\uBCF4\uC138\uC694",myFiles:"\uD30C\uC77C",recentFiles:"\uCD5C\uADFC \uBCF8 \uD30C\uC77C",favorites:"\uC990\uACA8\uCC3E\uAE30",results:"\uB0B4 \uC791\uC5C5 \uD30C\uC77C"},sideMenu:{title:"\uB354\uBCF4\uAE30",loginPrompt:"\uB85C\uADF8\uC778\uD558\uB7EC \uAC00\uAE30",myPoints:"\uB0B4 \uD3EC\uC778\uD2B8",points:"\uD3EC\uC778\uD2B8",myPage:"\uB9C8\uC774\uD398\uC774\uC9C0",settings:"\uC124\uC815"},common:{confirm:"\uD655\uC778",cancel:"\uCDE8\uC18C",save:"\uC800\uC7A5",delete:"\uC0AD\uC81C",close:"\uB2EB\uAE30",loading:"\uB85C\uB529 \uC911...",error:"\uC624\uB958 \uBC1C\uC0DD",success:"\uC131\uACF5",preparing:"\uC900\uBE44\uC911 \uC785\uB2C8\uB2E4",uploading:"\uC5C5\uB85C\uB4DC \uC911...",processing:"\uCC98\uB9AC \uC911...",completed:"\uC644\uB8CC",failed:"\uC2E4\uD328"},snackbar:{languageChanged:"\uC5B8\uC5B4\uAC00 {language}\uB85C \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",snackbarEnabled:"\uC2A4\uB0B5\uBC14 \uC54C\uB9BC\uC774 \uD65C\uC131\uD654\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",snackbarDisabled:"\uC2A4\uB0B5\uBC14 \uC54C\uB9BC\uC774 \uBE44\uD65C\uC131\uD654\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",logoutSuccess:"\uB85C\uADF8\uC544\uC6C3\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",apiKeyRemoved:"API \uD0A4\uAC00 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",apiKeyFetchStart:"Google API \uD0A4\uB97C \uAC00\uC838\uC635\uB2C8\uB2E4..."}};var dr={nav:{home:"Home",tools:"Tools",files:"My Files",favorites:"Favorites",profile:"Profile"},settings:{title:"Settings",snackbar:"Snackbar Notifications",language:"Language",getApiKey:"Get API Key from Google",removeApiKey:"Remove API Key",login:"Login",logout:"Logout",privacy:"Privacy Policy",support:"Customer Support",version:"Version Info",loginRequired:"Login Required",loginDescription:"Please login to use the service",apiKeyLabel:"Gemini API Key",apiKeyMissing:"No API Key",apiKeyDescription:"You need to get an API key from Google to use AI features",googleLogin:"Google Login",localLogin:"Local Login",guest:"Guest",aiSettings:"AI Settings",aiAuthStatus:"AI Auth Status",authMethod:"Authentication Method",googleOAuth:"Google OAuth",geminiApiKey:"Gemini API Key",noAuth:"No Authentication",noAuthDesc:"Authentication is required to use AI features",googleAuthTitle:"Sign in with Google",googleAuthDesc:"Use AI features via Google OAuth",geminiInputTitle:"Enter Gemini API Key",geminiInputDesc:"Enter a key issued from Google AI Studio",testKeyTitle:"Use Test API Key",testKeyDesc:"Auto-set Gemini API key for development/testing",authModeSection:"Authentication Mode",useOAuthToken:"Use OAuth Token",oauthQuotaDesc:"Uses Google account quota",authManagement:"Auth Management",deleteAllAuth:"Delete All Authentication",active:"Active",inactive:"Not Set",apiKeyManagement:"API Key Management",googleAuthKey:"Google Auth Key",oauthUsing:"OAuth Token (Using: ",testDevUsing:"Test/Dev (Using: ",deleteApiKey:"Delete API Key",privacyTitle:"Privacy Policy",privacyIntro:"EzReader values your privacy and complies with applicable laws.",privacyCollect:"Information We Collect",privacyCollectContent:`- Email address during Google authentication
- App usage history and settings`,privacyPurpose:"Purpose of Use",privacyPurposeContent:`- Authentication for AI features
- Service improvement and user support`,privacyPeriod:"Retention Period",privacyPeriodContent:"- Until account deletion or as required by law",supportTitle:"Customer Support",supportInquiry:"Contact Us",supportDesc:"If you have any issues, please contact us below.",supportHours:"Business Hours: Mon-Fri 09:00 - 18:00",versionTitle:"Version Info",versionLabel:"Version",copyright:"\xA9 2024 EzReader. All rights reserved.",deviceInfo:"Device Info",manufacturer:"Manufacturer",model:"Model",screenSize:"Screen Size",status:"Status",nativePending:"Waiting for Native response (default)",notch:"Notch",hasNotch:"Yes",noNotch:"No",layoutAdjust:"Layout Adjustment",statusBarHeight:"Status Bar Height",navBarHeight:"Navigation Bar Height",applyLayout:"Apply Layout"},home:{search:"Search",pdfOpen:"Organize",pdfConvert:"Split",pdfMerge:"Merge",recentFiles:"Recent Files",noRecentFiles:"No recent files"},tools:{title:"Tools",aiFeatures:"AI Features",aiSummary:"AI Summary",aiTranslate:"AI Translate",aiAnalysis:"PDF Analysis",fromPdf:"Convert from PDF",pdfToImage:"PDF \u2192 Image",pdfToExcel:"PDF \u2192 Excel",pdfToWord:"PDF \u2192 Word",pdfToJpg:"PDF \u2192 JPG",toPdf:"Convert to PDF",imageToPdf:"Image \u2192 PDF",wordToPdf:"Word \u2192 PDF",excelToPdf:"Excel \u2192 PDF",pptToPdf:"PPT \u2192 PDF",pdfTools:"PDF Tools",documentTools:"Document Tools",merge:"Merge",split:"Split",rotate:"Rotate",organize:"Organize",pageNumber:"Page Number",watermark:"Watermark",security:"Security",encrypt:"Encrypt",decrypt:"Decrypt",create:"Create",edit:"Edit"},files:{title:"My Files",noFiles:"No saved files",uploadFirst:"Upload or create a PDF file",myFiles:"My Files",recentFiles:"Recent Files",favorites:"Favorites",results:"My Results"},sideMenu:{title:"More",loginPrompt:"Go to Login",myPoints:"My Points",points:"Points",myPage:"My Page",settings:"Settings"},common:{confirm:"Confirm",cancel:"Cancel",save:"Save",delete:"Delete",close:"Close",loading:"Loading...",error:"Error",success:"Success",preparing:"Coming soon",uploading:"Uploading...",processing:"Processing...",completed:"Completed",failed:"Failed"},snackbar:{languageChanged:"Language changed to {language}.",snackbarEnabled:"Snackbar notifications enabled.",snackbarDisabled:"Snackbar notifications disabled.",logoutSuccess:"Logged out successfully.",apiKeyRemoved:"API key removed.",apiKeyFetchStart:"Getting Google API key..."}};var pr={nav:{home:"\u4E3B\u9801",tools:"\u5DE5\u5177",files:"\u6211\u7684\u6A94\u6848",favorites:"\u6536\u85CF\u593E",profile:"\u6211\u7684\u8CC7\u8A0A"},settings:{title:"\u8A2D\u5B9A",snackbar:"\u63D0\u793A\u901A\u77E5",language:"\u8A9E\u8A00\u9078\u64C7",getApiKey:"\u5F9E Google \u7372\u53D6 API \u5BC6\u9470",removeApiKey:"\u522A\u9664 API \u5BC6\u9470",login:"\u767B\u5165",logout:"\u767B\u51FA",privacy:"\u96B1\u79C1\u653F\u7B56",support:"\u5BA2\u6236\u652F\u63F4",version:"\u7248\u672C\u8CC7\u8A0A",loginRequired:"\u9700\u8981\u767B\u5165",loginDescription:"\u8ACB\u767B\u5165\u4F7F\u7528\u670D\u52D9",apiKeyLabel:"Gemini API \u5BC6\u9470",apiKeyMissing:"\u6C92\u6709 API \u5BC6\u9470",apiKeyDescription:"\u8981\u4F7F\u7528 AI \u529F\u80FD\uFF0C\u9700\u8981\u5F9E Google \u7372\u53D6 API \u5BC6\u9470",googleLogin:"Google \u767B\u5165",localLogin:"\u672C\u5730\u767B\u5165",guest:"\u8A2A\u5BA2",aiSettings:"AI \u8A2D\u5B9A",aiAuthStatus:"AI \u8A8D\u8B49\u72C0\u614B",authMethod:"\u8A8D\u8B49\u65B9\u6CD5",googleOAuth:"Google OAuth",geminiApiKey:"Gemini API \u5BC6\u9470",noAuth:"\u672A\u8A8D\u8B49",noAuthDesc:"\u4F7F\u7528 AI \u529F\u80FD\u9700\u8981\u8A8D\u8B49",googleAuthTitle:"\u4F7F\u7528 Google \u5E33\u865F\u8A8D\u8B49",googleAuthDesc:"\u900F\u904E Google OAuth \u4F7F\u7528 AI \u529F\u80FD",geminiInputTitle:"\u76F4\u63A5\u8F38\u5165 Gemini API \u5BC6\u9470",geminiInputDesc:"\u8F38\u5165\u5F9E Google AI Studio \u7372\u5F97\u7684\u5BC6\u9470",testKeyTitle:"\u4F7F\u7528\u6E2C\u8A66 API \u5BC6\u9470",testKeyDesc:"\u81EA\u52D5\u8A2D\u5B9A\u958B\u767C/\u6E2C\u8A66\u7528 Gemini API \u5BC6\u9470",authModeSection:"\u4F7F\u7528\u7684\u8A8D\u8B49\u65B9\u5F0F",useOAuthToken:"\u4F7F\u7528 OAuth Token",oauthQuotaDesc:"\u4F7F\u7528 Google \u5E33\u865F\u914D\u984D",authManagement:"\u8A8D\u8B49\u8CC7\u8A0A\u7BA1\u7406",deleteAllAuth:"\u522A\u9664\u6240\u6709\u8A8D\u8B49\u8CC7\u8A0A",active:"\u555F\u7528",inactive:"\u672A\u8A2D\u5B9A",apiKeyManagement:"API \u5BC6\u9470\u7BA1\u7406",googleAuthKey:"Google \u8A8D\u8B49\u5BC6\u9470",oauthUsing:"OAuth Token\uFF08\u4F7F\u7528\u4E2D\uFF1A",testDevUsing:"\u6E2C\u8A66/\u958B\u767C\u7528\uFF08\u4F7F\u7528\u4E2D\uFF1A",deleteApiKey:"\u522A\u9664 API \u5BC6\u9470",privacyTitle:"\u96B1\u79C1\u653F\u7B56",privacyIntro:"EzReader \u91CD\u8996\u60A8\u7684\u500B\u4EBA\u8CC7\u8A0A\uFF0C\u4E26\u9075\u5B88\u76F8\u95DC\u6CD5\u5F8B\u6CD5\u898F\u3002",privacyCollect:"\u6536\u96C6\u7684\u500B\u4EBA\u8CC7\u8A0A",privacyCollectContent:`- Google \u5E33\u865F\u8A8D\u8B49\u6642\u7684\u96FB\u5B50\u90F5\u4EF6\u5730\u5740
- \u61C9\u7528\u7A0B\u5F0F\u4F7F\u7528\u8A18\u9304\u548C\u8A2D\u5B9A`,privacyPurpose:"\u500B\u4EBA\u8CC7\u8A0A\u4F7F\u7528\u76EE\u7684",privacyPurposeContent:`- AI \u529F\u80FD\u8A8D\u8B49
- \u670D\u52D9\u6539\u9032\u548C\u7528\u6236\u652F\u63F4`,privacyPeriod:"\u500B\u4EBA\u8CC7\u8A0A\u4FDD\u7559\u671F\u9593",privacyPeriodContent:"- \u76F4\u5230\u8A3B\u92B7\u5E33\u865F\u6216\u6CD5\u5F8B\u898F\u5B9A\u7684\u671F\u9593",supportTitle:"\u5BA2\u6236\u652F\u63F4",supportInquiry:"\u806F\u7E6B\u6211\u5011",supportDesc:"\u5982\u679C\u60A8\u5728\u4F7F\u7528\u670D\u52D9\u6642\u9047\u5230\u554F\u984C\uFF0C\u8ACB\u806F\u7E6B\u4EE5\u4E0B\u65B9\u5F0F\u3002",supportHours:"\u71DF\u696D\u6642\u9593\uFF1A\u9031\u4E00\u81F3\u9031\u4E94 09:00 - 18:00",versionTitle:"\u7248\u672C\u8CC7\u8A0A",versionLabel:"\u7248\u672C",copyright:"\xA9 2024 EzReader. All rights reserved.",deviceInfo:"\u8A2D\u5099\u8CC7\u8A0A",manufacturer:"\u88FD\u9020\u5546",model:"\u578B\u865F",screenSize:"\u87A2\u5E55\u5C3A\u5BF8",status:"\u72C0\u614B",nativePending:"\u7B49\u5F85 Native \u56DE\u61C9\uFF08\u9810\u8A2D\u503C\uFF09",notch:"\u700F\u6D77",hasNotch:"\u6709",noNotch:"\u7121",layoutAdjust:"\u4F48\u5C40\u8ABF\u6574",statusBarHeight:"\u72C0\u614B\u6B04\u9AD8\u5EA6",navBarHeight:"\u5C0E\u822A\u6B04\u9AD8\u5EA6",applyLayout:"\u5957\u7528\u4F48\u5C40"},home:{search:"\u641C\u5C0B",pdfOpen:"\u7D44\u7E54",pdfConvert:"\u5206\u5272",pdfMerge:"\u5408\u4F75",recentFiles:"\u6700\u8FD1\u67E5\u770B\u7684\u6A94\u6848",noRecentFiles:"\u6C92\u6709\u6700\u8FD1\u67E5\u770B\u7684\u6A94\u6848"},tools:{title:"\u5DE5\u5177",aiFeatures:"AI \u529F\u80FD",aiSummary:"AI \u6458\u8981",aiTranslate:"AI \u7FFB\u8B6F",aiAnalysis:"PDF \u5206\u6790",fromPdf:"\u5F9E PDF \u8F49\u63DB",pdfToImage:"PDF \u2192 \u5716\u7247",pdfToExcel:"PDF \u2192 Excel",pdfToWord:"PDF \u2192 Word",pdfToJpg:"PDF \u2192 JPG",toPdf:"\u8F49\u63DB\u70BA PDF",imageToPdf:"\u5716\u7247 \u2192 PDF",wordToPdf:"Word \u2192 PDF",excelToPdf:"Excel \u2192 PDF",pptToPdf:"PPT \u2192 PDF",pdfTools:"PDF \u5DE5\u5177",documentTools:"\u6587\u4EF6\u529F\u80FD",merge:"\u5408\u4F75",split:"\u5206\u5272",rotate:"\u65CB\u8F49",organize:"\u6574\u7406",pageNumber:"\u9801\u78BC",watermark:"\u6C34\u5370",security:"\u5B89\u5168",encrypt:"\u52A0\u5BC6",decrypt:"\u89E3\u5BC6",create:"\u5275\u5EFA",edit:"\u7DE8\u8F2F"},files:{title:"\u6211\u7684\u6A94\u6848",noFiles:"\u6C92\u6709\u5132\u5B58\u7684\u6A94\u6848",uploadFirst:"\u4E0A\u50B3\u6216\u5275\u5EFA PDF \u6A94\u6848",myFiles:"\u6A94\u6848",recentFiles:"\u6700\u8FD1\u67E5\u770B\u7684\u6A94\u6848",favorites:"\u6211\u7684\u6700\u611B",results:"\u6211\u7684\u4F5C\u696D\u6A94\u6848"},sideMenu:{title:"\u66F4\u591A",loginPrompt:"\u524D\u5F80\u767B\u5165",myPoints:"\u6211\u7684\u9EDE\u6578",points:"\u9EDE\u6578",myPage:"\u6211\u7684\u9801\u9762",settings:"\u8A2D\u5B9A"},common:{confirm:"\u78BA\u8A8D",cancel:"\u53D6\u6D88",save:"\u5132\u5B58",delete:"\u522A\u9664",close:"\u95DC\u9589",loading:"\u8F09\u5165\u4E2D...",error:"\u932F\u8AA4",success:"\u6210\u529F",preparing:"\u6E96\u5099\u4E2D",uploading:"\u4E0A\u50B3\u4E2D...",processing:"\u8655\u7406\u4E2D...",completed:"\u5B8C\u6210",failed:"\u5931\u6557"},snackbar:{languageChanged:"\u8A9E\u8A00\u5DF2\u66F4\u6539\u70BA {language}\u3002",snackbarEnabled:"\u63D0\u793A\u901A\u77E5\u5DF2\u555F\u7528\u3002",snackbarDisabled:"\u63D0\u793A\u901A\u77E5\u5DF2\u7981\u7528\u3002",logoutSuccess:"\u5DF2\u6210\u529F\u767B\u51FA\u3002",apiKeyRemoved:"API \u5BC6\u9470\u5DF2\u522A\u9664\u3002",apiKeyFetchStart:"\u6B63\u5728\u7372\u53D6 Google API \u5BC6\u9470..."}};var gr={nav:{home:"\u30DB\u30FC\u30E0",tools:"\u30C4\u30FC\u30EB",files:"\u30DE\u30A4\u30D5\u30A1\u30A4\u30EB",favorites:"\u304A\u6C17\u306B\u5165\u308A",profile:"\u30DE\u30A4\u30DA\u30FC\u30B8"},settings:{title:"\u8A2D\u5B9A",snackbar:"\u901A\u77E5",language:"\u8A00\u8A9E\u9078\u629E",getApiKey:"Google \u304B\u3089 API \u30AD\u30FC\u3092\u53D6\u5F97",removeApiKey:"API \u30AD\u30FC\u3092\u524A\u9664",login:"\u30ED\u30B0\u30A4\u30F3",logout:"\u30ED\u30B0\u30A2\u30A6\u30C8",privacy:"\u30D7\u30E9\u30A4\u30D0\u30B7\u30FC\u30DD\u30EA\u30B7\u30FC",support:"\u30AB\u30B9\u30BF\u30DE\u30FC\u30B5\u30DD\u30FC\u30C8",version:"\u30D0\u30FC\u30B8\u30E7\u30F3\u60C5\u5831",loginRequired:"\u30ED\u30B0\u30A4\u30F3\u304C\u5FC5\u8981\u3067\u3059",loginDescription:"\u30B5\u30FC\u30D3\u30B9\u3092\u5229\u7528\u3059\u308B\u306B\u306F\u30ED\u30B0\u30A4\u30F3\u3057\u3066\u304F\u3060\u3055\u3044",apiKeyLabel:"Gemini API \u30AD\u30FC",apiKeyMissing:"API \u30AD\u30FC\u304C\u3042\u308A\u307E\u305B\u3093",apiKeyDescription:"AI \u6A5F\u80FD\u3092\u4F7F\u7528\u3059\u308B\u306B\u306F\u3001Google \u304B\u3089 API \u30AD\u30FC\u3092\u53D6\u5F97\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059",googleLogin:"Google \u30ED\u30B0\u30A4\u30F3",localLogin:"\u30ED\u30FC\u30AB\u30EB\u30ED\u30B0\u30A4\u30F3",guest:"\u30B2\u30B9\u30C8",aiSettings:"AI \u8A2D\u5B9A",aiAuthStatus:"AI \u8A8D\u8A3C\u72B6\u614B",authMethod:"\u8A8D\u8A3C\u65B9\u6CD5",googleOAuth:"Google OAuth",geminiApiKey:"Gemini API \u30AD\u30FC",noAuth:"\u8A8D\u8A3C\u306A\u3057",noAuthDesc:"AI \u6A5F\u80FD\u3092\u4F7F\u7528\u3059\u308B\u306B\u306F\u8A8D\u8A3C\u304C\u5FC5\u8981\u3067\u3059",googleAuthTitle:"Google \u30A2\u30AB\u30A6\u30F3\u30C8\u3067\u8A8D\u8A3C",googleAuthDesc:"Google OAuth \u3067 AI \u6A5F\u80FD\u3092\u4F7F\u7528",geminiInputTitle:"Gemini API \u30AD\u30FC\u3092\u76F4\u63A5\u5165\u529B",geminiInputDesc:"Google AI Studio \u3067\u767A\u884C\u3055\u308C\u305F\u30AD\u30FC\u3092\u5165\u529B",testKeyTitle:"\u30C6\u30B9\u30C8 API \u30AD\u30FC\u3092\u4F7F\u7528",testKeyDesc:"\u958B\u767A\u30FB\u30C6\u30B9\u30C8\u7528 Gemini API \u30AD\u30FC\u3092\u81EA\u52D5\u8A2D\u5B9A",authModeSection:"\u4F7F\u7528\u3059\u308B\u8A8D\u8A3C\u65B9\u5F0F",useOAuthToken:"OAuth \u30C8\u30FC\u30AF\u30F3\u3092\u4F7F\u7528",oauthQuotaDesc:"Google \u30A2\u30AB\u30A6\u30F3\u30C8\u306E\u30AF\u30A9\u30FC\u30BF\u3092\u4F7F\u7528",authManagement:"\u8A8D\u8A3C\u60C5\u5831\u306E\u7BA1\u7406",deleteAllAuth:"\u3059\u3079\u3066\u306E\u8A8D\u8A3C\u60C5\u5831\u3092\u524A\u9664",active:"\u6709\u52B9",inactive:"\u672A\u8A2D\u5B9A",apiKeyManagement:"API \u30AD\u30FC\u7BA1\u7406",googleAuthKey:"Google \u8A8D\u8A3C\u30AD\u30FC",oauthUsing:"OAuth \u30C8\u30FC\u30AF\u30F3\uFF08\u4F7F\u7528\u4E2D\uFF1A",testDevUsing:"\u30C6\u30B9\u30C8/\u958B\u767A\u7528\uFF08\u4F7F\u7528\u4E2D\uFF1A",deleteApiKey:"API \u30AD\u30FC\u3092\u524A\u9664",privacyTitle:"\u30D7\u30E9\u30A4\u30D0\u30B7\u30FC\u30DD\u30EA\u30B7\u30FC",privacyIntro:"EzReader \u306F\u30E6\u30FC\u30B6\u30FC\u306E\u500B\u4EBA\u60C5\u5831\u3092\u5927\u5207\u306B\u3057\u3001\u95A2\u9023\u6CD5\u4EE4\u3092\u9075\u5B88\u3057\u307E\u3059\u3002",privacyCollect:"\u53CE\u96C6\u3059\u308B\u500B\u4EBA\u60C5\u5831",privacyCollectContent:`- Google \u30A2\u30AB\u30A6\u30F3\u30C8\u8A8D\u8A3C\u6642\u306E\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9
- \u30A2\u30D7\u30EA\u4F7F\u7528\u5C65\u6B74\u3068\u8A2D\u5B9A`,privacyPurpose:"\u500B\u4EBA\u60C5\u5831\u306E\u5229\u7528\u76EE\u7684",privacyPurposeContent:`- AI \u6A5F\u80FD\u63D0\u4F9B\u306E\u305F\u3081\u306E\u8A8D\u8A3C
- \u30B5\u30FC\u30D3\u30B9\u6539\u5584\u3068\u30E6\u30FC\u30B6\u30FC\u30B5\u30DD\u30FC\u30C8`,privacyPeriod:"\u500B\u4EBA\u60C5\u5831\u306E\u4FDD\u6301\u671F\u9593",privacyPeriodContent:"- \u9000\u4F1A\u6642\u307E\u3067\u3001\u307E\u305F\u306F\u6CD5\u4EE4\u3067\u5B9A\u3081\u3089\u308C\u305F\u671F\u9593",supportTitle:"\u30AB\u30B9\u30BF\u30DE\u30FC\u30B5\u30DD\u30FC\u30C8",supportInquiry:"\u304A\u554F\u3044\u5408\u308F\u305B",supportDesc:"\u30B5\u30FC\u30D3\u30B9\u5229\u7528\u4E2D\u306B\u554F\u984C\u304C\u3054\u3056\u3044\u307E\u3057\u305F\u3089\u3001\u4E0B\u8A18\u307E\u3067\u3054\u9023\u7D61\u304F\u3060\u3055\u3044\u3002",supportHours:"\u55B6\u696D\u6642\u9593\uFF1A\u5E73\u65E5 09:00 \uFF5E 18:00",versionTitle:"\u30D0\u30FC\u30B8\u30E7\u30F3\u60C5\u5831",versionLabel:"\u30D0\u30FC\u30B8\u30E7\u30F3",copyright:"\xA9 2024 EzReader. All rights reserved.",deviceInfo:"\u30C7\u30D0\u30A4\u30B9\u60C5\u5831",manufacturer:"\u30E1\u30FC\u30AB\u30FC",model:"\u30E2\u30C7\u30EB\u540D",screenSize:"\u753B\u9762\u30B5\u30A4\u30BA",status:"\u30B9\u30C6\u30FC\u30BF\u30B9",nativePending:"Native \u5FDC\u7B54\u5F85\u6A5F\u4E2D\uFF08\u30C7\u30D5\u30A9\u30EB\u30C8\uFF09",notch:"\u30CE\u30C3\u30C1",hasNotch:"\u3042\u308A",noNotch:"\u306A\u3057",layoutAdjust:"\u30EC\u30A4\u30A2\u30A6\u30C8\u8ABF\u6574",statusBarHeight:"\u30B9\u30C6\u30FC\u30BF\u30B9\u30D0\u30FC\u306E\u9AD8\u3055",navBarHeight:"\u30CA\u30D3\u30B2\u30FC\u30B7\u30E7\u30F3\u30D0\u30FC\u306E\u9AD8\u3055",applyLayout:"\u30EC\u30A4\u30A2\u30A6\u30C8\u3092\u9069\u7528"},home:{search:"\u691C\u7D22",pdfOpen:"\u69CB\u6210",pdfConvert:"\u5206\u5272",pdfMerge:"\u7D50\u5408",recentFiles:"\u6700\u8FD1\u958B\u3044\u305F\u30D5\u30A1\u30A4\u30EB",noRecentFiles:"\u6700\u8FD1\u958B\u3044\u305F\u30D5\u30A1\u30A4\u30EB\u304C\u3042\u308A\u307E\u305B\u3093"},tools:{title:"\u30C4\u30FC\u30EB",aiFeatures:"AI \u6A5F\u80FD",aiSummary:"AI \u8981\u7D04",aiTranslate:"AI \u7FFB\u8A33",aiAnalysis:"PDF \u5206\u6790",fromPdf:"PDF \u304B\u3089\u5909\u63DB",pdfToImage:"PDF \u2192 \u753B\u50CF",pdfToExcel:"PDF \u2192 Excel",pdfToWord:"PDF \u2192 Word",pdfToJpg:"PDF \u2192 JPG",toPdf:"PDF \u306B\u5909\u63DB",imageToPdf:"\u753B\u50CF \u2192 PDF",wordToPdf:"Word \u2192 PDF",excelToPdf:"Excel \u2192 PDF",pptToPdf:"PPT \u2192 PDF",pdfTools:"PDF \u30C4\u30FC\u30EB",documentTools:"\u6587\u66F8\u6A5F\u80FD",merge:"\u7D50\u5408",split:"\u5206\u5272",rotate:"\u56DE\u8EE2",organize:"\u6574\u7406",pageNumber:"\u30DA\u30FC\u30B8\u756A\u53F7",watermark:"\u900F\u304B\u3057",security:"\u30BB\u30AD\u30E5\u30EA\u30C6\u30A3",encrypt:"\u6697\u53F7\u5316",decrypt:"\u5FA9\u53F7\u5316",create:"\u4F5C\u6210",edit:"\u7DE8\u96C6"},files:{title:"\u30DE\u30A4\u30D5\u30A1\u30A4\u30EB",noFiles:"\u4FDD\u5B58\u3055\u308C\u305F\u30D5\u30A1\u30A4\u30EB\u304C\u3042\u308A\u307E\u305B\u3093",uploadFirst:"PDF \u30D5\u30A1\u30A4\u30EB\u3092\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u307E\u305F\u306F\u4F5C\u6210\u3057\u3066\u304F\u3060\u3055\u3044",myFiles:"\u30DE\u30A4\u30D5\u30A1\u30A4\u30EB",recentFiles:"\u6700\u8FD1\u958B\u3044\u305F\u30D5\u30A1\u30A4\u30EB",favorites:"\u304A\u6C17\u306B\u5165\u308A",results:"\u30DE\u30A4\u7D50\u679C"},sideMenu:{title:"\u3082\u3063\u3068\u898B\u308B",loginPrompt:"\u30ED\u30B0\u30A4\u30F3\u3059\u308B",myPoints:"\u30DE\u30A4\u30DD\u30A4\u30F3\u30C8",points:"\u30DD\u30A4\u30F3\u30C8",myPage:"\u30DE\u30A4\u30DA\u30FC\u30B8",settings:"\u8A2D\u5B9A"},common:{confirm:"\u78BA\u8A8D",cancel:"\u30AD\u30E3\u30F3\u30BB\u30EB",save:"\u4FDD\u5B58",delete:"\u524A\u9664",close:"\u9589\u3058\u308B",loading:"\u8AAD\u307F\u8FBC\u307F\u4E2D...",error:"\u30A8\u30E9\u30FC",success:"\u6210\u529F",preparing:"\u6E96\u5099\u4E2D",uploading:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u4E2D...",processing:"\u51E6\u7406\u4E2D...",completed:"\u5B8C\u4E86",failed:"\u5931\u6557"},snackbar:{languageChanged:"\u8A00\u8A9E\u304C {language} \u306B\u5909\u66F4\u3055\u308C\u307E\u3057\u305F\u3002",snackbarEnabled:"\u901A\u77E5\u304C\u6709\u52B9\u306B\u306A\u308A\u307E\u3057\u305F\u3002",snackbarDisabled:"\u901A\u77E5\u304C\u7121\u52B9\u306B\u306A\u308A\u307E\u3057\u305F\u3002",logoutSuccess:"\u30ED\u30B0\u30A2\u30A6\u30C8\u3057\u307E\u3057\u305F\u3002",apiKeyRemoved:"API \u30AD\u30FC\u304C\u524A\u9664\u3055\u308C\u307E\u3057\u305F\u3002",apiKeyFetchStart:"Google API \u30AD\u30FC\u3092\u53D6\u5F97\u3057\u3066\u3044\u307E\u3059..."}};var Mt=class r{STORAGE_KEY="ezm_user_preferences";DEFAULT_PREFERENCES={showSnackbar:!0,language:"ko"};preferencesSubject;preferences$;constructor(){let t=this.loadPreferences();this.preferencesSubject=new de(t),this.preferences$=this.preferencesSubject.asObservable()}loadPreferences(){try{let t=localStorage.getItem(this.STORAGE_KEY);if(t){let e=JSON.parse(t);return K(K({},this.DEFAULT_PREFERENCES),e)}}catch{}return K({},this.DEFAULT_PREFERENCES)}savePreferences(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t)),this.preferencesSubject.next(t)}catch{}}getPreferences(){return this.preferencesSubject.value}getShowSnackbar(){return this.preferencesSubject.value.showSnackbar}setShowSnackbar(t){let e=this.getPreferences(),n=Z(K({},e),{showSnackbar:t});this.savePreferences(n)}getLanguage(){return this.preferencesSubject.value.language}setLanguage(t){let e=this.getPreferences(),n=Z(K({},e),{language:t});this.savePreferences(n)}updatePreferences(t){let e=this.getPreferences(),n=K(K({},e),t);this.savePreferences(n)}resetPreferences(){this.savePreferences(K({},this.DEFAULT_PREFERENCES))}getAndroidLayout(){let t=this.getPreferences();return{statusBarHeight:t.androidStatusBarHeight||0,navigationBarHeight:t.androidNavigationBarHeight||0}}setAndroidLayout(t,e){let n=this.getPreferences(),i=Z(K({},n),{androidStatusBarHeight:t,androidNavigationBarHeight:e});this.savePreferences(i)}applyAndroidLayoutToDOM(){let t=this.getAndroidLayout();if(console.log("=".repeat(80)),console.log("\u{1F3A8} [Layout] applyAndroidLayoutToDOM() \uD638\uCD9C\uB428"),console.log("\u{1F4E6} [Layout] localStorage\uC5D0\uC11C \uC77D\uC740 \uAC12:",t),console.log("\u{1F4E6} [Layout] statusBarHeight:",t.statusBarHeight,"px"),console.log("\u{1F4E6} [Layout] navigationBarHeight:",t.navigationBarHeight,"px"),t.statusBarHeight===void 0&&t.navigationBarHeight===void 0){console.log("\u2139\uFE0F [Layout] \uC800\uC7A5\uB41C \uB808\uC774\uC544\uC6C3 \uAC12\uC774 \uC5C6\uC74C. \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4 \uC218\uC2E0 \uB300\uAE30 \uC911..."),console.log("=".repeat(80));return}console.log("\u2705 [Layout] CSS \uBCC0\uC218 \uC801\uC6A9 \uC2DC\uC791"),document.documentElement.style.setProperty("--android-status-bar-height",`${t.statusBarHeight}px`),document.documentElement.style.setProperty("--android-navigation-bar-height",`${t.navigationBarHeight}px`),document.documentElement.style.setProperty("--safe-area-top",`${t.statusBarHeight}px`),document.documentElement.style.setProperty("--safe-area-bottom",`${t.navigationBarHeight}px`),document.documentElement.style.setProperty("--status-bar-height",`${t.statusBarHeight}px`),document.documentElement.style.setProperty("--navigation-bar-height",`${t.navigationBarHeight}px`),console.log("\u2705 [Layout] CSS \uBCC0\uC218 \uC801\uC6A9 \uC644\uB8CC"),console.log("=".repeat(80))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var nt=class r{constructor(t){this.preferencesService=t;let e=this.preferencesService.getLanguage();this.currentLang$.next(e),this.preferencesService.preferences$.subscribe(n=>{n.language!==this.currentLang$.value&&this.currentLang$.next(n.language)})}currentLang$=new de("ko");translations={ko:cr,en:dr,zh:pr,ja:gr};translate(t,e){let n=this.currentLang$.value,i=t.split("."),s=this.translations[n];for(let d of i)if(s=s?.[d],s==null)return console.warn(`[EzmI18n] Translation key not found: ${t}`),t;return typeof s!="string"?(console.warn(`[EzmI18n] Translation value is not a string: ${t}`),t):e?this.interpolate(s,e):s}interpolate(t,e){return t.replace(/\{(\w+)\}/g,(n,i)=>e[i]!==void 0?String(e[i]):n)}get currentLanguage$(){return this.currentLang$.asObservable()}getCurrentLanguage(){return this.currentLang$.value}setLanguage(t){this.preferencesService.setLanguage(t)}translateTo(t,e,n){let i=t.split("."),s=this.translations[e];for(let d of i)if(s=s?.[d],s==null)return t;return typeof s!="string"?t:n?this.interpolate(s,n):s}static \u0275fac=function(e){return new(e||r)(X(Mt))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var yt=class r{constructor(t){this.i18n=t;this.langSubscription=this.i18n.currentLanguage$.subscribe(e=>{this.currentLang=e,this.lastKey="",this.lastValue=""})}lastKey="";lastValue="";lastParams;langSubscription;currentLang="";transform(t,e){return t===this.lastKey&&this.paramsEqual(e,this.lastParams)?this.lastValue:(this.lastKey=t,this.lastParams=e,this.lastValue=this.i18n.translate(t,e),this.lastValue)}paramsEqual(t,e){if(t===e)return!0;if(!t||!e)return!1;let n=Object.keys(t),i=Object.keys(e);return n.length!==i.length?!1:n.every(s=>t[s]===e[s])}ngOnDestroy(){this.langSubscription&&this.langSubscription.unsubscribe()}static \u0275fac=function(e){return new(e||r)(V(nt,16))};static \u0275pipe=io({name:"translate",type:r,pure:!1})};var it=class r{constructor(t,e){this.router=t;this.toolActionService=e}activeTab="home";androidBridge=P(Ae);navigateTo(t){ye()&&this.androidBridge.closeWebView(`bottom-nav-${t}`),this.toolActionService.clearPendingAction();let n={home:"/ezm/home",tools:"/ezm/tools",favorites:"/ezm/myfiles/favorites",profile:"/ezm/profile"}[t];n&&this.router.navigate([n]).catch(()=>{})}static \u0275fac=function(e){return new(e||r)(V(N),V(le))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-bottom-nav"]],inputs:{activeTab:"activeTab"},standalone:!1,decls:21,vars:24,consts:[[1,"bottom-nav"],[1,"nav-item",3,"click"],["alt","\uD648","width","24","height","24",1,"nav-icon",3,"src"],["alt","\uB3C4\uAD6C","width","24","height","24",1,"nav-icon",3,"src"],["alt","\uC990\uACA8\uCC3E\uAE30","width","24","height","24",1,"nav-icon",3,"src"],["alt","\uB0B4\uC815\uBCF4","width","24","height","24",1,"nav-icon",3,"src"]],template:function(e,n){e&1&&(o(0,"nav",0)(1,"button",1),u("click",function(){return n.navigateTo("home")}),h(2,"img",2),o(3,"span"),c(4),L(5,"translate"),a()(),o(6,"button",1),u("click",function(){return n.navigateTo("tools")}),h(7,"img",3),o(8,"span"),c(9),L(10,"translate"),a()(),o(11,"button",1),u("click",function(){return n.navigateTo("favorites")}),h(12,"img",4),o(13,"span"),c(14),L(15,"translate"),a()(),o(16,"button",1),u("click",function(){return n.navigateTo("profile")}),h(17,"img",5),o(18,"span"),c(19),L(20,"translate"),a()()()),e&2&&(l(),k("active",n.activeTab==="home"),l(),p("src",n.activeTab==="home"?"images/icons/gnb-home-on.svg":"images/icons/gnb-home.svg",ce),l(2),x(J(5,16,"nav.home")),l(2),k("active",n.activeTab==="tools"),l(),p("src",n.activeTab==="tools"?"images/icons/gnb-tool-on.svg":"images/icons/gnb-tool.svg",ce),l(2),x(J(10,18,"nav.tools")),l(2),k("active",n.activeTab==="favorites"),l(),p("src",n.activeTab==="favorites"?"images/icons/gnb-bookmark-on.svg":"images/icons/gnb-bookmark.svg",ce),l(2),x(J(15,20,"nav.favorites")),l(2),k("active",n.activeTab==="profile"),l(),p("src",n.activeTab==="profile"?"images/icons/gnb-myinfo-on.svg":"images/icons/gnb-myinfo.svg",ce),l(2),x(J(20,22,"nav.profile")))},dependencies:[yt],styles:[".bottom-nav[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;height:calc(72px + var(--android-navigation-bar-height, 0px));padding-bottom:var(--android-navigation-bar-height, 0px);background:#fff;border-radius:20px 20px 0 0;border:none;display:flex;align-items:flex-start;padding-top:10px;justify-content:space-around;z-index:1002;box-shadow:0 -4px 20px #0000001a;box-sizing:border-box}.nav-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px;background:none;border:none;color:#555;cursor:pointer;padding:8px 16px 12px;transition:all .2s;flex:1}.nav-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#555;transition:stroke .2s;flex-shrink:0}.nav-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:11px;font-weight:500;color:#555;transition:color .2s}.nav-item.active[_ngcontent-%COMP%]{color:#e53935}.nav-item.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#e53935}.nav-item.active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#e53935}.nav-item[_ngcontent-%COMP%]:active{background:#f5f5f5}"]})};var Jt=class r{STORAGE_KEY="ez_reader_point_sync_logs";MAX_LOGS=100;logsSubject=new de([]);logs$=this.logsSubject.asObservable();syncStatusSubject=new de({lastSyncAt:null,localPoints:0,serverPoints:null,syncState:"pending",needsSync:!0,difference:0});syncStatus$=this.syncStatusSubject.asObservable();constructor(){this.loadLogs()}addLog(t,e,n,i){let s={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),source:t,action:e,message:n,previousValue:i?.previousValue,newValue:i?.newValue,delta:i?.delta,documentInfo:i?.documentInfo,apiResponse:i?.apiResponse,metadata:i?.metadata,success:i?.success??!0},d=this.logsSubject.value,_=[s,...d].slice(0,this.MAX_LOGS);this.logsSubject.next(_),this.saveLogs(_);let v=s.success?"\u2705":"\u274C";return console.log(`${v} [\uD3EC\uC778\uD2B8 \uB85C\uADF8] [${t}] ${e}: ${n}`,{previous:i?.previousValue,new:i?.newValue,delta:i?.delta}),s}logViewerRead(t,e,n,i,s){let d=s-i;return this.addLog("viewer","read",`PDF \uC77D\uAE30: ${t} (${e}/${n}\uD398\uC774\uC9C0)`,{previousValue:i,newValue:s,delta:d,documentInfo:{name:t,page:e,totalPages:n},success:d>0})}logApiFetch(t,e,n){return t?this.addLog("api","fetch",`\uC11C\uBC84 \uD3EC\uC778\uD2B8 \uC870\uD68C: ${e?.toLocaleString()}P`,{newValue:e,apiResponse:{success:!0,endpoint:"/v1/points/balance"},success:!0}):this.addLog("api","error",`\uD3EC\uC778\uD2B8 \uC870\uD68C \uC2E4\uD328: ${n}`,{apiResponse:{success:!1,endpoint:"/v1/points/balance",errorMessage:n},success:!1})}logApiEarn(t,e,n,i){return this.addLog("api","earn",`\uD3EC\uC778\uD2B8 \uD68D\uB4DD: +${t}P (${n})`,{previousValue:i,newValue:e,delta:t,apiResponse:{success:!0,endpoint:"/v1/points/earn"},metadata:{earnType:n},success:!0})}logApiUse(t,e,n,i){return this.addLog("api","use",`\uD3EC\uC778\uD2B8 \uC0AC\uC6A9: -${t}P (${n})`,{previousValue:i,newValue:e,delta:-t,apiResponse:{success:!0,endpoint:"/v1/points/use"},metadata:{useType:n},success:!0})}logLocalInit(t,e){return this.addLog("local","init",`\uB85C\uCEEC \uD3EC\uC778\uD2B8 \uCD08\uAE30\uD654: ${t.toLocaleString()}P (\uC624\uB298 ${e}P)`,{newValue:t,metadata:{todayPoints:e},success:!0})}logLocalAdd(t,e,n,i){let s=e-t,d=i-n;return this.addLog("local","earn",`\uB85C\uCEEC \uD3EC\uC778\uD2B8 \uCD94\uAC00: +${s}P (\uC624\uB298 ${n}/${i}, \uB0A8\uC740 ${d}P)`,{previousValue:t,newValue:e,delta:s,metadata:{todayPoints:n,maxDaily:i,remaining:d},success:!0})}logSync(t,e,n,i){let s=t-e;return this.addLog("api","sync",i||`\uB3D9\uAE30\uD654: \uB85C\uCEEC ${t}P vs \uC11C\uBC84 ${e}P (\uCC28\uC774: ${s>0?"+":""}${s}P)`,{previousValue:t,newValue:e,delta:s,metadata:{syncResult:n},success:n==="success"})}logAndroidPoints(t,e,n){return this.addLog("android",t,n||`Android: ${t} ${e}P`,{newValue:e,success:!0})}getLogs(){return this.logsSubject.value}getFilteredLogs(t){let e=this.logsSubject.value;if(t.source&&(e=e.filter(n=>n.source===t.source)),t.action&&(e=e.filter(n=>n.action===t.action)),t.success!==void 0&&(e=e.filter(n=>n.success===t.success)),t.startDate){let n=new Date(t.startDate).getTime();e=e.filter(i=>new Date(i.timestamp).getTime()>=n)}if(t.endDate){let n=new Date(t.endDate).getTime();e=e.filter(i=>new Date(i.timestamp).getTime()<=n)}return t.limit&&(e=e.slice(0,t.limit)),e}getTodayLogs(){let t=new Date;return t.setHours(0,0,0,0),this.getFilteredLogs({startDate:t.toISOString()})}getLogsBySource(t){return this.getFilteredLogs({source:t})}getErrorLogs(){return this.getFilteredLogs({success:!1})}updateSyncStatus(t,e,n){let i=e!==null?t-e:0,s=e!==null&&i!==0,d={lastSyncAt:new Date().toISOString(),localPoints:t,serverPoints:e,syncState:n||(s?"pending":"synced"),needsSync:s,difference:i};this.syncStatusSubject.next(d),console.log("\u{1F4CA} [\uD3EC\uC778\uD2B8 \uB3D9\uAE30\uD654 \uC0C1\uD0DC]",d)}getSyncStatus(){return this.syncStatusSubject.value}getStats(){let t=this.logsSubject.value,e=this.getTodayLogs(),n={api:0,viewer:0,local:0,android:0},i={init:0,read:0,fetch:0,earn:0,use:0,sync:0,reset:0,error:0},s=0,d=0,_=0;return t.forEach(v=>{n[v.source]=(n[v.source]||0)+1,i[v.action]=(i[v.action]||0)+1,v.success||_++,v.delta&&(v.delta>0?s+=v.delta:d+=Math.abs(v.delta))}),{totalLogs:t.length,todayLogs:e.length,errorCount:_,bySource:n,byAction:i,totalEarned:s,totalUsed:d}}clearLogs(){this.logsSubject.next([]),localStorage.removeItem(this.STORAGE_KEY),console.log("\u{1F5D1}\uFE0F [\uD3EC\uC778\uD2B8 \uB85C\uADF8] \uBAA8\uB4E0 \uB85C\uADF8 \uC0AD\uC81C\uB428"),this.addLog("local","reset","\uB85C\uADF8 \uCD08\uAE30\uD654")}loadLogs(){try{let t=localStorage.getItem(this.STORAGE_KEY);if(t){let e=JSON.parse(t);this.logsSubject.next(e),console.log(`\u{1F4CA} [\uD3EC\uC778\uD2B8 \uB85C\uADF8] ${e.length}\uAC1C \uB85C\uADF8 \uB85C\uB4DC\uB428`)}}catch(t){console.error("\u274C [\uD3EC\uC778\uD2B8 \uB85C\uADF8] \uB85C\uB4DC \uC2E4\uD328:",t),this.logsSubject.next([])}}saveLogs(t){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(e){console.error("\u274C [\uD3EC\uC778\uD2B8 \uB85C\uADF8] \uC800\uC7A5 \uC2E4\uD328:",e)}}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var ot="https://dev-api.ezlab.im";var Ft={AUTH:{LOGIN:"/auth/login",REFRESH:"/auth/refresh",LOGOUT:"/auth/logout",USER_INFO:"/auth/user-info"},POINTS:{BALANCE_GUEST:"/v1/points/balance/guest",BALANCE:"/v1/points/balance",HISTORY:"/v1/points/history",EARN:"/v1/points/earn",USE:"/v1/points/use"},USER:{PROFILE:"/v1/users/profile",SETTINGS:"/v1/users/settings",REFERRAL:"/v1/users/referral"},DOCUMENT:{LIST:"/v1/documents",UPLOAD:"/v1/documents/upload",DOWNLOAD:"/v1/documents/download"}},Gn="ezm-mobile-app",Yn="1.0.0",wt={BACKEND_TOKENS:"ezm_backend_tokens",DEVICE_ID:"ezm_device_id"},mr=60,Li=3e4;var fr=1e3,Re=!Ye.production;var rt=class r{cachedDeviceInfo=null;constructor(){}getBaseUrl(){return ot}buildUrl(t){if(t.startsWith("http://")||t.startsWith("https://"))return t;let e=t.startsWith("/")?t:`/${t}`;return`${ot}${e}`}getClientId(){return Gn}getClientVersion(){return Yn}getDeviceInfo(){if(this.cachedDeviceInfo)return this.cachedDeviceInfo;let t=navigator.userAgent.toLowerCase();return t.includes("android")?(this.cachedDeviceInfo={os:"ANDROID",platform:"MOBILE",deviceType:"MOBILE_ANDROID"},this.cachedDeviceInfo):t.includes("iphone")||t.includes("ipad")?(this.cachedDeviceInfo={os:"IOS",platform:"MOBILE",deviceType:"MOBILE_IOS"},this.cachedDeviceInfo):t.includes("mac")?(this.cachedDeviceInfo={os:"MACOS",platform:"DESKTOP",deviceType:"DESKTOP_MAC"},this.cachedDeviceInfo):t.includes("win")?(this.cachedDeviceInfo={os:"WINDOWS",platform:"DESKTOP",deviceType:"DESKTOP_WINDOWS"},this.cachedDeviceInfo):(this.cachedDeviceInfo={os:"LINUX",platform:"WEB",deviceType:"WEB"},this.cachedDeviceInfo)}getDeviceId(){let t=localStorage.getItem(wt.DEVICE_ID);return t||(t=this.generateDeviceId(),localStorage.setItem(wt.DEVICE_ID,t),this.log("\uC0C8 \uB514\uBC14\uC774\uC2A4 ID \uC0DD\uC131",t)),t}generateDeviceId(){return`ezm-${Date.now()}-${Math.random().toString(36).substring(2,11)}`}getCommonHeaders(){let t=this.getDeviceInfo(),e=this.getDeviceId();return{"Content-Type":"application/json","X-Client-Id":Gn,"X-Client-OS":t.os,"X-Platform":t.platform,"X-Client-Version":Yn,"X-Device-Id":e}}getCommonHeadersAsRecord(){let t=this.getCommonHeaders(),e={};return Object.entries(t).forEach(([n,i])=>{i!==void 0&&(e[n]=i)}),e}isAndroidWebView(){return typeof window.sendToAndroid=="function"}isIOSWebView(){return typeof window.webkit?.messageHandlers?.iosHandler<"u"}isNativeApp(){return this.isAndroidWebView()||this.isIOSWebView()}log(t,e){Re&&console.log(`\u2699\uFE0F [ApiConfigService] ${t}`,e||"")}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var at=class r{tokenStatusSubject=new de(this.getInitialStatus());tokenStatus$=this.tokenStatusSubject.asObservable();constructor(){this.initializeFromStorage(),this.startExpirationCheck()}getInitialStatus(){return{isAuthenticated:!1,isAccessTokenExpired:!0,isRefreshTokenExpired:!0,needsRefresh:!1,accessTokenRemainingSeconds:0,refreshTokenRemainingSeconds:0}}initializeFromStorage(){this.getStoredTokens()&&(this.updateTokenStatus(),this.log("\uD1A0\uD070 \uC11C\uBE44\uC2A4 \uCD08\uAE30\uD654 \uC644\uB8CC",this.tokenStatusSubject.value))}startExpirationCheck(){setInterval(()=>{this.updateTokenStatus()},6e4)}saveTokens(t,e,n,i,s){let d={accessToken:t,refreshToken:e,accessExpiresAt:n,refreshExpiresAt:i,loginType:s,savedAt:Date.now()};localStorage.setItem(wt.BACKEND_TOKENS,JSON.stringify(d)),this.updateTokenStatus(),this.log("\uD1A0\uD070 \uC800\uC7A5 \uC644\uB8CC",{loginType:s,accessExpiresAt:n,refreshExpiresAt:i})}getStoredTokens(){try{let t=localStorage.getItem(wt.BACKEND_TOKENS);return t?JSON.parse(t):null}catch(t){return this.log("\uD1A0\uD070 \uD30C\uC2F1 \uC2E4\uD328",t,"error"),null}}getAccessToken(){let t=this.getStoredTokens();return!t||this.isExpired(t.accessExpiresAt)?null:t.accessToken}getRefreshToken(){let t=this.getStoredTokens();return!t||this.isExpired(t.refreshExpiresAt)?null:t.refreshToken}clearTokens(){localStorage.removeItem(wt.BACKEND_TOKENS),this.tokenStatusSubject.next(this.getInitialStatus()),this.log("\uD1A0\uD070 \uC0AD\uC81C \uC644\uB8CC")}parseExpiresAt(t){if(!t||t.length!==14)return null;try{let e=parseInt(t.substring(0,4)),n=parseInt(t.substring(4,6))-1,i=parseInt(t.substring(6,8)),s=parseInt(t.substring(8,10)),d=parseInt(t.substring(10,12)),_=parseInt(t.substring(12,14));return new Date(e,n,i,s,d,_)}catch{return null}}isExpired(t){let e=this.parseExpiresAt(t);return e?new Date>=e:!0}getRemainingSeconds(t){let e=this.parseExpiresAt(t);if(!e)return 0;let n=Math.floor((e.getTime()-Date.now())/1e3);return Math.max(0,n)}isAccessTokenExpired(){let t=this.getStoredTokens();return t?this.isExpired(t.accessExpiresAt):!0}isRefreshTokenExpired(){let t=this.getStoredTokens();return t?this.isExpired(t.refreshExpiresAt):!0}needsTokenRefresh(){let t=this.getStoredTokens();return!t||this.isExpired(t.refreshExpiresAt)?!1:this.getRemainingSeconds(t.accessExpiresAt)<=mr}updateTokenStatus(){let t=this.getStoredTokens();if(!t){this.tokenStatusSubject.next(this.getInitialStatus());return}let e=this.isExpired(t.accessExpiresAt),n=this.isExpired(t.refreshExpiresAt),i={isAuthenticated:!n,isAccessTokenExpired:e,isRefreshTokenExpired:n,needsRefresh:this.needsTokenRefresh(),accessTokenRemainingSeconds:this.getRemainingSeconds(t.accessExpiresAt),refreshTokenRemainingSeconds:this.getRemainingSeconds(t.refreshExpiresAt)};this.tokenStatusSubject.next(i)}getTokenStatus(){return this.tokenStatusSubject.value}isAuthenticated(){return this.tokenStatusSubject.value.isAuthenticated}formatExpiresAt(t){return!t||t.length!==14?t:`${t.substring(0,4)}-${t.substring(4,6)}-${t.substring(6,8)} ${t.substring(8,10)}:${t.substring(10,12)}:${t.substring(12,14)}`}log(t,e,n="info"){if(!Re)return;let i="\u{1F511} [TokenService]";switch(n){case"error":console.error(`${i} ${t}`,e||"");break;case"warn":console.warn(`${i} ${t}`,e||"");break;default:console.log(`${i} ${t}`,e||"")}}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var St=class r{http=P(Ht);apiConfig=P(rt);tokenService=P(at);constructor(){}get(t,e){return this.request("GET",t,void 0,e)}post(t,e,n){return this.request("POST",t,e,n)}put(t,e,n){return this.request("PUT",t,e,n)}patch(t,e,n){return this.request("PATCH",t,e,n)}delete(t,e){return this.request("DELETE",t,void 0,e)}request(t,e,n,i={}){let s=this.apiConfig.buildUrl(e),d=this.buildHeaders(i),_=this.buildParams(i.params),v=i.timeout||Li,w=i.retries??0;this.logRequest(t,s,n,d);let M;switch(t){case"GET":M=this.http.get(s,{headers:d,params:_,responseType:i.responseType});break;case"POST":M=this.http.post(s,n,{headers:d,params:_});break;case"PUT":M=this.http.put(s,n,{headers:d,params:_});break;case"PATCH":M=this.http.patch(s,n,{headers:d,params:_});break;case"DELETE":M=this.http.delete(s,{headers:d,params:_});break}return M.pipe(Ki(v),qi({count:w,delay:(O,E)=>this.isRetryableError(O)?(this.log(`\uC7AC\uC2DC\uB3C4 ${E}/${w}`,{error:O.message}),Gi(fr*E)):ct(()=>O)}),mn(O=>(this.logResponse(t,s,O),O)),dt(O=>this.handleError(O,t,s)))}buildHeaders(t={}){let e=this.apiConfig.getCommonHeadersAsRecord();if(t.withAuth!==!1){let n=this.tokenService.getAccessToken();n&&(e.Authorization=`Bearer ${n}`)}return t.headers&&(e=K(K({},e),t.headers)),new rn(e)}buildParams(t){if(!t)return new Ti;let e=new Ti;return Object.entries(t).forEach(([n,i])=>{i!=null&&(e=e.set(n,String(i)))}),e}handleError(t,e,n){let i=this.parseError(t);return this.logError(e,n,i),ct(()=>i)}parseError(t){return t.name==="TimeoutError"?{status:0,code:"TIMEOUT",message:"\uC694\uCCAD \uC2DC\uAC04\uC774 \uCD08\uACFC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",originalError:t}:t instanceof an?this.parseHttpError(t):navigator.onLine?{status:0,code:"UNKNOWN",message:t.message||"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.",originalError:t}:{status:0,code:"NETWORK_ERROR",message:"\uB124\uD2B8\uC6CC\uD06C \uC5F0\uACB0\uC744 \uD655\uC778\uD574\uC8FC\uC138\uC694.",originalError:t}}parseHttpError(t){let e=t.error?.message||t.message,n=t.error?.errorCode;switch(t.status){case 0:return{status:0,code:"NETWORK_ERROR",message:"\uC11C\uBC84\uC5D0 \uC5F0\uACB0\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.",originalError:t};case 400:return{status:400,code:n||"BAD_REQUEST",message:e||"\uC798\uBABB\uB41C \uC694\uCCAD\uC785\uB2C8\uB2E4.",originalError:t};case 401:return{status:401,code:n||"UNAUTHORIZED",message:e||"\uC778\uC99D\uC774 \uD544\uC694\uD569\uB2C8\uB2E4.",originalError:t};case 403:return{status:403,code:n||"FORBIDDEN",message:e||"\uC811\uADFC \uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.",originalError:t};case 404:return{status:404,code:n||"NOT_FOUND",message:e||"\uC694\uCCAD\uD55C \uB9AC\uC18C\uC2A4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.",originalError:t};case 409:return{status:409,code:n||"CONFLICT",message:e||"\uCDA9\uB3CC\uC774 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.",originalError:t};case 500:return{status:500,code:n||"INTERNAL_ERROR",message:e||"\uC11C\uBC84 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.",originalError:t};case 503:return{status:503,code:n||"SERVICE_UNAVAILABLE",message:e||"\uC11C\uBE44\uC2A4\uB97C \uC77C\uC2DC\uC801\uC73C\uB85C \uC0AC\uC6A9\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.",originalError:t};default:return{status:t.status,code:n||"UNKNOWN",message:e||`\uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4. (${t.status})`,originalError:t}}}isRetryableError(t){return t.status===0||t.status===503||t.name==="TimeoutError"}logRequest(t,e,n,i){Re&&(console.log(`\u{1F4E4} [API Request] ${t} ${e}`),n&&console.log("  Body:",n))}logResponse(t,e,n){Re&&(console.log(`\u{1F4E5} [API Response] ${t} ${e}`),console.log("  Data:",n))}logError(t,e,n){console.error(`\u274C [API Error] ${t} ${e}`),console.error(`  Status: ${n.status}`),console.error(`  Code: ${n.code}`),console.error(`  Message: ${n.message}`)}log(t,e){Re&&console.log(`\u{1F537} [BaseApiService] ${t}`,e||"")}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var st=class r extends St{getGuestBalance(){return this.get(Ft.POINTS.BALANCE_GUEST,{withAuth:!0})}getBalance(){return this.get(Ft.POINTS.BALANCE,{withAuth:!0})}getTotalPoints(){return this.getGuestBalance().pipe(mn(t=>t.success?t.data.total_point_amount:0),dt(t=>(this.logPoints("\uD3EC\uC778\uD2B8 \uC870\uD68C \uC2E4\uD328",t,"error"),un(0))))}getHistory(t){return this.get(Ft.POINTS.HISTORY,{withAuth:!0,params:t})}earnPoints(t){return this.post(Ft.POINTS.EARN,t,{withAuth:!0})}earnReadingPoints(t=1,e=365){let n=Math.floor(Date.now()/1e3)+86400*e;return this.earnPoints({amount:t,description:"POINT.REWARD.PDF_READ",expired_at:n})}earnAttendancePoints(t=10){let e=Math.floor(Date.now()/1e3)+31536e3;return this.earnPoints({amount:t,description:"POINT.REWARD.ATTENDANCE",expired_at:e})}earnTestPoints(t){let e=Math.floor(Date.now()/1e3)+2592e3;return this.earnPoints({amount:t,description:"POINT.REWARD.TEST",expired_at:e})}usePoints(t){return this.post(Ft.POINTS.USE,t,{withAuth:!0})}useForTranslation(t,e){return this.usePoints({amount:t,use_type:"AI_TRANSLATION",reference_id:e})}logPoints(t,e,n="info"){let i="\u{1F3AF} [PointsApiService]";switch(n){case"error":console.error(`${i} ${t}`,e||"");break;case"warn":console.warn(`${i} ${t}`,e||"");break;default:console.log(`${i} ${t}`,e||"")}}static \u0275fac=(()=>{let t;return function(n){return(t||(t=Zi(r)))(n||r)}})();static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ue=class r{MAX_DAILY_POINTS=5;POINTS_STORAGE_KEY="ez_reader_points";DAILY_POINTS_STORAGE_KEY="ez_reader_daily_points";LAST_POINT_DATE_KEY="ez_reader_last_point_date";totalPointsSubject=new de(0);todayPointsSubject=new de(0);totalPoints$=this.totalPointsSubject.asObservable();todayPoints$=this.todayPointsSubject.asObservable();syncLogService=P(Jt);pointsApiService=P(st);authService=P(Ce);constructor(){this.initializePoints()}initializePoints(){let t=localStorage.getItem(this.POINTS_STORAGE_KEY),e=t?parseInt(t,10):0,n=localStorage.getItem(this.LAST_POINT_DATE_KEY),i=this.getTodayDateString(),s=0;if(n===i){let d=localStorage.getItem(this.DAILY_POINTS_STORAGE_KEY);s=d?parseInt(d,10):0}else s=0,localStorage.setItem(this.DAILY_POINTS_STORAGE_KEY,"0"),localStorage.setItem(this.LAST_POINT_DATE_KEY,i);this.totalPointsSubject.next(e),this.todayPointsSubject.next(s),console.log(`\u{1F4CA} \uD3EC\uC778\uD2B8 \uC11C\uBE44\uC2A4 \uCD08\uAE30\uD654: \uCD1D ${e}\uD3EC\uC778\uD2B8, \uC624\uB298 ${s}/${this.MAX_DAILY_POINTS}\uD3EC\uC778\uD2B8`),this.syncLogService.logLocalInit(e,s)}getTodayDateString(){let t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}addPoint(){return C(this,null,function*(){let t=this.getTodayDateString(),e=localStorage.getItem(this.LAST_POINT_DATE_KEY),n=this.todayPointsSubject.value;return e!==t&&(n=0,localStorage.setItem(this.DAILY_POINTS_STORAGE_KEY,"0"),localStorage.setItem(this.LAST_POINT_DATE_KEY,t)),n>=this.MAX_DAILY_POINTS?(console.log(`\u{1F4CA} \uC624\uB298 \uCD5C\uB300 \uD3EC\uC778\uD2B8(${this.MAX_DAILY_POINTS})\uC5D0 \uB3C4\uB2EC\uD568`),{success:!1,message:`\uC624\uB298\uC740 \uCD5C\uB300 ${this.MAX_DAILY_POINTS}\uD3EC\uC778\uD2B8\uB97C \uC774\uBBF8 \uD68D\uB4DD\uD588\uC2B5\uB2C8\uB2E4.`,total:this.totalPointsSubject.value,today:n}):(yield Di(this.authService.isAuthenticated$))?this.addPointToServer():this.addPointToLocal()})}addPointToServer(){return C(this,null,function*(){let t=this.todayPointsSubject.value;try{console.log("\u{1F310} \uC11C\uBC84\uC5D0 \uD3EC\uC778\uD2B8 \uC801\uB9BD \uC2DC\uB3C4...");let e=yield Di(this.pointsApiService.earnReadingPoints(1,365));if(e.success&&e.data){let n=e.data.total_points,i=e.data.earned_points,s=t+1;return localStorage.setItem(this.POINTS_STORAGE_KEY,n.toString()),localStorage.setItem(this.DAILY_POINTS_STORAGE_KEY,s.toString()),this.totalPointsSubject.next(n),this.todayPointsSubject.next(s),console.log(`\u2705 \uC11C\uBC84 \uC801\uB9BD \uC131\uACF5! \uCD1D ${n}\uD3EC\uC778\uD2B8 (+${i}), \uC624\uB298 ${s}/${this.MAX_DAILY_POINTS}`),this.syncLogService.logApiEarn(i,n,"PDF_READ",n-i),{success:!0,message:`+${i} \uD3EC\uC778\uD2B8! (\uC11C\uBC84 \uB3D9\uAE30\uD654, \uC624\uB298 ${s}/${this.MAX_DAILY_POINTS})`,total:n,today:s}}else throw new Error(e.message||"\uC11C\uBC84 \uC751\uB2F5 \uC624\uB958")}catch(e){console.error("\u274C \uC11C\uBC84 \uC801\uB9BD \uC2E4\uD328, \uB85C\uCEEC\uC5D0\uB9CC \uC800\uC7A5:",e);let n=this.addPointToLocal();return this.syncLogService.logApiFetch(!1,void 0,e instanceof Error?e.message:"\uC11C\uBC84 \uC801\uB9BD \uC2E4\uD328"),n}})}addPointToLocal(){let t=this.todayPointsSubject.value+1,e=this.totalPointsSubject.value+1;return localStorage.setItem(this.DAILY_POINTS_STORAGE_KEY,t.toString()),localStorage.setItem(this.POINTS_STORAGE_KEY,e.toString()),this.todayPointsSubject.next(t),this.totalPointsSubject.next(e),console.log(`\u{1F4CA} +1 \uD3EC\uC778\uD2B8! \uCD1D ${e}\uD3EC\uC778\uD2B8, \uC624\uB298 ${t}/${this.MAX_DAILY_POINTS}\uD3EC\uC778\uD2B8 (\uB85C\uCEEC \uC800\uC7A5)`),this.syncLogService.logLocalAdd(e-1,e,t,this.MAX_DAILY_POINTS),{success:!0,message:`+1 \uD3EC\uC778\uD2B8! (\uC624\uB298 ${t}/${this.MAX_DAILY_POINTS})`,total:e,today:t}}getPointInfo(){let t=this.totalPointsSubject.value,e=this.todayPointsSubject.value;return{total:t,today:e,maxDaily:this.MAX_DAILY_POINTS,remaining:this.MAX_DAILY_POINTS-e}}getTotalPoints(){return this.totalPointsSubject.value}getTodayPoints(){return this.todayPointsSubject.value}getMaxDailyPoints(){return this.MAX_DAILY_POINTS}getRemainingDailyPoints(){return Math.max(0,this.MAX_DAILY_POINTS-this.todayPointsSubject.value)}addPointFromViewer(t,e,n){return C(this,null,function*(){let i=this.totalPointsSubject.value,s=yield this.addPoint();return this.syncLogService.logViewerRead(t,e,n,i,s.total),s})}getSyncLogService(){return this.syncLogService}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};function Hr(r,t){if(r&1){let e=y();o(0,"button",14),u("click",function(){m(e);let i=g();return f(i.onLoginClick())}),c(1," \uB85C\uADF8\uC778 "),a()}}function Wr(r,t){if(r&1&&h(0,"img",18),r&2){let e=g(2);p("src",e.userProfile.picture,ce)("alt",e.userProfile.name)}}function Kr(r,t){if(r&1&&(o(0,"span",19),c(1),a()),r&2){let e=g(2);l(),x(e.getAvatarText())}}function Gr(r,t){if(r&1&&(o(0,"div",15),b(1,Wr,1,2,"img",16)(2,Kr,2,1,"span",17),a()),r&2){let e=g();l(),p("ngIf",e.userProfile.picture),l(),p("ngIf",!e.userProfile.picture)}}var Ot=class r{constructor(t){this.router=t}menuClick=new W;isAuthenticated=!1;userPoints=0;userProfile=null;authSubscription;userProfileSubscription;pointsSubscription;authService=P(Ce);pointsService=P(Ue);ngOnInit(){this.authSubscription=this.authService.isAuthenticated$.subscribe(t=>this.isAuthenticated=t),this.userProfileSubscription=this.authService.userProfile$.subscribe(t=>this.userProfile=t),this.pointsSubscription=this.pointsService.totalPoints$.subscribe(t=>this.userPoints=t)}ngOnDestroy(){this.authSubscription&&this.authSubscription.unsubscribe(),this.userProfileSubscription&&this.userProfileSubscription.unsubscribe(),this.pointsSubscription&&this.pointsSubscription.unsubscribe()}onMenuClick(){this.menuClick.emit()}onLoginClick(){this.authService.startGoogleLogin()}navigateToSearch(){this.router.navigate(["/ezm/search"])}getAvatarText(){return this.userProfile?(this.userProfile.name||this.userProfile.email||"").charAt(0).toUpperCase():""}static \u0275fac=function(e){return new(e||r)(V(N))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-header"]],outputs:{menuClick:"menuClick"},standalone:!1,decls:17,vars:5,consts:[[1,"header"],[1,"header-left"],["title","\uBA54\uB274",1,"icon-btn","menu-btn",3,"click"],["src","images/icons/ico-top-menu.svg","alt","\uBA54\uB274","width","24","height","24"],["src","./images/title/a-2@3x.png","alt","EZ Reader Icon",1,"header-logo-icon"],["src","./images/title/ez-reader_title.svg","alt","ezReader",1,"header-logo-title"],[1,"header-right"],["title","\uAC80\uC0C9",1,"icon-btn","search-btn",3,"click"],["src","images/icons/btn-search.svg","alt","\uAC80\uC0C9","width","20","height","20"],[1,"points-display"],[1,"points-icon"],[1,"points-value"],["class","login-btn",3,"click",4,"ngIf"],["class","user-avatar",4,"ngIf"],[1,"login-btn",3,"click"],[1,"user-avatar"],["class","avatar-img",3,"src","alt",4,"ngIf"],["class","avatar-text",4,"ngIf"],[1,"avatar-img",3,"src","alt"],[1,"avatar-text"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),u("click",function(){return n.onMenuClick()}),h(3,"img",3),a(),h(4,"img",4)(5,"img",5),a(),o(6,"div",6)(7,"button",7),u("click",function(){return n.navigateToSearch()}),h(8,"img",8),a(),o(9,"div",9)(10,"span",10),c(11,"P"),a(),o(12,"span",11),c(13),L(14,"number"),a()(),b(15,Hr,2,0,"button",12)(16,Gr,3,2,"div",13),a()()),e&2&&(l(13),S("",J(14,3,n.userPoints),"P"),l(2),p("ngIf",!n.isAuthenticated),l(),p("ngIf",n.isAuthenticated&&n.userProfile))},dependencies:[B,Te],styles:[".header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fff;border-bottom:1px solid #e0e0e0;display:flex;align-items:center;justify-content:space-between;padding-left:8px;padding-right:16px;z-index:100;box-sizing:border-box}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.header-left[_ngcontent-%COMP%]   .header-logo-icon[_ngcontent-%COMP%]{height:28px;width:28px;object-fit:contain}.header-left[_ngcontent-%COMP%]   .header-logo-title[_ngcontent-%COMP%]{height:auto;width:auto}.header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.icon-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#666;display:flex;align-items:center;justify-content:center;border-radius:50%}.icon-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.icon-btn.menu-btn[_ngcontent-%COMP%]{margin-right:4px}.points-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;background:#fff;border-radius:4px;cursor:pointer;transition:background .2s}.points-display[_ngcontent-%COMP%]:active{background:#f5f5f5}.points-display[_ngcontent-%COMP%]   .points-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;background:#f44;border-radius:50%;color:#fff;font-size:11px;font-weight:700}.points-display[_ngcontent-%COMP%]   .points-value[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#333;white-space:nowrap}.login-btn[_ngcontent-%COMP%]{padding:6px 16px;background:#fff;border:1px solid #ff4444;border-radius:20px;color:#f44;font-size:13px;font-weight:500;cursor:pointer;white-space:nowrap;transition:all .2s}.login-btn[_ngcontent-%COMP%]:active{background:#fff5f5;border-color:#f22;color:#f22}.user-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;overflow:hidden;cursor:pointer;display:flex;align-items:center;justify-content:center;background:#4285f4;transition:opacity .2s}.user-avatar[_ngcontent-%COMP%]:active{opacity:.8}.user-avatar[_ngcontent-%COMP%]   .avatar-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.user-avatar[_ngcontent-%COMP%]   .avatar-text[_ngcontent-%COMP%]{color:#fff;font-size:14px;font-weight:600;-webkit-user-select:none;user-select:none}"]})};function Yr(r,t){if(r&1){let e=y();o(0,"div",16),u("click",function(){m(e);let i=g();return f(i.closeMenu())})("touchmove",function(i){return m(e),f(i.preventDefault())}),a()}}function qr(r,t){if(r&1){let e=y();o(0,"div",17)(1,"div",18),u("click",function(){m(e);let i=g();return f(i.navigateToLogin())}),o(2,"div",19),h(3,"img",20),a(),o(4,"span",21),c(5),L(6,"translate"),a(),h(7,"img",22),a(),o(8,"div",23)(9,"span",24),c(10),L(11,"translate"),a(),o(12,"div",25)(13,"span",26),c(14,"P"),a(),o(15,"span",27),c(16),L(17,"number"),a(),h(18,"img",28),a()()()}if(r&2){let e=g();l(5),x(J(6,3,"sideMenu.loginPrompt")),l(5),x(J(11,5,"sideMenu.myPoints")),l(6),S("",J(17,7,e.userPoints),"P")}}function Xr(r,t){if(r&1&&h(0,"img",32),r&2){let e=g(2);p("src",e.userProfile.profileImageUrl||e.userProfile.picture,ce)("alt",e.userProfile.nickname||e.userProfile.name)}}function Jr(r,t){r&1&&h(0,"img",20)}function Zr(r,t){if(r&1){let e=y();o(0,"div",17)(1,"div",18),u("click",function(){m(e);let i=g();return f(i.navigateToMyPage())}),o(2,"div",19),b(3,Xr,1,2,"img",29)(4,Jr,1,0,"img",30),a(),o(5,"span",21),c(6),a(),h(7,"img",22),a(),o(8,"div",31),u("click",function(){m(e);let i=g();return f(i.navigateToPoints())}),o(9,"span",24),c(10),L(11,"translate"),a(),o(12,"div",25)(13,"span",26),c(14,"P"),a(),o(15,"span",27),c(16),L(17,"number"),a(),h(18,"img",28),a()()()}if(r&2){let e=g();l(2),k("has-image",e.userProfile.picture||e.userProfile.profileImageUrl),l(),p("ngIf",e.userProfile.picture||e.userProfile.profileImageUrl),l(),p("ngIf",!e.userProfile.picture&&!e.userProfile.profileImageUrl),l(2),x(e.getDisplayName()),l(4),x(J(11,7,"sideMenu.myPoints")),l(6),S("",J(17,9,e.userPoints),"P")}}var Et=class r{constructor(t){this.router=t}isOpen=!1;close=new W;isLoggedIn=!1;userPoints=0;userProfile=null;authSubscription;userProfileSubscription;pointsSubscription;menuNavigationSubscription;authService=P(Ce);pointsService=P(Ue);snackbar=P(G);androidBridge=P(Ae);authApi=P(qt);ngOnInit(){this.authSubscription=this.authService.isAuthenticated$.subscribe(t=>this.isLoggedIn=t),this.userProfileSubscription=this.authService.userProfile$.subscribe(t=>this.userProfile=t),this.pointsSubscription=this.pointsService.totalPoints$.subscribe(t=>this.userPoints=t),ye()&&(this.menuNavigationSubscription=this.androidBridge.menuNavigationRequested$.subscribe(t=>{console.log("\u{1F9ED} [\uBA54\uB274 \uB124\uBE44\uAC8C\uC774\uC158] Android \uC694\uCCAD \uC218\uC2E0:",t),this.closeMenu(),t.params?this.router.navigate([t.route],{queryParams:t.params}):this.router.navigate([t.route]),this.snackbar.showInfo(`${t.menuId} \uBA54\uB274\uB85C \uC774\uB3D9\uD569\uB2C8\uB2E4.`)}))}ngOnDestroy(){this.authSubscription&&this.authSubscription.unsubscribe(),this.userProfileSubscription&&this.userProfileSubscription.unsubscribe(),this.pointsSubscription&&this.pointsSubscription.unsubscribe(),this.menuNavigationSubscription&&this.menuNavigationSubscription.unsubscribe()}closeMenu(){this.close.emit()}navigateToLogin(){this.closeMenu(),this.authService.startGoogleLogin()}navigateToPoints(){this.closeMenu(),ye()?this.androidBridge.navigateToMenu("points","/ezm/points"):this.router.navigate(["/ezm/points"])}navigateToMyPage(){if(this.closeMenu(),ye()){let t=this.authApi.getAccessToken();t?(console.log("\u{1F517} Android \uB9C8\uC774\uD398\uC774\uC9C0 WebView \uC5F4\uAE30"),this.androidBridge.openMyPage(t,100,150)):(console.warn("\u26A0\uFE0F Access Token \uC5C6\uC74C - \uB85C\uADF8\uC778 \uD544\uC694"),this.snackbar.showWarning("\uB85C\uADF8\uC778\uC774 \uD544\uC694\uD569\uB2C8\uB2E4."),this.authService.startGoogleLogin())}else this.router.navigate(["/ezm/profile"])}navigateToSettings(){this.closeMenu(),ye()?this.androidBridge.navigateToMenu("settings","/ezm/profile"):this.router.navigate(["/ezm/profile"])}onLogout(){return C(this,null,function*(){(yield xe("\uB85C\uADF8\uC544\uC6C3 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"))&&(this.closeMenu(),this.authService.logout(),this.snackbar.showSuccess("\uB85C\uADF8\uC544\uC6C3\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.router.navigate(["/ezm/home"]))})}getAvatarText(){let t=this.userProfile?.nickname||this.userProfile?.name;return t?t.charAt(0).toUpperCase():"U"}getDisplayName(){return this.userProfile?.nickname?this.userProfile.nickname:this.getMaskedEmail()}getMaskedEmail(){let t=this.userProfile?.email||this.userProfile?.name||"";if(!t.includes("@"))return t;let[e,n]=t.split("@");return e.length<=2?`${e[0]}*@${n}`:`${`${e.substring(0,2)}**${e.slice(-1)}`}@${n}`}static \u0275fac=function(e){return new(e||r)(V(N))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-side-menu"]],inputs:{isOpen:"isOpen"},outputs:{close:"close"},standalone:!1,decls:31,vars:17,consts:[["class","side-menu-overlay",3,"click","touchmove",4,"ngIf"],[1,"side-menu"],[1,"side-menu-header"],[1,"close-btn",3,"click"],["src","images/icons/ico-close.svg","alt","\uB2EB\uAE30","width","24","height","24"],[1,"side-menu-content"],["class","user-card",4,"ngIf"],[1,"menu-list"],[1,"menu-item",3,"click"],[1,"menu-icon","points-icon-wrapper"],[1,"points-icon-circle"],[1,"menu-text","points-text"],[1,"menu-icon"],["src","images/icons/ico-sidebar-my.svg","alt","\uB9C8\uC774\uD398\uC774\uC9C0","width","24","height","24"],[1,"menu-text"],["src","images/icons/ico-tool-configuration.svg","alt","\uC124\uC815","width","24","height","24"],[1,"side-menu-overlay",3,"click","touchmove"],[1,"user-card"],[1,"user-card-top",3,"click"],[1,"user-avatar"],["src","images/icons/ico-sidebar-my.svg","alt","\uD504\uB85C\uD544","width","24","height","24"],[1,"user-card-text"],["src","images/icons/btn-view-next.svg","alt","\uC774\uB3D9","width","20","height","20",1,"arrow-icon"],[1,"user-card-bottom"],[1,"points-label"],[1,"points-value"],[1,"points-icon"],[1,"points-amount"],["src","images/icons/btn-view-next.svg","alt","\uC774\uB3D9","width","16","height","16",1,"arrow-icon"],[3,"src","alt",4,"ngIf"],["src","images/icons/ico-sidebar-my.svg","alt","\uD504\uB85C\uD544","width","24","height","24",4,"ngIf"],[1,"user-card-bottom",3,"click"],[3,"src","alt"]],template:function(e,n){e&1&&(b(0,Yr,1,0,"div",0),o(1,"div",1)(2,"div",2)(3,"h2"),c(4),L(5,"translate"),a(),o(6,"button",3),u("click",function(){return n.closeMenu()}),h(7,"img",4),a()(),o(8,"div",5),b(9,qr,19,9,"div",6)(10,Zr,19,11,"div",6),o(11,"div",7)(12,"div",8),u("click",function(){return n.navigateToPoints()}),o(13,"div",9)(14,"span",10),c(15,"P"),a()(),o(16,"span",11),c(17),L(18,"translate"),a()(),o(19,"div",8),u("click",function(){return n.navigateToMyPage()}),o(20,"div",12),h(21,"img",13),a(),o(22,"span",14),c(23),L(24,"translate"),a()(),o(25,"div",8),u("click",function(){return n.navigateToSettings()}),o(26,"div",12),h(27,"img",15),a(),o(28,"span",14),c(29),L(30,"translate"),a()()()()()),e&2&&(p("ngIf",n.isOpen),l(),k("open",n.isOpen),l(3),x(J(5,9,"sideMenu.title")),l(5),p("ngIf",!n.isLoggedIn),l(),p("ngIf",n.isLoggedIn&&n.userProfile),l(7),x(J(18,11,"sideMenu.points")),l(6),x(J(24,13,"sideMenu.myPage")),l(6),x(J(30,15,"sideMenu.settings")))},dependencies:[B,Te,yt],styles:[".side-menu-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:999;touch-action:none;-webkit-overflow-scrolling:auto}.side-menu[_ngcontent-%COMP%]{position:fixed;top:0;left:0;bottom:0;width:80%;max-width:320px;background:#f5f5f5;z-index:1000;transform:translate(-100%);transition:transform .3s ease;display:flex;flex-direction:column;box-shadow:2px 0 8px #0000001a}.side-menu.open[_ngcontent-%COMP%]{transform:translate(0)}.side-menu-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;background:#fff}.side-menu-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0}.side-menu-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#333;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background .2s}.side-menu-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.side-menu-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px}.user-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;overflow:hidden;margin-bottom:16px;box-shadow:0 1px 3px #00000014}.user-card-top[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;cursor:pointer;border-bottom:1px solid #f0f0f0}.user-card-top[_ngcontent-%COMP%]:active{background:#f8f8f8}.user-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#f0f0f0;display:flex;align-items:center;justify-content:center;flex-shrink:0;overflow:hidden}.user-avatar.has-image[_ngcontent-%COMP%]{background:transparent}.user-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.user-card-text[_ngcontent-%COMP%]{flex:1;margin-left:12px;font-size:15px;color:#333;font-weight:500}.arrow-icon[_ngcontent-%COMP%]{flex-shrink:0}.user-card-bottom[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;cursor:pointer}.user-card-bottom[_ngcontent-%COMP%]:active{background:#f8f8f8}.points-label[_ngcontent-%COMP%]{font-size:14px;color:#666}.points-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.points-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;background:#ff5722;border-radius:50%;color:#fff;font-size:11px;font-weight:700}.points-amount[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#333}.menu-list[_ngcontent-%COMP%]{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 1px 3px #00000014}.menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;cursor:pointer;border-bottom:1px solid #f5f5f5}.menu-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.menu-item[_ngcontent-%COMP%]:active{background:#f8f8f8}.menu-icon[_ngcontent-%COMP%]{width:24px;height:24px;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-right:12px}.points-icon-wrapper[_ngcontent-%COMP%]{margin-right:12px}.points-icon-circle[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:24px;height:24px;background:#ff5722;border-radius:50%;color:#fff;font-size:12px;font-weight:700}.menu-text[_ngcontent-%COMP%]{font-size:15px;color:#333;font-weight:400}.points-text[_ngcontent-%COMP%]{color:#ff5722;font-weight:500}"]})};function Qr(r,t){if(r&1&&(o(0,"span",23),c(1),a()),r&2){let e=g(2);l(),S("(",e.progressText,")")}}function ea(r,t){r&1&&h(0,"img",24)}function ta(r,t){r&1&&h(0,"img",25)}function na(r,t){if(r&1&&(o(0,"div",26),h(1,"img",27),o(2,"span"),c(3),a()()),r&2){let e=g(2);l(3),x(e.modalState.errorMessage)}}function ia(r,t){if(r&1){let e=y();o(0,"label",28)(1,"input",29),$("ngModelChange",function(i){m(e);let s=g(2);return U(s.rememberPassword,i)||(s.rememberPassword=i),f(i)}),a(),h(2,"span",30),o(3,"span",31),c(4,"\uC774 \uC138\uC158 \uB3D9\uC548 \uC554\uD638 \uAE30\uC5B5\uD558\uAE30"),a()()}if(r&2){let e=g(2);l(),j("ngModel",e.rememberPassword),p("disabled",e.modalState.isLoading)}}function oa(r,t){if(r&1){let e=y();o(0,"button",32),u("click",function(){m(e);let i=g(2);return f(i.onCancel())}),c(1," \uCDE8\uC18C "),a()}if(r&2){let e=g(2);p("disabled",e.modalState.isLoading)}}function ra(r,t){r&1&&(o(0,"span"),c(1,"\uD655\uC778"),a())}function aa(r,t){r&1&&h(0,"span",33)}function sa(r,t){if(r&1){let e=y();o(0,"div",1),u("click",function(){m(e);let i=g();return f(i.onOverlayClick())}),o(1,"div",2),u("click",function(i){return m(e),f(i.stopPropagation())}),o(2,"div",3)(3,"div",4),h(4,"img",5),a(),o(5,"h3",6),c(6," \uC554\uD638 \uD655\uC778 "),b(7,Qr,2,1,"span",7),a()(),o(8,"div",8),h(9,"img",9),o(10,"span",10),c(11),a()(),o(12,"div",11)(13,"input",12),$("ngModelChange",function(i){m(e);let s=g();return U(s.modalState.password,i)||(s.modalState.password=i),f(i)}),u("keydown",function(i){m(e);let s=g();return f(s.onKeyDown(i))}),a(),o(14,"button",13),u("click",function(){m(e);let i=g();return f(i.togglePasswordVisibility())}),b(15,ea,1,0,"img",14)(16,ta,1,0,"img",15),a()(),b(17,na,4,1,"div",16)(18,ia,5,2,"label",17),o(19,"div",18),b(20,oa,2,1,"button",19),o(21,"button",20),u("click",function(){m(e);let i=g();return f(i.onSubmit())}),b(22,ra,2,0,"span",21)(23,aa,1,0,"span",22),a()()()()}if(r&2){let e=g();l(7),p("ngIf",e.isMultiFileMode),l(4),x(e.fileName),l(2),p("type",e.modalState.showPassword?"text":"password"),j("ngModel",e.modalState.password),p("disabled",e.modalState.isLoading),l(),p("disabled",e.modalState.isLoading),l(),p("ngIf",!e.modalState.showPassword),l(),p("ngIf",e.modalState.showPassword),l(),p("ngIf",e.modalState.errorMessage),l(),p("ngIf",e.modalState.options.rememberPassword!==!1),l(2),p("ngIf",e.modalState.options.allowCancel!==!1),l(),p("disabled",e.modalState.isLoading||!e.modalState.password.trim()),l(),p("ngIf",!e.modalState.isLoading),l(),p("ngIf",e.modalState.isLoading)}}var kt=class r{rememberPassword=!1;passwordService=P(Ke);constructor(){}ngOnInit(){}ngOnDestroy(){}get modalState(){return this.passwordService.modalState}get fileName(){return this.modalState.document?.fileName||this.modalState.document?.title||"\uBB38\uC11C"}get isMultiFileMode(){return(this.modalState.options.total||0)>1}get progressText(){return this.isMultiFileMode?`${this.modalState.options.current}/${this.modalState.options.total}`:""}togglePasswordVisibility(){this.passwordService.togglePasswordVisibility()}onSubmit(){return C(this,null,function*(){this.modalState.password.trim()&&(yield this.passwordService.submitPassword(this.modalState.password,this.rememberPassword))})}onCancel(){this.passwordService.cancelModal()}onKeyDown(t){t.key==="Enter"&&!this.modalState.isLoading&&this.onSubmit()}onOverlayClick(){this.modalState.options.allowCancel!==!1&&this.onCancel()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["pdf-password-modal"]],standalone:!1,decls:1,vars:1,consts:[["class","password-modal-overlay",3,"click",4,"ngIf"],[1,"password-modal-overlay",3,"click"],[1,"password-modal",3,"click"],[1,"modal-header"],[1,"header-icon"],["src","images/icons/ico-tool-main-password.svg","alt","\uC554\uD638","width","32","height","32"],[1,"header-title"],["class","progress-badge",4,"ngIf"],[1,"file-info"],["src","images/icons/ico-pdf.svg","alt","PDF","width","20","height","20"],[1,"file-name"],[1,"password-input-wrapper"],["placeholder","\uBE44\uBC00\uBC88\uD638 \uC785\uB825","autocomplete","off","autofocus","",1,"password-input",3,"ngModelChange","keydown","type","ngModel","disabled"],["type","button",1,"visibility-toggle",3,"click","disabled"],["src","images/icons/btn-top-find.svg","alt","\uBCF4\uC774\uAE30","width","20","height","20",4,"ngIf"],["src","images/icons/btn-top-find.svg","alt","\uC228\uAE30\uAE30","width","20","height","20","style","opacity: 0.5;",4,"ngIf"],["class","error-message",4,"ngIf"],["class","remember-option",4,"ngIf"],[1,"modal-actions"],["class","btn-cancel",3,"disabled","click",4,"ngIf"],[1,"btn-confirm",3,"click","disabled"],[4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"progress-badge"],["src","images/icons/btn-top-find.svg","alt","\uBCF4\uC774\uAE30","width","20","height","20"],["src","images/icons/btn-top-find.svg","alt","\uC228\uAE30\uAE30","width","20","height","20",2,"opacity","0.5"],[1,"error-message"],["src","images/icons/ico-tooltip-info.svg","alt","\uC624\uB958","width","16","height","16"],[1,"remember-option"],["type","checkbox",3,"ngModelChange","ngModel","disabled"],[1,"checkbox-custom"],[1,"remember-text"],[1,"btn-cancel",3,"click","disabled"],[1,"loading-spinner"]],template:function(e,n){e&1&&b(0,sa,24,14,"div",0),e&2&&p("ngIf",n.modalState.isOpen)},dependencies:[B,he,xn,pe,ge],styles:['.password-modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:9999;padding:20px;animation:_ngcontent-%COMP%_fadeIn .2s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.password-modal[_ngcontent-%COMP%]{background:#fff;border-radius:16px;width:100%;max-width:340px;padding:24px;box-shadow:0 8px 32px #0003;animation:_ngcontent-%COMP%_slideUp .25s ease-out}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:20px}.modal-header[_ngcontent-%COMP%]   .header-icon[_ngcontent-%COMP%]{width:56px;height:56px;background:#fff3e0;border-radius:50%;display:flex;align-items:center;justify-content:center;margin-bottom:12px}.modal-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0;display:flex;align-items:center;gap:8px}.modal-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]   .progress-badge[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#f57c00;background:#fff3e0;padding:2px 8px;border-radius:12px}.file-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px;background:#f5f5f5;border-radius:8px;margin-bottom:16px}.file-info[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-size:14px;color:#333;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1}.password-input-wrapper[_ngcontent-%COMP%]{position:relative;margin-bottom:12px}.password-input-wrapper[_ngcontent-%COMP%]   .password-input[_ngcontent-%COMP%]{width:100%;height:48px;padding:0 48px 0 16px;border:1px solid #E0E0E0;border-radius:8px;font-size:16px;outline:none;transition:border-color .2s;box-sizing:border-box}.password-input-wrapper[_ngcontent-%COMP%]   .password-input[_ngcontent-%COMP%]:focus{border-color:#f57c00}.password-input-wrapper[_ngcontent-%COMP%]   .password-input[_ngcontent-%COMP%]:disabled{background:#f5f5f5;color:#999}.password-input-wrapper[_ngcontent-%COMP%]   .password-input[_ngcontent-%COMP%]::placeholder{color:#999}.password-input-wrapper[_ngcontent-%COMP%]   .visibility-toggle[_ngcontent-%COMP%]{position:absolute;right:8px;top:50%;transform:translateY(-50%);width:36px;height:36px;background:none;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background .2s}.password-input-wrapper[_ngcontent-%COMP%]   .visibility-toggle[_ngcontent-%COMP%]:hover:not(:disabled){background:#0000000d}.password-input-wrapper[_ngcontent-%COMP%]   .visibility-toggle[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:10px 12px;background:#ffebee;border-radius:8px;margin-bottom:12px;color:#d32f2f;font-size:13px}.error-message[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.remember-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:20px;cursor:pointer}.remember-option[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.remember-option[_ngcontent-%COMP%]   .checkbox-custom[_ngcontent-%COMP%]{width:18px;height:18px;border:2px solid #BDBDBD;border-radius:4px;display:flex;align-items:center;justify-content:center;transition:all .2s;flex-shrink:0}.remember-option[_ngcontent-%COMP%]   .checkbox-custom[_ngcontent-%COMP%]:after{content:"";width:10px;height:5px;border-left:2px solid white;border-bottom:2px solid white;transform:rotate(-45deg) translateY(-1px);opacity:0}.remember-option[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .checkbox-custom[_ngcontent-%COMP%]{background:#f57c00;border-color:#f57c00}.remember-option[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .checkbox-custom[_ngcontent-%COMP%]:after{opacity:1}.remember-option[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled + .checkbox-custom[_ngcontent-%COMP%]{opacity:.5}.remember-option[_ngcontent-%COMP%]   .remember-text[_ngcontent-%COMP%]{font-size:13px;color:#666}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.modal-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;height:48px;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s}.modal-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.modal-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:#f5f5f5;border:none;color:#666}.modal-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover:not(:disabled){background:#eee}.modal-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:active:not(:disabled){background:#e0e0e0}.modal-actions[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{background:#f57c00;border:none;color:#fff;display:flex;align-items:center;justify-content:center}.modal-actions[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:hover:not(:disabled){background:#ef6c00}.modal-actions[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:active:not(:disabled){background:#e65100}.loading-spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}']})};function la(r,t){r&1&&h(0,"ez-shimmer-skeleton",37),r&2&&p("count",3)}function ca(r,t){if(r&1&&(o(0,"div",48),c(1),L(2,"date"),a()),r&2){let e=g().$implicit;l(),x(me(2,1,e.date,"yyyy.MM.dd HH:mm:ss"))}}function da(r,t){if(r&1){let e=y();o(0,"div",40),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.onFolderClick(i))}),o(1,"div",41),h(2,"img",42),a(),o(3,"div",43)(4,"div",44),c(5),a(),b(6,ca,3,4,"div",45),a(),o(7,"button",46),u("click",function(i){let s=m(e).$implicit,d=g(2);return f(d.onFolderMoreClick(s,i))}),h(8,"img",47),a()()}if(r&2){let e=t.$implicit;l(5),x(e.name),l(),p("ngIf",e.date)}}function pa(r,t){if(r&1&&(o(0,"div",38),b(1,da,9,2,"div",39),a()),r&2){let e=g();l(),p("ngForOf",e.folderItems)}}function ga(r,t){r&1&&h(0,"ez-shimmer-skeleton",49),r&2&&p("count",5)}function ua(r,t){r&1&&(o(0,"div",65),h(1,"div",66),a())}function ma(r,t){r&1&&(o(0,"div",67),h(1,"img",68),a())}function fa(r,t){if(r&1&&h(0,"img",69),r&2){let e=g().$implicit;p("src",e.thumbnail,ce)}}function ha(r,t){r&1&&(o(0,"div",70),h(1,"img",71),a())}function _a(r,t){if(r&1&&(o(0,"span",72),c(1),a()),r&2){let e=g().$implicit,n=g(2);l(),S(" \xB7 ",n.formatFileSize(e.size))}}function Ca(r,t){if(r&1){let e=y();o(0,"div",52),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.onFileClick(i))}),o(1,"div",53),b(2,ua,2,0,"div",54)(3,ma,2,0,"div",55)(4,fa,1,1,"img",56)(5,ha,2,0,"div",57),a(),o(6,"div",58)(7,"div",59),c(8),a(),o(9,"div",60)(10,"span",61),c(11),L(12,"date"),a(),b(13,_a,2,1,"span",62),a()(),o(14,"button",63),u("click",function(i){let s=m(e).$implicit,d=g(2);return f(d.onToggleFavorite(s,i))}),h(15,"img",64),a(),o(16,"button",46),u("click",function(i){let s=m(e).$implicit,d=g(2);return f(d.onFileMoreClick(s,i))}),h(17,"img",47),a()()}if(r&2){let e=t.$implicit,n=g(2);l(2),p("ngIf",n.isLoadingThumbnail(e.id)),l(),p("ngIf",!n.isLoadingThumbnail(e.id)&&e.isEncrypted),l(),p("ngIf",!n.isLoadingThumbnail(e.id)&&!e.isEncrypted&&e.thumbnail),l(),p("ngIf",!n.isLoadingThumbnail(e.id)&&!e.isEncrypted&&!e.thumbnail),l(3),x(e.name),l(3),x(me(12,10,e.date,"yyyy.MM.dd HH:mm:ss")),l(2),p("ngIf",e.size),l(),k("active",e.isFavorite),l(),p("src",e.isFavorite?"images/icons/btn-bookmark-on.svg":"images/icons/btn-bookmark-off.svg",ce)}}function ba(r,t){if(r&1&&(o(0,"cdk-virtual-scroll-viewport",50),b(1,Ca,18,13,"div",51),a()),r&2){let e=g();p("itemSize",e.FILE_ITEM_HEIGHT),l(),p("cdkVirtualForOf",e.fileItems)("cdkVirtualForTrackBy",e.trackByFileId)}}function va(r,t){r&1&&(o(0,"div",73),h(1,"img",74),o(2,"p",75),c(3,"\uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4."),a()())}function xa(r,t){if(r&1){let e=y();o(0,"div",76)(1,"div",77)(2,"h3",78),c(3),a()(),o(4,"div",79)(5,"button",80),u("click",function(){m(e);let i=g();return f(i.onFolderRename())}),h(6,"img",81),o(7,"span"),c(8,"\uC774\uB984 \uBCC0\uACBD"),a()(),o(9,"button",82),u("click",function(){m(e);let i=g();return f(i.onFolderDelete())}),h(10,"img",83),o(11,"span"),c(12,"\uC0AD\uC81C"),a()()()()}if(r&2){let e=g();l(3),x(e.selectedFolderItem.name)}}function Pa(r,t){if(r&1){let e=y();o(0,"div",76)(1,"div",77)(2,"h3",78),c(3),a()(),o(4,"div",79)(5,"button",80),u("click",function(){m(e);let i=g();return f(i.onFileShare())}),h(6,"img",84),o(7,"span"),c(8,"\uACF5\uC720"),a()(),o(9,"button",80),u("click",function(){m(e);let i=g();return f(i.onFileRename())}),h(10,"img",81),o(11,"span"),c(12,"\uC774\uB984 \uBCC0\uACBD"),a()(),o(13,"button",80),u("click",function(){m(e);let i=g();return f(i.onFileMoveClick())}),h(14,"img",85),o(15,"span"),c(16,"\uD30C\uC77C \uC774\uB3D9"),a()(),o(17,"button",82),u("click",function(){m(e);let i=g();return f(i.onFileDelete())}),h(18,"img",83),o(19,"span"),c(20,"\uC0AD\uC81C"),a()()()()}if(r&2){let e=g();l(3),x(e.selectedFileItem.name)}}function Ma(r,t){r&1&&h(0,"img",105)}function ya(r,t){r&1&&h(0,"div",106)}function wa(r,t){if(r&1){let e=y();o(0,"div",97),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.onSelectMoveFolder(i.id))}),o(1,"div",98),b(2,Ma,1,0,"img",99)(3,ya,1,0,"div",100),a(),o(4,"div",101),h(5,"img",42),a(),o(6,"div",102)(7,"span",103),c(8),a(),o(9,"span",104),c(10),L(11,"date"),a()()()}if(r&2){let e=t.$implicit,n=g(2);k("selected",n.selectedMoveTargetFolderId===e.id),l(2),p("ngIf",n.selectedMoveTargetFolderId===e.id),l(),p("ngIf",n.selectedMoveTargetFolderId!==e.id),l(5),x(e.name),l(2),ue("",me(11,7,e.updatedAt,"yyyy.MM.dd HH:mm")," ",e.fileCount||0," MB")}}function Sa(r,t){r&1&&(o(0,"div",107)(1,"p"),c(2,"\uC774\uB3D9 \uAC00\uB2A5\uD55C \uD3F4\uB354\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),a()())}function Oa(r,t){if(r&1){let e=y();o(0,"div",86)(1,"div",87)(2,"button",88),u("click",function(){m(e);let i=g();return f(i.closeFileMoveSheet())}),h(3,"img",89),a(),o(4,"h3",90),c(5,"\uD30C\uC77C \uC774\uB3D9"),a()(),o(6,"div",91),b(7,wa,12,10,"div",92)(8,Sa,3,0,"div",93),a(),o(9,"div",94)(10,"span",95),c(11),a(),o(12,"button",96),u("click",function(){m(e);let i=g();return f(i.onFileMoveConfirm())}),c(13," \uC774\uB3D9\uD558\uAE30 "),a()()()}if(r&2){let e=g();l(7),p("ngForOf",e.availableFolders),l(),p("ngIf",e.availableFolders.length===0),l(3),S("\uC120\uD0DD\uB41C \uD30C\uC77C ",e.selectedFilesForMove.length,"\uAC1C"),l(),p("disabled",!e.selectedMoveTargetFolderId)}}var qn=class r{constructor(t){this.router=t;this.indexedDbService.migrateToDocumentsMeta().then(()=>{this.loadRecentFiles(),this.loadFoldersAndFiles()})}currentActiveTab="home";recentFiles=[];myFiles=[];viewerFiles=[];sheetState="collapsed";convertSheetState="collapsed";recentFileSheetState="collapsed";selectedFile=null;selectedRecentFile=null;selectedAction=null;isAuthenticated=!1;userPoints=2450;userProfile=null;showAuthElements=!0;isSideMenuOpen=!1;authSubscription;userProfileSubscription;folders=[];documents=[];folderSheetState="collapsed";fileSheetState="collapsed";selectedFileItem=null;selectedFolderItem=null;showFolderDialog=!1;folderDialogTitle="\uD3F4\uB354 \uB9CC\uB4E4\uAE30";folderDialogInitialValue="";editingFolderId=null;showFileRenameDialog=!1;fileRenameDialogInitialValue="";editingFileId=null;addFileSheetState="collapsed";sortSheetState="collapsed";sortCriteria="date";sortOrder="desc";fileMoveSheetState="collapsed";availableFolders=[];selectedMoveTargetFolderId=null;selectedFilesForMove=[];FILE_ITEM_HEIGHT=72;FOLDER_ITEM_HEIGHT=64;isDataLoading=!1;shimmerStartTime=0;MIN_SHIMMER_DURATION=500;loadingDocIds=new Set;isLoadingThumbnail(t){return this.loadingDocIds.has(t)}indexedDbService=P(ee);snackbar=P(G);authService=P(Ce);toolActionService=P(le);reversePdfConverter=P(_t);pdfPasswordService=P(Ke);filePicker=P(je);cdr=P(fe);homeDataCache=P(Xt);loadingService=P(Ct);pdfjsLibService=P(Me);isDestroyed=!1;ngOnInit(){window.scrollTo(0,0),this.showAuthElements=!0,this.authSubscription=this.authService.isAuthenticated$.subscribe(t=>this.isAuthenticated=t),this.userProfileSubscription=this.authService.userProfile$.subscribe(t=>this.userProfile=t)}ngOnDestroy(){this.isDestroyed=!0,this.authSubscription&&this.authSubscription.unsubscribe(),this.userProfileSubscription&&this.userProfileSubscription.unsubscribe(),this.recentFiles=[],this.myFiles=[],this.viewerFiles=[]}onLogout(){return C(this,null,function*(){(yield xe("\uB85C\uADF8\uC544\uC6C3 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"))&&(yield this.authService.logout())})}onLoginClick(){this.authService.startGoogleLogin()}getAvatarText(){return this.userProfile?.name?this.userProfile.name.charAt(0).toUpperCase():"U"}navigateToSearch(){this.router.navigate(["/ezm/search"])}onMenuClick(){this.isSideMenuOpen=!0}onSideMenuClose(){this.isSideMenuOpen=!1}loadRecentFiles(){return C(this,null,function*(){try{let t=yield this.indexedDbService.getRecentFileEntries(30);this.recentFiles=yield Promise.all(t.map(s=>C(this,null,function*(){let d=!1;if(s.documentId)try{let _=yield this.indexedDbService.getDocumentById(s.documentId);d=_?.isEncrypted===!0||!!_?.encryptionMetadata}catch(_){console.warn(`\u26A0\uFE0F [RecentFiles] Failed to get document: ${s.documentId}`,_)}return{id:s.id,documentId:s.documentId,name:s.fileName,date:s.viewedAt,size:"",fileSize:s.fileSize,thumbnail:s.thumbnail,documentType:s.documentType,folderId:s.folderId,isEncrypted:d}}))),console.log("\u{1F4CB} [RecentFiles] Loaded files:",this.recentFiles);let e=yield this.indexedDbService.getRecentDocuments(30),n=e.filter(s=>(s.fileName||s.title||"").toLowerCase().split(".").pop()!=="pdf"?!1:!s.documentType||s.documentType==="editor");this.myFiles=n.map(s=>({id:s.id,name:s.fileName||s.title,date:new Date(s.updatedAt).toLocaleDateString("ko-KR"),size:"",thumbnail:s.thumbnail,documentType:s.documentType}));let i=e.filter(s=>(s.fileName||s.title||"").toLowerCase().split(".").pop()!=="pdf"?!1:s.documentType==="viewer");this.viewerFiles=i.map(s=>({id:s.id,name:s.fileName||s.title,date:new Date(s.updatedAt).toLocaleDateString("ko-KR"),size:"",thumbnail:s.thumbnail,documentType:s.documentType}))}catch{}})}onFunctionClick(t){t==="PDF \uC5F4\uAE30"?this.sheetState="full":t==="PDF \uBCC0\uD658"?this.convertSheetState="full":t==="\uC0C8\uBB38\uC11C \uB9CC\uB4E4\uAE30"&&(this.router.navigate(["/ezm/viewer"],{queryParams:{mode:"new-document",fileName:`\uC0C8\uBB38\uC11C_${Date.now()}.pdf`}}),this.snackbar.showInfo("\uC0C8 \uBB38\uC11C\uB97C \uC791\uC131\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4"))}onRecentFileClick(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t.documentId);if(!e){this.snackbar.showWarning("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}console.log("\u{1F50D} [RecentFile Click] Document:",{fileName:e.fileName,isEncrypted:e.isEncrypted,hasMetadata:!!e.encryptionMetadata,metadata:e.encryptionMetadata});let i=(e.fileName||e.title||"").toLowerCase().split(".").pop();if(i!=="pdf"){["jpg","jpeg","png","gif","bmp","webp"].includes(i||"")?this.snackbar.showError("\uC774\uBBF8\uC9C0 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["xlsx","xls","csv"].includes(i||"")?this.snackbar.showError("\uC5D1\uC140 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["docx","doc"].includes(i||"")?this.snackbar.showError("\uC6CC\uB4DC \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["pptx","ppt"].includes(i||"")?this.snackbar.showError("\uD30C\uC6CC\uD3EC\uC778\uD2B8 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):this.snackbar.showError("PDF \uD30C\uC77C\uB9CC \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC788\uC2B5\uB2C8\uB2E4.");return}if(e.isEncrypted||e.encryptionMetadata){let s=yield this.pdfPasswordService.verifyPassword(e);if(s.cancelled)return;if(!s.success){s.error&&this.snackbar.showError(s.error);return}let d=K({},e);s.decryptedBase64&&(d.pdfBase64=s.decryptedBase64,d.isEncrypted=!1),this.router.navigate(["/ezm/viewer"],{state:{document:d}});return}this.router.navigate(["/ezm/viewer"],{state:{document:e}})}catch{this.snackbar.showError("\uD30C\uC77C\uC744 \uC5EC\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}onRecentFileMore(t){this.selectedRecentFile=t,this.recentFileSheetState="full"}onOrganizeClick(){this.toolActionService.setPendingAction({toolId:"organize",toolLabel:"PDF \uAD6C\uC131",action:"organize-pdf",requiresFileSelection:!0}),this.router.navigate(["/ezm/myfiles","my-files"])}onSplitClick(){this.toolActionService.setPendingAction({toolId:"split",toolLabel:"PDF \uBD84\uD560",action:"split-pdf",requiresFileSelection:!0}),this.router.navigate(["/ezm/myfiles","my-files"])}executeAction(){return C(this,null,function*(){if(!(!this.selectedFile||!this.selectedAction))try{let t=yield this.indexedDbService.getDocumentById(this.selectedFile.id);if(!t){this.snackbar.showWarning("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if(this.selectedAction==="edit")this.router.navigate(["/ezm/viewer"],{state:{document:t,mode:"convert"}});else{let e=this.selectedAction==="view"?"viewer":"convert";this.router.navigate(["/ezm/viewer"],{state:{document:t,mode:e}})}this.selectedFile=null,this.selectedAction=null}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}loadDocumentFromIndexedDB(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t.id);if(!e){this.snackbar.showWarning("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.router.navigate(["/ezm/viewer"],{state:{document:e}})}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}onMergeClick(){return C(this,null,function*(){this.toolActionService.setPendingAction({toolId:"merge",toolLabel:"PDF \uBCD1\uD569",action:"merge-pdf",requiresFileSelection:!0}),this.router.navigate(["/ezm/myfiles","my-files"])})}onRecentFileEdit(){return C(this,null,function*(){if(this.selectedRecentFile){this.recentFileSheetState="collapsed";try{let t=yield this.indexedDbService.getDocumentById(this.selectedRecentFile.documentId);if(!t){this.snackbar.showWarning("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.router.navigate(["/ezm/viewer"],{state:{document:t,mode:"editor"}})}catch{this.snackbar.showError("\uD30C\uC77C\uC744 \uC5EC\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}}})}onRecentFileShare(){return C(this,null,function*(){if(this.selectedRecentFile){this.recentFileSheetState="collapsed";try{let t=yield this.indexedDbService.getDocumentById(this.selectedRecentFile.documentId);if(!t){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let e=t.pdfBase64||t.originalPdfBase64;if(!e){this.snackbar.showError("\uACF5\uC720\uD560 PDF \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=this.ensurePdfExtension(t.fileName||t.title||this.selectedRecentFile.name||"document.pdf");if(this.tryNativeShare(n,e)){this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uACF5\uC720\uD588\uC2B5\uB2C8\uB2E4.");return}if(typeof navigator<"u"&&navigator.share){let i=this.base64ToBlob(e,"application/pdf"),s=[];try{s.push(new File([i],n,{type:"application/pdf"}))}catch{}let d={title:n,text:`${n} \uBB38\uC11C\uB97C \uACF5\uC720\uD569\uB2C8\uB2E4.`};s.length&&(typeof navigator.canShare!="function"||navigator.canShare({files:s}))&&(d.files=s),yield navigator.share(d),this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uACF5\uC720\uD588\uC2B5\uB2C8\uB2E4.");return}this.downloadFile(n,e),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch(t){if(t?.name==="AbortError")return;this.snackbar.showError("\uBB38\uC11C \uACF5\uC720\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}}})}onRecentFileRemove(){return C(this,null,function*(){if(this.selectedRecentFile){this.recentFileSheetState="collapsed";try{if(!(yield xe("\uCD5C\uADFC \uBAA9\uB85D\uC5D0\uC11C \uC81C\uAC70\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")))return;yield this.indexedDbService.removeFromRecentFiles(this.selectedRecentFile.id),this.snackbar.showSuccess("\uCD5C\uADFC \uBAA9\uB85D\uC5D0\uC11C \uC81C\uAC70\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),yield this.loadRecentFiles()}catch{this.snackbar.showError("\uBAA9\uB85D\uC5D0\uC11C \uC81C\uAC70\uD558\uB294\uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}}})}onRecentFileGoToLocation(){return C(this,null,function*(){if(this.selectedRecentFile){this.recentFileSheetState="collapsed";try{let t=this.selectedRecentFile.folderId,e=this.selectedRecentFile.documentId;t?this.router.navigate(["/ezm/myfiles",t],{queryParams:{fileId:e}}):this.router.navigate(["/ezm/myfiles","my-files"],{queryParams:{fileId:e}})}catch{this.snackbar.showError("\uC704\uCE58\uB85C \uC774\uB3D9\uD558\uB294\uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}}})}closeBottomSheet(){this.sheetState="collapsed"}closeRecentFileSheet(){this.recentFileSheetState="collapsed",this.selectedRecentFile=null}onRecentFileSheetStateChange(t){this.recentFileSheetState=t,t==="collapsed"&&(this.selectedRecentFile=null)}tryNativeShare(t,e){if(typeof window<"u"&&window.parent!==window)try{return window.parent.postMessage({type:"share",fileName:t,data:e},"*"),!0}catch{}return window.ReactNativeWebView?(window.ReactNativeWebView.postMessage(JSON.stringify({type:"share",fileName:t,data:e})),!0):window.webkit?.messageHandlers?.shareFile?(window.webkit.messageHandlers.shareFile.postMessage({fileName:t,data:e}),!0):window.Android?.shareFile?(window.Android.shareFile(t,e),!0):!1}downloadFile(t,e){let n=this.base64ToBlob(e,"application/pdf"),i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}base64ToBlob(t,e="application/pdf"){let n=t.includes(",")?t.split(",")[1]:t,i=atob(n),s=new Array(i.length);for(let _=0;_<i.length;_++)s[_]=i.charCodeAt(_);let d=new Uint8Array(s);return new Blob([d],{type:e})}ensurePdfExtension(t){return t.toLowerCase().endsWith(".pdf")?t:`${t}.pdf`}closeConvertBottomSheet(){this.convertSheetState="collapsed"}onSheetStateChange(t){this.sheetState=t}onConvertSheetStateChange(t){this.convertSheetState=t}openFileDialog(){let t=document.createElement("input");t.type="file",t.accept=".pdf",t.onchange=e=>C(this,null,function*(){let n=e.target.files[0];n&&(yield this.onFileSelected(n))}),t.click()}onBottomSheetOptionSelected(t){this.sheetState="collapsed";let e="",n=t;switch(t){case"pdf":e=".pdf,application/pdf";break;case"image":e="image/*,.jpg,.jpeg,.png,.gif,.bmp,.webp";break;case"excel":e=".xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel";break;case"word":e=".docx,.doc,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/msword";break;case"ppt":e=".pptx,.ppt,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.ms-powerpoint";break;default:e="*/*"}let i=document.createElement("input");i.type="file",i.accept=e,i.onchange=s=>C(this,null,function*(){let d=s.target.files[0];d&&(yield this.onFileSelected(d,n))}),i.click()}onConvertBottomSheetOptionSelected(t){this.convertSheetState="collapsed";let e={"image-to-pdf":"\uC774\uBBF8\uC9C0 \u2192 PDF","photo-to-pdf":"\uC0AC\uC9C4 \u2192 PDF","excel-to-pdf":"\uC5D1\uC140 \u2192 PDF","word-to-pdf":"\uC6CC\uB4DC \u2192 PDF","ppt-to-pdf":"PPT \u2192 PDF"},n={"image-to-pdf":"image","photo-to-pdf":"image","excel-to-pdf":"excel","word-to-pdf":"word","ppt-to-pdf":"ppt"};this.toolActionService.setPendingAction({toolId:t,toolLabel:e[t]||"\uBB38\uC11C \uBCC0\uD658",action:"convert-to-pdf",requiresFileSelection:!0,data:{convertType:t,sourceFileType:n[t]}}),this.router.navigate(["/ezm/myfiles","my-files"])}onFileSelected(t,e="pdf"){return C(this,null,function*(){try{if(this.snackbar.showInfo(`${t.name} \uD30C\uC77C\uC744 \uC5EC\uB294 \uC911...`),e==="pdf"){if(t.type!=="application/pdf"&&!t.name.toLowerCase().endsWith(".pdf")){this.snackbar.showError("PDF \uD30C\uC77C\uB9CC \uC5C5\uB85C\uB4DC \uAC00\uB2A5\uD569\uB2C8\uB2E4.");return}yield this.handlePdfFile(t)}else yield this.handleOtherFile(t,e)}catch{this.snackbar.showError("\uD30C\uC77C\uC744 \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}handlePdfFile(t){return C(this,null,function*(){let e=t.size>5242880;try{e&&this.loadingService.showSpinner("\uD30C\uC77C \uC77D\uB294 \uC911...");let n=URL.createObjectURL(t);e&&this.loadingService.updateMessage("\uD30C\uC77C \uC800\uC7A5 \uC911..."),yield this.saveOpenedPdfAsDocument(t,n),e&&this.loadingService.updateMessage("\uBAA9\uB85D \uAC31\uC2E0 \uC911..."),yield this.loadRecentFiles(),e&&this.loadingService.hide(),this.router.navigate(["/ezm/viewer"],{state:{pdfUrl:n,fileName:t.name,pdfBlob:t}}),this.snackbar.showSuccess(`${t.name} \uD30C\uC77C\uC744 \uC5F4\uC5C8\uC2B5\uB2C8\uB2E4.`)}catch(n){throw this.loadingService.hide(),n}})}handleOtherFile(t,e){return C(this,null,function*(){let n=t.size>5242880;try{n&&this.loadingService.showSpinner("\uD30C\uC77C \uC77D\uB294 \uC911...");let i=n?yield this.fileToBase64WithProgress(t,v=>{this.loadingService.updateMessage(`\uD30C\uC77C \uC77D\uB294 \uC911... ${v}%`)}):yield this.fileToBase64(t),s={image:"image",excel:"excel",word:"word",ppt:"ppt"},d={id:this.generateDocumentId(),title:t.name,pages:[],elementCount:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:"1.0",fileName:t.name,documentType:s[e]||"image",originalFileData:i,mimeType:t.type,fileSize:t.size},_=yield this.indexedDbService.findDocumentMetadataByFileNameAndType(t.name,s[e]||"image");_&&(d.id=_.id,d.createdAt=_.createdAt),n&&this.loadingService.updateMessage("\uD30C\uC77C \uC800\uC7A5 \uC911..."),yield this.indexedDbService.saveDocument(d),n&&this.loadingService.updateMessage("\uBAA9\uB85D \uAC31\uC2E0 \uC911..."),this.homeDataCache.invalidate(),yield this.loadFoldersAndFiles(),yield this.loadRecentFiles(),n&&this.loadingService.hide(),this.snackbar.showSuccessWithAction(`${t.name} \uD30C\uC77C\uC744 \uC800\uC7A5\uD588\uC2B5\uB2C8\uB2E4.`,{label:"\uD30C\uC77C\uB85C \uC774\uB3D9",callback:()=>{this.router.navigate(["/ezm/myfiles","my-files"],{state:{highlightFileId:d.id,scrollToFile:!0}})}},5e3)}catch(i){throw this.loadingService.hide(),i}})}saveOpenedPdfAsDocument(t,e){return C(this,null,function*(){let n=t.size>5242880;try{let i=n?yield this.fileToBase64WithProgress(t,_=>{this.loadingService.updateMessage(`\uD30C\uC77C \uC77D\uB294 \uC911... ${_}%`)}):yield this.fileToBase64(t),s={id:this.generateDocumentId(),title:t.name,pages:[],elementCount:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:"1.0",pdfSrc:e,pdfBase64:i,fileName:t.name,documentType:"viewer"},d=yield this.indexedDbService.findDocumentMetadataByFileNameAndType(t.name,"viewer");d&&(s.id=d.id,s.createdAt=d.createdAt),yield this.indexedDbService.saveDocument(s),this.homeDataCache.invalidate(),yield this.loadFoldersAndFiles()}catch{}})}fileToBase64(t){return C(this,null,function*(){return new Promise((e,n)=>{let i=new FileReader;i.onloadend=()=>e(i.result),i.onerror=n,i.readAsDataURL(t)})})}fileToBase64WithProgress(t,e){return C(this,null,function*(){return new Promise((n,i)=>{let s=new FileReader;s.onprogress=d=>{if(d.lengthComputable&&e){let _=Math.round(d.loaded/d.total*100);e(_)}},s.onloadend=()=>n(s.result),s.onerror=i,s.readAsDataURL(t)})})}generateDocumentId(){return`doc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}startShimmer(){this.shimmerStartTime=Date.now(),this.isDataLoading=!0}hideShimmer(){return C(this,null,function*(){let t=Date.now()-this.shimmerStartTime,e=this.MIN_SHIMMER_DURATION-t;e>0&&(yield new Promise(n=>setTimeout(n,e))),this.isDataLoading=!1})}loadFoldersAndFiles(){return C(this,null,function*(){try{let t=this.homeDataCache.getSnapshot();if(t){this.folders=t.folders,this.folders.sort((e,n)=>{let i=new Date(e.createdAt||0).getTime(),s=new Date(n.createdAt||0).getTime();return i-s}),this.documents=t.documents,this.isDataLoading=!1,this.cdr.detectChanges(),this.generateMissingThumbnailsOptimized(),this.homeDataCache.refreshInBackground().then(e=>{if(e){let n=this.homeDataCache.getSnapshot();n&&(this.folders=n.folders,this.folders.sort((i,s)=>{let d=new Date(i.createdAt||0).getTime(),_=new Date(s.createdAt||0).getTime();return d-_}),this.documents=n.documents,this.cdr.detectChanges(),this.generateMissingThumbnailsOptimized())}});return}this.startShimmer(),this.folders=yield this.indexedDbService.getFolders(null),this.folders.sort((e,n)=>{let i=new Date(e.createdAt||0).getTime(),s=new Date(n.createdAt||0).getTime();return i-s});for(let e of this.folders){let n=yield this.indexedDbService.getFolderDocumentCount(e.id);e.fileCount=n}this.documents=yield this.indexedDbService.getFolderContentsMetadataOnly(null),this.homeDataCache.updateSnapshot(this.folders,this.documents),yield this.hideShimmer(),this.cdr.detectChanges(),this.generateMissingThumbnailsOptimized()}catch(t){console.error("\uD3F4\uB354/\uD30C\uC77C \uB85C\uB4DC \uC2E4\uD328:",t),this.isDataLoading=!1}})}get folderItems(){return this.folders.map(t=>({id:t.id,name:t.name,type:"folder",date:this.safeParseDate(t.updatedAt)||this.safeParseDate(t.createdAt),fileCount:t.fileCount||0}))}get fileItems(){return this.documents.map(t=>({id:t.id,name:t.fileName||t.title,type:"pdf",date:this.safeParseDate(t.updatedAt)||this.safeParseDate(t.createdAt),size:t.fileSize||0,isFavorite:t.isFavorite,documentType:t.documentType,thumbnail:t.thumbnail,isEncrypted:t.isEncrypted}))}safeParseDate(t){if(!t)return null;let e=new Date(t);return isNaN(e.getTime())?null:e}trackByFileId(t,e){return e.id}trackByFolderId(t,e){return e.id}formatFileSize(t){return!t||t===0?"":t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/(1024*1024)).toFixed(2)+" MB"}onAddFolderClick(){this.folderDialogTitle="\uD3F4\uB354 \uB9CC\uB4E4\uAE30",this.folderDialogInitialValue="",this.editingFolderId=null,this.showFolderDialog=!0}onFolderDialogConfirm(t){return C(this,null,function*(){try{this.editingFolderId?(yield this.indexedDbService.updateFolder(this.editingFolderId,t),this.snackbar.showSuccess("\uD3F4\uB354 \uC774\uB984\uC774 \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")):(yield this.indexedDbService.createFolder(t,null),this.snackbar.showSuccess(`"${t}" \uD3F4\uB354\uAC00 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)),this.homeDataCache.invalidate(),yield this.loadFoldersAndFiles()}catch{this.snackbar.showError("\uD3F4\uB354 \uC791\uC5C5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onFolderDialogCancel(){this.showFolderDialog=!1,this.editingFolderId=null}onFolderClick(t){this.router.navigate(["/ezm/myfiles",t.id])}onFolderMoreClick(t,e){e.stopPropagation(),this.selectedFolderItem=t,this.folderSheetState="full"}closeFolderSheet(){this.folderSheetState="collapsed",this.selectedFolderItem=null}onFolderSheetStateChange(t){this.folderSheetState=t,t==="collapsed"&&(this.selectedFolderItem=null)}onFolderRename(){this.selectedFolderItem&&(this.folderSheetState="collapsed",this.folderDialogTitle="\uD3F4\uB354 \uC774\uB984 \uBCC0\uACBD",this.folderDialogInitialValue=this.selectedFolderItem.name,this.editingFolderId=this.selectedFolderItem.id,this.showFolderDialog=!0)}onFolderDelete(){return C(this,null,function*(){if(!(!this.selectedFolderItem||(this.folderSheetState="collapsed",!(yield xe(`"${this.selectedFolderItem.name}" \uD3F4\uB354\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?
(\uD3F4\uB354 \uB0B4 \uD30C\uC77C\uC740 \uB8E8\uD2B8\uB85C \uC774\uB3D9\uB429\uB2C8\uB2E4)`)))))try{let e=this.selectedFolderItem.id;yield this.indexedDbService.deleteFolder(e),this.homeDataCache.removeFolder(e),this.snackbar.showSuccess("\uD3F4\uB354\uAC00 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.homeDataCache.invalidate(),yield this.loadFoldersAndFiles()}catch{this.snackbar.showError("\uD3F4\uB354 \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onFileClick(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t.id);if(!e){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if((e.fileName||e.title||"").toLowerCase().split(".").pop()!=="pdf"){this.snackbar.showError("PDF \uD30C\uC77C\uB9CC \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC788\uC2B5\uB2C8\uB2E4.");return}if(e.isEncrypted||e.encryptionMetadata){let s=yield this.pdfPasswordService.verifyPassword(e);if(s.cancelled)return;if(!s.success){s.error&&this.snackbar.showError(s.error);return}let d=K({},e);s.decryptedBase64&&(d.pdfBase64=s.decryptedBase64,d.isEncrypted=!1),this.router.navigate(["/ezm/viewer"],{state:{document:d}});return}this.router.navigate(["/ezm/viewer"],{queryParams:{docId:e.id}})}catch{this.snackbar.showError("\uD30C\uC77C\uC744 \uC5EC\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}onFileMoreClick(t,e){e.stopPropagation(),this.selectedFileItem=t,this.fileSheetState="full"}closeFileSheet(){this.fileSheetState="collapsed",this.selectedFileItem=null}onFileSheetStateChange(t){this.fileSheetState=t,t==="collapsed"&&(this.selectedFileItem=null)}onToggleFavorite(t,e){return C(this,null,function*(){e.stopPropagation();let n=t.isFavorite,i=!n,s=this.documents.findIndex(d=>d.id===t.id);s!==-1&&(this.documents[s]=Z(K({},this.documents[s]),{isFavorite:i}),this.documents=[...this.documents]),this.homeDataCache.toggleFavorite(t.id),this.cdr.detectChanges();try{yield this.indexedDbService.toggleFavoriteFast(t.id),this.snackbar.showSuccess(i?"\uC990\uACA8\uCC3E\uAE30\uC5D0 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.":"\uC990\uACA8\uCC3E\uAE30\uC5D0\uC11C \uC81C\uAC70\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch{s!==-1&&(this.documents[s]=Z(K({},this.documents[s]),{isFavorite:n}),this.documents=[...this.documents]),this.homeDataCache.toggleFavorite(t.id),this.cdr.detectChanges(),this.snackbar.showError("\uC990\uACA8\uCC3E\uAE30 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onFileShare(){return C(this,null,function*(){if(this.selectedFileItem){this.fileSheetState="collapsed";try{let t=yield this.indexedDbService.getDocumentById(this.selectedFileItem.id);if(!t){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let e=t.pdfBase64||t.originalPdfBase64;if(!e){this.snackbar.showError("\uACF5\uC720\uD560 PDF \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=this.ensurePdfExtension(t.fileName||t.title||"document.pdf");if(this.tryNativeShare(n,e)){this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uACF5\uC720\uD588\uC2B5\uB2C8\uB2E4.");return}if(typeof navigator<"u"&&navigator.share){let i=this.base64ToBlob(e,"application/pdf"),s=[new File([i],n,{type:"application/pdf"})],d={title:n,text:`${n} \uBB38\uC11C\uB97C \uACF5\uC720\uD569\uB2C8\uB2E4.`};(typeof navigator.canShare!="function"||navigator.canShare({files:s}))&&(d.files=s),yield navigator.share(d),this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uACF5\uC720\uD588\uC2B5\uB2C8\uB2E4.");return}this.downloadFile(n,e),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch(t){if(t?.name==="AbortError")return;this.snackbar.showError("\uBB38\uC11C \uACF5\uC720\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}}})}onFileRename(){return C(this,null,function*(){this.selectedFileItem&&(this.fileSheetState="collapsed",this.fileRenameDialogInitialValue=this.selectedFileItem.name.replace(/\.pdf$/i,""),this.editingFileId=this.selectedFileItem.id,this.showFileRenameDialog=!0)})}onFileRenameDialogConfirm(t){return C(this,null,function*(){try{if(!this.editingFileId)return;let e=yield this.indexedDbService.getDocumentById(this.editingFileId);if(!e){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=t.replace(/\.pdf$/i,""),i=t.endsWith(".pdf")?t:t+".pdf";e.title=n,e.fileName=i,yield this.indexedDbService.updateDocument(e),this.snackbar.showSuccess("\uD30C\uC77C \uC774\uB984\uC774 \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.homeDataCache.invalidate(),yield this.loadFoldersAndFiles()}catch{this.snackbar.showError("\uD30C\uC77C \uC774\uB984 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onFileRenameDialogCancel(){this.showFileRenameDialog=!1,this.editingFileId=null}onFileDuplicate(){return C(this,null,function*(){if(this.selectedFileItem){this.fileSheetState="collapsed";try{let t=yield this.indexedDbService.getDocumentById(this.selectedFileItem.id);if(!t){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let e=Z(K({},t),{id:this.generateDocumentId(),title:t.title+"_\uBCF5\uC0AC\uBCF8",fileName:(t.fileName||t.title||"").replace(/\.pdf$/i,"_\uBCF5\uC0AC\uBCF8.pdf"),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});yield this.indexedDbService.saveDocument(e),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uBCF5\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),yield this.loadFoldersAndFiles()}catch{this.snackbar.showError("\uD30C\uC77C \uBCF5\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}}})}onFileDelete(){return C(this,null,function*(){if(!(!this.selectedFileItem||(this.fileSheetState="collapsed",!(yield xe(`"${this.selectedFileItem.name}" \uD30C\uC77C\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`)))))try{let e=this.selectedFileItem.id;yield this.indexedDbService.deleteDocument(e),this.homeDataCache.removeDocument(e);let n=this.documents.findIndex(i=>i.id===e);n>=0&&this.documents.splice(n,1),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.cdr.detectChanges()}catch{this.snackbar.showError("\uD30C\uC77C \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onFileMoveClick(){return C(this,null,function*(){if(this.selectedFileItem){this.fileSheetState="collapsed",this.selectedFilesForMove=[this.selectedFileItem],this.availableFolders=yield this.indexedDbService.getFolders(null);for(let t of this.availableFolders){let e=yield this.indexedDbService.getFolderDocumentCount(t.id);t.fileCount=e}this.selectedMoveTargetFolderId=null,this.fileMoveSheetState="full"}})}onFileMoveSheetStateChange(t){this.fileMoveSheetState=t,t==="collapsed"&&(this.selectedFilesForMove=[],this.selectedMoveTargetFolderId=null)}closeFileMoveSheet(){this.fileMoveSheetState="collapsed",this.selectedFilesForMove=[],this.selectedMoveTargetFolderId=null}onSelectMoveFolder(t){this.selectedMoveTargetFolderId=t}onFileMoveConfirm(){return C(this,null,function*(){if(!(!this.selectedMoveTargetFolderId||this.selectedFilesForMove.length===0))try{this.loadingService.showSpinner("\uD30C\uC77C\uC744 \uC774\uB3D9\uD558\uB294 \uC911...");for(let n of this.selectedFilesForMove)yield this.indexedDbService.moveDocumentToFolder(n.id,this.selectedMoveTargetFolderId),this.homeDataCache.moveDocument(n.id,this.selectedMoveTargetFolderId);let e=this.availableFolders.find(n=>n.id===this.selectedMoveTargetFolderId)?.name||"\uC120\uD0DD\uD55C \uD3F4\uB354";this.loadingService.hide(),this.snackbar.showSuccess(`${this.selectedFilesForMove.length}\uAC1C \uD30C\uC77C\uC774 "${e}"\uB85C \uC774\uB3D9\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),this.closeFileMoveSheet(),this.homeDataCache.invalidate(),yield this.loadFoldersAndFiles()}catch{this.loadingService.hide(),this.snackbar.showError("\uD30C\uC77C \uC774\uB3D9\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onFilesAdded(t){return C(this,null,function*(){console.log("[onFilesAdded] FAB\uC5D0\uC11C \uD30C\uC77C \uCD94\uAC00\uB428:",t.length);let e=t.map(n=>n.id).filter(n=>n);e.length>0&&(this.loadingDocIds=new Set([...this.loadingDocIds,...e]),console.log("[onFilesAdded] loadingDocIds \uCD94\uAC00:",e)),yield this.loadFoldersAndFiles(),this.cdr.detectChanges()})}closeAddFileSheet(){this.addFileSheetState="collapsed"}onAddFileSheetStateChange(t){this.addFileSheetState=t}onSortClick(){this.sortSheetState="full"}onSortSheetStateChange(t){this.sortSheetState=t}closeSortSheet(){this.sortSheetState="collapsed"}onSortApply(t){this.sortCriteria=t.criteria,this.sortOrder=t.order,this.applySorting()}applySorting(){this.documents=[...this.documents].sort((t,e)=>{let n=0,i=t.fileName||t.title,s=e.fileName||e.title;switch(this.sortCriteria){case"title":n=i.localeCompare(s,"ko");break;case"type":let d=i.split(".").pop()||"",_=s.split(".").pop()||"";n=d.localeCompare(_);break;case"date":let v=t.updatedAt?new Date(t.updatedAt).getTime():t.createdAt?new Date(t.createdAt).getTime():0,w=e.updatedAt?new Date(e.updatedAt).getTime():e.createdAt?new Date(e.createdAt).getTime():0;n=v-w;break;case"size":n=(t.fileSize||0)-(e.fileSize||0);break}return this.sortOrder==="asc"?n:-n})}onAddFileOptionSelected(t){return C(this,null,function*(){switch(this.addFileSheetState="collapsed",t){case"file":yield this.uploadFile();break;case"folder":this.onAddFolderClick();break}})}uploadFile(){return C(this,null,function*(){yield this.filePicker.pick({multiple:!0,accept:je.getAcceptString("pdf"),onFilesSelected:t=>C(this,null,function*(){if(t.length===0){this.snackbar.showWarning("\uC120\uD0DD\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=t.reduce((i,s)=>i+s.size,0)>5*1024*1024||t.length>3;n?this.loadingService.showSpinner(`\uD30C\uC77C \uC5C5\uB85C\uB4DC \uC911... (0/${t.length})`):this.snackbar.showInfo(`${t.length}\uAC1C \uD30C\uC77C \uC5C5\uB85C\uB4DC \uC911...`);try{let i=[];for(let s=0;s<t.length;s++){let d=t[s];n&&this.loadingService.updateMessage(`\uD30C\uC77C \uC5C5\uB85C\uB4DC \uC911... (${s+1}/${t.length})
${d.name}`);let _=yield this.handleFileUploadToRoot(d);_&&(i.push(_),this.loadingDocIds=new Set([...this.loadingDocIds,_]),console.log("[Upload] loadingDocIds \uCD94\uAC00:",_,[...this.loadingDocIds]))}n&&this.loadingService.updateMessage("\uBAA9\uB85D \uAC31\uC2E0 \uC911..."),this.homeDataCache.invalidate(),yield this.loadFoldersAndFiles(),this.cdr.detectChanges(),this.generateThumbnailsForDocs(i),n&&this.loadingService.hide(),this.snackbar.showSuccess(`${t.length}\uAC1C \uD30C\uC77C\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}catch{this.loadingService.hide(),this.snackbar.showError("\uD30C\uC77C \uC5C5\uB85C\uB4DC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}}),onError:t=>{this.loadingService.hide(),this.snackbar.showError(t||"\uD30C\uC77C \uC5C5\uB85C\uB4DC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})})}handleFileUploadToRoot(t){return C(this,null,function*(){let e=t.size>10485760;try{let n=e?yield this.fileToBase64WithProgress(t,v=>{this.loadingService.updateMessage(`\uD30C\uC77C \uC77D\uB294 \uC911... ${v}%
${t.name}`)}):yield this.fileToBase64(t),i=t.name.split(".").pop()?.toLowerCase()||"",s=t.type==="application/pdf"||i==="pdf",d=this.generateDocumentId(),_={id:d,title:t.name.replace(/\.[^/.]+$/,""),fileName:t.name,pages:[],elementCount:0,version:"1.0",folderId:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:"viewer",fileSize:t.size};return s?_.pdfBase64=n:(_.originalFileData=n,_.mimeType=t.type),yield this.indexedDbService.saveDocument(_),d}catch(n){return console.error("\uD30C\uC77C \uC5C5\uB85C\uB4DC \uC2E4\uD328:",n),null}})}generateThumbnailsForDocs(t){return C(this,null,function*(){if(this.isDestroyed||t.length===0)return;let e=500;console.log("[Thumbnail-Upload] \uC0C8 \uD30C\uC77C \uC378\uB124\uC77C \uC0DD\uC131 \uC2DC\uC791:",t.length);for(let n of t){if(this.isDestroyed)return;let i=this.documents.find(d=>d.id===n);if(!i)continue;let s=Date.now();try{yield this.generateSingleThumbnailOptimized(i);let d=Date.now()-s;d<e&&(yield new Promise(v=>setTimeout(v,e-d)));let _=new Set(this.loadingDocIds);_.delete(n),this.loadingDocIds=_,this.cdr.detectChanges(),console.log("[Thumbnail-Upload] \uC644\uB8CC:",n)}catch(d){console.warn("[Thumbnail-Upload] \uC2E4\uD328:",n,d);let _=Date.now()-s;_<e&&(yield new Promise(w=>setTimeout(w,e-_)));let v=new Set(this.loadingDocIds);v.delete(n),this.loadingDocIds=v,this.cdr.detectChanges()}}console.log("[Thumbnail-Upload] \uBAA8\uB4E0 \uC378\uB124\uC77C \uC0DD\uC131 \uC644\uB8CC")})}generateMissingThumbnailsOptimized(){return C(this,null,function*(){if(this.isDestroyed)return;let t=2,e=300,n=this.documents.filter(i=>!i.thumbnail&&(!i.documentType||i.documentType==="viewer"||i.documentType==="editor"||i.documentType==="converted"||i.documentType==="page-numbered"));if(console.log("[Thumbnail-Home] \uC378\uB124\uC77C \uC5C6\uB294 \uBB38\uC11C \uC218:",n.length),n.length!==0)for(let i=0;i<n.length;i+=t){if(this.isDestroyed)return;let s=n.slice(i,i+t);for(let d of s){if(this.isDestroyed)return;let _=this.loadingDocIds.has(d.id),v=Date.now();try{if(yield this.generateSingleThumbnailOptimized(d),_){let w=Date.now()-v;w<500&&(yield new Promise(M=>setTimeout(M,500-w)))}}catch(w){if(console.warn("[Thumbnail-Home] \uC2E4\uD328:",d.id,w),this.loadingDocIds.has(d.id)){let M=new Set(this.loadingDocIds);M.delete(d.id),this.loadingDocIds=M,this.cdr.detectChanges()}}}i+t<n.length&&(yield new Promise(d=>setTimeout(d,e)))}})}generateSingleThumbnailOptimized(t){return C(this,null,function*(){let e=null,n=null;try{let i=yield this.indexedDbService.getDocumentPdfData(t.id);if(!i){console.log("[Thumbnail-Home] PDF \uB370\uC774\uD130 \uC5C6\uC74C:",t.id);return}let s=i.includes(",")?i.split(",")[1]:i,d=Uint8Array.from(atob(s),I=>I.charCodeAt(0)),_=new Blob([d],{type:"application/pdf"});e=URL.createObjectURL(_),n=yield this.pdfjsLibService.getDocument(e);let v=yield n.getPage(1),w=v.getViewport({scale:1}),M=100,O=Math.min(M/w.width,M/w.height),E=v.getViewport({scale:O}),D=document.createElement("canvas");D.width=E.width,D.height=E.height;let T=D.getContext("2d");if(T){yield v.render({canvasContext:T,viewport:E}).promise;let I=D.toDataURL("image/jpeg",.5);if(yield this.indexedDbService.updateDocumentThumbnail(t.id,I),!this.isDestroyed){if(t.thumbnail=I,this.documents=[...this.documents],this.loadingDocIds.has(t.id)){let z=new Set(this.loadingDocIds);z.delete(t.id),this.loadingDocIds=z}this.cdr.detectChanges(),console.log("[Thumbnail-Home] \uC644\uB8CC:",t.id)}}}finally{if(n)try{yield n.destroy()}catch{}e&&URL.revokeObjectURL(e)}})}static \u0275fac=function(e){return new(e||r)(V(N))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-main"]],standalone:!1,decls:51,vars:28,consts:[[3,"menuClick"],[3,"close","isOpen"],[1,"main-content"],[1,"folder-section"],[1,"section-header"],[1,"section-title"],[1,"add-btn",3,"click"],["src","images/icons/btn-new-folder.svg","alt","\uCD94\uAC00","width","20","height","20"],["type","folder",3,"count",4,"ngIf"],["class","folder-list",4,"ngIf"],[1,"file-section"],[1,"sort-btn",3,"click"],["src","images/icons/btn-list-filter.svg","alt","\uC815\uB82C","width","20","height","20"],["type","file",3,"count",4,"ngIf"],["class","file-list-viewport",3,"itemSize",4,"ngIf"],["class","empty-state",4,"ngIf"],[3,"filesAdded","folderId","autoOpen","multiple"],[3,"activeTab"],[3,"isOpenChange","confirm","cancel","isOpen","title","placeholder","initialValue"],[3,"sheetStateChange","close","sheetState"],["class","item-sheet-content",4,"ngIf"],["class","file-move-sheet",4,"ngIf"],[1,"bottom-sheet-header"],[1,"bottom-sheet-title"],[1,"bottom-sheet-content"],[1,"import-option-single"],[1,"import-option-card",3,"click"],[1,"import-option-icon","file-icon"],["src","images/icons/ico-myfile.svg","alt","\uD30C\uC77C","width","40","height","40"],[1,"import-option-label"],[1,"divider"],[1,"option-list"],[1,"option-item",3,"click"],[1,"option-icon"],["src","images/icons/ico-myfile.svg","alt","\uD3F4\uB354","width","24","height","24"],[1,"option-label"],[3,"sheetStateChange","sortApply","close","sheetState","criteria","order"],["type","folder",3,"count"],[1,"folder-list"],["class","folder-item",3,"click",4,"ngFor","ngForOf"],[1,"folder-item",3,"click"],[1,"folder-icon"],["src","images/icons/ico-folder.svg","alt","\uD3F4\uB354","width","24","height","24"],[1,"folder-info"],[1,"folder-name"],["class","folder-date",4,"ngIf"],[1,"more-btn",3,"click"],["src","images/icons/btn-more-main.svg","alt","\uB354\uBCF4\uAE30","width","20","height","20"],[1,"folder-date"],["type","file",3,"count"],[1,"file-list-viewport",3,"itemSize"],["class","file-item",3,"click",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],[1,"file-item",3,"click"],[1,"file-icon"],["class","thumbnail-shimmer",4,"ngIf"],["class","encrypted-icon",4,"ngIf"],["alt","PDF \uC378\uB124\uC77C","class","file-thumbnail","loading","lazy",3,"src",4,"ngIf"],["class","pdf-icon",4,"ngIf"],[1,"file-info"],[1,"file-name"],[1,"file-meta"],[1,"file-date"],["class","file-size",4,"ngIf"],[1,"favorite-btn",3,"click"],["alt","\uC990\uACA8\uCC3E\uAE30","width","20","height","20",3,"src"],[1,"thumbnail-shimmer"],[1,"shimmer-animation"],[1,"encrypted-icon"],["src","images/icons/ico-tool-main-password.svg","alt","\uC554\uD638\uD654","width","32","height","40"],["alt","PDF \uC378\uB124\uC77C","loading","lazy",1,"file-thumbnail",3,"src"],[1,"pdf-icon"],["src","images/icons/ico-pdf.svg","alt","PDF","width","32","height","40"],[1,"file-size"],[1,"empty-state"],["src","images/icons/ico-pdf.svg","alt","\uD30C\uC77C \uC5C6\uC74C","width","64","height","64"],[1,"empty-text"],[1,"item-sheet-content"],[1,"sheet-header"],[1,"sheet-title"],[1,"sheet-options"],[1,"sheet-option",3,"click"],["src","images/icons/btn-top-edit.svg","alt","\uC774\uB984 \uBCC0\uACBD","width","24","height","24"],[1,"sheet-option","danger",3,"click"],["src","images/icons/ico-tool-cut.svg","alt","\uC0AD\uC81C","width","24","height","24"],["src","images/icons/ico-share.svg","alt","\uACF5\uC720","width","24","height","24"],["src","images/icons/ico-folder.svg","alt","\uD30C\uC77C \uC774\uB3D9","width","24","height","24"],[1,"file-move-sheet"],[1,"file-move-header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","20","height","20"],[1,"file-move-title"],[1,"folder-list-container"],["class","folder-select-item",3,"selected","click",4,"ngFor","ngForOf"],["class","empty-folders",4,"ngIf"],[1,"file-move-footer"],[1,"selected-count"],[1,"move-btn",3,"click","disabled"],[1,"folder-select-item",3,"click"],[1,"folder-select-check"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","24","height","24",4,"ngIf"],["class","empty-check",4,"ngIf"],[1,"folder-select-icon"],[1,"folder-select-info"],[1,"folder-select-name"],[1,"folder-select-date"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","24","height","24"],[1,"empty-check"],[1,"empty-folders"]],template:function(e,n){e&1&&(o(0,"ez-reader-mobile-header",0),u("menuClick",function(){return n.onMenuClick()}),a(),o(1,"ez-reader-mobile-side-menu",1),u("close",function(){return n.onSideMenuClose()}),a(),o(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5),c(6,"\uD3F4\uB354"),a(),o(7,"button",6),u("click",function(){return n.onAddFolderClick()}),h(8,"img",7),a()(),b(9,la,1,1,"ez-shimmer-skeleton",8)(10,pa,2,1,"div",9),a(),o(11,"div",10)(12,"div",4)(13,"span",5),c(14,"\uD30C\uC77C"),a(),o(15,"button",11),u("click",function(){return n.onSortClick()}),h(16,"img",12),a()(),b(17,ga,1,1,"ez-shimmer-skeleton",13)(18,ba,2,3,"cdk-virtual-scroll-viewport",14)(19,va,4,0,"div",15),a()(),o(20,"ez-reader-mobile-fab",16),u("filesAdded",function(s){return n.onFilesAdded(s)}),a(),h(21,"ez-reader-mobile-bottom-nav",17),o(22,"app-input-dialog",18),$("isOpenChange",function(s){return U(n.showFolderDialog,s)||(n.showFolderDialog=s),s}),u("confirm",function(s){return n.onFolderDialogConfirm(s)})("cancel",function(){return n.onFolderDialogCancel()}),a(),o(23,"app-input-dialog",18),$("isOpenChange",function(s){return U(n.showFileRenameDialog,s)||(n.showFileRenameDialog=s),s}),u("confirm",function(s){return n.onFileRenameDialogConfirm(s)})("cancel",function(){return n.onFileRenameDialogCancel()}),a(),o(24,"app-bottom-sheet",19),u("sheetStateChange",function(s){return n.onFolderSheetStateChange(s)})("close",function(){return n.closeFolderSheet()}),b(25,xa,13,1,"div",20),a(),o(26,"app-bottom-sheet",19),u("sheetStateChange",function(s){return n.onFileSheetStateChange(s)})("close",function(){return n.closeFileSheet()}),b(27,Pa,21,1,"div",20),a(),o(28,"app-bottom-sheet",19),u("sheetStateChange",function(s){return n.onFileMoveSheetStateChange(s)})("close",function(){return n.closeFileMoveSheet()}),b(29,Oa,14,4,"div",21),a(),o(30,"app-bottom-sheet",19),u("sheetStateChange",function(s){return n.onAddFileSheetStateChange(s)})("close",function(){return n.closeAddFileSheet()}),o(31,"div",22)(32,"h3",23),c(33,"PDF \uD30C\uC77C\uC744 \uC5F4\uC5B4\uBCF4\uC138\uC694."),a()(),o(34,"div",24)(35,"div",25)(36,"button",26),u("click",function(){return n.onAddFileOptionSelected("file")}),o(37,"div",27),h(38,"img",28),a(),o(39,"span",29),c(40,"\uD30C\uC77C"),a()()(),h(41,"div",30),o(42,"div",31)(43,"button",32),u("click",function(){return n.onAddFileOptionSelected("folder")}),o(44,"div",33),h(45,"img",34),a(),o(46,"span",35),c(47,"\uD3F4\uB354 \uB9CC\uB4E4\uAE30"),a()()()()(),o(48,"ez-sort-bottom-sheet",36),u("sheetStateChange",function(s){return n.onSortSheetStateChange(s)})("sortApply",function(s){return n.onSortApply(s)})("close",function(){return n.closeSortSheet()}),a(),h(49,"pdf-password-modal")(50,"ez-loading-overlay")),e&2&&(l(),p("isOpen",n.isSideMenuOpen),l(8),p("ngIf",n.isDataLoading),l(),p("ngIf",!n.isDataLoading&&n.folderItems.length>0),l(7),p("ngIf",n.isDataLoading),l(),p("ngIf",!n.isDataLoading&&n.fileItems.length>0),l(),p("ngIf",!n.isDataLoading&&n.fileItems.length===0),l(),p("folderId",null)("autoOpen",!0)("multiple",!1),l(),p("activeTab",n.currentActiveTab),l(),j("isOpen",n.showFolderDialog),p("title",n.folderDialogTitle)("placeholder","\uD3F4\uB354 \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694")("initialValue",n.folderDialogInitialValue),l(),j("isOpen",n.showFileRenameDialog),p("title","\uD30C\uC77C \uC774\uB984 \uBCC0\uACBD")("placeholder","\uD30C\uC77C \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694")("initialValue",n.fileRenameDialogInitialValue),l(),p("sheetState",n.folderSheetState),l(),p("ngIf",n.selectedFolderItem),l(),p("sheetState",n.fileSheetState),l(),p("ngIf",n.selectedFileItem),l(),p("sheetState",n.fileMoveSheetState),l(),p("ngIf",n.fileMoveSheetState!=="collapsed"),l(),p("sheetState",n.addFileSheetState),l(18),p("sheetState",n.sortSheetState)("criteria",n.sortCriteria)("order",n.sortOrder))},dependencies:[oe,B,Po,yo,Mo,Pe,bt,vt,xt,tt,Pt,it,Ot,Et,kt,Oe],styles:['.header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fff;border-bottom:1px solid #e0e0e0;display:flex;align-items:center;justify-content:space-between;padding-left:16px;padding-right:16px;z-index:100;box-sizing:border-box}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.header-left[_ngcontent-%COMP%]   .header-logo[_ngcontent-%COMP%]{height:15px;width:auto;object-fit:contain}.header-left[_ngcontent-%COMP%]   .header-logo-icon[_ngcontent-%COMP%]{height:28px;width:28px;object-fit:contain}.header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.icon-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#666;display:flex;align-items:center;justify-content:center;border-radius:50%}.icon-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.icon-btn.logout-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#666}.icon-btn.logout-btn[_ngcontent-%COMP%]:active{background:#ffebee}.icon-btn.logout-btn[_ngcontent-%COMP%]:active   svg[_ngcontent-%COMP%]{color:#d32f2f}.points-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;background:#fff;border-radius:4px;cursor:pointer;transition:background .2s}.points-display[_ngcontent-%COMP%]:active{background:#f5f5f5}.points-display[_ngcontent-%COMP%]   .points-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;background:#f44;border-radius:50%;color:#fff;font-size:11px;font-weight:700}.points-display[_ngcontent-%COMP%]   .points-value[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#333;white-space:nowrap}.login-btn[_ngcontent-%COMP%]{padding:6px 16px;background:#fff;border:1px solid #ff4444;border-radius:20px;color:#f44;font-size:13px;font-weight:500;cursor:pointer;white-space:nowrap;transition:all .2s}.login-btn[_ngcontent-%COMP%]:active{background:#fff5f5;border-color:#f22;color:#f22}.user-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;overflow:hidden;cursor:pointer;display:flex;align-items:center;justify-content:center;background:#4285f4;transition:opacity .2s}.user-avatar[_ngcontent-%COMP%]:active{opacity:.8}.user-avatar[_ngcontent-%COMP%]   .avatar-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.user-avatar[_ngcontent-%COMP%]   .avatar-text[_ngcontent-%COMP%]{color:#fff;font-size:14px;font-weight:600;-webkit-user-select:none;user-select:none}.main-content[_ngcontent-%COMP%]{padding-top:calc(56px + var(--android-status-bar-height, 0px));padding-bottom:calc(80px + var(--android-navigation-bar-height, 0px))}.folder-section[_ngcontent-%COMP%]{background:#fff;padding:0 16px;margin-bottom:8px}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 0 8px}.section-header[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333}.section-header[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%], .section-header[_ngcontent-%COMP%]   .sort-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#666;display:flex;align-items:center;justify-content:center;border-radius:50%}.section-header[_ngcontent-%COMP%]   .add-btn[_ngcontent-%COMP%]:active, .section-header[_ngcontent-%COMP%]   .sort-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.folder-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:320px;overflow-y:auto}.folder-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.folder-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;border-radius:2px}.folder-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid #f0f0f0;cursor:pointer}.folder-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.folder-item[_ngcontent-%COMP%]:active{background:#f8f9fa}.folder-item[_ngcontent-%COMP%]   .folder-icon[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.folder-item[_ngcontent-%COMP%]   .folder-info[_ngcontent-%COMP%]{flex:1;min-width:0}.folder-item[_ngcontent-%COMP%]   .folder-info[_ngcontent-%COMP%]   .folder-name[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.folder-item[_ngcontent-%COMP%]   .folder-info[_ngcontent-%COMP%]   .folder-date[_ngcontent-%COMP%]{font-size:12px;color:#999;margin-top:2px}.folder-item[_ngcontent-%COMP%]   .more-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#999;display:flex;align-items:center;justify-content:center;flex-shrink:0}.folder-item[_ngcontent-%COMP%]   .more-btn[_ngcontent-%COMP%]:active{color:#666}.file-section[_ngcontent-%COMP%]{background:#fff;padding:0 16px}.file-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:80px}.file-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid #f0f0f0;cursor:pointer}.file-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.file-item[_ngcontent-%COMP%]:active{background:#f8f9fa}.file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]{width:48px;height:56px;display:flex;align-items:center;justify-content:center;flex-shrink:0;background:#f5f5f5;border-radius:4px;overflow:hidden}.file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-thumbnail[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .pdf-icon[_ngcontent-%COMP%], .file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .encrypted-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{flex:1;min-width:0}.file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-meta[_ngcontent-%COMP%]{font-size:12px;color:#999;margin-top:2px}.file-item[_ngcontent-%COMP%]   .favorite-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;margin-right:-4px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0}.file-item[_ngcontent-%COMP%]   .favorite-btn.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:#ef5350}.file-item[_ngcontent-%COMP%]   .favorite-btn[_ngcontent-%COMP%]:active{transform:scale(1.1)}.file-item[_ngcontent-%COMP%]   .more-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#999;display:flex;align-items:center;justify-content:center;flex-shrink:0}.file-item[_ngcontent-%COMP%]   .more-btn[_ngcontent-%COMP%]:active{color:#666}.file-list-viewport[_ngcontent-%COMP%]{height:calc(100vh - 300px);min-height:300px;width:100%;overflow-x:hidden}.file-list-viewport[_ngcontent-%COMP%]     .cdk-virtual-scroll-content-wrapper{width:100%;padding-bottom:80px}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;border-bottom:1px solid #f5f5f5;cursor:pointer;transition:background .2s;height:72px;box-sizing:border-box}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]:active{background:#f9f9f9}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]{width:48px;height:56px;flex-shrink:0;background:#f5f5f5;border-radius:4px;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-thumbnail[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .thumbnail-shimmer[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#e0e0e0;overflow:hidden}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .thumbnail-shimmer[_ngcontent-%COMP%]   .shimmer-animation[_ngcontent-%COMP%]{width:100%;height:100%;background:linear-gradient(90deg,#e0e0e0,#f0f0f0,#e0e0e0);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{flex:1 1 0;min-width:0;overflow:hidden}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-meta[_ngcontent-%COMP%]{font-size:12px;color:#999;margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .favorite-btn[_ngcontent-%COMP%]{width:32px;height:32px;min-width:32px;flex-shrink:0;background:none;border:none;padding:4px;cursor:pointer;display:flex;align-items:center;justify-content:center}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .favorite-btn[_ngcontent-%COMP%]:active{transform:scale(1.1)}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .more-btn[_ngcontent-%COMP%]{width:32px;height:32px;min-width:32px;flex-shrink:0;background:none;border:none;padding:4px;margin-right:-8px;cursor:pointer;display:flex;align-items:center;justify-content:center}.file-list-viewport[_ngcontent-%COMP%]   .file-item[_ngcontent-%COMP%]   .more-btn[_ngcontent-%COMP%]:active{opacity:.7}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 20px}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   .empty-text[_ngcontent-%COMP%]{font-size:15px;color:#999;text-align:center}.fab-button[_ngcontent-%COMP%]{position:fixed;right:20px;bottom:calc(80px + var(--android-navigation-bar-height, 0px));width:auto;height:auto;border:none;background:transparent;padding:0;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:50;transition:all .2s}.fab-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block}.fab-button[_ngcontent-%COMP%]:active{transform:scale(.95)}.import-option-single[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:20px 0}.import-option-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;padding:16px 24px;background:#f8f9fa;border:2px solid #e0e0e0;border-radius:12px;cursor:pointer;transition:all .2s}.import-option-card[_ngcontent-%COMP%]:active{background:#f0f0f0;border-color:#ccc}.import-option-card[_ngcontent-%COMP%]   .import-option-icon[_ngcontent-%COMP%]{width:48px;height:48px;display:flex;align-items:center;justify-content:center}.import-option-card[_ngcontent-%COMP%]   .import-option-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333}.divider[_ngcontent-%COMP%]{height:1px;background:#e0e0e0;margin:0 20px}.bottom-sheet-header[_ngcontent-%COMP%]{padding:20px 20px 10px}.bottom-sheet-header[_ngcontent-%COMP%]   .bottom-sheet-title[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#333}.bottom-sheet-header[_ngcontent-%COMP%]   .bottom-sheet-subtitle[_ngcontent-%COMP%]{margin:8px 0 0;font-size:14px;color:#666;font-weight:400}.bottom-sheet-content[_ngcontent-%COMP%]{padding:10px 20px 30px}.option-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:0}.option-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;background:none;border:none;border-bottom:1px solid #f0f0f0;cursor:pointer;text-align:left;transition:background .2s}.option-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.option-item[_ngcontent-%COMP%]:active{background:#f5f5f5}.option-item[_ngcontent-%COMP%]   .option-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;background:#f5f5f5;color:#007acc;flex-shrink:0}.option-item[_ngcontent-%COMP%]   .option-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}.option-item[_ngcontent-%COMP%]   .option-label[_ngcontent-%COMP%]{font-size:16px;color:#333;font-weight:500}.convert-options-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px}.convert-option-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;padding:20px 12px;background:#fff;border:2px solid #e0e0e0;border-radius:12px;cursor:pointer;transition:all .2s;text-align:center}.convert-option-card[_ngcontent-%COMP%]:active{background:#f8f9fa;border-color:#2196f3;transform:scale(.98)}.convert-option-card[_ngcontent-%COMP%]   .option-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:48px;height:48px;border-radius:12px;background:#00000008;margin-bottom:4px}.convert-option-card[_ngcontent-%COMP%]   .option-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:32px;height:32px}.convert-option-card[_ngcontent-%COMP%]   .option-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.convert-option-card[_ngcontent-%COMP%]   .option-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#333;line-height:1.2}.convert-option-card[_ngcontent-%COMP%]   .option-description[_ngcontent-%COMP%]{font-size:12px;color:#999;line-height:1.2}.convert-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px;background:#f8f9fa;border-radius:8px}.convert-info[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.convert-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;color:#666;line-height:1.4}.item-sheet-content[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]{padding:20px;border-bottom:1px solid #e5e7eb}.item-sheet-content[_ngcontent-%COMP%]   .sheet-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#222;margin:0;text-align:center}.item-sheet-content[_ngcontent-%COMP%]   .sheet-options[_ngcontent-%COMP%]{padding:8px 0}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]{width:100%;padding:16px 20px;background:none;border:none;display:flex;align-items:center;gap:16px;cursor:pointer;font-size:16px;color:#333;transition:background .2s ease}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]:active{background:#f3f4f6}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option.danger[_ngcontent-%COMP%]{color:#ef5350}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%], .item-sheet-content[_ngcontent-%COMP%]   .sheet-option.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   line[_ngcontent-%COMP%]{stroke:#ef5350!important}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;text-align:left}.sort-sheet-content[_ngcontent-%COMP%]{padding:20px}.sort-sheet-content[_ngcontent-%COMP%]   .sort-sheet-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin-bottom:16px}.sort-sheet-content[_ngcontent-%COMP%]   .sort-options[_ngcontent-%COMP%]{display:flex;flex-direction:column}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:14px 0;cursor:pointer}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-size:15px;color:#333}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]   .radio-mark[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid #ddd;border-radius:50%;position:relative;flex-shrink:0}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + .radio-mark[_ngcontent-%COMP%]{border-color:#ef5350}.sort-sheet-content[_ngcontent-%COMP%]   .sort-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + .radio-mark[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:10px;height:10px;background:#ef5350;border-radius:50%}.sort-sheet-content[_ngcontent-%COMP%]   .sort-divider[_ngcontent-%COMP%]{height:1px;background:#eee;margin:8px 0}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:20px}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:14px;border-radius:8px;font-size:15px;font-weight:500;cursor:pointer}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:#f5f5f5;border:none;color:#666}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:active{background:#e8e8e8}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{background:#ef5350;border:none;color:#fff}.sort-sheet-content[_ngcontent-%COMP%]   .sort-buttons[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:active{background:#e53935}.file-move-sheet[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:70vh}.file-move-sheet[_ngcontent-%COMP%]   .file-move-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:16px;border-bottom:1px solid #eee}.file-move-sheet[_ngcontent-%COMP%]   .file-move-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:none;border:none;padding:4px;cursor:pointer;display:flex;align-items:center;justify-content:center}.file-move-sheet[_ngcontent-%COMP%]   .file-move-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:active{opacity:.7}.file-move-sheet[_ngcontent-%COMP%]   .file-move-header[_ngcontent-%COMP%]   .file-move-title[_ngcontent-%COMP%]{font-size:17px;font-weight:600;color:#333;margin:0}.file-move-sheet[_ngcontent-%COMP%]   .folder-list-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px 0}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;cursor:pointer;transition:background .2s}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]:active, .file-move-sheet[_ngcontent-%COMP%]   .folder-select-item.selected[_ngcontent-%COMP%]{background:#f0f8ff}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-check[_ngcontent-%COMP%]{width:24px;height:24px;display:flex;align-items:center;justify-content:center}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-check[_ngcontent-%COMP%]   .empty-check[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid #ddd;border-radius:50%}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-icon[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:#f5f5f5;border-radius:8px}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-info[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:2px}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-info[_ngcontent-%COMP%]   .folder-select-name[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-info[_ngcontent-%COMP%]   .folder-select-date[_ngcontent-%COMP%]{font-size:12px;color:#999}.file-move-sheet[_ngcontent-%COMP%]   .empty-folders[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:40px 20px}.file-move-sheet[_ngcontent-%COMP%]   .empty-folders[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#999;font-size:14px}.file-move-sheet[_ngcontent-%COMP%]   .file-move-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-top:1px solid #eee;background:#fff}.file-move-sheet[_ngcontent-%COMP%]   .file-move-footer[_ngcontent-%COMP%]   .selected-count[_ngcontent-%COMP%]{font-size:14px;color:#666}.file-move-sheet[_ngcontent-%COMP%]   .file-move-footer[_ngcontent-%COMP%]   .move-btn[_ngcontent-%COMP%]{background:#ddd;border:none;padding:12px 32px;border-radius:8px;font-size:15px;font-weight:500;color:#999;cursor:not-allowed;transition:all .2s}.file-move-sheet[_ngcontent-%COMP%]   .file-move-footer[_ngcontent-%COMP%]   .move-btn[_ngcontent-%COMP%]:not(:disabled){background:#2196f3;color:#fff;cursor:pointer}.file-move-sheet[_ngcontent-%COMP%]   .file-move-footer[_ngcontent-%COMP%]   .move-btn[_ngcontent-%COMP%]:not(:disabled):active{background:#1976d2}']})};var hr=()=>[];function Ea(r,t){r&1&&(ve(),o(0,"g"),h(1,"path",11)(2,"path",12),a())}function ka(r,t){r&1&&(ve(),o(0,"g"),h(1,"circle",13)(2,"path",14),a())}function Da(r,t){r&1&&(ve(),o(0,"g"),h(1,"path",15),a())}function Ia(r,t){r&1&&(ve(),o(0,"g"),h(1,"path",16)(2,"path",17),a())}function Ta(r,t){r&1&&(ve(),o(0,"g"),h(1,"path",18)(2,"circle",19),a())}function Aa(r,t){r&1&&(ve(),o(0,"g"),h(1,"circle",19)(2,"path",20),a())}function Fa(r,t){r&1&&(ve(),o(0,"g"),h(1,"rect",21)(2,"path",22),a())}function za(r,t){if(r&1){let e=y();o(0,"button",7),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.onMenuClick(i.id))}),ve(),o(1,"svg",8),re(2,9),b(3,Ea,3,0,"g",10)(4,ka,3,0,"g",10)(5,Da,2,0,"g",10)(6,Ia,3,0,"g",10)(7,Ta,3,0,"g",10)(8,Aa,3,0,"g",10)(9,Fa,3,0,"g",10),ae(),a()()}if(r&2){let e=t.$implicit,n=g(2);k("disabled",e.id==="element-properties"&&!n.selectedElement||n.isPdfViewer&&e.id!=="pdf-analysis")("hidden",n.hideElementProperties&&e.id==="element-properties"),Be("aria-label",e.title),l(2),p("ngSwitch",e.icon),l(),p("ngSwitchCase","edit"),l(),p("ngSwitchCase","search"),l(),p("ngSwitchCase","folder"),l(),p("ngSwitchCase","file"),l(),p("ngSwitchCase","eye"),l(),p("ngSwitchCase","settings"),l(),p("ngSwitchCase","form")}}function Ra(r,t){if(r&1&&(o(0,"div",5),b(1,za,10,13,"button",6),a()),r&2){let e=g();l(),p("ngForOf",e.menuGroups)}}function Ba(r,t){r&1&&(ve(),o(0,"g"),h(1,"path",11)(2,"path",12),a())}function Va(r,t){r&1&&(ve(),o(0,"g"),h(1,"circle",13)(2,"path",14),a())}function La(r,t){r&1&&(ve(),o(0,"g"),h(1,"path",15),a())}function Na(r,t){r&1&&(ve(),o(0,"g"),h(1,"path",16)(2,"path",17),a())}function ja(r,t){r&1&&(ve(),o(0,"g"),h(1,"path",18)(2,"circle",19),a())}function Ua(r,t){r&1&&(ve(),o(0,"g"),h(1,"circle",19)(2,"path",20),a())}function $a(r,t){r&1&&(ve(),o(0,"g"),h(1,"rect",21)(2,"path",22),a())}function Ha(r,t){if(r&1){let e=y();o(0,"div",28),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.onMenuClick(i.id))}),o(1,"div",29),ve(),o(2,"svg",30),re(3,9),b(4,Ba,3,0,"g",10)(5,Va,3,0,"g",10)(6,La,2,0,"g",10)(7,Na,3,0,"g",10)(8,ja,3,0,"g",10)(9,Ua,3,0,"g",10)(10,$a,3,0,"g",10),ae(),a()(),Vt(),o(11,"div",31)(12,"div",32),c(13),a(),o(14,"div",33),c(15),a()(),o(16,"div",34),c(17,"\u203A"),a()()}if(r&2){let e=t.$implicit,n=g(2);k("disabled",e.id==="element-properties"&&!n.selectedElement||n.isPdfViewer&&e.id!=="pdf-analysis")("hidden",n.hideElementProperties&&e.id==="element-properties"),l(3),p("ngSwitch",e.icon),l(),p("ngSwitchCase","edit"),l(),p("ngSwitchCase","search"),l(),p("ngSwitchCase","folder"),l(),p("ngSwitchCase","file"),l(),p("ngSwitchCase","eye"),l(),p("ngSwitchCase","settings"),l(),p("ngSwitchCase","form"),l(3),x(e.title),l(2),S(" ",e.id==="element-properties"?n.selectedElement?n.getElementTypeName(n.selectedElement.type)+" \uC120\uD0DD\uB428":"\uC120\uD0DD\uB41C \uC694\uC18C \uC5C6\uC74C":e.items.length+"\uAC1C \uD56D\uBAA9"," ")}}function Wa(r,t){if(r&1){let e=y();o(0,"div",23)(1,"div",24)(2,"h3"),c(3,"PDF \uB3C4\uAD6C"),a(),o(4,"button",25),u("click",function(){m(e);let i=g();return f(i.closeSheet())}),c(5,"\xD7"),a()(),o(6,"div",26),b(7,Ha,18,14,"div",27),a()()}if(r&2){let e=g();l(7),p("ngForOf",e.menuGroups)}}function Ka(r,t){if(r&1){let e=y();o(0,"div",39)(1,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddText())}),o(2,"span",41),c(3,"\u{1F4DD}"),a(),o(4,"span",42),c(5,"\uD14D\uC2A4\uD2B8 \uCD94\uAC00"),a()(),o(6,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddImage())}),o(7,"span",41),c(8,"\u{1F5BC}\uFE0F"),a(),o(9,"span",42),c(10,"\uC774\uBBF8\uC9C0 \uCD94\uAC00"),a()(),o(11,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddShape())}),o(12,"span",41),c(13,"\u25FC\uFE0F"),a(),o(14,"span",42),c(15,"\uB3C4\uD615 \uCD94\uAC00"),a()(),o(16,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddSignature())}),o(17,"span",41),c(18,"\u270D\uFE0F"),a(),o(19,"span",42),c(20,"\uC11C\uBA85 \uCD94\uAC00"),a()(),o(21,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddWatermark())}),o(22,"span",41),c(23,"\u{1F4A7}"),a(),o(24,"span",42),c(25,"\uC6CC\uD130\uB9C8\uD06C"),a()(),o(26,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddVectorPath())}),o(27,"span",41),c(28,"\u{1F4D0}"),a(),o(29,"span",42),c(30,"\uBCA1\uD130 \uACBD\uB85C"),a()()()}}function Ga(r,t){if(r&1){let e=y();o(0,"div",39)(1,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onSaveDocument())}),o(2,"span",41),c(3,"\u{1F4BE}"),a(),o(4,"span",42),c(5,"\uBB38\uC11C \uC800\uC7A5"),a()(),o(6,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onExportPdf())}),o(7,"span",41),c(8,"\u{1F4C4}"),a(),o(9,"span",42),c(10,"PDF \uB0B4\uBCF4\uB0B4\uAE30"),a()()()}}function Ya(r,t){if(r&1){let e=y();o(0,"div",39)(1,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddPage())}),o(2,"span",41),c(3,"\u2795"),a(),o(4,"span",42),c(5,"\uD398\uC774\uC9C0 \uCD94\uAC00"),a()(),o(6,"button",43),u("click",function(){m(e);let i=g(2);return f(i.onDeletePage())}),o(7,"span",41),c(8,"\u{1F5D1}\uFE0F"),a(),o(9,"span",42),c(10,"\uD398\uC774\uC9C0 \uC0AD\uC81C"),a()(),o(11,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onRotatePage())}),o(12,"span",41),c(13,"\u{1F504}"),a(),o(14,"span",42),c(15,"\uD398\uC774\uC9C0 \uD68C\uC804"),a()(),o(16,"div",44)(17,"label"),c(18,"\uD398\uC774\uC9C0 \uC120\uD0DD:"),a(),o(19,"input",45),u("change",function(i){m(e);let s=g(2);return f(s.onPageSelect(+i.target.value))}),a(),o(20,"span",46),c(21),a()()()}if(r&2){let e=g(2);l(6),p("disabled",e.totalPages<=1),l(13),p("value",e.currentPage)("min",1)("max",e.totalPages),l(2),S("/ ",e.totalPages)}}function qa(r,t){if(r&1){let e=y();o(0,"div",39)(1,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onZoomIn())}),o(2,"span",41),c(3,"\u{1F50D}"),a(),o(4,"span",42),c(5),a()(),o(6,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onZoomOut())}),o(7,"span",41),c(8,"\u{1F50E}"),a(),o(9,"span",42),c(10,"\uCD95\uC18C"),a()()()}if(r&2){let e=g(2);l(5),S("\uD655\uB300 (",e.zoomLevel,"%)")}}function Xa(r,t){if(r&1){let e=y();o(0,"div",39)(1,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddFormCheckbox())}),o(2,"span",41),c(3,"\u2611\uFE0F"),a(),o(4,"span",42),c(5,"\uCCB4\uD06C\uBC15\uC2A4 \uCD94\uAC00"),a()(),o(6,"p",47),c(7," \uD604\uC7AC \uD398\uC774\uC9C0 \uC911\uC559 \uBD80\uADFC\uC5D0 \uAE30\uBCF8 \uD06C\uAE30\uC758 \uCCB4\uD06C\uBC15\uC2A4\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4. "),a(),o(8,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddFormRadio())}),o(9,"span",41),c(10,"\u{1F518}"),a(),o(11,"span",42),c(12,"\uB77C\uB514\uC624 \uBC84\uD2BC \uCD94\uAC00"),a()(),o(13,"p",47),c(14," \uAC19\uC740 \uADF8\uB8F9 \uC774\uB984\uC744 \uACF5\uC720\uD558\uB294 \uB77C\uB514\uC624 \uBC84\uD2BC\uC740 \uB2E8\uC77C \uC120\uD0DD\uC73C\uB85C \uB3D9\uC791\uD569\uB2C8\uB2E4. "),a(),o(15,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddFormDropdown())}),o(16,"span",41),c(17,"v"),a(),o(18,"span",42),c(19,"\uB4DC\uB86D\uB2E4\uC6B4 \uCD94\uAC00"),a()(),o(20,"p",47),c(21," \uAE30\uBCF8 \uC635\uC158 3\uAC1C\uAC00 \uD3EC\uD568\uB41C \uC120\uD0DD \uC785\uB825 \uD544\uB4DC\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4. "),a(),o(22,"button",40),u("click",function(){m(e);let i=g(2);return f(i.onAddFormDateField())}),o(23,"span",41),c(24,"\u{1F4C5}"),a(),o(25,"span",42),c(26,"\uB0A0\uC9DC \uD544\uB4DC \uCD94\uAC00"),a()(),o(27,"p",47),c(28," \uAE30\uBCF8 \uD615\uC2DD(YYYY-MM-DD)\uC744 \uC0AC\uC6A9\uD558\uB294 \uB0A0\uC9DC \uC785\uB825 \uD544\uB4DC\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4. "),a()()}}function Ja(r,t){if(r&1){let e=y();o(0,"div",49)(1,"h4"),c(2,"\uD14D\uC2A4\uD2B8"),a(),o(3,"div",57)(4,"label"),c(5,"\uB0B4\uC6A9:"),a(),o(6,"textarea",58),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("text",i))}),a()(),o(7,"div",50)(8,"label"),c(9,"\uAE00\uAF34 \uD06C\uAE30:"),a(),o(10,"input",51),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("fontSize",i))}),a(),o(11,"span",52),c(12,"px"),a()(),o(13,"div",57)(14,"label"),c(15,"\uAE00\uAF34:"),a(),o(16,"select",59),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("fontFamily",i))}),o(17,"optgroup",60)(18,"option",61),c(19,"Noto Sans KR"),a(),o(20,"option",62),c(21,"\uB098\uB214\uACE0\uB515"),a()(),o(22,"optgroup",63)(23,"option",64),c(24,"Arial"),a(),o(25,"option",65),c(26,"Helvetica"),a()()()(),o(27,"div",50)(28,"label"),c(29,"\uC0C9\uC0C1:"),a(),o(30,"input",66),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("color",i))}),a()()()}if(r&2){let e=g(3);l(6),p("value",e.selectedElement.text),l(4),p("value",e.selectedElement.fontSize),l(6),p("value",e.selectedElement.fontFamily),l(14),p("value",e.selectedElement.color)}}function Za(r,t){if(r&1){let e=y();o(0,"div",49)(1,"h4"),c(2,"\uD3FC \uCCB4\uD06C\uBC15\uC2A4"),a(),o(3,"div",57)(4,"label"),c(5,"\uB808\uC774\uBE14"),a(),o(6,"input",67),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.label",i))}),a()(),o(7,"div",57)(8,"label"),c(9,"\uAE30\uBCF8 \uC0C1\uD0DC"),a(),o(10,"label",68)(11,"input",69),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.checked",i))}),a(),o(12,"span"),c(13),a()()()()}if(r&2){let e=g(3);l(6),p("value",(e.selectedElement.properties==null?null:e.selectedElement.properties.label)||""),l(5),p("checked",e.selectedElement.properties==null?null:e.selectedElement.properties.checked),l(2),x(e.selectedElement.properties!=null&&e.selectedElement.properties.checked?"\uC120\uD0DD\uB428":"\uC120\uD0DD \uC548 \uD568")}}function Qa(r,t){if(r&1){let e=y();o(0,"div",49)(1,"h4"),c(2,"\uD3FC \uB77C\uB514\uC624 \uBC84\uD2BC"),a(),o(3,"div",57)(4,"label"),c(5,"\uB808\uC774\uBE14"),a(),o(6,"input",67),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.label",i))}),a()(),o(7,"div",57)(8,"label"),c(9,"\uADF8\uB8F9 \uC774\uB984"),a(),o(10,"input",67),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.groupName",i))}),a()(),o(11,"div",57)(12,"label"),c(13,"\uC635\uC158 \uAC12"),a(),o(14,"input",67),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.value",i))}),a()(),o(15,"div",57)(16,"label"),c(17,"\uAE30\uBCF8 \uC120\uD0DD"),a(),o(18,"label",68)(19,"input",69),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.selected",i))}),a(),o(20,"span"),c(21),a()()()()}if(r&2){let e=g(3);l(6),p("value",(e.selectedElement.properties==null?null:e.selectedElement.properties.label)||""),l(4),p("value",(e.selectedElement.properties==null?null:e.selectedElement.properties.groupName)||""),l(4),p("value",(e.selectedElement.properties==null?null:e.selectedElement.properties.value)||""),l(5),p("checked",e.selectedElement.properties==null?null:e.selectedElement.properties.selected),l(2),x(e.selectedElement.properties!=null&&e.selectedElement.properties.selected?"\uC120\uD0DD\uB428":"\uC120\uD0DD \uC548 \uD568")}}function es(r,t){if(r&1&&(o(0,"option",72),c(1),a()),r&2){let e=t.$implicit;p("value",e),l(),S(" ",e," ")}}function ts(r,t){if(r&1){let e=y();o(0,"div",49)(1,"h4"),c(2,"\uD3FC \uB4DC\uB86D\uB2E4\uC6B4"),a(),o(3,"div",57)(4,"label"),c(5,"\uB808\uC774\uBE14"),a(),o(6,"input",67),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.label",i))}),a()(),o(7,"div",57)(8,"label"),c(9,"\uC635\uC158 \uBAA9\uB85D"),a(),o(10,"textarea",58),u("change",function(i){m(e);let s=g(3);return f(s.onDropdownOptionsChange(i))}),a(),o(11,"small",70),c(12,"\uC904\uBC14\uAFC8\uC73C\uB85C \uC635\uC158\uC744 \uAD6C\uBD84\uD558\uC138\uC694."),a()(),o(13,"div",57)(14,"label"),c(15,"\uAE30\uBCF8 \uC120\uD0DD"),a(),o(16,"select",59),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.selectedOption",i))}),b(17,es,2,2,"option",71),a()()()}if(r&2){let e=g(3);l(6),p("value",(e.selectedElement.properties==null?null:e.selectedElement.properties.label)||""),l(4),p("value",((e.selectedElement.properties==null?null:e.selectedElement.properties.options)||Ii(4,hr)).join(`
`)),l(6),p("value",(e.selectedElement.properties==null?null:e.selectedElement.properties.selectedOption)||""),l(),p("ngForOf",(e.selectedElement.properties==null?null:e.selectedElement.properties.options)||Ii(5,hr))}}function ns(r,t){if(r&1){let e=y();o(0,"div",49)(1,"h4"),c(2,"\uD3FC \uB0A0\uC9DC \uD544\uB4DC"),a(),o(3,"div",57)(4,"label"),c(5,"\uB808\uC774\uBE14"),a(),o(6,"input",67),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.label",i))}),a()(),o(7,"div",57)(8,"label"),c(9,"\uC790\uB9AC\uD45C\uC2DC\uC790"),a(),o(10,"input",67),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.placeholder",i))}),a()(),o(11,"div",57)(12,"label"),c(13,"\uB0A0\uC9DC \uD615\uC2DD"),a(),o(14,"input",67),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.dateFormat",i))}),a()(),o(15,"div",57)(16,"label"),c(17,"\uAE30\uBCF8 \uAC12"),a(),o(18,"input",67),u("change",function(i){m(e);let s=g(3);return f(s.onPropertyChange("properties.defaultValue",i))}),a()()()}if(r&2){let e=g(3);l(6),p("value",(e.selectedElement.properties==null?null:e.selectedElement.properties.label)||""),l(4),p("value",(e.selectedElement.properties==null?null:e.selectedElement.properties.placeholder)||""),l(4),p("value",(e.selectedElement.properties==null?null:e.selectedElement.properties.dateFormat)||""),l(4),p("value",(e.selectedElement.properties==null?null:e.selectedElement.properties.defaultValue)||"")}}function is(r,t){if(r&1){let e=y();o(0,"div",48)(1,"div",49)(2,"h4"),c(3,"\uC704\uCE58 \uBC0F \uD06C\uAE30"),a(),o(4,"div",50)(5,"label"),c(6,"X:"),a(),o(7,"input",51),u("change",function(i){m(e);let s=g(2);return f(s.onPropertyChange("x",i))}),a(),o(8,"span",52),c(9,"px"),a()(),o(10,"div",50)(11,"label"),c(12,"Y:"),a(),o(13,"input",51),u("change",function(i){m(e);let s=g(2);return f(s.onPropertyChange("y",i))}),a(),o(14,"span",52),c(15,"px"),a()(),o(16,"div",50)(17,"label"),c(18,"\uB108\uBE44:"),a(),o(19,"input",51),u("change",function(i){m(e);let s=g(2);return f(s.onPropertyChange("width",i))}),a(),o(20,"span",52),c(21,"px"),a()(),o(22,"div",50)(23,"label"),c(24,"\uB192\uC774:"),a(),o(25,"input",51),u("change",function(i){m(e);let s=g(2);return f(s.onPropertyChange("height",i))}),a(),o(26,"span",52),c(27,"px"),a()()(),b(28,Ja,31,4,"div",53)(29,Za,14,3,"div",53)(30,Qa,22,5,"div",53)(31,ts,18,6,"div",53)(32,ns,19,4,"div",53),o(33,"div",54)(34,"button",55),u("click",function(){m(e);let i=g(2);return f(i.onDeleteElement())}),c(35,"\uC0AD\uC81C"),a(),o(36,"button",56),u("click",function(){m(e);let i=g(2);return f(i.onDeselectElement())}),c(37,"\uC120\uD0DD \uD574\uC81C"),a()()()}if(r&2){let e=g(2);l(7),p("value",e.selectedElement.x),l(6),p("value",e.selectedElement.y),l(6),p("value",e.selectedElement.width),l(6),p("value",e.selectedElement.height),l(3),p("ngIf",e.selectedElement.type==="text"),l(),p("ngIf",e.selectedElement.type==="form-checkbox"),l(),p("ngIf",e.selectedElement.type==="form-radio"),l(),p("ngIf",e.selectedElement.type==="form-dropdown"),l(),p("ngIf",e.selectedElement.type==="form-date")}}function os(r,t){if(r&1){let e=y();o(0,"div",35)(1,"div",24)(2,"button",36),u("click",function(){m(e);let i=g();return f(i.onBack())}),c(3,"\u2039"),a(),o(4,"h3"),c(5),a(),o(6,"button",25),u("click",function(){m(e);let i=g();return f(i.closeSheet())}),c(7,"\xD7"),a()(),b(8,Ka,31,0,"div",37)(9,Ga,11,0,"div",37)(10,Ya,22,5,"div",37)(11,qa,11,1,"div",37)(12,Xa,29,0,"div",37)(13,is,38,9,"div",38),a()}if(r&2){let e=g();l(5),x(e.getMenuTitle()),l(3),p("ngIf",e.expandedMenuId==="editing-tools"),l(),p("ngIf",e.expandedMenuId==="document-management"),l(),p("ngIf",e.expandedMenuId==="page-management"),l(),p("ngIf",e.expandedMenuId==="view-options"),l(),p("ngIf",e.expandedMenuId==="form-tools"),l(),p("ngIf",!e.hideElementProperties&&e.expandedMenuId==="element-properties"&&e.selectedElement)}}var Ge=class r{constructor(t){this.cdr=t}sheetState="collapsed";expandedMenuId=null;selectedElement=null;currentPage=1;totalPages=1;zoomLevel=100;pdfPages=[];isPdfViewer=!1;isTextEditModalOpen=!1;hideElementProperties=!1;panelAction=new W;close=new W;addText=new W;addImage=new W;addShape=new W;addSignature=new W;addWatermark=new W;addVectorPath=new W;addFormCheckbox=new W;addFormRadio=new W;addFormDropdown=new W;addFormDateField=new W;analyze=new W;saveDocument=new W;addPage=new W;deletePage=new W;rotatePage=new W;pageSelect=new W;zoomIn=new W;zoomOut=new W;elementPropertyChange=new W;deleteElement=new W;deselectElement=new W;menuGroups=[{id:"editing-tools",title:"\uD3B8\uC9D1 \uB3C4\uAD6C",icon:"edit",modes:["\uD648","\uD3B8\uC9D1"],items:[{id:"add-text",label:"\uD14D\uC2A4\uD2B8 \uCD94\uAC00",description:"\uC0C8\uB85C\uC6B4 \uD14D\uC2A4\uD2B8 \uC0C1\uC790\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4"},{id:"add-image",label:"\uC774\uBBF8\uC9C0 \uCD94\uAC00",description:"\uC774\uBBF8\uC9C0\uB97C \uC0BD\uC785\uD569\uB2C8\uB2E4"},{id:"add-shape",label:"\uB3C4\uD615 \uCD94\uAC00",description:"\uB3C4\uD615\uC744 \uADF8\uB9BD\uB2C8\uB2E4"},{id:"add-signature",label:"\uC11C\uBA85 \uCD94\uAC00",description:"\uC11C\uBA85\uC744 \uC0BD\uC785\uD569\uB2C8\uB2E4"},{id:"add-watermark",label:"\uC6CC\uD130\uB9C8\uD06C",description:"\uC6CC\uD130\uB9C8\uD06C\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4"},{id:"add-vector-path",label:"\uBCA1\uD130 \uACBD\uB85C",description:"\uBCA1\uD130 \uACBD\uB85C\uB97C \uADF8\uB9BD\uB2C8\uB2E4"}]},{id:"pdf-analysis",title:"PDF \uD3B8\uC9D1",icon:"search",modes:["\uD648","\uD3B8\uC9D1"],items:[{id:"analyze",label:"PDF \uBD84\uC11D \uC2DC\uC791",description:"PDF \uBB38\uC11C\uB97C \uBD84\uC11D\uD558\uACE0 \uC0C8 \uBB38\uC11C\uB85C \uBCC0\uD658\uD569\uB2C8\uB2E4"}]},{id:"form-tools",title:"\uD3FC \uB3C4\uAD6C",icon:"form",modes:["\uD3B8\uC9D1"],items:[{id:"add-form-checkbox",label:"\uCCB4\uD06C\uBC15\uC2A4 \uCD94\uAC00",description:"\uC0AC\uC6A9\uC790\uAC00 \uC120\uD0DD\uD560 \uC218 \uC788\uB294 \uCCB4\uD06C\uBC15\uC2A4\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4"},{id:"add-form-radio",label:"\uB77C\uB514\uC624 \uBC84\uD2BC \uCD94\uAC00",description:"\uB2E8\uC77C \uC120\uD0DD\uC6A9 \uB77C\uB514\uC624 \uBC84\uD2BC\uC744 \uCD94\uAC00\uD569\uB2C8\uB2E4"},{id:"add-form-dropdown",label:"\uB4DC\uB86D\uB2E4\uC6B4 \uCD94\uAC00",description:"\uC5EC\uB7EC \uC635\uC158 \uC911 \uD558\uB098\uB97C \uC120\uD0DD\uD558\uB294 \uB4DC\uB86D\uB2E4\uC6B4\uC744 \uCD94\uAC00\uD569\uB2C8\uB2E4"},{id:"add-form-date",label:"\uB0A0\uC9DC \uD544\uB4DC \uCD94\uAC00",description:"\uB0A0\uC9DC \uC785\uB825\uC744 \uC704\uD55C \uD544\uB4DC\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4"}]},{id:"document-management",title:"\uBB38\uC11C \uAD00\uB9AC",icon:"folder",modes:["\uD648","\uD3B8\uC9D1"],items:[{id:"save-document",label:"\uBB38\uC11C \uC800\uC7A5",description:"\uD604\uC7AC \uBB38\uC11C\uB97C \uC800\uC7A5\uD569\uB2C8\uB2E4"},{id:"export-pdf",label:"PDF \uB0B4\uBCF4\uB0B4\uAE30",description:"PDF \uD30C\uC77C\uB85C \uB0B4\uBCF4\uB0C5\uB2C8\uB2E4"}]},{id:"page-management",title:"\uD398\uC774\uC9C0 \uAD00\uB9AC",icon:"file",modes:["\uD648","\uD3B8\uC9D1"],items:[{id:"add-page",label:"\uD398\uC774\uC9C0 \uCD94\uAC00",description:"\uC0C8 \uD398\uC774\uC9C0\uB97C \uCD94\uAC00\uD569\uB2C8\uB2E4"},{id:"delete-page",label:"\uD398\uC774\uC9C0 \uC0AD\uC81C",description:"\uD604\uC7AC \uD398\uC774\uC9C0\uB97C \uC0AD\uC81C\uD569\uB2C8\uB2E4"},{id:"rotate-page",label:"\uD398\uC774\uC9C0 \uD68C\uC804",description:"\uD398\uC774\uC9C0\uB97C 90\uB3C4 \uD68C\uC804\uD569\uB2C8\uB2E4"},{id:"select-page",label:"\uD398\uC774\uC9C0 \uC120\uD0DD",description:"\uD2B9\uC815 \uD398\uC774\uC9C0\uB85C \uC774\uB3D9\uD569\uB2C8\uB2E4"}]},{id:"view-options",title:"\uBCF4\uAE30 \uC635\uC158",icon:"eye",modes:["\uD648","\uD3B8\uC9D1"],items:[{id:"zoom-in",label:"\uD655\uB300",description:"\uD654\uBA74\uC744 \uD655\uB300\uD569\uB2C8\uB2E4"},{id:"zoom-out",label:"\uCD95\uC18C",description:"\uD654\uBA74\uC744 \uCD95\uC18C\uD569\uB2C8\uB2E4"}]},{id:"element-properties",title:"\uC694\uC18C \uC18D\uC131",icon:"settings",modes:["\uD648","\uD3B8\uC9D1"],items:[]}];ngOnChanges(t){t.selectedElement&&(this.selectedElement&&this.sheetState==="collapsed"&&!this.isTextEditModalOpen&&!this.hideElementProperties?this.onMenuClick("element-properties"):!this.selectedElement&&this.expandedMenuId==="element-properties"&&this.onBack()),t.isTextEditModalOpen&&this.isTextEditModalOpen&&this.sheetState!=="collapsed"&&this.closeSheet()}onSheetStateChange(t){this.sheetState=t,this.cdr.markForCheck()}toggleSheet(){this.sheetState=this.sheetState==="collapsed"?"half":"collapsed",this.cdr.markForCheck()}closeSheet(){this.sheetState="collapsed",this.expandedMenuId=null,this.close.emit()}onMenuClick(t){if(!(this.isPdfViewer&&t!=="pdf-analysis")&&!(t==="element-properties"&&!this.selectedElement)){if(t==="pdf-analysis"){this.onAnalyze();return}this.expandedMenuId=t,this.sheetState="full"}}onBack(){this.expandedMenuId=null,this.sheetState="full"}getMenuTitle(){let t=this.menuGroups.find(e=>e.id===this.expandedMenuId);return t?t.title:""}onAddText(){this.addText.emit(),this.closeSheet()}onAddImage(){this.addImage.emit(),this.closeSheet()}onAddShape(){this.addShape.emit(),this.closeSheet()}onAddSignature(){this.addSignature.emit(),this.closeSheet()}onAddWatermark(){this.addWatermark.emit(),this.closeSheet()}onAddVectorPath(){this.addVectorPath.emit(),this.closeSheet()}onAddFormCheckbox(){this.addFormCheckbox.emit(),this.closeSheet()}onAddFormRadio(){this.addFormRadio.emit(),this.closeSheet()}onAddFormDropdown(){this.addFormDropdown.emit(),this.closeSheet()}onAddFormDateField(){this.addFormDateField.emit(),this.closeSheet()}onSaveDocument(){this.saveDocument.emit(),this.closeSheet()}onExportPdf(){this.closeSheet()}onAnalyze(){this.analyze.emit(),this.closeSheet()}onAddPage(){this.addPage.emit(),this.closeSheet()}onDeletePage(){this.deletePage.emit(),this.closeSheet()}onRotatePage(){this.rotatePage.emit(),this.closeSheet()}onPageSelect(t){this.pageSelect.emit(t)}onZoomIn(){this.zoomIn.emit()}onZoomOut(){this.zoomOut.emit()}onPropertyChange(t,e){if(!this.selectedElement)return;let n;if(e&&e.target){let d=e.target;d instanceof HTMLInputElement&&d.type==="checkbox"?n=d.checked:n=d.value}else n=e?.value??e;let i=["x","y","width","height","fontSize","strokeWidth","boxSize","circleSize"],s=t.split(".").pop()||t;i.includes(s)&&(n=parseFloat(n)),this.elementPropertyChange.emit({elementId:this.selectedElement.id,property:t,value:n})}onDropdownOptionsChange(t){if(!this.selectedElement)return;let i=(t.target?.value??"").split(/\r?\n/).map(s=>s.trim()).filter(s=>s.length>0);this.elementPropertyChange.emit({elementId:this.selectedElement.id,property:"properties.options",value:i}),i.length>0&&(!this.selectedElement.properties?.selectedOption||!i.includes(this.selectedElement.properties.selectedOption))&&this.elementPropertyChange.emit({elementId:this.selectedElement.id,property:"properties.selectedOption",value:i[0]})}onDeleteElement(){this.deleteElement.emit(),this.closeSheet()}onDeselectElement(){this.deselectElement.emit(),this.closeSheet()}getElementTypeName(t){return{text:"\uD14D\uC2A4\uD2B8",image:"\uC774\uBBF8\uC9C0",shape:"\uB3C4\uD615",signature:"\uC11C\uBA85",watermark:"\uC6CC\uD130\uB9C8\uD06C","vector-path":"\uBCA1\uD130 \uD328\uC2A4",line:"\uC120","form-checkbox":"\uD3FC \uCCB4\uD06C\uBC15\uC2A4","form-radio":"\uD3FC \uB77C\uB514\uC624 \uBC84\uD2BC","form-dropdown":"\uD3FC \uB4DC\uB86D\uB2E4\uC6B4","form-date":"\uD3FC \uB0A0\uC9DC \uD544\uB4DC"}[t]||"\uC694\uC18C"}static \u0275fac=function(e){return new(e||r)(V(fe))};static \u0275cmp=F({type:r,selectors:[["shared-pdf-tools-panel-mobile"]],inputs:{selectedElement:"selectedElement",currentPage:"currentPage",totalPages:"totalPages",zoomLevel:"zoomLevel",pdfPages:"pdfPages",isPdfViewer:"isPdfViewer",isTextEditModalOpen:"isTextEditModalOpen",hideElementProperties:"hideElementProperties"},outputs:{panelAction:"panelAction",close:"close",addText:"addText",addImage:"addImage",addShape:"addShape",addSignature:"addSignature",addWatermark:"addWatermark",addVectorPath:"addVectorPath",addFormCheckbox:"addFormCheckbox",addFormRadio:"addFormRadio",addFormDropdown:"addFormDropdown",addFormDateField:"addFormDateField",analyze:"analyze",saveDocument:"saveDocument",addPage:"addPage",deletePage:"deletePage",rotatePage:"rotatePage",pageSelect:"pageSelect",zoomIn:"zoomIn",zoomOut:"zoomOut",elementPropertyChange:"elementPropertyChange",deleteElement:"deleteElement",deselectElement:"deselectElement"},features:[Je],decls:5,vars:4,consts:[[3,"sheetStateChange","close","sheetState"],[1,"panel-content"],["class","collapsed-icons",4,"ngIf"],["class","main-menu",4,"ngIf"],["class","sub-menu",4,"ngIf"],[1,"collapsed-icons"],["class","icon-btn",3,"disabled","hidden","click",4,"ngFor","ngForOf"],[1,"icon-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none"],[3,"ngSwitch"],[4,"ngSwitchCase"],["d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","11","cy","11","r","8","stroke","currentColor","stroke-width","2"],["d","m21 21-4.35-4.35","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["d","M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M14 2v6h6M12 18v-6M9 15h6","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","12","cy","12","r","3","stroke","currentColor","stroke-width","2"],["d","M12 1v6m0 6v6M4.22 4.22l4.24 4.24m5.08 5.08l4.24 4.24M1 12h6m6 0h6M4.22 19.78l4.24-4.24m5.08-5.08l4.24-4.24","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["x","4","y","6","width","16","height","12","rx","2","stroke","currentColor","stroke-width","2","fill","none"],["d","m8 12 2 2 5-5","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"main-menu"],[1,"sheet-header"],["aria-label","\uB2EB\uAE30",1,"close-btn",3,"click"],[1,"category-list"],["class","category-item",3,"disabled","hidden","click",4,"ngFor","ngForOf"],[1,"category-item",3,"click"],[1,"category-icon"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],[1,"category-content"],[1,"category-title"],[1,"category-count"],[1,"category-arrow"],[1,"sub-menu"],["aria-label","\uB4A4\uB85C\uAC00\uAE30",1,"back-btn",3,"click"],["class","menu-content",4,"ngIf"],["class","property-editor",4,"ngIf"],[1,"menu-content"],[1,"menu-item-btn",3,"click"],[1,"btn-icon"],[1,"btn-label"],[1,"menu-item-btn",3,"click","disabled"],[1,"page-selector"],["type","number",3,"change","value","min","max"],[1,"page-total"],[1,"menu-helper-text"],[1,"property-editor"],[1,"property-section"],[1,"property-row"],["type","number",1,"property-input",3,"change","value"],[1,"unit"],["class","property-section",4,"ngIf"],[1,"action-buttons"],[1,"btn-danger",3,"click"],[1,"btn-secondary",3,"click"],[1,"property-row","full-width"],["rows","3",1,"property-textarea",3,"change","value"],[1,"property-select",3,"change","value"],["label","\uD55C\uAE00 \uACE0\uB515\uCCB4"],["value","Noto Sans KR"],["value","NanumGothic"],["label","\uC601\uBB38 \uD3F0\uD2B8"],["value","Arial"],["value","Helvetica"],["type","color",1,"property-color",3,"change","value"],["type","text",1,"property-input",3,"change","value"],[1,"property-checkbox"],["type","checkbox",3,"change","checked"],[1,"helper-text"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,n){e&1&&(o(0,"app-bottom-sheet",0),u("sheetStateChange",function(s){return n.onSheetStateChange(s)})("close",function(){return n.closeSheet()}),o(1,"div",1),b(2,Ra,2,1,"div",2)(3,Wa,8,1,"div",3)(4,os,14,7,"div",4),a()()),e&2&&(p("sheetState",n.sheetState),l(2),p("ngIf",n.sheetState==="collapsed"),l(),p("ngIf",(n.sheetState==="half"||n.sheetState==="full")&&!n.expandedMenuId),l(),p("ngIf",n.sheetState==="full"&&n.expandedMenuId))},dependencies:[_e,oe,B,pt,gt,Qe,Ve,Le,Pe],styles:[".fab-button[_ngcontent-%COMP%]{position:fixed;bottom:calc(80px + var(--android-navigation-bar-height, 0px));right:20px;width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#2196f3,#1976d2);color:#fff;font-size:24px;border:none;box-shadow:0 4px 12px #2196f366;z-index:999;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_fabEntrance .3s cubic-bezier(.4,0,.2,1)}.fab-button[_ngcontent-%COMP%]:active{transform:scale(.95);box-shadow:0 2px 8px #2196f34d}.fab-button.hidden[_ngcontent-%COMP%]{display:none!important}@keyframes _ngcontent-%COMP%_fabEntrance{0%{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}.sheet-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .2s ease;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.bottom-sheet[_ngcontent-%COMP%]{position:fixed;left:0;right:0;bottom:0;background:#fff!important;color:#333!important;border-radius:16px 16px 0 0;box-shadow:0 -2px 16px #00000026;z-index:1001;transition:transform .3s cubic-bezier(.4,0,.2,1),max-height .3s cubic-bezier(.4,0,.2,1);max-height:90vh;display:flex;flex-direction:column}.bottom-sheet.collapsed[_ngcontent-%COMP%]{transform:translateY(calc(100% - 60px));max-height:60px}.bottom-sheet.half[_ngcontent-%COMP%]{transform:translateY(0);max-height:50vh}.bottom-sheet.full[_ngcontent-%COMP%]{transform:translateY(0);max-height:90vh;overflow-y:auto}.bottom-sheet[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;height:20px;display:flex;justify-content:center;align-items:center;cursor:ns-resize;z-index:10}.bottom-sheet[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]   .handle-bar[_ngcontent-%COMP%]{width:40px;height:4px;background-color:#ccc;border-radius:2px;transition:background-color .2s ease}.bottom-sheet[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]   .handle-bar.dragging[_ngcontent-%COMP%]{background-color:#2196f3}.bottom-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;border-bottom:1px solid #e0e0e0;flex-shrink:0;background:#fff!important}.bottom-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{flex:1;margin:0;font-size:18px;font-weight:600;text-align:center;color:#333!important}.bottom-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%], .bottom-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{width:32px;height:32px;background:transparent;border:none;font-size:24px;cursor:pointer;color:#666!important;transition:color .2s}.bottom-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:active, .bottom-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:active{color:#2196f3!important}.bottom-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{margin-right:auto}.bottom-sheet[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{margin-left:auto}.drag-handle[_ngcontent-%COMP%]{padding:16px 0 12px;text-align:center;cursor:grab;flex-shrink:0;background:linear-gradient(to bottom,transparent 0%,rgba(0,0,0,.02) 100%);touch-action:none}.drag-handle[_ngcontent-%COMP%]:active{cursor:grabbing;background:#0000000d}.drag-handle[_ngcontent-%COMP%]   .handle-bar[_ngcontent-%COMP%]{width:48px;height:5px;background:#bbb!important;border-radius:3px;margin:0 auto;transition:all .2s ease;box-shadow:0 1px 2px #0000001a}.drag-handle[_ngcontent-%COMP%]:hover   .handle-bar[_ngcontent-%COMP%]{background:#888!important;width:56px}.drag-handle[_ngcontent-%COMP%]:active   .handle-bar[_ngcontent-%COMP%]{background:#666!important;width:56px;transform:scaleY(1.2)}.collapsed-icons[_ngcontent-%COMP%]{display:flex;overflow-x:auto;padding:8px 16px;gap:12px;flex-shrink:0;-ms-overflow-style:none;scrollbar-width:none}.collapsed-icons[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.collapsed-icons[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{min-width:48px;height:48px;font-size:24px;background:#f5f5f5!important;color:#333!important;border-radius:12px;border:none;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center}.collapsed-icons[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#e0e0e0!important}.collapsed-icons[_ngcontent-%COMP%]   .icon-btn.disabled[_ngcontent-%COMP%]{opacity:.4;cursor:not-allowed}.sheet-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;border-bottom:1px solid #e0e0e0;flex-shrink:0;background:#fff!important}.sheet-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{flex:1;margin:0;font-size:18px;font-weight:600;text-align:center;color:#333!important}.sheet-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%], .sheet-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{width:32px;height:32px;background:transparent;border:none;font-size:24px;cursor:pointer;color:#666!important;transition:color .2s}.sheet-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:active, .sheet-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:active{color:#2196f3!important}.sheet-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{margin-right:auto}.sheet-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{margin-left:auto}.main-menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:hidden}.category-list[_ngcontent-%COMP%]{padding:8px 16px;overflow-y:auto;flex:1}.category-list[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;margin-bottom:8px;background:#f5f5f5!important;color:#333!important;border-radius:12px;cursor:pointer;transition:all .2s}.category-list[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]:active{background:#e0e0e0!important;transform:scale(.98)}.category-list[_ngcontent-%COMP%]   .category-item.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}.category-list[_ngcontent-%COMP%]   .category-item.disabled[_ngcontent-%COMP%]:active{background:#f5f5f5!important;transform:none}.category-list[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]   .category-icon[_ngcontent-%COMP%]{font-size:32px;margin-right:16px;flex-shrink:0}.category-list[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]   .category-content[_ngcontent-%COMP%]{flex:1;min-width:0}.category-list[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]   .category-content[_ngcontent-%COMP%]   .category-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:4px;color:#333!important}.category-list[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]   .category-content[_ngcontent-%COMP%]   .category-count[_ngcontent-%COMP%]{font-size:12px;color:#666!important}.category-list[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]   .category-arrow[_ngcontent-%COMP%]{font-size:24px;color:#999!important;flex-shrink:0}.sub-menu[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;overflow:hidden}.menu-content[_ngcontent-%COMP%]{padding:8px 16px;overflow-y:auto;flex:1}.menu-content[_ngcontent-%COMP%]   .menu-item-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;padding:16px;margin-bottom:8px;background:#fff!important;color:#333!important;border:1px solid #e0e0e0;border-radius:12px;cursor:pointer;transition:all .2s}.menu-content[_ngcontent-%COMP%]   .menu-item-btn[_ngcontent-%COMP%]:active{background:#f5f5f5!important;transform:scale(.98)}.menu-content[_ngcontent-%COMP%]   .menu-item-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.menu-content[_ngcontent-%COMP%]   .menu-item-btn[_ngcontent-%COMP%]:disabled:active{background:#fff!important;transform:none}.menu-content[_ngcontent-%COMP%]   .menu-item-btn[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{font-size:28px;margin-right:16px;flex-shrink:0;color:#333!important}.menu-content[_ngcontent-%COMP%]   .menu-item-btn[_ngcontent-%COMP%]   .btn-label[_ngcontent-%COMP%]{font-size:16px;text-align:left;color:#333!important}.menu-content[_ngcontent-%COMP%]   .page-selector[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;margin-top:16px;background:#f5f5f5;border-radius:12px}.menu-content[_ngcontent-%COMP%]   .page-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;margin-right:12px}.menu-content[_ngcontent-%COMP%]   .page-selector[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:60px;padding:8px;border:1px solid #e0e0e0;border-radius:8px;font-size:14px;text-align:center}.menu-content[_ngcontent-%COMP%]   .page-selector[_ngcontent-%COMP%]   .page-total[_ngcontent-%COMP%]{margin-left:8px;font-size:14px;color:#666}.menu-content[_ngcontent-%COMP%]   .menu-helper-text[_ngcontent-%COMP%]{font-size:12px;color:#666;margin:4px 4px 12px;line-height:1.4}.property-editor[_ngcontent-%COMP%]{padding:16px;overflow-y:auto;flex:1}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]{margin-bottom:24px}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:14px;font-weight:600;margin-bottom:12px;color:#666;text-transform:uppercase;letter-spacing:.5px}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:12px}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row.full-width[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row.full-width[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:auto;margin-bottom:8px}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:70px;font-size:14px;font-weight:500;flex-shrink:0}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .property-input[_ngcontent-%COMP%]{flex:1;padding:10px 12px;border:1px solid #e0e0e0;border-radius:8px;font-size:14px;min-width:0}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .property-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .property-textarea[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #e0e0e0;border-radius:8px;font-size:14px;resize:vertical}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .property-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .property-select[_ngcontent-%COMP%]{flex:1;padding:10px 12px;border:1px solid #e0e0e0;border-radius:8px;font-size:14px;background:#fff}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .property-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .property-color[_ngcontent-%COMP%]{width:60px;height:40px;border:1px solid #e0e0e0;border-radius:8px;cursor:pointer}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{margin-left:8px;font-size:12px;color:#999;flex-shrink:0}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .property-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .property-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:20px;height:20px;accent-color:#2196F3}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   .property-row[_ngcontent-%COMP%]   .property-checkbox[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#555}.property-editor[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:24px;padding-top:24px;border-top:1px solid #e0e0e0}.property-editor[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:14px;border-radius:8px;font-size:16px;font-weight:600;border:none;cursor:pointer;transition:all .2s}.property-editor[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{transform:scale(.98)}.property-editor[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-danger[_ngcontent-%COMP%]{background:#f44336;color:#fff}.property-editor[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-danger[_ngcontent-%COMP%]:active{background:#d32f2f}.property-editor[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#e0e0e0;color:#333}.property-editor[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:active{background:#bdbdbd}@media (min-width: 768px){.bottom-sheet[_ngcontent-%COMP%]{max-width:400px;right:0;left:auto;border-radius:16px 0 0}.fab-button[_ngcontent-%COMP%]{right:40px}}@media (prefers-color-scheme: dark){.bottom-sheet[_ngcontent-%COMP%]{background:#1e1e1e;box-shadow:0 -2px 16px #00000080}.sheet-header[_ngcontent-%COMP%]{border-bottom-color:#333}.sheet-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff}.sheet-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%], .sheet-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{color:#ccc}.category-item[_ngcontent-%COMP%]{background:#2a2a2a}.category-item[_ngcontent-%COMP%]:active{background:#333}.category-item[_ngcontent-%COMP%]   .category-title[_ngcontent-%COMP%]{color:#fff}.category-item[_ngcontent-%COMP%]   .category-count[_ngcontent-%COMP%]{color:#999}.menu-item-btn[_ngcontent-%COMP%]{background:#2a2a2a;border-color:#333;color:#fff}.menu-item-btn[_ngcontent-%COMP%]:active{background:#333}.property-editor[_ngcontent-%COMP%]   .property-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#999}.property-editor[_ngcontent-%COMP%]   .property-input[_ngcontent-%COMP%], .property-editor[_ngcontent-%COMP%]   .property-textarea[_ngcontent-%COMP%], .property-editor[_ngcontent-%COMP%]   .property-select[_ngcontent-%COMP%]{background:#2a2a2a;border-color:#333;color:#fff}}"],changeDetection:0})};var Dt=class r{constructor(t,e){this.indexedDbService=t;this.snackbar=e}loadPdfFile(t){try{let e={pdfSrc:t.pdfUrl,pdfBlob:t.pdfBlob,fileName:t.fileName,documentType:"pdf-viewer"};return un(e)}catch(e){throw this.snackbar.showError("PDF \uD30C\uC77C\uC744 \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),e}}loadDocumentFromIndexedDB(t,e){return Wi(this._loadDocumentFromIndexedDBAsync(t,e))}_loadDocumentFromIndexedDBAsync(t,e){return C(this,null,function*(){try{if(!t.pdfBase64){let M=(t.fileName||t.title||"").toLowerCase().split(".").pop();throw M&&["jpg","jpeg","png","gif","bmp","webp"].includes(M)?new Error("\uC774\uBBF8\uC9C0 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):M&&["xlsx","xls","csv"].includes(M)?new Error("\uC5D1\uC140 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):M&&["docx","doc"].includes(M)?new Error("\uC6CC\uB4DC \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):M&&["pptx","ppt"].includes(M)?new Error("\uD30C\uC6CC\uD3EC\uC778\uD2B8 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):new Error("PDF \uD30C\uC77C\uB9CC \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC788\uC2B5\uB2C8\uB2E4.")}let n=yield this.base64ToBlob(t.pdfBase64),i=URL.createObjectURL(n),s="pdf-viewer",d,_;return(e.mode==="editor"&&t.pages&&t.pages.length>0||e.mode==="auto"&&t.documentType==="editor"&&t.pages)&&(s="pdf-editor",d=t.pages,_=t.pages.length),{pdfSrc:i,pdfBlob:n,fileName:t.fileName||t.title,documentType:s,pdfPages:d,totalPages:_}}catch(n){let i=n?.message||"\uBB38\uC11C\uB97C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.";throw this.snackbar.showError(i),n}})}saveDocument(t){return C(this,null,function*(){try{let n=(yield this.indexedDbService.getAllDocuments()).find(s=>s.title===t.title);n&&(t.id=n.id,t.createdAt=n.createdAt),yield this.indexedDbService.saveDocument(t);let i=t.documentType==="viewer"?"PDF \uBDF0\uC5B4":"\uD3B8\uC9D1\uAE30";this.snackbar.showSuccess(`'${t.title}' \uBB38\uC11C\uAC00 ${i} \uBAA8\uB4DC\uB85C \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}catch(e){throw this.snackbar.showError("\uBB38\uC11C \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),e}})}saveDocumentSimple(t,e,n,i,s){return C(this,null,function*(){try{let d="";if(i)d=yield this.blobToBase64(i);else if(s&&s.startsWith("blob:")){let w=yield(yield fetch(s)).blob();d=yield this.blobToBase64(w)}let _={id:this.generateDocumentId(),title:t,pages:e,elementCount:this.getTotalElementCount(e),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:"1.0",pdfSrc:s,pdfBase64:d||void 0,fileName:t,documentType:n};yield this.saveDocument(_)}catch(d){throw d}})}base64ToBlob(t){return C(this,null,function*(){return new Promise((e,n)=>{try{let i=t.includes(",")?t.split(",")[1]:t,s=8192,d=atob(i),_=[];for(let w=0;w<d.length;w+=s){let M=d.slice(w,w+s),O=new Array(M.length);for(let E=0;E<M.length;E++)O[E]=M.charCodeAt(E);_.push(new Uint8Array(O))}let v=new Blob(_,{type:"application/pdf"});e(v)}catch(i){n(i)}})})}blobToBase64(t){return C(this,null,function*(){return new Promise((e,n)=>{let i=new FileReader;i.onloadend=()=>e(i.result),i.onerror=n,i.readAsDataURL(t)})})}generateDocumentId(){return"doc_"+Date.now()+"_"+Math.random().toString(36).substr(2,9)}getTotalElementCount(t){return t.reduce((e,n)=>e+(n.elements?.length||0),0)}revokeBlobUrl(t){t&&t.startsWith("blob:")&&URL.revokeObjectURL(t)}static \u0275fac=function(e){return new(e||r)(X(ee),X(G))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Zt=class r{constructor(t,e,n,i,s,d,_,v,w,M,O,E){this.pdfAnalysisManager=t;this.pageContentBuilder=e;this.pdfThumbnailService=n;this.dialog=i;this.snackbar=s;this.appRef=d;this.injector=_;this.docGenerator=v;this.vectorElementConverter=w;this.pdfDocBuilder=M;this.debugLogger=O;this.pdfImageExtractor=E}pageSelectorComponentRef=null;pdfjsLibService=P(Me);startPdfAnalysis(t,e=!1){return C(this,null,function*(){if(e){let d=yield this.showEditorResumeDialog();if(d==="cancel")throw new Error("\uBD84\uC11D \uCDE8\uC18C\uB428");if(d==="continue")throw new Error("\uAE30\uC874 \uD3B8\uC9D1 \uACC4\uC18D")}this.debugLogger.info("EZM-\uBD84\uC11D","\u{1F4CA} \uC804\uCCB4 \uD398\uC774\uC9C0 \uBD84\uC11D \uC2DC\uC791 (EZ-Reader \uBC29\uC2DD)");let n=yield this.executePdfAnalysis(t.pdfSrc,t.fileName,void 0);this.debugLogger.info("EZM-\uBD84\uC11D",`\u{1F4CA} \uBD84\uC11D \uACB0\uACFC - \uD14D\uC2A4\uD2B8: ${n.textStreamData?.pages?.length||0}\uD398\uC774\uC9C0, \uBCA1\uD130: ${n.vectorData?.pageDetails?.length||0}\uD398\uC774\uC9C0`);let i=yield this.createCombinedDocument(n.summary,n.vectorData,n.imageData,n.textStreamData);return this.debugLogger.success("EZM-\uBD84\uC11D",`\u2705 ${i.length}\uD398\uC774\uC9C0 \uBD84\uC11D \uBC0F \uD63C\uD569 \uBB38\uC11C \uC0DD\uC131 \uC644\uB8CC`),{pdfPages:i,pdfAnalysisData:n.summary,vectorData:n.vectorData,imageData:n.imageData,pdfTextStreamData:n.textStreamData}})}showEditorResumeDialog(){return C(this,null,function*(){return new Promise(t=>{this.dialog.open(Ln,{width:"90%",maxWidth:"500px",data:{title:"\uD3B8\uC9D1 \uBAA8\uB4DC",message:`\uC774\uBBF8 \uD3B8\uC9D1 \uC911\uC778 \uBB38\uC11C\uAC00 \uC788\uC2B5\uB2C8\uB2E4.
\uC5B4\uB5BB\uAC8C \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`}}).afterClosed().subscribe(n=>{t(n||"cancel")})})})}openPageSelectorModal(t,e){return C(this,null,function*(){try{this.snackbar.showInfo("\uD398\uC774\uC9C0 \uC378\uB124\uC77C \uC0DD\uC131 \uC911...");let n=e;try{this.pdfjsLibService.isLoaded&&(n=(yield this.pdfjsLibService.getDocument(t)).numPages)}catch{n=1}let i=[];for(let s=1;s<=n;s++)i.push({pageNumber:s,thumbnail:"",selected:s===1,isLoading:!0});return new Promise(s=>{let d=po(Nn,{environmentInjector:this.injector});this.pageSelectorComponentRef=d,d.instance.isVisible=!0,d.instance.thumbnails=i,d.instance.close.subscribe(()=>{this.destroyPageSelectorModal(),s({confirmed:!1})}),d.instance.confirm.subscribe(v=>{this.destroyPageSelectorModal(),s({confirmed:!0,selectedPage:v})}),this.appRef.attachView(d.hostView);let _=d.hostView.rootNodes[0];document.body.appendChild(_),this.generateThumbnailsAsync(t,n,i)})}catch(n){throw this.snackbar.showError("\uD398\uC774\uC9C0 \uC120\uD0DD \uBAA8\uB2EC\uC744 \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),n}})}generateThumbnailsAsync(t,e,n){return C(this,null,function*(){try{for(let i=0;i<e;i++){let s=i+1;try{let d=yield this.pdfThumbnailService.generateThumbnail(t,s,{scale:.3});n[i].thumbnail=d,n[i].isLoading=!1}catch{n[i].isLoading=!1}}this.snackbar.showSuccess("\uC378\uB124\uC77C \uC0DD\uC131 \uC644\uB8CC!")}catch{}})}destroyPageSelectorModal(){this.pageSelectorComponentRef&&(this.appRef.detachView(this.pageSelectorComponentRef.hostView),this.pageSelectorComponentRef.destroy(),this.pageSelectorComponentRef=null)}cleanup(){this.pageSelectorComponentRef&&this.destroyPageSelectorModal()}executePdfAnalysis(t,e,n){return C(this,null,function*(){try{return this.snackbar.showInfo("PDF \uBD84\uC11D\uC744 \uC2DC\uC791\uD569\uB2C8\uB2E4... (\uC804\uCCB4 \uD398\uC774\uC9C0)"),yield this.pdfAnalysisManager.analyzePdf(t,e,(s,d)=>{},{targetPage:n,singlePageMode:!1})}catch(i){throw this.snackbar.showError("PDF \uBD84\uC11D \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."),i}})}createCombinedDocument(t,e,n,i){return C(this,null,function*(){try{this.debugLogger.info("EZM-\uD63C\uD569\uBB38\uC11C","\u{1F3A8} \uD63C\uD569 \uBB38\uC11C \uC0DD\uC131 \uC2DC\uC791 (DocumentGeneratorHandler \uC0AC\uC6A9)");let s=t.pageWidth||595,d=t.pageHeight||842;t&&n?.images&&(t.hasImages=!0,t.imageInfo||(t.imageInfo={images:[],totalImages:0,pagesWithImages:0}),t.imageInfo.images=n.images,t.imageInfo.totalImages||(t.imageInfo.totalImages=n.images.reduce((v,w)=>v+(w.images?.length||0),0)),this.debugLogger.info("EZM-\uD63C\uD569\uBB38\uC11C",`\u{1F5BC}\uFE0F \uC774\uBBF8\uC9C0 \uC815\uBCF4 \uC124\uC815: ${t.imageInfo?.totalImages||0}\uAC1C \uC774\uBBF8\uC9C0`));let _=yield this.docGenerator.createCombinedDocument({debugLogger:this.debugLogger,pdfDocBuilder:this.pdfDocBuilder,vectorElementConverter:this.vectorElementConverter,pageBuilder:this.pageContentBuilder,loadedVectorData:e,textStreamRawData:i,pdfAnalysisData:t,pdfPages:[],pageWidth:s,pageHeight:d,totalPages:0,currentPage:1,cdr:{detectChanges:()=>{}},addDebugLog:(v,w,M)=>{let O=M?`${w} ${JSON.stringify(M)}`:w;this.debugLogger.info(v,O)},groupTextItems:v=>v,initializeNewDocument:()=>{},extractImagesFromPdf:()=>C(this,null,function*(){let v=new Map;if(t?.imageInfo?.images&&t.imageInfo.images.length>0){this.debugLogger.info("EZM-\uC774\uBBF8\uC9C0\uCD94\uCD9C",`\u{1F5BC}\uFE0F PdfImageExtractorService \uC0AC\uC6A9 (${t.imageInfo.images.length}\uAC1C \uD398\uC774\uC9C0 \uADF8\uB8F9)`);try{let w=this.pdfImageExtractor.extractFromAnalysisData(t,{preferOriginal:!0});this.debugLogger.info("EZM-\uC774\uBBF8\uC9C0\uCD94\uCD9C",`\u2705 \uCD94\uCD9C\uB41C \uC774\uBBF8\uC9C0: ${w.images.length}\uAC1C`);for(let M of w.images){let E=(t?.pageHeight||841.89)-M.y-M.height,D={id:`image-from-analysis-${Date.now()}-${Math.random()}`,type:"image",x:M.x,y:E,width:M.width,height:M.height,src:M.src,zIndex:-1},T=v.get(M.pageNumber)||[];T.push(D),v.set(M.pageNumber,T)}return v}catch(w){this.debugLogger.error("EZM-\uC774\uBBF8\uC9C0\uCD94\uCD9C",`\u274C PdfImageExtractorService \uC2E4\uD328: ${w}`)}}return n?.images&&(this.debugLogger.warn("EZM-\uC774\uBBF8\uC9C0\uCD94\uCD9C","\u26A0\uFE0F Fallback: imageData \uC9C1\uC811 \uC0AC\uC6A9"),n.images.forEach(w=>{let M=w.pageNumber||1;v.has(M)||v.set(M,[]),v.get(M).push(w)})),v}),closeAllModals:()=>{}});if(_.success&&_.pdfPages)return this.debugLogger.success("EZM-\uD63C\uD569\uBB38\uC11C",`\u2705 ${_.pdfPages.length}\uD398\uC774\uC9C0\uC758 \uD63C\uD569 \uBB38\uC11C \uC0DD\uC131 \uC644\uB8CC`),this.snackbar.showSuccess(`${_.pdfPages.length}\uD398\uC774\uC9C0\uC758 \uD63C\uD569 \uBB38\uC11C\uAC00 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4!`),_.pdfPages;throw new Error("\uD63C\uD569 \uBB38\uC11C \uC0DD\uC131 \uC2E4\uD328")}catch(s){throw this.debugLogger.error("EZM-\uD63C\uD569\uBB38\uC11C",`\u274C \uD63C\uD569 \uBB38\uC11C \uC0DD\uC131 \uC2E4\uD328: ${s}`),this.snackbar.showError("\uBB38\uC11C \uC0DD\uC131 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."),s}})}addVectorElementsToPages(t,e,n,i){!e||!e.pageDetails||e.pageDetails.forEach((s,d)=>{if(!s.svgContent)return;let _=t[d];if(!_)return;_.width=n,_.height=i;let v={id:`vector-${Date.now()}-${d}`,type:"svg",x:0,y:0,width:n,height:i,svgContent:s.svgContent,vectorData:s};_.elements.unshift(v)})}generateThumbnails(t,e,n){return C(this,null,function*(){let i=e.map(s=>({pageNumber:s,thumbnail:"",selected:s===1,isLoading:!0}));return yield this.pdfThumbnailService.generateThumbnailsBatch(t,e,{scale:.3,quality:.8,format:"image/webp"},(s,d)=>{let _=i.find(v=>v.pageNumber===s);_&&(_.thumbnail=d,_.isLoading=!1),n&&n(s,d)}),i})}static \u0275fac=function(e){return new(e||r)(X(kn),X(Dn),X(No),X(Yt),X(G),X(oo),X(Ji),X(Ro),X(Vo),X(Bo),X(Eo),X(Do))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var It=class r{currentDocumentSubject=new de(null);currentDocument$=this.currentDocumentSubject.asObservable();constructor(){}setEditingDocument(t){let e=Z(K({},t),{lastModified:new Date().toISOString()});this.currentDocumentSubject.next(e)}getEditingDocument(){return this.currentDocumentSubject.value}updateEditingDocument(t){let e=this.currentDocumentSubject.value;if(!e)return;let n=Z(K(K({},e),t),{lastModified:new Date().toISOString()});this.currentDocumentSubject.next(n)}clearEditingDocument(){this.currentDocumentSubject.next(null)}hasEditingDocument(){return this.currentDocumentSubject.value!==null}getStateInfo(){let t=this.currentDocumentSubject.value;return t?{hasDocument:!0,fileName:t.fileName,totalPages:t.totalPages,currentPage:t.currentPage,elementCount:t.pdfPages.reduce((e,n)=>e+(n.elements?.length||0),0),hasAnalysisData:!!t.pdfAnalysisData,lastModified:t.lastModified}:{hasDocument:!1}}backupToSessionStorage(){let t=this.currentDocumentSubject.value;if(t)try{let e=Z(K({},t),{pdfBlob:null,pdfSrc:null});sessionStorage.setItem("ezm-editor-state",JSON.stringify(e))}catch{}}restoreFromSessionStorage(){try{let t=sessionStorage.getItem("ezm-editor-state");if(t){let e=JSON.parse(t);return this.currentDocumentSubject.next(e),!0}}catch{}return!1}clearSessionStorage(){sessionStorage.removeItem("ezm-editor-state")}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var as=["searchInput"];function ss(r,t){if(r&1&&(o(0,"div",54)(1,"div",55)(2,"div",56),h(3,"div",57)(4,"div",58)(5,"div",58)(6,"div",59)(7,"div",60)(8,"div",58)(9,"div",58)(10,"div",61),a(),o(11,"div",62)(12,"span"),c(13),a(),o(14,"span",63),c(15,"..."),a()()()()),r&2){let e=g();l(13),x(e.loadingMessage)}}function ls(r,t){if(r&1&&(o(0,"div",64),h(1,"img",65),o(2,"span",66),c(3),a(),o(4,"span",67),c(5),a()()),r&2){let e=g();l(3),S("",e.totalPoints,"P"),l(2),ue("(\uC624\uB298 ",e.todayPoints,"/",e.MAX_DAILY_POINTS,")")}}function cs(r,t){if(r&1){let e=y();o(0,"div",68),u("click",function(i){return m(e),f(i.stopPropagation())}),o(1,"button",69),u("click",function(){m(e);let i=g();return f(i.onAiMenuSelect("summary"))}),o(2,"span"),c(3,"AI PDF \uC694\uC57D"),a(),h(4,"img",70),a(),o(5,"button",69),u("click",function(){m(e);let i=g();return f(i.onAiMenuSelect("translate"))}),o(6,"span"),c(7,"AI PDF \uBC88\uC5ED"),a(),h(8,"img",71),a()()}}function ds(r,t){if(r&1){let e=y();o(0,"button",69),u("click",function(){m(e);let i=g(2);return f(i.onMoreMenuSelect("encrypt"))}),h(1,"img",86),o(2,"span"),c(3,"\uC554\uD638\uD654"),a()()}}function ps(r,t){if(r&1){let e=y();o(0,"button",69),u("click",function(){m(e);let i=g(2);return f(i.onMoreMenuSelect("decrypt"))}),h(1,"img",87),o(2,"span"),c(3,"\uC554\uD638\uD574\uC81C"),a()()}}function gs(r,t){r&1&&h(0,"img",88)}function us(r,t){r&1&&h(0,"img",88)}function ms(r,t){if(r&1){let e=y();o(0,"div",72),u("click",function(i){return m(e),f(i.stopPropagation())}),o(1,"button",69),u("click",function(){m(e);let i=g();return f(i.onMoreMenuSelect("split"))}),h(2,"img",73),o(3,"span"),c(4,"\uBD84\uD560"),a()(),o(5,"button",69),u("click",function(){m(e);let i=g();return f(i.onMoreMenuSelect("rotate"))}),h(6,"img",74),o(7,"span"),c(8,"\uD68C\uC804"),a()(),b(9,ds,4,0,"button",75)(10,ps,4,0,"button",75),o(11,"button",69),u("click",function(){m(e);let i=g();return f(i.onMoreMenuSelect("organize"))}),h(12,"img",76),o(13,"span"),c(14,"\uAD6C\uC131"),a()(),o(15,"button",69),u("click",function(){m(e);let i=g();return f(i.onMoreMenuSelect("page-number"))}),h(16,"img",77),o(17,"span"),c(18,"\uD398\uC774\uC9C0 \uBC88\uD638"),a()(),o(19,"button",69),u("click",function(){m(e);let i=g();return f(i.onMoreMenuSelect("watermark"))}),h(20,"img",78),o(21,"span"),c(22,"\uC6CC\uD130\uB9C8\uD06C"),a()(),h(23,"div",79),o(24,"button",69),u("click",function(){m(e);let i=g();return f(i.onMoreMenuSelect("view-horizontal"))}),h(25,"img",80),o(26,"span"),c(27,"\uAC00\uB85C \uBCF4\uAE30 (\uD55C \uC7A5\uC529)"),a(),b(28,gs,1,0,"img",81),a(),o(29,"button",69),u("click",function(){m(e);let i=g();return f(i.onMoreMenuSelect("view-vertical"))}),h(30,"img",82),o(31,"span"),c(32,"\uC138\uB85C \uBCF4\uAE30 (\uC5F0\uC18D)"),a(),b(33,us,1,0,"img",81),a(),h(34,"div",79),o(35,"button",69),u("click",function(){m(e);let i=g();return f(i.onMoreMenuSelect("share"))}),h(36,"img",83),o(37,"span"),c(38,"\uACF5\uC720"),a()(),o(39,"button",84),u("click",function(){m(e);let i=g();return f(i.onMoreMenuSelect("delete"))}),h(40,"img",85),o(41,"span"),c(42,"\uC0AD\uC81C"),a()()()}if(r&2){let e=g();l(9),p("ngIf",!e.isDocumentEncrypted),l(),p("ngIf",e.isDocumentEncrypted),l(14),k("active",e.viewMode==="horizontal"),l(4),p("ngIf",e.viewMode==="horizontal"),l(),k("active",e.viewMode==="vertical"),l(4),p("ngIf",e.viewMode==="vertical")}}function fs(r,t){if(r&1){let e=y();o(0,"shared-pdf-viewer",89),u("pdfLoaded",function(i){m(e);let s=g();return f(s.onPdfLoaded(i))})("pdfLoadingFailed",function(i){m(e);let s=g();return f(s.onPdfLoadingFailed(i))})("pageChange",function(i){m(e);let s=g();return f(s.onPageChanged(i))})("zoomChange",function(i){m(e);let s=g();return f(s.onZoomChanged(i))})("updateFindMatchesCount",function(i){m(e);let s=g();return f(s.onFindMatchesCountUpdate(i))})("updateFindState",function(i){m(e);let s=g();return f(s.onFindStateUpdate(i))}),a()}if(r&2){let e=g();p("pdfSrc",e.pdfSrc)("isMobile",!0)("config",e.pdfViewerConfig)("showFloatingZoom",!1)}}function hs(r,t){if(r&1){let e=y();o(0,"shared-pdf-tools-panel-mobile",90),u("analyze",function(){m(e);let i=g();return f(i.onAddAnalyze())})("saveDocument",function(){m(e);let i=g();return f(i.onSaveDocument())}),a()}if(r&2){let e=g();p("currentPage",e.currentPage)("totalPages",e.totalPages)("isPdfViewer",!0)}}function _s(r,t){if(r&1){let e=y();o(0,"shared-pdf-thumbnail-strip",91),u("pageSelected",function(i){m(e);let s=g();return f(s.onThumbnailPageSelected(i))}),a()}if(r&2){let e=g();p("pdfSrc",e.pdfSrc)("totalPages",e.totalPages)("currentPage",e.currentPage)("visible",e.showThumbnails)}}function Cs(r,t){if(r&1){let e=y();o(0,"div",92)(1,"button",93),u("click",function(){m(e);let i=g();return f(i.toggleColorPalette())}),h(2,"img",94),a(),o(3,"button",95),u("click",function(){m(e);let i=g();return f(i.onEraserMode())}),h(4,"img",96),a(),o(5,"button",97),u("click",function(){m(e);let i=g();return f(i.closeDrawingMode())}),h(6,"img",98),a()()}if(r&2){let e=g();l(),q("--current-color",e.drawingColor),k("light-color",e.isLightColor(e.drawingColor)),l(2),k("active",e.isEraserMode)}}function bs(r,t){if(r&1){let e=y();o(0,"button",99),u("click",function(){let i=m(e).$implicit,s=g();return f(s.selectPresetColor(i))}),h(1,"img",100),a()}if(r&2){let e=t.$implicit,n=g();q("background-color",e),k("selected",n.drawingColor===e&&!n.isEraserMode)("light-color",n.isLightColor(e))}}function vs(r,t){if(r&1){let e=y();o(0,"button",104),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.selectFullColor(i))}),h(1,"img",105),a()}if(r&2){let e=t.$implicit,n=g(2);q("background-color",e),k("selected",n.drawingColor===e)("light-color",n.isLightColor(e))("white-color",e==="#FFFFFF")}}function xs(r,t){if(r&1&&(o(0,"div",101)(1,"div",102),b(2,vs,2,8,"button",103),a()()),r&2){let e=g();l(2),p("ngForOf",e.fullColorPalette)}}function Ps(r,t){if(r&1){let e=y();re(0),o(1,"div",106)(2,"button",107),u("click",function(){m(e);let i=g();return f(i.cancelRename())}),h(3,"img",108),a(),o(4,"h3",38),c(5,"\uC774\uB984 \uBCC0\uACBD"),a()(),o(6,"div",109)(7,"label",110),c(8,"\uC0C8 \uC774\uB984"),a(),o(9,"input",111),$("ngModelChange",function(i){m(e);let s=g();return U(s.renameInputValue,i)||(s.renameInputValue=i),f(i)}),a(),o(10,"p",112),c(11,".pdf \uD655\uC7A5\uC790\uB294 \uC790\uB3D9\uC73C\uB85C \uCD94\uAC00\uB429\uB2C8\uB2E4."),a(),o(12,"div",113)(13,"button",114),u("click",function(){m(e);let i=g();return f(i.cancelRename())}),c(14,"\uCDE8\uC18C"),a(),o(15,"button",115),u("click",function(){m(e);let i=g();return f(i.confirmRename())}),c(16,"\uC644\uB8CC"),a()()(),ae()}if(r&2){let e=g();l(9),j("ngModel",e.renameInputValue)}}function Ms(r,t){if(r&1){let e=y();o(0,"div",37)(1,"h3",38),c(2),a()(),o(3,"div",116)(4,"button",117),u("click",function(){m(e);let i=g();return f(i.onFileMenuAction("edit"))}),h(5,"img",118),o(6,"span"),c(7,"PDF \uD3B8\uC9D1"),a()(),o(8,"button",117),u("click",function(){m(e);let i=g();return f(i.onFileMenuAction("share"))}),h(9,"img",119),o(10,"span"),c(11,"\uACF5\uC720"),a()(),o(12,"button",117),u("click",function(){m(e);let i=g();return f(i.onFileMenuAction("rename"))}),h(13,"img",120),o(14,"span"),c(15,"\uC774\uB984\uBCC0\uACBD"),a()(),o(16,"button",117),u("click",function(){m(e);let i=g();return f(i.onFileMenuAction("duplicate"))}),h(17,"img",121),o(18,"span"),c(19,"\uBCF5\uC81C"),a()(),o(20,"button",122),u("click",function(){m(e);let i=g();return f(i.onFileMenuAction("delete"))}),h(21,"img",123),o(22,"span"),c(23,"\uC0AD\uC81C"),a()()()}if(r&2){let e=g();l(2),x(e.fileName)}}var Xn=class r{constructor(t,e,n,i,s,d){this.router=t;this.route=e;this.dialog=n;this.geminiApiManager=i;this.toolActionService=s;this.cdr=d}pdfSrc=null;pdfBlob=null;fileName="";documentType="empty";currentActiveTab="viewer";currentDocumentId=null;currentDocumentIsFavorite=!1;isLoading=!1;loadingMessage="PDF \uBB38\uC11C\uB97C \uBD88\uB7EC\uC624\uB294 \uC911...";loadingProgress=0;pdfPages=[];currentPage=1;totalPages=0;zoomLevel=100;showThumbnails=!0;thumbnailDelayTimer=null;isFullscreenMode=!1;isDrawingMode=!1;isEraserMode=!1;showColorPalette=!1;showColorPicker=!1;drawingThickness=5;drawingColor="#FFEB3B";presetColors=["#FFEB3B","#2196F3","#4CAF50","#F44336"];fullColorPalette=["#FFEB3B","#2196F3","#4CAF50","#F44336","#FF9800","#9C27B0","#00BCD4","#E91E63","#795548","#607D8B","#000000","#FFFFFF"];availableColors=["#FFFFFF","#FFEB3B","#4CAF50","#2196F3","#E91E63","#000000"];isHeaderSearchMode=!1;searchQuery="";searchResults=[];currentSearchIndex=0;totalSearchMatches=0;searchSubject=new be;pdfAnalysisData=null;vectorData=null;imageData=null;pdfTextStreamData=null;hasGeneratedDocument=!1;pdfViewerConfig={zoom:"page-width",height:"100%",mobileFriendlyZoom:"page-width",currentPage:1,scrollMode:0,pageViewMode:"multiple",textLayer:!1};viewMode="horizontal";initialZoomLevel=100;isInitialZoomSet=!1;touchStartX=0;touchStartY=0;touchEndX=0;touchEndY=0;SWIPE_THRESHOLD=50;swipeListenersAttached=!1;boundTouchStart=null;boundTouchEnd=null;isPinchZooming=!1;touchFingerCount=0;toolsPanel;searchInputRef;fileMenuSheetState="collapsed";currentDocument=null;isRenameMode=!1;renameInputValue="";isDocumentEncrypted=!1;drawingSheetState="collapsed";showAiMenu=!1;showMoreMenu=!1;todayPoints=0;totalPoints=0;MAX_DAILY_POINTS=5;currentDocumentPointAdded=!1;snackbar=P(G);documentService=P(Dt);analysisService=P(Zt);editorStateService=P(It);indexedDbService=P(ee);pdfViewerService=P(bo);pdfjsLibService=P(Me);pdfNotificationService=P(Co);pointsService=P(Ue);get PDFViewerApplication(){return this.pdfNotificationService.onPDFJSInitSignal()}toggleFileMenu(){this.fileMenuSheetState==="collapsed"?this.fileMenuSheetState="half":(this.fileMenuSheetState="collapsed",this.isRenameMode=!1)}closeFileMenu(){this.fileMenuSheetState="collapsed",this.isRenameMode=!1}onFileMenuAction(t){switch(t){case"share":this.shareCurrentDocument();break;case"rename":this.isRenameMode=!0,this.renameInputValue=this.fileName.replace(/\.pdf$/i,""),this.fileMenuSheetState="full";break;case"duplicate":this.duplicateCurrentDocument();break;case"delete":this.deleteCurrentDocument();break;case"edit":this.startPdfEdit();break}}startPdfEdit(){if(this.closeFileMenu(),this.documentType==="pdf-editor"&&this.pdfPages&&this.pdfPages.length>0){this.snackbar.showInfo("\uC774\uBBF8 \uD3B8\uC9D1 \uBAA8\uB4DC\uC785\uB2C8\uB2E4.");return}this.onAddAnalyze()}openToolsPanel(){this.toolsPanel&&this.toolsPanel.toggleSheet()}shareCurrentDocument(){return C(this,null,function*(){if(this.closeFileMenu(),!!this.currentDocument)try{let t=this.currentDocument.pdfBase64||this.currentDocument.originalPdfBase64;if(!t){this.snackbar.showError("\uACF5\uC720\uD560 PDF \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let e=this.currentDocument.fileName||this.currentDocument.title+".pdf";if(this.tryNativeShare(e,t)){this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uACF5\uC720\uD588\uC2B5\uB2C8\uB2E4.");return}if(typeof navigator<"u"&&navigator.share){let n=this.base64ToBlob(t,"application/pdf"),i=[];try{i.push(new File([n],e,{type:"application/pdf"}))}catch{}let s={title:e,text:`${e} \uBB38\uC11C\uB97C \uACF5\uC720\uD569\uB2C8\uB2E4.`};i.length&&(typeof navigator.canShare!="function"||navigator.canShare({files:i}))&&(s.files=i),yield navigator.share(s),this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uACF5\uC720\uD588\uC2B5\uB2C8\uB2E4.");return}this.downloadFile(e,t),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch(t){if(t?.name==="AbortError")return;this.snackbar.showError("\uBB38\uC11C \uACF5\uC720\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}tryNativeShare(t,e){if(typeof window<"u"&&window.parent!==window)try{return window.parent.postMessage({type:"share",fileName:t,data:e},"*"),!0}catch{}return window.ReactNativeWebView?(window.ReactNativeWebView.postMessage(JSON.stringify({type:"share",fileName:t,data:e})),!0):window.webkit?.messageHandlers?.shareFile?(window.webkit.messageHandlers.shareFile.postMessage({fileName:t,data:e}),!0):window.Android?.shareFile?(window.Android.shareFile(t,e),!0):!1}downloadFile(t,e){let n=this.base64ToBlob(e,"application/pdf"),i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}confirmRename(){return C(this,null,function*(){if(!this.currentDocument)return;let t=this.renameInputValue.trim();if(!t){this.snackbar.showWarning("\uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694.");return}try{this.currentDocument.title=t,this.currentDocument.fileName=t+".pdf",yield this.indexedDbService.updateDocument(this.currentDocument),this.fileName=t+".pdf",this.snackbar.showSuccess("\uD30C\uC77C \uC774\uB984\uC774 \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.isRenameMode=!1,this.fileMenuSheetState="collapsed"}catch{this.snackbar.showError("\uD30C\uC77C \uC774\uB984\uC744 \uBCC0\uACBD\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}cancelRename(){this.isRenameMode=!1,this.fileMenuSheetState="full"}duplicateCurrentDocument(){return C(this,null,function*(){if(this.closeFileMenu(),!!this.currentDocument)try{let t=new Date().toISOString(),e=(this.currentDocument.title||this.currentDocument.fileName||"\uBB38\uC11C").replace(/\.pdf$/i,""),n=Z(K({},this.currentDocument),{id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,title:`${e} \uC0AC\uBCF8`,fileName:`${e}_\uC0AC\uBCF8.pdf`,createdAt:t,updatedAt:t});yield this.indexedDbService.saveDocument(n),this.snackbar.showSuccess("\uC0AC\uBCF8\uC774 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch{this.snackbar.showError("\uD30C\uC77C\uC744 \uBCF5\uC81C\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}deleteCurrentDocument(){return C(this,null,function*(){if(!(!this.currentDocument||!(yield xe(`"${this.fileName}" \uD30C\uC77C\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`))))try{yield this.indexedDbService.deleteDocument(this.currentDocument.id),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.router.navigate(["/ezm/myfiles","my-files"])}catch{this.snackbar.showError("\uD30C\uC77C \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}base64ToBlob(t,e="application/pdf"){let n=t.includes(",")?t.split(",")[1]:t,i=atob(n),s=new Array(i.length);for(let _=0;_<i.length;_++)s[_]=i.charCodeAt(_);let d=new Uint8Array(s);return new Blob([d],{type:e})}ngOnInit(){this.pointsService.totalPoints$.subscribe(t=>{this.totalPoints=t}),this.pointsService.todayPoints$.subscribe(t=>{this.todayPoints=t}),this.searchSubject.pipe(hn(400),_n()).subscribe(t=>{this.executeSearch(t)}),this.route.queryParams.subscribe(t=>C(this,null,function*(){if(t.mode==="new-document"){this.initializeNewDocument(t.fileName||"\uC0C8\uBB38\uC11C.pdf");return}if(t.docId){this.startLoading("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC624\uB294 \uC911...");try{let i=yield this.indexedDbService.getDocumentById(t.docId);if(i){yield this.loadDocumentFromIndexedDB(i,"viewer");return}else{this.stopLoading(),this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.goBack();return}}catch{this.stopLoading(),this.snackbar.showError("\uBB38\uC11C \uB85C\uB4DC \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."),this.goBack();return}}let n=this.router.getCurrentNavigation()?.extras?.state||history.state;if(n?.pdfUrl)this.loadNewPdfFile(n.pdfUrl,n.fileName,n.pdfBlob);else if(n?.document){let i=n.mode||"auto";this.loadDocumentFromIndexedDB(n.document,i)}else this.documentType="empty"}))}ngAfterViewInit(){this.setupTouchListeners()}setupTouchListeners(){let t=document.querySelector("#viewerContainer");t&&(t.addEventListener("touchstart",e=>{let n=e;this.isUserTouching=!0,this.touchFingerCount=n.touches.length,n.touches.length>=2&&(this.isPinchZooming=!0),this.zoomBounceTimer&&(clearTimeout(this.zoomBounceTimer),this.zoomBounceTimer=null)},{passive:!0}),t.addEventListener("touchmove",e=>{let n=e;n.touches.length>=2&&(this.isPinchZooming=!0,this.touchFingerCount=n.touches.length)},{passive:!0}),t.addEventListener("touchend",e=>{let n=e;if(n.touches.length===0){this.isUserTouching=!1,this.isPinchZooming=!1,this.touchFingerCount=0;let i=this.initialZoomLevel||40;this.zoomLevel<i&&this.bounceBackToMinZoom(i)}else this.touchFingerCount=n.touches.length},{passive:!0}),t.addEventListener("touchcancel",()=>{this.isUserTouching=!1,this.isPinchZooming=!1,this.touchFingerCount=0},{passive:!0}))}initializeNewDocument(t){this.documentType="pdf-editor",this.fileName=t,this.pdfPages=[{pageNumber:1,elements:[],width:595,height:842}],this.totalPages=1,this.currentPage=1,this.pdfSrc=null,this.pdfBlob=null}loadNewPdfFile(t,e,n){this.startLoading("PDF \uD30C\uC77C \uC900\uBE44 \uC911..."),this.documentService.loadPdfFile({pdfUrl:t,fileName:e,pdfBlob:n}).subscribe({next:i=>{this.updateLoadingProgress(50,"PDF \uBDF0\uC5B4 \uC900\uBE44 \uC911..."),this.pdfSrc=i.pdfSrc,this.pdfBlob=i.pdfBlob,this.fileName=i.fileName,this.documentType=i.documentType},error:i=>{this.stopLoading(),this.goBack()}})}loadDocumentFromIndexedDB(t,e="auto"){return C(this,null,function*(){let n=t;try{let i=yield this.indexedDbService.getDocumentById(t.id);i&&(n=i,console.log("\u{1F504} [\uCD5C\uC2E0 \uBB38\uC11C \uC870\uD68C] IndexedDB\uC5D0\uC11C \uCD5C\uC2E0 \uB370\uC774\uD130 \uB85C\uB4DC\uB428"))}catch(i){console.warn("\u26A0\uFE0F \uCD5C\uC2E0 \uBB38\uC11C \uC870\uD68C \uC2E4\uD328, \uC804\uB2EC\uB41C \uB370\uC774\uD130 \uC0AC\uC6A9:",i)}this.currentDocument=n,console.log("\u{1F510} [\uC554\uD638\uD654 \uC0C1\uD0DC \uCCB4\uD06C] freshDocData.isEncrypted:",n.isEncrypted),this.isDocumentEncrypted=n.isEncrypted||!1,console.log("\u{1F510} [\uC554\uD638\uD654 \uC0C1\uD0DC \uC124\uC815] this.isDocumentEncrypted =",this.isDocumentEncrypted),this.startLoading("PDF \uB370\uC774\uD130 \uBCC0\uD658 \uC911..."),this.documentService.loadDocumentFromIndexedDB(n,{mode:e}).subscribe({next:i=>C(this,null,function*(){if(this.updateLoadingProgress(50,"PDF \uBDF0\uC5B4 \uC900\uBE44 \uC911..."),this.pdfSrc=i.pdfSrc,this.pdfBlob=i.pdfBlob,this.fileName=i.fileName,this.documentType=i.documentType,this.currentDocumentId=n.id,i.pdfPages&&(this.pdfPages=i.pdfPages,this.totalPages=i.totalPages||i.pdfPages.length,this.currentPage=1),e==="viewer"||!e||e==="auto")try{let s=n.thumbnail;if(!s&&i.pdfSrc){let d=yield this.generateThumbnail(i.pdfSrc);d&&(s=d,n.thumbnail=d,yield this.indexedDbService.updateDocument(n))}yield this.indexedDbService.addToRecentFiles(n.id,i.fileName,s,n.documentType,n.folderId,n.fileSize,n.isEncrypted),console.log("\u{1F510} [Viewer \uBAA8\uB4DC] \uC554\uD638\uD654 \uC0C1\uD0DC \uC7AC\uC124\uC815:",n.isEncrypted),this.isDocumentEncrypted=n.isEncrypted||!1}catch{}this.updateFavoriteStatus(),(e==="editor"||e==="convert")&&!i.pdfPages&&setTimeout(()=>{this.onAddAnalyze()},300)}),error:i=>{this.stopLoading(),this.goBack()}})})}onAddAnalyze(){return C(this,null,function*(){if(!this.pdfSrc||!this.fileName){this.snackbar.showError("PDF \uD30C\uC77C\uC744 \uBA3C\uC800 \uC5F4\uC5B4\uC8FC\uC138\uC694.");return}try{let t=yield this.analysisService.startPdfAnalysis({pdfSrc:this.pdfSrc,fileName:this.fileName},this.hasGeneratedDocument&&this.documentType==="pdf-editor");this.editorStateService.setEditingDocument({fileName:this.fileName,pdfSrc:this.pdfSrc,pdfBlob:this.pdfBlob,pdfPages:t.pdfPages,currentPage:1,totalPages:t.pdfPages.length,pdfAnalysisData:t.pdfAnalysisData,vectorData:t.vectorData,imageData:t.imageData,pdfTextStreamData:t.pdfTextStreamData,hasGeneratedDocument:!0,lastModified:new Date().toISOString()}),this.router.navigate(["/ezm/editor"])}catch(t){if(t.message==="\uBD84\uC11D \uCDE8\uC18C\uB428")return;if(t.message==="\uAE30\uC874 \uD3B8\uC9D1 \uACC4\uC18D")return;this.snackbar.showError("PDF \uBD84\uC11D \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}onPdfLoaded(t){this.totalPages=t.pagesCount||0,this.currentPage=1,this.showThumbnails=!0,this.viewMode==="horizontal"&&this.applyHorizontalMode(),this.addReadingPoint(),this.updateLoadingProgress(100,"\uC644\uB8CC!"),setTimeout(()=>this.stopLoading(),300)}onPdfLoadingFailed(t){return C(this,null,function*(){console.error("\u274C [Viewer] PDF \uB85C\uB4DC \uC2E4\uD328:",t),this.stopLoading();let e="PDF \uD30C\uC77C\uC744 \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.";t?.message&&(t.message.includes("Invalid PDF structure")||t.name==="InvalidPDFException"?e=`\uC190\uC0C1\uB41C PDF \uD30C\uC77C\uC785\uB2C8\uB2E4.
\uD30C\uC77C\uC774 \uC62C\uBC14\uB978\uC9C0 \uD655\uC778\uD574\uC8FC\uC138\uC694.`:t.message.includes("password")&&(e="\uC554\uD638\uAC00 \uD544\uC694\uD55C PDF \uD30C\uC77C\uC785\uB2C8\uB2E4.")),yield xe(e),this.router.navigate(["/ezm"])})}applyHorizontalMode(){setTimeout(()=>{let t=this.PDFViewerApplication;t?.pdfViewer&&(t.pdfViewer.scrollMode=1,t.pdfViewer.spreadMode=0,t.pdfViewer.currentPageNumber=1,this.calculateAndApplyFitZoom(t),this.setupSwipeListeners(),console.log("\u{1F4D0} \uAC00\uB85C \uBCF4\uAE30 \uBAA8\uB4DC \uC801\uC6A9\uB428")),this.pdfViewerConfig=Z(K({},this.pdfViewerConfig),{scrollMode:1,pageViewMode:"single",currentPage:1}),this.currentPage=1},300)}calculateAndApplyFitZoom(t){try{let e=t.pdfViewer;if(!e)return;let n=e.getPageView(0);if(!n?.viewport){console.warn("\u26A0\uFE0F \uD398\uC774\uC9C0 \uBDF0\uD3EC\uD2B8\uB97C \uAC00\uC838\uC62C \uC218 \uC5C6\uC74C");return}let i=n.viewport.width,s=n.viewport.height,d=n.viewport.scale,_=document.querySelector(".pdf-viewer-wrapper");if(!_){console.warn("\u26A0\uFE0F \uBDF0\uC5B4 \uCEE8\uD14C\uC774\uB108\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC74C");return}let v=_.clientWidth,w=_.clientHeight,M=i/d,O=s/d,E=v/M,D=Math.floor(E*100*.75),T=Math.max(25,Math.min(200,D));if(console.log(`\u{1F4D0} \uC90C \uACC4\uC0B0: \uD398\uC774\uC9C0 \uB108\uBE44(${Math.round(M)}) / \uCEE8\uD14C\uC774\uB108 \uB108\uBE44(${v}) => ${T}%`),!this.isInitialZoomSet){this.initialZoomLevel=T,this.isInitialZoomSet=!0;let I=T*.7/100;"minZoom"in e?(e.minZoom=I,console.log(`\u{1F512} \uCD5C\uC18C \uC90C \uC124\uC815 (\uD0C4\uC131 \uD6A8\uACFC\uC6A9): ${Math.round(T*.7)}% (scale: ${I.toFixed(2)})`)):console.warn("\u26A0\uFE0F pdfViewer\uC5D0 minZoom \uC18D\uC131\uC774 \uC5C6\uC74C. \uC218\uB3D9 \uC81C\uD55C \uC801\uC6A9\uB428.")}this.zoomLevel=T,t.pdfViewer.currentScaleValue=(T/100).toString(),this.pdfViewerConfig=Z(K({},this.pdfViewerConfig),{zoom:T.toString()})}catch(e){console.error("\u274C \uC90C \uACC4\uC0B0 \uC2E4\uD328:",e)}}setupSwipeListeners(){if(this.swipeListenersAttached)return;let t=document.querySelector("#viewerContainer");if(!t){console.warn("\u26A0\uFE0F viewerContainer\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC74C");return}this.boundTouchStart=e=>{if(e.touches.length>=2){this.isPinchZooming=!0;return}this.touchStartX=e.touches[0].clientX,this.touchStartY=e.touches[0].clientY},this.boundTouchEnd=e=>{if(this.isPinchZooming){e.touches.length===0&&setTimeout(()=>{this.isPinchZooming=!1},100);return}this.touchEndX=e.changedTouches[0].clientX,this.touchEndY=e.changedTouches[0].clientY,this.handleSwipeGesture()},t.addEventListener("touchstart",this.boundTouchStart,{passive:!0}),t.addEventListener("touchend",this.boundTouchEnd,{passive:!0}),this.swipeListenersAttached=!0,console.log("\u{1F446} \uC2A4\uC640\uC774\uD504 \uB9AC\uC2A4\uB108 \uB4F1\uB85D\uB428")}removeSwipeListeners(){if(!this.swipeListenersAttached)return;let t=document.querySelector("#viewerContainer");t&&(this.boundTouchStart&&t.removeEventListener("touchstart",this.boundTouchStart),this.boundTouchEnd&&t.removeEventListener("touchend",this.boundTouchEnd)),this.swipeListenersAttached=!1,this.boundTouchStart=null,this.boundTouchEnd=null}onThumbnailPageSelected(t){this.currentPage=t;let e=this.PDFViewerApplication;e?.pdfViewer&&(e.pdfViewer.currentPageNumber=t)}onPageChanged(t){this.currentPage=t}zoomBounceTimer=null;isUserTouching=!1;onZoomChanged(t){if(isNaN(t)||t<=0||t>1e3)return;let e=this.initialZoomLevel||40,n=e*.7;if(t<e){t>=n&&(this.zoomLevel=Math.round(t),this.isUserTouching||(this.zoomBounceTimer&&clearTimeout(this.zoomBounceTimer),this.zoomBounceTimer=setTimeout(()=>{this.bounceBackToMinZoom(e)},150)));return}this.zoomBounceTimer&&(clearTimeout(this.zoomBounceTimer),this.zoomBounceTimer=null),this.zoomLevel=Math.round(t)}bounceBackToMinZoom(t){let e=this.PDFViewerApplication;if(!e?.pdfViewer)return;let n=this.zoomLevel,i=t,s=i/n,d=document.querySelector("#viewer");d?(d.style.transformOrigin="center center",d.style.transition="transform 0.25s cubic-bezier(0.34, 1.56, 0.64, 1)",d.style.transform=`scale(${s})`,setTimeout(()=>{d.style.transition="none",d.style.transform="",this.zoomLevel=i,e.pdfViewer.currentScaleValue=(i/100).toString(),setTimeout(()=>{d.style.transition="",d.style.transformOrigin=""},50),this.zoomBounceTimer=null,this.cdr.detectChanges()},250)):(this.zoomLevel=t,e.pdfViewer.currentScaleValue=(t/100).toString(),this.zoomBounceTimer=null,this.cdr.detectChanges())}onFindMatchesCountUpdate(t){console.log("\uAC80\uC0C9 \uACB0\uACFC \uC5C5\uB370\uC774\uD2B8:",t),this.totalSearchMatches=t.total||0,this.currentSearchIndex=t.current||0,this.totalSearchMatches>0?this.searchResults=Array(this.totalSearchMatches).fill(0).map((e,n)=>n):this.searchResults=[],this.cdr.detectChanges()}onFindStateUpdate(t){console.log("\uAC80\uC0C9 \uC0C1\uD0DC \uC5C5\uB370\uC774\uD2B8:",t)}onZoomIn(){this.zoomLevel=Math.min(this.zoomLevel+25,300),this.updateZoomConfig()}onZoomOut(){this.zoomLevel=Math.max(this.zoomLevel-25,50),this.updateZoomConfig()}updateZoomConfig(){this.pdfViewerConfig=Z(K({},this.pdfViewerConfig),{zoom:this.zoomLevel.toString()})}toggleThumbnails(){this.showThumbnails=!this.showThumbnails}toggleFullscreenMode(){if(this.showAiMenu||this.showMoreMenu){this.showAiMenu=!1,this.showMoreMenu=!1;return}this.isFullscreenMode=!this.isFullscreenMode,this.cdr.detectChanges(),requestAnimationFrame(()=>{window.dispatchEvent(new Event("resize")),setTimeout(()=>{window.dispatchEvent(new Event("resize"))},50)})}onAiMenuClick(){this.showAiMenu=!this.showAiMenu,this.showMoreMenu=!1}onMoreMenuClick(){this.showMoreMenu=!this.showMoreMenu,this.showAiMenu=!1,console.log("\u{1F4CB} [\uB354\uBCF4\uAE30 \uBA54\uB274 \uC5F4\uB9BC] isDocumentEncrypted:",this.isDocumentEncrypted)}closeAllMenus(){this.showAiMenu=!1,this.showMoreMenu=!1}onAiMenuSelect(t){this.showAiMenu=!1,t==="summary"?this.onAiSummary():t==="translate"&&this.onAiTranslate()}onMoreMenuSelect(t){if(console.log("\u{1F514} onMoreMenuSelect \uD638\uCD9C\uB428:",t),console.log("\u{1F510} [\uBA54\uB274 \uC120\uD0DD \uC2DC] isDocumentEncrypted:",this.isDocumentEncrypted),console.log("\u{1F4C4} currentDocument:",this.currentDocument),console.log("\u{1F194} currentDocumentId:",this.currentDocumentId),this.showMoreMenu=!1,!this.currentDocument||!this.currentDocumentId){console.warn("\uBB38\uC11C \uC815\uBCF4 \uC5C6\uC74C!"),this.snackbar.showWarning("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC624\uB294 \uC911\uC785\uB2C8\uB2E4.");return}switch(t){case"merge":this.toolActionService.setPendingAction({toolId:"merge",toolLabel:"PDF \uBCD1\uD569",action:"merge-pdf",requiresFileSelection:!0}),this.router.navigate(["/ezm/myfiles","my-files"]);break;case"split":this.navigateToTool("split","/ezm/split","\uBD84\uD560");break;case"rotate":this.navigateToTool("rotate","/ezm/rotate","\uD68C\uC804");break;case"encrypt":this.navigateToTool("encrypt","/ezm/encrypt","\uC554\uD638\uD654");break;case"decrypt":this.navigateToTool("decrypt","/ezm/decrypt","\uC554\uD638\uD574\uC81C");break;case"organize":this.navigateToTool("organize","/ezm/organize","\uAD6C\uC131");break;case"page-number":this.navigateToTool("page-number","/ezm/page-number","\uD398\uC774\uC9C0 \uBC88\uD638");break;case"watermark":this.navigateToTool("watermark","/ezm/watermark","\uC6CC\uD130\uB9C8\uD06C");break;case"share":this.shareCurrentDocument();break;case"delete":this.deleteCurrentDocument();break;case"view-vertical":this.setViewMode("vertical");break;case"view-horizontal":this.setViewMode("horizontal");break}}setViewMode(t){if(this.viewMode===t)return;this.viewMode=t;let e=t==="vertical"?0:3;try{let i=this.PDFViewerApplication;i?.eventBus?(i.eventBus.dispatch("switchscrollmode",{source:this,mode:e}),console.log("ScrollMode \uC774\uBCA4\uD2B8 \uBC1C\uC1A1:",e)):i?.pdfViewer&&(i.pdfViewer.scrollMode=e,console.log("ScrollMode \uC9C1\uC811 \uC124\uC815:",e))}catch(i){console.warn("ScrollMode \uBCC0\uACBD \uC2E4\uD328:",i)}let n=t==="vertical"?"\uC138\uB85C \uBCF4\uAE30 (\uC5F0\uC18D)":"\uAC00\uB85C \uBCF4\uAE30 (\uD55C \uC7A5\uC529)";this.snackbar.showSuccess(`${n} \uBAA8\uB4DC\uB85C \uC804\uD658\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),this.cdr.detectChanges()}onTouchStart(t){this.viewMode==="horizontal"&&(this.touchStartX=t.touches[0].clientX,this.touchStartY=t.touches[0].clientY)}onTouchEnd(t){this.viewMode==="horizontal"&&(this.touchEndX=t.changedTouches[0].clientX,this.touchEndY=t.changedTouches[0].clientY,this.handleSwipeGesture())}handleSwipeGesture(){let t=this.touchEndX-this.touchStartX,e=this.touchEndY-this.touchStartY;if(Math.abs(t)>Math.abs(e)&&Math.abs(t)>this.SWIPE_THRESHOLD){let n=document.querySelector("#viewerContainer");if(!n)return;let i=n.scrollLeft<=5,s=n.scrollLeft+n.clientWidth>=n.scrollWidth-5;t>0&&i?this.slideToPage(this.currentPage-1,"right"):t<0&&s&&this.slideToPage(this.currentPage+1,"left")}}goToPreviousPage(){if(this.currentPage>1){let t=this.currentPage-1;this.slideToPage(t,"right")}}goToNextPage(){if(this.currentPage<this.totalPages){let t=this.currentPage+1;this.slideToPage(t,"left")}}slideToPage(t,e){if(!(t<1||t>this.totalPages))try{let n=document.querySelector("#viewerContainer"),i=document.querySelector("#viewer");if(!n||!i){this.navigateToPage(t);return}i.classList.add("slide-animating",`slide-${e}`),setTimeout(()=>{this.navigateToPage(t),n.scrollLeft=0,i.classList.remove("slide-animating","slide-left","slide-right"),i.classList.add("slide-enter"),setTimeout(()=>{i.classList.remove("slide-enter")},200)},150)}catch(n){console.warn("\uC2AC\uB77C\uC774\uB4DC \uD398\uC774\uC9C0 \uC774\uB3D9 \uC2E4\uD328:",n),this.navigateToPage(t)}}navigateToPage(t){try{let e=this.PDFViewerApplication;e?.pdfViewer&&(e.pdfViewer.currentPageNumber=t,this.currentPage=t,this.cdr.detectChanges())}catch(e){console.warn("\uD398\uC774\uC9C0 \uC774\uB3D9 \uC2E4\uD328:",e)}}navigateToTool(t,e,n){this.currentDocumentId&&this.toolActionService.setViewerReturnState({docId:this.currentDocumentId,page:this.currentPage}),this.toolActionService.setPendingAction({toolId:t,toolLabel:`PDF ${n}`,action:`${t}-pdf`,requiresFileSelection:!1,data:{documentId:this.currentDocumentId,fromViewer:!0}}),this.router.navigate([e])}toggleFavorite(){return C(this,null,function*(){if(console.log("\u{1F516} [\uC990\uACA8\uCC3E\uAE30] \uD1A0\uAE00 \uC2DC\uC791"),console.log("\u{1F516} [\uC990\uACA8\uCC3E\uAE30] currentDocumentId:",this.currentDocumentId),console.log("\u{1F516} [\uC990\uACA8\uCC3E\uAE30] currentDocumentIsFavorite:",this.currentDocumentIsFavorite),!this.currentDocumentId){console.error("\u274C [\uC990\uACA8\uCC3E\uAE30] documentId\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4"),this.snackbar.showWarning("\uBB38\uC11C \uC815\uBCF4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}try{console.log("\u{1F516} [\uC990\uACA8\uCC3E\uAE30] IndexedDB toggleFavorite \uD638\uCD9C \uC2DC\uC791..."),yield this.documentService.indexedDbService.toggleFavorite(this.currentDocumentId),console.log("\u2705 [\uC990\uACA8\uCC3E\uAE30] IndexedDB toggleFavorite \uC644\uB8CC"),this.currentDocumentIsFavorite=!this.currentDocumentIsFavorite,console.log("\u{1F516} [\uC990\uACA8\uCC3E\uAE30] \uC0C8\uB85C\uC6B4 \uC0C1\uD0DC:",this.currentDocumentIsFavorite);let t=this.currentDocumentIsFavorite?`"${this.fileName}"\uC744(\uB97C) \uC990\uACA8\uCC3E\uAE30\uC5D0 \uCD94\uAC00\uD588\uC2B5\uB2C8\uB2E4.`:`"${this.fileName}"\uC744(\uB97C) \uC990\uACA8\uCC3E\uAE30\uC5D0\uC11C \uC81C\uAC70\uD588\uC2B5\uB2C8\uB2E4.`;this.snackbar.showSuccess(t),console.log("\u2705 [\uC990\uACA8\uCC3E\uAE30] \uC644\uB8CC:",t)}catch(t){console.error("\u274C [\uC990\uACA8\uCC3E\uAE30] \uD1A0\uAE00 \uC2E4\uD328:",t),console.error("\u274C [\uC990\uACA8\uCC3E\uAE30] \uC5D0\uB7EC \uC0C1\uC138:",JSON.stringify(t,null,2)),this.snackbar.showError("\uC990\uACA8\uCC3E\uAE30 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}updateFavoriteStatus(){return C(this,null,function*(){if(console.log("\u{1F516} [\uC990\uACA8\uCC3E\uAE30] \uC0C1\uD0DC \uC5C5\uB370\uC774\uD2B8 \uC2DC\uC791"),console.log("\u{1F516} [\uC990\uACA8\uCC3E\uAE30] currentDocumentId:",this.currentDocumentId),!this.currentDocumentId){console.warn("\u26A0\uFE0F [\uC990\uACA8\uCC3E\uAE30] documentId \uC5C6\uC74C, false\uB85C \uC124\uC815"),this.currentDocumentIsFavorite=!1;return}try{let t=yield this.documentService.indexedDbService.getDocumentById(this.currentDocumentId);console.log("\u{1F516} [\uC990\uACA8\uCC3E\uAE30] \uBB38\uC11C \uC870\uD68C \uACB0\uACFC:",t?{id:t.id,isFavorite:t.isFavorite,title:t.title}:"null"),this.currentDocumentIsFavorite=t?.isFavorite||!1,console.log("\u2705 [\uC990\uACA8\uCC3E\uAE30] \uC0C1\uD0DC \uC5C5\uB370\uC774\uD2B8 \uC644\uB8CC:",this.currentDocumentIsFavorite)}catch(t){console.error("\u274C [\uC990\uACA8\uCC3E\uAE30] \uC0C1\uD0DC \uC5C5\uB370\uC774\uD2B8 \uC2E4\uD328:",t),this.currentDocumentIsFavorite=!1}})}onSaveDocument(){return C(this,null,function*(){try{let t=prompt("\uBB38\uC11C \uC81C\uBAA9\uC744 \uC785\uB825\uD558\uC138\uC694:",this.fileName||"\uC0C8\uBB38\uC11C.pdf");if(!t||t.trim()==="")return;this.snackbar.showInfo("\uBB38\uC11C\uB97C \uC800\uC7A5\uD558\uACE0 \uC788\uC2B5\uB2C8\uB2E4..."),yield this.documentService.saveDocumentSimple(t.trim(),this.pdfPages,this.documentType==="pdf-editor"?"editor":"viewer",this.pdfBlob||void 0,this.pdfSrc||void 0),this.fileName=t.trim();let e=yield this.documentService.indexedDbService.getDocumentByTitle(this.fileName);e&&(this.currentDocumentId=e.id,yield this.updateFavoriteStatus())}catch{this.snackbar.showError("\uBB38\uC11C \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}goBack(){return C(this,null,function*(){if(yield this.checkForDrawingAnnotations()){if(yield xe("\uADF8\uB9AC\uAE30 \uB0B4\uC6A9\uC774 \uC788\uC2B5\uB2C8\uB2E4. \uC800\uC7A5\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")){yield this.saveDrawingAndExit();return}this.isDrawingMode&&this.closeDrawingMode()}this.pdfSrc&&URL.revokeObjectURL(this.pdfSrc),this.router.navigate(["/ezm/home"])})}onAiTranslate(){return C(this,null,function*(){if(!this.currentDocument){this.snackbar.showWarning("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC624\uB294 \uC911\uC785\uB2C8\uB2E4.");return}let t=yield this.geminiApiManager.getApiKeyInfo();if(!t||!t.apiKey){this.router.navigate(["/ezm/google-login-required"],{state:{featureName:"PDF AI \uBC88\uC5ED"}});return}this.router.navigate(["/ezm/ai-translate"],{state:{document:this.currentDocument}})})}onAiSummary(){return C(this,null,function*(){if(!this.currentDocument){this.snackbar.showWarning("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC624\uB294 \uC911\uC785\uB2C8\uB2E4.");return}let t=yield this.geminiApiManager.getApiKeyInfo();if(!t||!t.apiKey){this.router.navigate(["/ezm/google-login-required"],{state:{featureName:"PDF AI \uC694\uC57D"}});return}this.router.navigate(["/ezm/ai-summary"],{state:{document:this.currentDocument}})})}onDraw(){this.isDrawingMode=!this.isDrawingMode,this.pdfViewerConfig=Z(K({},this.pdfViewerConfig),{showDrawEditor:this.isDrawingMode}),this.isDrawingMode?(this.snackbar.showInfo("\uADF8\uB9AC\uAE30 \uBAA8\uB4DC\uAC00 \uD65C\uC131\uD654\uB418\uC5C8\uC2B5\uB2C8\uB2E4. PDF \uC704\uC5D0 \uC9C1\uC811 \uADF8\uB9B4 \uC218 \uC788\uC2B5\uB2C8\uB2E4."),this.activateDrawEditor()):(this.drawingSheetState="collapsed",this.showColorPalette=!1,this.showColorPicker=!1)}activateDrawEditor(){setTimeout(()=>{let t=this.PDFViewerApplication;if(t?.eventBus)t.eventBus.dispatch("switchannotationeditormode",{source:this,mode:15}),setTimeout(()=>{this.applyDrawingColorToPdfJs(this.drawingColor),this.applyDrawingThicknessToPdfJs(this.drawingThickness),this.applyDrawingOpacityToPdfJs(100)},50);else{let e=["button#primaryEditorInk","button#editorInk",'button[title*="\uADF8\uB9AC\uAE30"]','button[title*="Draw"]','[data-l10n-id="pdfjs-editor-ink-button"]'];for(let n of e){let i=document.querySelector(n);if(i){i.click();break}}}},100)}deactivateDrawEditor(){let t=this.PDFViewerApplication;t?.eventBus&&t.eventBus.dispatch("switchannotationeditormode",{source:this,mode:0})}toggleColorPalette(){this.drawingSheetState==="collapsed"?(this.drawingSheetState="full",this.showColorPalette=!0):(this.drawingSheetState="collapsed",this.showColorPalette=!1),this.showColorPicker=!1}toggleColorPicker(){this.showColorPicker=!this.showColorPicker,this.showColorPicker?this.drawingSheetState="full":this.drawingSheetState="full"}closeColorPalette(){this.drawingSheetState="collapsed",this.showColorPalette=!1,this.showColorPicker=!1}selectPresetColor(t){this.drawingColor=t,this.isEraserMode=!1,this.applyDrawingColorToPdfJs(t),this.closeColorPalette()}selectFullColor(t){this.drawingColor=t,this.isEraserMode=!1,this.applyDrawingColorToPdfJs(t),this.closeColorPalette()}isLightColor(t){let e=t.replace("#",""),n=parseInt(e.substring(0,2),16),i=parseInt(e.substring(2,4),16),s=parseInt(e.substring(4,6),16);return(n*299+i*587+s*114)/1e3>180}onDrawingThicknessChange(t){this.drawingThickness=t,this.applyDrawingThicknessToPdfJs(t)}onDrawingColorChange(t){this.drawingColor=t,this.isEraserMode=!1,this.applyDrawingColorToPdfJs(t)}applyDrawingColorToPdfJs(t){let e=this.PDFViewerApplication;e?.eventBus&&e.eventBus.dispatch("switchannotationeditorparams",{source:this,type:21,value:t})}applyDrawingThicknessToPdfJs(t){let e=this.PDFViewerApplication;e?.eventBus&&e.eventBus.dispatch("switchannotationeditorparams",{source:this,type:22,value:t})}applyDrawingOpacityToPdfJs(t){let e=this.PDFViewerApplication;e?.eventBus&&e.eventBus.dispatch("switchannotationeditorparams",{source:this,type:23,value:t})}onEraserMode(){this.isEraserMode=!this.isEraserMode,this.isEraserMode&&this.snackbar.showInfo("\uC9C0\uC6B0\uAC1C \uBAA8\uB4DC\uAC00 \uD65C\uC131\uD654\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}closeDrawingMode(){this.isDrawingMode=!1,this.drawingSheetState="collapsed",this.showColorPalette=!1,this.showColorPicker=!1,this.deactivateDrawEditor(),this.pdfViewerConfig=Z(K({},this.pdfViewerConfig),{showDrawEditor:!1})}saveDrawingOnly(){return C(this,null,function*(){try{this.snackbar.showInfo("\uADF8\uB9AC\uAE30\uB97C \uC800\uC7A5\uD558\uACE0 \uC788\uC2B5\uB2C8\uB2E4...");let t=this.PDFViewerApplication;if(!t?.pdfDocument){this.snackbar.showError("PDF \uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}t.eventBus&&(t.eventBus.dispatch("switchannotationeditormode",{source:this,mode:0}),yield new Promise(v=>setTimeout(v,300)));let e=yield t.pdfDocument.saveDocument();if(!e){this.snackbar.showError("PDF \uB370\uC774\uD130\uB97C \uAC00\uC838\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=new Blob([new Uint8Array(e)],{type:"application/pdf"}),i=new Date().toISOString(),s=new FileReader,_=yield new Promise((v,w)=>{s.onloadend=()=>{let M=s.result;v(M.split(",")[1])},s.onerror=M=>{console.error("\u{1F3A8} [\uADF8\uB9AC\uAE30 \uC800\uC7A5] Base64 \uBCC0\uD658 \uC624\uB958:",M),w(M)},s.readAsDataURL(n)});if(this.currentDocumentId){let v=yield this.indexedDbService.getDocumentById(this.currentDocumentId);if(v)v.pdfBase64=_,v.updatedAt=i,yield this.indexedDbService.saveDocument(v),this.snackbar.showSuccess("\uADF8\uB9AC\uAE30\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.");else{let w={id:this.currentDocumentId,title:this.fileName,pages:[],elementCount:0,pdfBase64:_,documentType:"viewer",createdAt:i,updatedAt:i,version:"1.0"};yield this.indexedDbService.saveDocument(w),this.snackbar.showSuccess("\uADF8\uB9AC\uAE30\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}}else{let v={id:"doc_"+Date.now(),title:this.fileName,pages:[],elementCount:0,pdfBase64:_,documentType:"viewer",createdAt:i,updatedAt:i,version:"1.0"};this.currentDocumentId=v.id,yield this.indexedDbService.saveDocument(v),this.snackbar.showSuccess("\uADF8\uB9AC\uAE30\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}}catch(t){console.error("\u{1F3A8} [\uADF8\uB9AC\uAE30 \uC800\uC7A5] \uC624\uB958:",t),this.snackbar.showError("\uADF8\uB9AC\uAE30 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}checkForDrawingAnnotations(){return C(this,null,function*(){try{let t=this.PDFViewerApplication;if(t?.pdfDocument){let e=t.pdfDocument.annotationStorage;if(e)return e.size>0}return!1}catch{return!1}})}saveDrawingAndExit(){return C(this,null,function*(){try{yield this.saveDrawingOnly(),this.closeDrawingMode(),this.pdfSrc&&URL.revokeObjectURL(this.pdfSrc),this.router.navigate(["/ezm/home"])}catch(t){console.error("\uADF8\uB9AC\uAE30 \uC800\uC7A5 \uC624\uB958:",t),this.snackbar.showError("\uADF8\uB9AC\uAE30 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onSearch(){this.isHeaderSearchMode=!0,this.searchQuery="",this.searchResults=[],this.currentSearchIndex=0,this.totalSearchMatches=0,this.pdfViewerConfig=Z(K({},this.pdfViewerConfig),{textLayer:!0}),this.cdr.detectChanges(),setTimeout(()=>{this.searchInputRef?.nativeElement.focus()},100)}exitSearchMode(){this.isHeaderSearchMode=!1,this.searchQuery="",this.searchResults=[],this.currentSearchIndex=0,this.totalSearchMatches=0,this.pdfViewerService&&this.pdfViewerService.find("",{highlightAll:!1}),this.pdfViewerConfig=Z(K({},this.pdfViewerConfig),{textLayer:!1}),this.cdr.detectChanges()}onSearchInput(t){this.searchQuery=t,this.searchSubject.next(t)}executeSearch(t){return C(this,null,function*(){if(!t.trim()){this.searchResults=[],this.currentSearchIndex=0,this.totalSearchMatches=0,this.pdfViewerService&&this.pdfViewerService.find("",{highlightAll:!1});return}try{yield this.pdfViewerService.find(t,{highlightAll:!0,matchCase:!1,wholeWords:!1,findMultiple:!0})}catch(e){console.error("\uAC80\uC0C9 \uC911 \uC624\uB958:",e)}})}previousSearchResult(){if(this.searchResults.length===0){this.snackbar.showWarning("\uAC80\uC0C9 \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.pdfViewerService.findPrevious(),this.currentSearchIndex=Math.max(0,this.currentSearchIndex-1)}nextSearchResult(){if(this.searchResults.length===0){this.snackbar.showWarning("\uAC80\uC0C9 \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.pdfViewerService.findNext(),this.currentSearchIndex=Math.min(this.searchResults.length-1,this.currentSearchIndex+1)}goToSearchResult(){}generateThumbnail(t){return C(this,null,function*(){try{let n=yield(yield this.pdfjsLibService.getDocument(t)).getPage(1),i=n.getViewport({scale:.5}),s=document.createElement("canvas"),d=s.getContext("2d");return d?(s.width=i.width,s.height=i.height,yield n.render({canvas:s,canvasContext:d,viewport:i}).promise,s.toDataURL("image/jpeg",.7)):null}catch(e){return console.error("\uC378\uB124\uC77C \uC0DD\uC131 \uC2E4\uD328:",e),null}})}startLoading(t="PDF \uBB38\uC11C\uB97C \uBD88\uB7EC\uC624\uB294 \uC911..."){this.isLoading=!0,this.loadingMessage=t,this.loadingProgress=0,this.cdr.detectChanges()}updateLoadingProgress(t,e){this.loadingProgress=t,e&&(this.loadingMessage=e),this.cdr.detectChanges()}stopLoading(){this.isLoading=!1,this.loadingProgress=0,this.loadingMessage="",this.cdr.detectChanges()}addReadingPoint(){return C(this,null,function*(){if(this.currentDocumentPointAdded){console.log("\u{1F4CA} \uC774\uBBF8 \uC774 \uBB38\uC11C\uC5D0\uC11C \uD3EC\uC778\uD2B8\uAC00 \uCD94\uAC00\uB428");return}let t=yield this.pointsService.addPoint();t.success&&(this.currentDocumentPointAdded=!0,console.log("\u{1F4CA} \uD3EC\uC778\uD2B8 \uCD94\uAC00:",t.message))})}ngOnDestroy(){this.removeSwipeListeners(),this.thumbnailDelayTimer&&clearTimeout(this.thumbnailDelayTimer),this.searchSubject.complete(),this.analysisService.cleanup(),this.pdfSrc&&URL.revokeObjectURL(this.pdfSrc),this.pdfPages&&this.pdfPages.length>0&&this.pdfPages.forEach(t=>{t.imageUrl&&t.imageUrl.startsWith("blob:")&&URL.revokeObjectURL(t.imageUrl)})}static \u0275fac=function(e){return new(e||r)(V(N),V(et),V(Yt),V(Ne),V(le),V(fe))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-viewer"]],viewQuery:function(e,n){if(e&1&&($e(Ge,5),$e(as,5)),e&2){let i;He(i=We())&&(n.toolsPanel=i.first),He(i=We())&&(n.searchInputRef=i.first)}},standalone:!1,decls:64,vars:42,consts:[["searchInput",""],["fileActionsTemplate",""],[1,"mobile-viewer-container"],["class","shimmer-loading-overlay",4,"ngIf"],[1,"mobile-header"],[1,"header-back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C\uAC00\uAE30","width","20","height","20",1,"back-icon"],["class","point-display",4,"ngIf"],[1,"header-actions"],[1,"dropdown-wrapper"],["aria-label","AI \uAE30\uB2A5",1,"header-action-btn",3,"click"],["src","images/icons/btn-top-ai.svg","alt","AI","width","24","height","24"],["class","dropdown-menu",3,"click",4,"ngIf"],["aria-label","\uADF8\uB9AC\uAE30",1,"header-action-btn",3,"click"],["src","images/icons/btn-top-draw.svg","alt","\uADF8\uB9AC\uAE30","width","24","height","24"],["aria-label","\uAC80\uC0C9",1,"header-action-btn",3,"click"],["src","images/icons/btn-search.svg","alt","\uAC80\uC0C9","width","24","height","24"],["aria-label","\uB354\uBCF4\uAE30",1,"header-action-btn",3,"click"],["src","images/icons/btn-top-more.svg","alt","\uB354\uBCF4\uAE30","width","24","height","24"],["class","dropdown-menu more-menu",3,"click",4,"ngIf"],[1,"mobile-header","search-mode"],["src","images/icons/ico-back.svg","alt","\uAC80\uC0C9 \uC885\uB8CC","width","20","height","20",1,"back-icon"],[1,"search-input-container"],["type","text","placeholder","\uAC80\uC0C9\uC5B4 \uC785\uB825","aria-label","\uAC80\uC0C9\uC5B4 \uC785\uB825",1,"search-input",3,"ngModelChange","keyup","compositionend","ngModel"],[1,"search-nav"],["aria-label","\uC774\uC804 \uACB0\uACFC",1,"search-nav-btn",3,"click"],["src","images/icons/btn-view-prev.svg","alt","\uC774\uC804","width","18","height","18"],[1,"search-count"],["aria-label","\uB2E4\uC74C \uACB0\uACFC",1,"search-nav-btn",3,"click"],["src","images/icons/btn-view-next.svg","alt","\uB2E4\uC74C","width","18","height","18"],[1,"pdf-viewer-wrapper",3,"click","touchstart","touchend"],[3,"pdfSrc","isMobile","config","showFloatingZoom","pdfLoaded","pdfLoadingFailed","pageChange","zoomChange","updateFindMatchesCount","updateFindState",4,"ngIf"],[3,"currentPage","totalPages","isPdfViewer","analyze","saveDocument",4,"ngIf"],[3,"pdfSrc","totalPages","currentPage","visible","pageSelected",4,"ngIf"],["class","drawing-vertical-panel",4,"ngIf"],[3,"sheetStateChange","close","sheetState"],[1,"drawing-sheet-content"],[1,"sheet-header"],[1,"sheet-title"],[1,"thickness-section"],[1,"section-label"],[1,"thickness-slider-wrapper"],["type","range",1,"thickness-range",3,"input","min","max","value"],[1,"thickness-preview"],[1,"thickness-value"],[1,"thickness-circle"],[1,"color-section"],[1,"preset-colors"],["class","preset-color-btn",3,"selected","light-color","background-color","click",4,"ngFor","ngForOf"],[1,"preset-color-btn","more-colors-btn",3,"click"],["src","images/icons/btn-top-add.svg","alt","\uB354\uBCF4\uAE30","width","20","height","20"],["class","full-color-section",4,"ngIf"],[1,"file-menu-content"],[4,"ngIf","ngIfElse"],[1,"shimmer-loading-overlay"],[1,"shimmer-container"],[1,"shimmer-page"],[1,"shimmer-line","shimmer-title"],[1,"shimmer-line","shimmer-text"],[1,"shimmer-line","shimmer-text","short"],[1,"shimmer-image"],[1,"shimmer-line","shimmer-text","medium"],[1,"shimmer-message"],[1,"shimmer-dots"],[1,"point-display"],["src","images/icons/point-ico.svg","alt","\uD3EC\uC778\uD2B8","width","16","height","16"],[1,"point-value"],[1,"point-today"],[1,"dropdown-menu",3,"click"],[1,"dropdown-item",3,"click"],["src","images/icons/ico-tool-main-ai-summary.svg","alt","\uC694\uC57D","width","20","height","20"],["src","images/icons/ico-tool-main-ai-translation.svg","alt","\uBC88\uC5ED","width","20","height","20"],[1,"dropdown-menu","more-menu",3,"click"],["src","images/icons/ico-tool-main-cut.svg","alt","\uBD84\uD560","width","20","height","20"],["src","images/icons/ico-tool-main-rotation.svg","alt","\uD68C\uC804","width","20","height","20"],["class","dropdown-item",3,"click",4,"ngIf"],["src","images/icons/btn-top-view.svg","alt","\uAD6C\uC131","width","20","height","20"],["src","images/icons/ico-tool-main-page.svg","alt","\uD398\uC774\uC9C0\uBC88\uD638","width","20","height","20"],["src","images/icons/ico-tool-main-watermark.svg","alt","\uC6CC\uD130\uB9C8\uD06C","width","20","height","20"],[1,"dropdown-divider"],["src","images/icons/btn-view-prev.svg","alt","\uAC00\uB85C\uBCF4\uAE30","width","20","height","20"],["class","check-icon","src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","16","height","16",4,"ngIf"],["src","images/icons/ico-list.svg","alt","\uC138\uB85C\uBCF4\uAE30","width","20","height","20"],["src","images/icons/ico-share.svg","alt","\uACF5\uC720","width","20","height","20"],[1,"dropdown-item","danger",3,"click"],["src","images/icons/ico-tool-cut.svg","alt","\uC0AD\uC81C","width","20","height","20"],["src","images/icons/ico-tool-main-password.svg","alt","\uC554\uD638\uD654","width","20","height","20"],["src","images/icons/ico-tool-main-decryption.svg","alt","\uC554\uD638\uD574\uC81C","width","20","height","20"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","16","height","16",1,"check-icon"],[3,"pdfLoaded","pdfLoadingFailed","pageChange","zoomChange","updateFindMatchesCount","updateFindState","pdfSrc","isMobile","config","showFloatingZoom"],[3,"analyze","saveDocument","currentPage","totalPages","isPdfViewer"],[3,"pageSelected","pdfSrc","totalPages","currentPage","visible"],[1,"drawing-vertical-panel"],["aria-label","\uC0C9\uC0C1 \uC120\uD0DD",1,"drawing-panel-btn","color-btn",3,"click"],["src","images/icons/btn-top-draw.svg","alt","\uC0C9\uC0C1","width","20","height","20"],["aria-label","\uC9C0\uC6B0\uAC1C",1,"drawing-panel-btn","eraser-btn",3,"click"],["src","images/icons/ico-tool-cut.svg","alt","\uC9C0\uC6B0\uAC1C","width","20","height","20"],["aria-label","\uADF8\uB9AC\uAE30 \uB2EB\uAE30",1,"drawing-panel-btn","close-btn",3,"click"],["src","images/icons/ico-close.svg","alt","\uB2EB\uAE30","width","20","height","20"],[1,"preset-color-btn",3,"click"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","20","height","20"],[1,"full-color-section"],[1,"color-picker-grid"],["class","full-color-btn",3,"selected","light-color","white-color","background-color","click",4,"ngFor","ngForOf"],[1,"full-color-btn",3,"click"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","18","height","18"],[1,"sheet-header","rename-mode"],["aria-label","\uC774\uB984 \uBCC0\uACBD \uCDE8\uC18C",1,"sheet-back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","20","height","20"],[1,"rename-form"],["for","renameInput",1,"rename-label"],["id","renameInput","type","text","maxlength","80","placeholder","\uC0C8 \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694",1,"rename-input",3,"ngModelChange","ngModel"],[1,"rename-helper"],[1,"rename-actions"],["type","button",1,"rename-cancel",3,"click"],["type","button",1,"rename-confirm",3,"click"],[1,"sheet-options"],[1,"sheet-option",3,"click"],["src","images/icons/btn-top-edit.svg","alt","\uD3B8\uC9D1","width","24","height","24"],["src","images/icons/ico-share.svg","alt","\uACF5\uC720","width","24","height","24"],["src","images/icons/btn-top-edit.svg","alt","\uC774\uB984\uBCC0\uACBD","width","24","height","24"],["src","images/icons/ico-tool-copy.svg","alt","\uBCF5\uC81C","width","24","height","24"],[1,"sheet-option","danger",3,"click"],["src","images/icons/ico-tool-cut.svg","alt","\uC0AD\uC81C","width","24","height","24"]],template:function(e,n){if(e&1){let i=y();o(0,"div",2),b(1,ss,16,1,"div",3),o(2,"header",4)(3,"button",5),u("click",function(){return m(i),f(n.goBack())}),h(4,"img",6),a(),b(5,ls,6,3,"div",7),o(6,"div",8)(7,"div",9)(8,"button",10),u("click",function(){return m(i),f(n.onAiMenuClick())}),h(9,"img",11),a(),b(10,cs,9,0,"div",12),a(),o(11,"button",13),u("click",function(){return m(i),f(n.onDraw())}),h(12,"img",14),a(),o(13,"button",15),u("click",function(){return m(i),f(n.onSearch())}),h(14,"img",16),a(),o(15,"div",9)(16,"button",17),u("click",function(){return m(i),f(n.onMoreMenuClick())}),h(17,"img",18),a(),b(18,ms,43,8,"div",19),a()()(),o(19,"header",20)(20,"button",5),u("click",function(){return m(i),f(n.exitSearchMode())}),h(21,"img",21),a(),o(22,"div",22)(23,"input",23,0),$("ngModelChange",function(d){return m(i),U(n.searchQuery,d)||(n.searchQuery=d),f(d)}),u("keyup",function(){m(i);let d=Ut(24);return f(n.onSearchInput(d.value))})("compositionend",function(){m(i);let d=Ut(24);return f(n.onSearchInput(d.value))}),a(),o(25,"div",24)(26,"button",25),u("click",function(){return m(i),f(n.previousSearchResult())}),h(27,"img",26),a(),o(28,"span",27),c(29),a(),o(30,"button",28),u("click",function(){return m(i),f(n.nextSearchResult())}),h(31,"img",29),a()()()(),o(32,"div",30),u("click",function(){return m(i),f(!n.isDrawingMode&&n.toggleFullscreenMode())})("touchstart",function(d){return m(i),f(n.onTouchStart(d))})("touchend",function(d){return m(i),f(n.onTouchEnd(d))}),b(33,fs,1,4,"shared-pdf-viewer",31),a(),b(34,hs,1,3,"shared-pdf-tools-panel-mobile",32)(35,_s,1,4,"shared-pdf-thumbnail-strip",33)(36,Cs,7,6,"div",34),a(),o(37,"app-bottom-sheet",35),$("sheetStateChange",function(d){return m(i),U(n.drawingSheetState,d)||(n.drawingSheetState=d),f(d)}),u("close",function(){return m(i),f(n.closeColorPalette())}),o(38,"div",36)(39,"div",37)(40,"h3",38),c(41,"\uC0C9\uC0C1 \uBC0F \uAD75\uAE30"),a()(),o(42,"div",39)(43,"label",40),c(44,"\uAD75\uAE30"),a(),o(45,"div",41)(46,"input",42),u("input",function(d){return m(i),f(n.onDrawingThicknessChange(d.target.value))}),a(),o(47,"div",43)(48,"span",44),c(49),a(),h(50,"span",45),a()()(),o(51,"div",46)(52,"label",40),c(53,"\uC0C9\uC0C1"),a(),o(54,"div",47),b(55,bs,2,6,"button",48),o(56,"button",49),u("click",function(){return m(i),f(n.toggleColorPicker())}),h(57,"img",50),a()()(),b(58,xs,3,1,"div",51),a()(),o(59,"app-bottom-sheet",35),$("sheetStateChange",function(d){return m(i),U(n.fileMenuSheetState,d)||(n.fileMenuSheetState=d),f(d)}),u("close",function(){return m(i),f(n.closeFileMenu())}),o(60,"div",52),b(61,Ps,17,1,"ng-container",53)(62,Ms,24,1,"ng-template",null,1,$t),a()()}if(e&2){let i=Ut(63);k("thumbnail-hidden",!n.showThumbnails)("fullscreen-mode",n.isFullscreenMode),l(),p("ngIf",n.isLoading),l(),k("header-hidden",n.isFullscreenMode||n.isHeaderSearchMode||n.isDrawingMode)("header-visible",!n.isFullscreenMode&&!n.isHeaderSearchMode&&!n.isDrawingMode),l(3),p("ngIf",n.totalPoints>=0),l(5),p("ngIf",n.showAiMenu),l(8),p("ngIf",n.showMoreMenu),l(),k("header-hidden",n.isFullscreenMode||!n.isHeaderSearchMode)("header-visible",!n.isFullscreenMode&&n.isHeaderSearchMode),l(4),j("ngModel",n.searchQuery),l(6),x(n.totalSearchMatches>0?n.currentSearchIndex+1+" \uC911\uC758 "+n.totalSearchMatches:""),l(3),k("horizontal-mode",n.viewMode==="horizontal"),l(),p("ngIf",n.documentType==="pdf-viewer"&&n.pdfSrc),l(),p("ngIf",n.pdfSrc&&!n.isFullscreenMode&&!n.isDrawingMode),l(),p("ngIf",n.documentType==="pdf-viewer"&&n.pdfSrc&&n.showThumbnails&&!n.isFullscreenMode&&!n.isDrawingMode),l(),p("ngIf",n.isDrawingMode),l(),j("sheetState",n.drawingSheetState),l(9),p("min",1)("max",20)("value",n.drawingThickness),l(3),S("",n.drawingThickness,"px"),l(),q("width",n.drawingThickness*2,"px")("height",n.drawingThickness*2,"px")("background-color",n.drawingColor),l(5),p("ngForOf",n.presetColors),l(),k("active",n.showColorPicker),l(2),p("ngIf",n.showColorPicker),l(),j("sheetState",n.fileMenuSheetState),l(2),p("ngIf",n.isRenameMode)("ngIfElse",i)}},dependencies:[oe,B,he,pe,Sn,ge,Tn,Vn,Ge,Pe],styles:['.mobile-viewer-container[_ngcontent-%COMP%]{position:fixed;top:var(--android-status-bar-height, 0px);left:0;right:0;bottom:var(--android-navigation-bar-height, 0px);background:#fff;display:flex;flex-direction:column}.mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]{--android-status-bar-height: 0px !important;--android-navigation-bar-height: 0px !important;inset:0!important;width:100vw!important;height:100vh!important;height:100dvh!important;transition:none!important}.mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]   .pdf-viewer-wrapper[_ngcontent-%COMP%]{position:absolute!important;inset:0!important;width:100%!important;height:100%!important;transition:none!important}.mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]   .pdf-viewer-wrapper[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%], .mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]   .pdf-viewer-wrapper[_ngcontent-%COMP%]   shared-pdf-editor-mobile[_ngcontent-%COMP%]{position:absolute!important;inset:0!important;width:100%!important;height:100%!important;transition:none!important}.mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]   .pdf-viewer-wrapper[_ngcontent-%COMP%]     ngx-extended-pdf-viewer, .mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]   .pdf-viewer-wrapper[_ngcontent-%COMP%]     .shared-pdf-viewer-wrapper, .mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]   .pdf-viewer-wrapper[_ngcontent-%COMP%]     .ng2-pdf-viewer-container, .mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]   .pdf-viewer-wrapper[_ngcontent-%COMP%]     #viewerContainer, .mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]   .pdf-viewer-wrapper[_ngcontent-%COMP%]     #viewer{height:100%!important;max-height:100%!important;min-height:100%!important}.mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%], .mobile-viewer-container.fullscreen-mode[_ngcontent-%COMP%]   shared-pdf-editor-mobile[_ngcontent-%COMP%]{position:absolute!important;inset:0!important;width:100%!important;height:100%!important;transition:none!important}.shimmer-loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#f5f5f5;display:flex;align-items:center;justify-content:center;z-index:9999;animation:_ngcontent-%COMP%_fadeIn .2s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.shimmer-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:24px;width:100%;max-width:400px;padding:20px}.shimmer-page[_ngcontent-%COMP%]{width:100%;aspect-ratio:210/297;max-height:60vh;background:#fff;border-radius:4px;box-shadow:0 2px 12px #0000001a;padding:24px;display:flex;flex-direction:column;gap:12px;overflow:hidden}.shimmer-line[_ngcontent-%COMP%]{height:12px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite;border-radius:4px}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}.shimmer-title[_ngcontent-%COMP%]{width:60%;height:20px;margin-bottom:8px}.shimmer-text[_ngcontent-%COMP%]{width:100%}.shimmer-text.short[_ngcontent-%COMP%]{width:40%}.shimmer-text.medium[_ngcontent-%COMP%]{width:70%}.shimmer-image[_ngcontent-%COMP%]{width:100%;height:120px;margin:16px 0;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite;border-radius:8px}.shimmer-message[_ngcontent-%COMP%]{font-size:14px;color:#666;display:flex;align-items:center;gap:2px}.shimmer-dots[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_dots 1.4s infinite;width:20px}@keyframes _ngcontent-%COMP%_dots{0%,20%{content:".";opacity:0}40%{opacity:1}60%{opacity:1}80%,to{opacity:.3}}  .textLayer .highlight{background-color:#ff06!important}  .textLayer .highlight.selected{background-color:#ffc80099!important}.mobile-header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fffffff2;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-bottom:1px solid rgba(224,224,224,.8);display:flex;align-items:center;justify-content:space-between;padding-left:8px;padding-right:8px;z-index:1000;box-sizing:border-box;transition:opacity .25s ease-out,visibility .25s ease-out}.mobile-header.header-visible[_ngcontent-%COMP%]{opacity:1;visibility:visible;pointer-events:auto}.mobile-header.header-hidden[_ngcontent-%COMP%]{opacity:0;visibility:hidden;pointer-events:none}.mobile-header.search-mode[_ngcontent-%COMP%]{gap:8px;padding-left:8px;padding-right:12px}.mobile-header.search-mode[_ngcontent-%COMP%]   .search-input-container[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;position:relative;border:1px solid #ddd;border-radius:8px;background:#fff;transition:border-color .2s}.mobile-header.search-mode[_ngcontent-%COMP%]   .search-input-container[_ngcontent-%COMP%]:focus-within{border-color:#1976d2}.mobile-header.search-mode[_ngcontent-%COMP%]   .search-input-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{flex:1;height:36px;border:none;border-radius:8px;padding:0 12px;font-size:14px;outline:none;background:transparent}.mobile-header.search-mode[_ngcontent-%COMP%]   .search-input-container[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#999}.mobile-header.search-mode[_ngcontent-%COMP%]   .search-input-container[_ngcontent-%COMP%]   .search-nav[_ngcontent-%COMP%]{display:flex;align-items:center;gap:2px;padding-right:8px;flex-shrink:0}.mobile-header.search-mode[_ngcontent-%COMP%]   .search-input-container[_ngcontent-%COMP%]   .search-nav[_ngcontent-%COMP%]   .search-count[_ngcontent-%COMP%]{font-size:13px;color:#666;white-space:nowrap;padding:0 4px}.mobile-header.search-mode[_ngcontent-%COMP%]   .search-input-container[_ngcontent-%COMP%]   .search-nav[_ngcontent-%COMP%]   .search-nav-btn[_ngcontent-%COMP%]{width:28px;height:28px;background:none;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background .2s;color:#666;padding:0}.mobile-header.search-mode[_ngcontent-%COMP%]   .search-input-container[_ngcontent-%COMP%]   .search-nav[_ngcontent-%COMP%]   .search-nav-btn[_ngcontent-%COMP%]:hover{background:#0000000d}.mobile-header.search-mode[_ngcontent-%COMP%]   .search-input-container[_ngcontent-%COMP%]   .search-nav[_ngcontent-%COMP%]   .search-nav-btn[_ngcontent-%COMP%]:active{background:#0000001a}.header-back-btn[_ngcontent-%COMP%], .header-action-btn[_ngcontent-%COMP%]{width:40px;height:40px;background:none;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:all .2s;color:#333}.header-back-btn[_ngcontent-%COMP%]:hover, .header-action-btn[_ngcontent-%COMP%]:hover{background:#0000000d}.header-back-btn[_ngcontent-%COMP%]:active, .header-action-btn[_ngcontent-%COMP%]:active{background:#0000001a}.point-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 10px;background:linear-gradient(135deg,#fff8e1,#ffecb3);border-radius:16px;border:1px solid #FFD54F;flex-shrink:0;margin-left:auto;margin-right:8px}.point-display[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.point-display[_ngcontent-%COMP%]   .point-value[_ngcontent-%COMP%]{font-size:13px;font-weight:700;color:#f57c00;white-space:nowrap}.point-display[_ngcontent-%COMP%]   .point-today[_ngcontent-%COMP%]{font-size:11px;font-weight:500;color:#ff8f00;white-space:nowrap}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.dropdown-wrapper[_ngcontent-%COMP%]{position:relative}.dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 4px);right:0;background:#fff;border-radius:8px;box-shadow:0 4px 12px #00000026;width:fit-content;z-index:1100;overflow:hidden;animation:_ngcontent-%COMP%_dropdownFadeIn .2s ease}.dropdown-menu.more-menu[_ngcontent-%COMP%]{min-width:160px}@keyframes _ngcontent-%COMP%_dropdownFadeIn{0%{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}.dropdown-divider[_ngcontent-%COMP%]{height:1px;background:#e0e0e0;margin:4px 0}.dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;width:100%;padding:12px 16px;background:none;border:none;border-bottom:1px solid #f0f0f0;cursor:pointer;font-size:14px;color:#333;text-align:left;transition:background .2s}.dropdown-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.dropdown-item[_ngcontent-%COMP%]:hover{background:#f8f8f8}.dropdown-item[_ngcontent-%COMP%]:active{background:#f0f0f0}.dropdown-item.active[_ngcontent-%COMP%]{background:#f0f8ff;color:#007acc}.dropdown-item.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:first-of-type{stroke:#007acc!important}.dropdown-item.danger[_ngcontent-%COMP%]{color:#d32f2f}.dropdown-item.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#d32f2f!important}.dropdown-item.danger[_ngcontent-%COMP%]:hover{background:#ffebee}.dropdown-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.dropdown-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{white-space:nowrap;flex:1}.dropdown-item[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{margin-left:auto}.dropdown-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:transparent;z-index:1090}.back-icon[_ngcontent-%COMP%]{font-size:24px;color:#333}.pdf-viewer-wrapper[_ngcontent-%COMP%]{position:absolute;inset:0;transition:none}.pdf-viewer-wrapper[_ngcontent-%COMP%]     #viewerContainer, .pdf-viewer-wrapper[_ngcontent-%COMP%]     #mainContainer, .pdf-viewer-wrapper[_ngcontent-%COMP%]     .pdfViewer{background:#f5f5f5!important;background-color:#f5f5f5!important}.pdf-viewer-wrapper[_ngcontent-%COMP%]     .page{background:#fff!important;box-shadow:0 2px 8px #0000001a!important}.pdf-viewer-wrapper[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%], .pdf-viewer-wrapper[_ngcontent-%COMP%]   shared-pdf-editor-mobile[_ngcontent-%COMP%]{position:absolute;inset:0;overflow-x:auto;overflow-y:auto;width:100%;background:#fff;-webkit-overflow-scrolling:touch}.pdf-viewer-wrapper.horizontal-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%]{overflow:auto;-webkit-overflow-scrolling:touch;display:flex;align-items:flex-start;justify-content:flex-start}.pdf-viewer-wrapper.horizontal-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%]     ngx-extended-pdf-viewer{display:flex;align-items:flex-start;justify-content:flex-start;width:100%;height:100%}.pdf-viewer-wrapper.horizontal-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%]     #mainContainer{display:flex;align-items:flex-start;justify-content:flex-start;width:100%!important;height:100%!important}.pdf-viewer-wrapper.horizontal-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%]     #viewerContainer{overflow:auto!important;-webkit-overflow-scrolling:touch;display:flex!important;align-items:flex-start!important;justify-content:flex-start!important;width:100%!important;height:100%!important}.pdf-viewer-wrapper.horizontal-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%]     #viewer{display:flex;flex-direction:row;align-items:center;justify-content:center;margin:auto;min-height:100%}.pdf-viewer-wrapper.horizontal-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%]     .page{scroll-snap-align:center;scroll-snap-stop:always;flex-shrink:0;margin:auto!important}.pdf-viewer-wrapper.horizontal-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%]     #viewer.slide-animating{transition:transform .15s ease-out,opacity .15s ease-out}.pdf-viewer-wrapper.horizontal-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%]     #viewer.slide-left{transform:translate(-30px);opacity:.3}.pdf-viewer-wrapper.horizontal-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%]     #viewer.slide-right{transform:translate(30px);opacity:.3}.pdf-viewer-wrapper.horizontal-mode[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%]     #viewer.slide-enter{animation:_ngcontent-%COMP%_slideEnter .2s ease-out forwards}@keyframes _ngcontent-%COMP%_slideEnter{0%{opacity:.5;transform:scale(.98)}to{opacity:1;transform:scale(1)}}.horizontal-page-nav[_ngcontent-%COMP%]{position:absolute;bottom:100px;left:50%;transform:translate(-50%);display:flex;align-items:center;gap:12px;background:#000000b3;border-radius:24px;padding:8px 16px;z-index:100}.horizontal-page-nav[_ngcontent-%COMP%]   .page-nav-btn[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:#fff3;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#fff;transition:all .2s ease}.horizontal-page-nav[_ngcontent-%COMP%]   .page-nav-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#ffffff4d}.horizontal-page-nav[_ngcontent-%COMP%]   .page-nav-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.95)}.horizontal-page-nav[_ngcontent-%COMP%]   .page-nav-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.horizontal-page-nav[_ngcontent-%COMP%]   .page-nav-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.horizontal-page-nav[_ngcontent-%COMP%]   .page-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:14px;font-weight:600;color:#fff;min-width:60px;justify-content:center}.horizontal-page-nav[_ngcontent-%COMP%]   .page-indicator[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]{color:#4fc3f7}.horizontal-page-nav[_ngcontent-%COMP%]   .page-indicator[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{color:#fff9}.horizontal-page-nav[_ngcontent-%COMP%]   .page-indicator[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]{color:#fffc}shared-pdf-viewer[_ngcontent-%COMP%], shared-pdf-editor-mobile[_ngcontent-%COMP%]{position:absolute;top:calc(56px + var(--android-status-bar-height, 0px));left:0;right:0;bottom:0;overflow-x:auto;overflow-y:auto;width:100%;transition:bottom .3s ease;background:#fff;-webkit-overflow-scrolling:touch}.thumbnail-hidden[_ngcontent-%COMP%]   shared-pdf-viewer[_ngcontent-%COMP%], .thumbnail-hidden[_ngcontent-%COMP%]   shared-pdf-editor-mobile[_ngcontent-%COMP%]{bottom:10px}.empty-state[_ngcontent-%COMP%]{position:absolute;top:calc(56px + var(--android-status-bar-height, 0px));left:0;right:0;bottom:110px;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px;text-align:center;transition:bottom .3s ease}.thumbnail-hidden[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{bottom:10px}.empty-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px}.btn-primary[_ngcontent-%COMP%]{margin-top:24px;padding:12px 24px;background:#007acc;color:#fff;border:none;border-radius:8px;font-size:16px;cursor:pointer}.floating-zoom-controls[_ngcontent-%COMP%]{position:fixed;right:16px;bottom:calc(80px + var(--android-navigation-bar-height, 0px));display:flex;flex-direction:column;gap:8px;z-index:950}.zoom-btn[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:#fff;border:none;box-shadow:0 2px 8px #00000026;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#333;transition:all .2s ease}.zoom-btn[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0003;transform:scale(1.05)}.zoom-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#f0f0f0}.zoom-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}.zoom-level-display[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:6px 12px;font-size:12px;font-weight:600;color:#333;text-align:center;box-shadow:0 2px 8px #00000026;min-width:48px}.thumbnail-toggle-btn[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:#fff;border:none;box-shadow:0 2px 8px #00000026;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#333;transition:all .2s ease}.thumbnail-toggle-btn[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0003;transform:scale(1.05)}.thumbnail-toggle-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.thumbnail-toggle-btn.active[_ngcontent-%COMP%]{background:#007aff;color:#fff}.thumbnail-toggle-btn.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#fff}.thumbnail-toggle-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}.file-menu-content[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]{padding:20px;border-bottom:1px solid #e5e7eb}.file-menu-content[_ngcontent-%COMP%]   .sheet-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#222;margin:0;text-align:center}.file-menu-content[_ngcontent-%COMP%]   .sheet-options[_ngcontent-%COMP%]{padding:8px 0}.file-menu-content[_ngcontent-%COMP%]   .rename-mode[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.file-menu-content[_ngcontent-%COMP%]   .sheet-back-btn[_ngcontent-%COMP%]{width:40px;height:40px;border:none;background:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer}.file-menu-content[_ngcontent-%COMP%]   .sheet-back-btn[_ngcontent-%COMP%]:active{background:#f3f4f6}.file-menu-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]{width:100%;padding:16px 20px;background:none;border:none;display:flex;align-items:center;gap:16px;cursor:pointer;font-size:16px;color:#333;transition:background .2s ease}.file-menu-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]:active{background:#f3f4f6}.file-menu-content[_ngcontent-%COMP%]   .sheet-option.danger[_ngcontent-%COMP%]{color:#ef5350}.file-menu-content[_ngcontent-%COMP%]   .sheet-option.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%], .file-menu-content[_ngcontent-%COMP%]   .sheet-option.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   line[_ngcontent-%COMP%]{stroke:#ef5350!important}.file-menu-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.file-menu-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;text-align:left}.file-menu-content[_ngcontent-%COMP%]   .rename-form[_ngcontent-%COMP%]{padding:20px;display:flex;flex-direction:column;gap:16px}.file-menu-content[_ngcontent-%COMP%]   .rename-label[_ngcontent-%COMP%]{font-size:14px;color:#555}.file-menu-content[_ngcontent-%COMP%]   .rename-input[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #e0e0e0;border-radius:10px;font-size:15px;outline:none;transition:border .15s ease}.file-menu-content[_ngcontent-%COMP%]   .rename-input[_ngcontent-%COMP%]:focus{border-color:#007acc;box-shadow:0 0 0 2px #007acc1f}.file-menu-content[_ngcontent-%COMP%]   .rename-helper[_ngcontent-%COMP%]{margin:0;font-size:13px;color:#888}.file-menu-content[_ngcontent-%COMP%]   .rename-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px}.file-menu-content[_ngcontent-%COMP%]   .rename-cancel[_ngcontent-%COMP%], .file-menu-content[_ngcontent-%COMP%]   .rename-confirm[_ngcontent-%COMP%]{min-width:80px;padding:10px 16px;border-radius:8px;border:none;font-size:14px;font-weight:500;cursor:pointer}.file-menu-content[_ngcontent-%COMP%]   .rename-cancel[_ngcontent-%COMP%]{background:#f3f4f6;color:#555}.file-menu-content[_ngcontent-%COMP%]   .rename-cancel[_ngcontent-%COMP%]:active{background:#e2e6ea}.file-menu-content[_ngcontent-%COMP%]   .rename-confirm[_ngcontent-%COMP%]{background:#007acc;color:#fff;box-shadow:0 4px 10px #007acc40}.file-menu-content[_ngcontent-%COMP%]   .rename-confirm[_ngcontent-%COMP%]:active{background:#0061b5}.drawing-vertical-panel[_ngcontent-%COMP%]{position:fixed;right:16px;bottom:calc(80px + var(--android-navigation-bar-height, 0px));display:flex;flex-direction:column;gap:8px;z-index:1000;background:#fff;padding:8px;border-radius:16px;box-shadow:0 4px 16px #00000026}.drawing-vertical-panel[_ngcontent-%COMP%]   .drawing-panel-btn[_ngcontent-%COMP%]{width:44px;height:44px;border:none;border-radius:10px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;background:#f5f5f5}.drawing-vertical-panel[_ngcontent-%COMP%]   .drawing-panel-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.drawing-vertical-panel[_ngcontent-%COMP%]   .drawing-panel-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:22px;height:22px;color:#666}.drawing-vertical-panel[_ngcontent-%COMP%]   .drawing-panel-btn.color-btn[_ngcontent-%COMP%]{background:var(--current-color);border:2px solid rgba(0,0,0,.1)}.drawing-vertical-panel[_ngcontent-%COMP%]   .drawing-panel-btn.color-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#fff;filter:drop-shadow(0 1px 2px rgba(0,0,0,.3))}.drawing-vertical-panel[_ngcontent-%COMP%]   .drawing-panel-btn.color-btn.light-color[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#333;filter:none}.drawing-vertical-panel[_ngcontent-%COMP%]   .drawing-panel-btn.eraser-btn.active[_ngcontent-%COMP%]{background:#e3f2fd}.drawing-vertical-panel[_ngcontent-%COMP%]   .drawing-panel-btn.eraser-btn.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#2196f3}.drawing-vertical-panel[_ngcontent-%COMP%]   .drawing-panel-btn.close-btn[_ngcontent-%COMP%]:active{background:#ffebee}.drawing-vertical-panel[_ngcontent-%COMP%]   .drawing-panel-btn.close-btn[_ngcontent-%COMP%]:active   svg[_ngcontent-%COMP%]{color:#f44336}.drawing-sheet-content[_ngcontent-%COMP%]{padding:0 16px 16px}.drawing-sheet-content[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:8px 0 16px;border-bottom:1px solid #f0f0f0;margin-bottom:16px}.drawing-sheet-content[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   .sheet-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0}.drawing-sheet-content[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#666;margin-bottom:12px}.drawing-sheet-content[_ngcontent-%COMP%]   .thickness-section[_ngcontent-%COMP%]{margin-bottom:24px}.drawing-sheet-content[_ngcontent-%COMP%]   .thickness-section[_ngcontent-%COMP%]   .thickness-slider-wrapper[_ngcontent-%COMP%]   .thickness-range[_ngcontent-%COMP%]{width:100%;height:6px;border-radius:3px;background:linear-gradient(to right,#e0e0e0,#2196f3);outline:none;-webkit-appearance:none;appearance:none}.drawing-sheet-content[_ngcontent-%COMP%]   .thickness-section[_ngcontent-%COMP%]   .thickness-slider-wrapper[_ngcontent-%COMP%]   .thickness-range[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:24px;height:24px;border-radius:50%;background:#2196f3;cursor:pointer;box-shadow:0 2px 4px #0003}.drawing-sheet-content[_ngcontent-%COMP%]   .thickness-section[_ngcontent-%COMP%]   .thickness-slider-wrapper[_ngcontent-%COMP%]   .thickness-range[_ngcontent-%COMP%]::-moz-range-thumb{width:24px;height:24px;border-radius:50%;background:#2196f3;cursor:pointer;border:none;box-shadow:0 2px 4px #0003}.drawing-sheet-content[_ngcontent-%COMP%]   .thickness-section[_ngcontent-%COMP%]   .thickness-slider-wrapper[_ngcontent-%COMP%]   .thickness-preview[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-top:12px;padding:8px 12px;background:#f9f9f9;border-radius:8px}.drawing-sheet-content[_ngcontent-%COMP%]   .thickness-section[_ngcontent-%COMP%]   .thickness-slider-wrapper[_ngcontent-%COMP%]   .thickness-preview[_ngcontent-%COMP%]   .thickness-value[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#2196f3}.drawing-sheet-content[_ngcontent-%COMP%]   .thickness-section[_ngcontent-%COMP%]   .thickness-slider-wrapper[_ngcontent-%COMP%]   .thickness-preview[_ngcontent-%COMP%]   .thickness-circle[_ngcontent-%COMP%]{border-radius:50%;transition:all .2s}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]{margin-bottom:16px}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]   .preset-color-btn[_ngcontent-%COMP%]{width:44px;height:44px;border:2px solid transparent;border-radius:10px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]   .preset-color-btn.selected[_ngcontent-%COMP%]{border-color:#333;box-shadow:0 0 0 2px #0000001a}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]   .preset-color-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]   .preset-color-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#fff;filter:drop-shadow(0 1px 2px rgba(0,0,0,.3));opacity:0;transition:opacity .2s}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]   .preset-color-btn.selected[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:1}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]   .preset-color-btn.light-color[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#333;filter:none}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]   .preset-color-btn.more-colors-btn[_ngcontent-%COMP%]{background:#f5f5f5;border:2px dashed #ccc}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]   .preset-color-btn.more-colors-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#666;opacity:1;filter:none}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]   .preset-color-btn.more-colors-btn.active[_ngcontent-%COMP%]{border-color:#2196f3;background:#e3f2fd}.drawing-sheet-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .preset-colors[_ngcontent-%COMP%]   .preset-color-btn.more-colors-btn.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#2196f3}.drawing-sheet-content[_ngcontent-%COMP%]   .full-color-section[_ngcontent-%COMP%]{padding-top:16px;border-top:1px solid #f0f0f0}.drawing-sheet-content[_ngcontent-%COMP%]   .full-color-section[_ngcontent-%COMP%]   .color-picker-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(6,1fr);gap:10px}.drawing-sheet-content[_ngcontent-%COMP%]   .full-color-section[_ngcontent-%COMP%]   .color-picker-grid[_ngcontent-%COMP%]   .full-color-btn[_ngcontent-%COMP%]{aspect-ratio:1;border:2px solid transparent;border-radius:10px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.drawing-sheet-content[_ngcontent-%COMP%]   .full-color-section[_ngcontent-%COMP%]   .color-picker-grid[_ngcontent-%COMP%]   .full-color-btn.selected[_ngcontent-%COMP%]{border-color:#333;box-shadow:0 0 0 2px #0000001a}.drawing-sheet-content[_ngcontent-%COMP%]   .full-color-section[_ngcontent-%COMP%]   .color-picker-grid[_ngcontent-%COMP%]   .full-color-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.drawing-sheet-content[_ngcontent-%COMP%]   .full-color-section[_ngcontent-%COMP%]   .color-picker-grid[_ngcontent-%COMP%]   .full-color-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#fff;filter:drop-shadow(0 1px 2px rgba(0,0,0,.3));opacity:0;transition:opacity .2s}.drawing-sheet-content[_ngcontent-%COMP%]   .full-color-section[_ngcontent-%COMP%]   .color-picker-grid[_ngcontent-%COMP%]   .full-color-btn.selected[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:1}.drawing-sheet-content[_ngcontent-%COMP%]   .full-color-section[_ngcontent-%COMP%]   .color-picker-grid[_ngcontent-%COMP%]   .full-color-btn.light-color[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#333;filter:none}.drawing-sheet-content[_ngcontent-%COMP%]   .full-color-section[_ngcontent-%COMP%]   .color-picker-grid[_ngcontent-%COMP%]   .full-color-btn.white-color[_ngcontent-%COMP%]{border-color:#e0e0e0}  .search-bottom-sheet .sheet-overlay{-webkit-backdrop-filter:none!important;backdrop-filter:none!important;background:#0000004d}.search-sheet-content[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]{padding:20px;border-bottom:1px solid #e5e7eb}.search-sheet-content[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]   .sheet-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#222;margin:0;text-align:center}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]{padding:20px}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:16px}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{flex:1;padding:12px 16px;border:2px solid #e0e0e0;border-radius:12px;font-size:16px;outline:none;transition:all .2s}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{border-color:#2196f3;box-shadow:0 0 0 3px #2196f31a}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#999}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-btn[_ngcontent-%COMP%]{background:#2196f3;border:none;border-radius:12px;padding:12px 16px;cursor:pointer;color:#fff;display:flex;align-items:center;justify-content:center;transition:all .2s}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-btn[_ngcontent-%COMP%]:hover{background:#1976d2}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px;background:#f5f5f5;border-radius:12px}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .search-results-info[_ngcontent-%COMP%]{font-size:14px;color:#666;font-weight:500}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .search-navigation[_ngcontent-%COMP%]{display:flex;gap:8px}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .search-navigation[_ngcontent-%COMP%]   .search-nav-btn[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:8px 12px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .search-navigation[_ngcontent-%COMP%]   .search-nav-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5;border-color:#2196f3}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .search-navigation[_ngcontent-%COMP%]   .search-nav-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.search-sheet-content[_ngcontent-%COMP%]   .search-sheet-body[_ngcontent-%COMP%]   .search-results[_ngcontent-%COMP%]   .search-navigation[_ngcontent-%COMP%]   .search-nav-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;stroke:#666}  .editorParamsToolbar,   #editorInkParamsToolbar,   #editorFreeTextParamsToolbar,   #editorHighlightParamsToolbar,   #editorStampParamsToolbar{display:none!important}  .editorModeButtons{display:none!important}  ngx-extended-pdf-viewer #editorUndoBar,   ngx-extended-pdf-viewer .editorUndoBar,   #editorUndoBar{display:none!important}']})};function ys(r,t){if(r&1){let e=y();o(0,"button",8),u("click",function(){let i=m(e).$implicit,s=g();return f(s.onToolClick(i.id))}),o(1,"div",9)(2,"span",10),c(3),a()(),o(4,"span",11),c(5),a()()}if(r&2){let e=t.$implicit;l(3),x(e.icon),l(2),x(e.label)}}function ws(r,t){r&1&&h(0,"img",23)}function Ss(r,t){r&1&&h(0,"img",24)}function Os(r,t){r&1&&h(0,"img",25)}function Es(r,t){r&1&&h(0,"img",26)}function ks(r,t){r&1&&h(0,"img",27)}function Ds(r,t){r&1&&h(0,"img",28)}function Is(r,t){r&1&&h(0,"img",29)}function Ts(r,t){r&1&&h(0,"img",30)}function As(r,t){r&1&&h(0,"img",31)}function Fs(r,t){if(r&1){let e=y();o(0,"button",8),u("click",function(){let i=m(e).$implicit,s=g();return f(s.onToolClick(i.id))}),o(1,"div",12),re(2,13),b(3,ws,1,0,"img",14)(4,Ss,1,0,"img",15)(5,Os,1,0,"img",16)(6,Es,1,0,"img",17)(7,ks,1,0,"img",18)(8,Ds,1,0,"img",19)(9,Is,1,0,"img",20)(10,Ts,1,0,"img",21)(11,As,1,0,"img",22),ae(),a(),o(12,"span",11),c(13),a()()}if(r&2){let e=t.$implicit;l(),p("ngClass",e.icon+"-icon"),l(),p("ngSwitch",e.icon),l(),p("ngSwitchCase","merge"),l(),p("ngSwitchCase","create"),l(),p("ngSwitchCase","rotate"),l(),p("ngSwitchCase","encrypt"),l(),p("ngSwitchCase","decrypt"),l(),p("ngSwitchCase","page-number"),l(),p("ngSwitchCase","watermark"),l(),p("ngSwitchCase","split"),l(),p("ngSwitchCase","organize"),l(2),x(e.label)}}var Jn=class r{constructor(t,e){this.router=t;this.toolActionService=e;window.scrollTo(0,0)}currentActiveTab="tools";aiTools=[];fromPdfTools=[];toPdfTools=[];documentTools=[];isAuthenticated=!1;userPoints=2450;userProfile=null;isSideMenuOpen=!1;authSubscription;userProfileSubscription;reversePdfConverter=P(_t);indexedDbService=P(ee);snackbar=P(G);geminiApiManager=P(Ne);i18n=P(nt);authService=P(Ce);ngOnInit(){this.initializeTools(),this.i18n.currentLanguage$.subscribe(()=>{this.initializeTools()}),this.authSubscription=this.authService.isAuthenticated$.subscribe(t=>this.isAuthenticated=t),this.userProfileSubscription=this.authService.userProfile$.subscribe(t=>this.userProfile=t)}ngOnDestroy(){this.authSubscription&&this.authSubscription.unsubscribe(),this.userProfileSubscription&&this.userProfileSubscription.unsubscribe()}onLoginClick(){this.authService.startGoogleLogin()}navigateToSearch(){this.router.navigate(["/ezm/search"])}getAvatarText(){return this.userProfile?(this.userProfile.name||this.userProfile.email||"").charAt(0).toUpperCase():""}onMenuClick(){this.isSideMenuOpen=!0}onSideMenuClose(){this.isSideMenuOpen=!1}initializeTools(){this.aiTools=[{id:"ai-summary",label:this.i18n.translate("tools.aiSummary"),icon:"AI",iconType:"badge",color:"ai"},{id:"ai-translate",label:this.i18n.translate("tools.aiTranslate"),icon:"AI",iconType:"badge",color:"ai"}],this.fromPdfTools=[],this.toPdfTools=[],this.documentTools=[{id:"merge",label:this.i18n.translate("tools.merge"),icon:"merge",iconType:"svg"},{id:"split",label:this.i18n.translate("tools.split"),icon:"split",iconType:"svg"},{id:"create",label:this.i18n.translate("tools.create"),icon:"create",iconType:"svg"},{id:"rotate",label:this.i18n.translate("tools.rotate"),icon:"rotate",iconType:"svg"},{id:"encrypt",label:this.i18n.translate("tools.encrypt"),icon:"encrypt",iconType:"svg"},{id:"decrypt",label:this.i18n.translate("tools.decrypt"),icon:"decrypt",iconType:"svg"},{id:"organize",label:this.i18n.translate("tools.organize"),icon:"organize",iconType:"svg"},{id:"page-number",label:this.i18n.translate("tools.pageNumber"),icon:"page-number",iconType:"svg"},{id:"watermark",label:this.i18n.translate("tools.watermark"),icon:"watermark",iconType:"svg"}]}onToolClick(t){if(this.toolActionService.setOrigin("tools"),["image-to-pdf","excel-to-pdf","word-to-pdf","ppt-to-pdf","photo-to-pdf"].includes(t)){let i={"image-to-pdf":"\uC774\uBBF8\uC9C0 \u2192 PDF","photo-to-pdf":"\uC0AC\uC9C4 \u2192 PDF","excel-to-pdf":"\uC5D1\uC140 \u2192 PDF","word-to-pdf":"\uC6CC\uB4DC \u2192 PDF","ppt-to-pdf":"PPT \u2192 PDF"},s={"image-to-pdf":"image","photo-to-pdf":"image","excel-to-pdf":"excel","word-to-pdf":"word","ppt-to-pdf":"ppt"};this.toolActionService.setPendingAction({toolId:t,toolLabel:i[t]||"\uBB38\uC11C \uBCC0\uD658",action:"convert-to-pdf",requiresFileSelection:!0,selectionMode:"single",data:{convertType:t,sourceFileType:s[t]}}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="ai-summary"){if(!this.geminiApiManager.hasApiKey()){this.router.navigate(["/ezm/google-login-required"],{state:{featureName:"PDF AI \uC694\uC57D"}});return}this.toolActionService.setPendingAction({toolId:"ai-summary",toolLabel:"PDF AI \uC694\uC57D",action:"ai-summary",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="ai-translate"){if(!this.geminiApiManager.hasApiKey()){this.router.navigate(["/ezm/google-login-required"],{state:{featureName:"PDF AI \uBC88\uC5ED"}});return}this.toolActionService.setPendingAction({toolId:"ai-translate",toolLabel:"PDF AI \uBC88\uC5ED",action:"ai-translate",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(["pdf-to-image","pdf-to-excel","pdf-to-word","pdf-to-jpg","pdf-to-powerpoint"].includes(t)){let i={"pdf-to-image":"PDF\uB97C \uC774\uBBF8\uC9C0\uB85C","pdf-to-excel":"PDF\uB97C Excel\uB85C","pdf-to-word":"PDF\uB97C Word\uB85C","pdf-to-jpg":"PDF\uB97C JPG\uB85C","pdf-to-powerpoint":"PDF\uB97C PowerPoint"};this.toolActionService.setPendingAction({toolId:t,toolLabel:i[t],action:"convert-pdf",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="merge"){this.toolActionService.setPendingAction({toolId:"merge",toolLabel:"PDF \uBCD1\uD569",action:"merge-pdf",requiresFileSelection:!0,selectionMode:"multi",minSelection:2,confirmButtonLabel:"\uBCD1\uD569\uD558\uAE30"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="create"){this.router.navigate(["/ezm/pdf-create"]);return}if(t==="encrypt"){this.toolActionService.setPendingAction({toolId:"encrypt",toolLabel:"PDF \uC554\uD638\uD654",action:"encrypt-pdf",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="decrypt"){this.toolActionService.setPendingAction({toolId:"decrypt",toolLabel:"PDF \uC554\uD638 \uD574\uC81C",action:"decrypt-pdf",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="rotate"){this.toolActionService.setPendingAction({toolId:"rotate",toolLabel:"PDF \uD68C\uC804",action:"rotate-pdf",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="split"){this.toolActionService.setPendingAction({toolId:"split",toolLabel:"PDF \uBD84\uD560",action:"split-pdf",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="organize"){this.toolActionService.setPendingAction({toolId:"organize",toolLabel:"PDF \uAD6C\uC131",action:"organize-pdf",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="edit"){this.toolActionService.setPendingAction({toolId:"edit",toolLabel:"PDF \uD3B8\uC9D1",action:"edit",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="page-number"){this.toolActionService.setPendingAction({toolId:"page-number",toolLabel:"PDF \uD398\uC774\uC9C0 \uBC88\uD638",action:"add-page-numbers",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="watermark"){this.toolActionService.setPendingAction({toolId:"watermark",toolLabel:"PDF \uC6CC\uD130\uB9C8\uD06C",action:"add-watermark",requiresFileSelection:!0,selectionMode:"single"}),this.router.navigate(["/ezm/file-picker"]);return}if(t==="image-to-pdf"||t==="photo-to-pdf"||t==="excel-to-pdf"||t==="word-to-pdf"||t==="ppt-to-pdf"){let i={"image-to-pdf":"\uC774\uBBF8\uC9C0 \u2192 PDF","photo-to-pdf":"\uC0AC\uC9C4 \u2192 PDF","excel-to-pdf":"\uC5D1\uC140 \u2192 PDF","word-to-pdf":"\uC6CC\uB4DC \u2192 PDF","ppt-to-pdf":"PPT \u2192 PDF"},s={"image-to-pdf":"image","photo-to-pdf":"image","excel-to-pdf":"excel","word-to-pdf":"word","ppt-to-pdf":"ppt"};this.toolActionService.setPendingAction({toolId:t,toolLabel:i[t]||"\uBB38\uC11C \uBCC0\uD658",action:"convert-to-pdf",requiresFileSelection:!0,selectionMode:"single",data:{convertType:t,sourceFileType:s[t]}}),this.router.navigate(["/ezm/file-picker"]);return}}handleToPdfConversion(t){let e=document.createElement("input");switch(e.type="file",e.multiple=t==="image-to-pdf"||t==="photo-to-pdf",t){case"image-to-pdf":case"photo-to-pdf":e.accept="image/*";break;case"excel-to-pdf":e.accept=".xlsx,.xls";break;case"word-to-pdf":e.accept=".docx";break;case"ppt-to-pdf":e.accept=".pptx";break}e.onchange=n=>C(this,null,function*(){let i=Array.from(n.target.files||[]);if(i.length!==0)try{this.snackbar.showInfo("\uD30C\uC77C \uBCC0\uD658 \uC911...");let s=null,d="";switch(t){case"image-to-pdf":case"photo-to-pdf":s=yield this.reversePdfConverter.imageToPdf(i);let w=new Date,M=w.getHours().toString().padStart(2,"0")+w.getMinutes().toString().padStart(2,"0")+w.getSeconds().toString().padStart(2,"0");d=i.length===1?`\uC774\uBBF8\uC9C0\uBCC0\uD658_${M}.pdf`:`\uC774\uBBF8\uC9C0\uBCC0\uD658_${M}.pdf`;break;case"excel-to-pdf":s=yield this.reversePdfConverter.excelToPdf(i[0]);let O=new Date;d=`\uC5D1\uC140\uBCC0\uD658_${O.getHours().toString().padStart(2,"0")+O.getMinutes().toString().padStart(2,"0")+O.getSeconds().toString().padStart(2,"0")}.pdf`;break;case"word-to-pdf":s=yield this.reversePdfConverter.wordToPdf(i[0]);let D=new Date;d=`\uC6CC\uB4DC\uBCC0\uD658_${D.getHours().toString().padStart(2,"0")+D.getMinutes().toString().padStart(2,"0")+D.getSeconds().toString().padStart(2,"0")}.pdf`;break;case"ppt-to-pdf":s=yield this.reversePdfConverter.powerPointToPdf(i[0]);let I=new Date;d=`PPT\uBCC0\uD658_${I.getHours().toString().padStart(2,"0")+I.getMinutes().toString().padStart(2,"0")+I.getSeconds().toString().padStart(2,"0")}.pdf`;break}if(!s)throw new Error("PDF \uC0DD\uC131 \uC2E4\uD328");let _=`doc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,v=this.uint8ArrayToBase64(s);yield this.indexedDbService.saveDocument({id:_,title:d,fileName:d,pdfBase64:v,thumbnail:"",pages:[],elementCount:0,version:"1.0",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:"converted"}),this.router.navigate(["/ezm/file-saved"],{state:{fileId:_,fileName:d,fileCount:1,title:"\uBCC0\uD658 \uC644\uB8CC!",subtitle:`${d} \uD30C\uC77C\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`}})}catch{this.snackbar.showError("\uBCC0\uD658 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}}),e.click()}uint8ArrayToBase64(t){let n="";for(let i=0;i<t.length;i+=32768){let s=t.subarray(i,Math.min(i+32768,t.length));n+=String.fromCharCode(...Array.from(s))}return btoa(n)}static \u0275fac=function(e){return new(e||r)(V(N),V(le))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-tools"]],standalone:!1,decls:16,vars:10,consts:[[3,"menuClick"],[3,"close","isOpen"],[1,"main-content"],[1,"section"],[1,"section-title"],[1,"tools-grid"],["class","tool-item",3,"click",4,"ngFor","ngForOf"],[3,"activeTab"],[1,"tool-item",3,"click"],[1,"tool-icon"],[1,"icon-badge","ai"],[1,"tool-label"],[1,"tool-icon",3,"ngClass"],[3,"ngSwitch"],["src","images/icons/ico-tool-main-merge.svg","alt","\uBCD1\uD569","width","24","height","24",4,"ngSwitchCase"],["src","images/icons/ico-tool-main-making.svg","alt","\uB9CC\uB4E4\uAE30","width","24","height","24",4,"ngSwitchCase"],["src","images/icons/ico-tool-main-rotation.svg","alt","\uD68C\uC804","width","24","height","24",4,"ngSwitchCase"],["src","images/icons/ico-tool-main-password.svg","alt","\uC554\uD638\uD654","width","24","height","24",4,"ngSwitchCase"],["src","images/icons/ico-tool-main-decryption.svg","alt","\uC554\uD638\uD574\uC81C","width","24","height","24",4,"ngSwitchCase"],["src","images/icons/ico-tool-main-page.svg","alt","\uD398\uC774\uC9C0\uBC88\uD638","width","24","height","24",4,"ngSwitchCase"],["src","images/icons/ico-tool-main-watermark.svg","alt","\uC6CC\uD130\uB9C8\uD06C","width","24","height","24",4,"ngSwitchCase"],["src","images/icons/ico-tool-main-cut.svg","alt","\uBD84\uD560","width","24","height","24",4,"ngSwitchCase"],["src","images/icons/btn-top-view.svg","alt","\uAD6C\uC131","width","24","height","24",4,"ngSwitchCase"],["src","images/icons/ico-tool-main-merge.svg","alt","\uBCD1\uD569","width","24","height","24"],["src","images/icons/ico-tool-main-making.svg","alt","\uB9CC\uB4E4\uAE30","width","24","height","24"],["src","images/icons/ico-tool-main-rotation.svg","alt","\uD68C\uC804","width","24","height","24"],["src","images/icons/ico-tool-main-password.svg","alt","\uC554\uD638\uD654","width","24","height","24"],["src","images/icons/ico-tool-main-decryption.svg","alt","\uC554\uD638\uD574\uC81C","width","24","height","24"],["src","images/icons/ico-tool-main-page.svg","alt","\uD398\uC774\uC9C0\uBC88\uD638","width","24","height","24"],["src","images/icons/ico-tool-main-watermark.svg","alt","\uC6CC\uD130\uB9C8\uD06C","width","24","height","24"],["src","images/icons/ico-tool-main-cut.svg","alt","\uBD84\uD560","width","24","height","24"],["src","images/icons/btn-top-view.svg","alt","\uAD6C\uC131","width","24","height","24"]],template:function(e,n){e&1&&(o(0,"ez-reader-mobile-header",0),u("menuClick",function(){return n.onMenuClick()}),a(),o(1,"ez-reader-mobile-side-menu",1),u("close",function(){return n.onSideMenuClose()}),a(),o(2,"div",2)(3,"div",3)(4,"h3",4),c(5),L(6,"translate"),a(),o(7,"div",5),b(8,ys,6,2,"button",6),a()(),o(9,"div",3)(10,"h3",4),c(11),L(12,"translate"),a(),o(13,"div",5),b(14,Fs,14,12,"button",6),a()()(),h(15,"ez-reader-mobile-bottom-nav",7)),e&2&&(l(),p("isOpen",n.isSideMenuOpen),l(4),x(J(6,6,"tools.aiFeatures")),l(3),p("ngForOf",n.aiTools),l(3),x(J(12,8,"tools.documentTools")),l(3),p("ngForOf",n.documentTools),l(),p("activeTab",n.currentActiveTab))},dependencies:[Ze,oe,pt,gt,it,Ot,Et,yt],styles:[".header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fff;border-bottom:1px solid #e0e0e0;display:flex;align-items:center;justify-content:space-between;padding-left:16px;padding-right:16px;z-index:100;box-sizing:border-box}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.header-left[_ngcontent-%COMP%]   .header-logo-icon[_ngcontent-%COMP%]{height:28px;width:28px;object-fit:contain}.header-left[_ngcontent-%COMP%]   .header-logo-title[_ngcontent-%COMP%]{height:auto;width:auto}.header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.icon-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#666;display:flex;align-items:center;justify-content:center;border-radius:50%}.icon-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.points-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;background:#fff;border-radius:4px;cursor:pointer;transition:background .2s}.points-display[_ngcontent-%COMP%]:active{background:#f5f5f5}.points-display[_ngcontent-%COMP%]   .points-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;background:#f44;border-radius:50%;color:#fff;font-size:11px;font-weight:700}.points-display[_ngcontent-%COMP%]   .points-value[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#333;white-space:nowrap}.login-btn[_ngcontent-%COMP%]{padding:6px 16px;background:#fff;border:1px solid #ff4444;border-radius:20px;color:#f44;font-size:13px;font-weight:500;cursor:pointer;white-space:nowrap;transition:all .2s}.login-btn[_ngcontent-%COMP%]:active{background:#fff5f5;border-color:#f22;color:#f22}.user-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;overflow:hidden;cursor:pointer;display:flex;align-items:center;justify-content:center;background:#4285f4;transition:opacity .2s}.user-avatar[_ngcontent-%COMP%]:active{opacity:.8}.user-avatar[_ngcontent-%COMP%]   .avatar-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.user-avatar[_ngcontent-%COMP%]   .avatar-text[_ngcontent-%COMP%]{color:#fff;font-size:14px;font-weight:600;-webkit-user-select:none;user-select:none}.main-content[_ngcontent-%COMP%]{padding-top:calc(56px + var(--android-status-bar-height, 0px));padding-bottom:calc(60px + var(--android-navigation-bar-height, 0px));background:#f5f5f5}.section[_ngcontent-%COMP%]{padding:16px;margin-bottom:8px;background:#fff}.section-title[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;font-weight:600;color:#333}.tools-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.tool-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;padding:16px;background:#f8f9fa;border:1px solid #e0e0e0;border-radius:12px;cursor:pointer;transition:all .2s}.tool-item[_ngcontent-%COMP%]:active{background:#e9ecef;transform:scale(.98)}.tool-icon[_ngcontent-%COMP%]{width:48px;height:48px;display:flex;align-items:center;justify-content:center;border-radius:12px}.icon-badge.ai[_ngcontent-%COMP%]{padding:4px 8px;background:linear-gradient(135deg,#e91e63,#ff6b35);color:#fff;font-size:12px;font-weight:600;border-radius:4px}.tool-label[_ngcontent-%COMP%]{font-size:13px;color:#333;text-align:center}"]})};function zs(r,t){if(r&1){let e=y();re(0),o(1,"ez-reader-mobile-header",34),u("menuClick",function(){m(e);let i=g();return f(i.onMenuClick())}),a(),o(2,"ez-reader-mobile-side-menu",35),u("close",function(){m(e);let i=g();return f(i.onSideMenuClose())}),a(),ae()}if(r&2){let e=g();l(2),p("isOpen",e.isSideMenuOpen)}}function Rs(r,t){if(r&1){let e=y();o(0,"button",44),u("click",function(){m(e);let i=g(3);return f(i.toggleSelectionMode())}),c(1),a()}if(r&2){let e=g(3);l(),S(" ",e.isSelectionMode?"\uCDE8\uC18C":"\uC120\uD0DD"," ")}}function Bs(r,t){if(r&1){let e=y();o(0,"button",45),u("click",function(){m(e);let i=g(3);return f(i.onSortClick())}),h(1,"img",46),a()}}function Vs(r,t){if(r&1){let e=y();o(0,"div",37)(1,"button",38),u("click",function(){m(e);let i=g(2);return f(i.goBack())}),h(2,"img",39),a(),o(3,"div",40),c(4),a(),o(5,"div",41),b(6,Rs,2,1,"button",42)(7,Bs,2,0,"button",43),a()()}if(r&2){let e=g(2);l(4),x(e.currentFolderName),l(2),p("ngIf",e.items.length>0),l(),p("ngIf",e.items.length>0)}}function Ls(r,t){if(r&1&&(re(0),b(1,Vs,8,3,"div",36),ae()),r&2){let e=g();l(),p("ngIf",e.currentFolder)}}function Ns(r,t){if(r&1){let e=y();o(0,"div",48)(1,"button",38),u("click",function(){m(e);let i=g(2);return f(i.currentFolder?i.goBack():i.onCancelPendingAction())}),h(2,"img",39),a(),o(3,"div",40),c(4,"\uD30C\uC77C"),a(),o(5,"button",49),u("click",function(){m(e);let i=g(2);return f(i.onAddClick())}),c(6,"\uAC00\uC838\uC624\uAE30"),a()()}}function js(r,t){if(r&1){let e=y();o(0,"div",48)(1,"button",38),u("click",function(){m(e);let i=g(2);return f(i.currentFolder?i.goBack():i.onCancelPendingAction())}),h(2,"img",39),a(),o(3,"div",40),c(4),a()()}if(r&2){let e=g(2);l(4),x(e.currentFolder?e.currentFolderName:"\uD30C\uC77C \uC120\uD0DD")}}function Us(r,t){if(r&1&&(re(0),b(1,Ns,7,0,"div",47)(2,js,5,1,"div",47),ae()),r&2){let e=g();l(),p("ngIf",e.showImportButton()),l(),p("ngIf",!e.showImportButton())}}function $s(r,t){if(r&1&&(o(0,"span"),c(1),a()),r&2){let e=g(3);l(),S("(",e.selectedItems.size,"\uAC1C \uC120\uD0DD\uB428)")}}function Hs(r,t){if(r&1&&(o(0,"div",57)(1,"strong"),c(2,"\uC5F4\uAE30\uD560 PDF\uB97C \uC120\uD0DD"),a(),c(3,"\uD558\uC138\uC694 "),b(4,$s,2,1,"span",2),a()),r&2){let e=g(2);l(4),p("ngIf",e.selectedItems.size>0)}}function Ws(r,t){if(r&1&&(o(0,"span"),c(1),a()),r&2){let e=g(3);l(),S("(",e.selectedItems.size,"\uAC1C \uC120\uD0DD\uB428)")}}function Ks(r,t){if(r&1&&(o(0,"div",57)(1,"strong"),c(2,"\uBCD1\uD569\uD560 PDF\uB97C 2\uAC1C \uC774\uC0C1 \uC120\uD0DD"),a(),c(3,"\uD558\uC138\uC694 "),b(4,Ws,2,1,"span",2),a()),r&2){let e=g(2);l(4),p("ngIf",e.selectedItems.size>0)}}function Gs(r,t){if(r&1&&(o(0,"div",57)(1,"strong"),c(2),a(),c(3,"\uC744 \uC704\uD55C PDF\uB97C \uC120\uD0DD\uD558\uC138\uC694 "),a()),r&2){let e=g(2);l(2),x(e.pendingAction.toolLabel)}}function Ys(r,t){if(r&1){let e=y();o(0,"div",50)(1,"div",51)(2,"div",52),h(3,"img",53),a(),b(4,Hs,5,1,"div",54)(5,Ks,5,1,"div",54)(6,Gs,4,1,"div",54),o(7,"button",55),u("click",function(){m(e);let i=g();return f(i.onCancelPendingAction())}),h(8,"img",56),a()()()}if(r&2){let e=g();l(4),p("ngIf",e.pendingAction.action==="open-pdf"),l(),p("ngIf",e.pendingAction.action==="merge-pdf"),l(),p("ngIf",e.pendingAction.action!=="open-pdf"&&e.pendingAction.action!=="merge-pdf")}}function qs(r,t){if(r&1&&(o(0,"div",58)(1,"div",59)(2,"div",60),c(3,"\u{1F4E4}"),a(),o(4,"div",61)(5,"div",62),c(6),a(),o(7,"div",63),c(8),a()()(),o(9,"div",64),h(10,"div",65),a()()),r&2){let e=g();l(6),x(e.uploadingFileName),l(2),ue("",e.uploadQueue.current,"/",e.uploadQueue.total," \uD30C\uC77C \uC5C5\uB85C\uB4DC \uC911..."),l(2),q("width",e.uploadProgress,"%")}}function Xs(r,t){r&1&&h(0,"ez-shimmer-skeleton",66),r&2&&p("count",6)}function Js(r,t){r&1&&h(0,"img",95)}function Zs(r,t){if(r&1&&(o(0,"div",92)(1,"div",93),b(2,Js,1,0,"img",94),a()()),r&2){let e=g().$implicit,n=g(2);l(),k("checked",n.isItemSelected(e.id)),l(),p("ngIf",n.isItemSelected(e.id))}}function Qs(r,t){r&1&&h(0,"img",96)}function el(r,t){r&1&&h(0,"img",97)}function tl(r,t){r&1&&h(0,"img",98)}function nl(r,t){r&1&&h(0,"img",99)}function il(r,t){r&1&&h(0,"img",100)}function ol(r,t){r&1&&(o(0,"div",101),h(1,"img",102),a())}function rl(r,t){r&1&&(o(0,"div",103),h(1,"div",104),a())}function al(r,t){if(r&1&&h(0,"img",105),r&2){let e=g().$implicit,n=g(2);k("landscape",n.thumbnailOrientations[e.id]==="landscape"),p("src",e.thumbnail,ce)}}function sl(r,t){r&1&&(o(0,"div",106),h(1,"img",107),a())}function ll(r,t){r&1&&(o(0,"div",108),h(1,"img",109),a())}function cl(r,t){r&1&&(o(0,"div",110),h(1,"img",111),a())}function dl(r,t){r&1&&(o(0,"div",112),h(1,"img",113),a())}function pl(r,t){r&1&&(o(0,"div",114),h(1,"img",115),a())}function gl(r,t){if(r&1&&(o(0,"span",116),c(1),a()),r&2){let e=g().$implicit;l(),S(" ",e.fileCount," ")}}function ul(r,t){if(r&1&&(o(0,"div",117),c(1),L(2,"date"),a()),r&2){let e=g().$implicit;l(),S(" \uB9C8\uC9C0\uB9C9 \uBCC0\uACBD: ",me(2,1,e.date,"yyyy.MM.dd HH:mm:ss")," ")}}function ml(r,t){if(r&1&&(o(0,"span",121),c(1),a()),r&2){let e=g(2).$implicit,n=g(2);l(),S(" \xB7 ",n.formatFileSize(e.size))}}function fl(r,t){if(r&1&&(o(0,"div",118)(1,"span",119),c(2),L(3,"date"),a(),b(4,ml,2,1,"span",120),a()),r&2){let e=g().$implicit;l(2),x(me(3,2,e.date,"yyyy.MM.dd HH:mm:ss")),l(2),p("ngIf",e.size)}}function hl(r,t){if(r&1){let e=y();o(0,"button",122),u("click",function(i){m(e);let s=g().$implicit,d=g(2);return f(d.toggleFavorite(s,i))}),h(1,"img",123),a()}if(r&2){let e=g().$implicit;k("active",e.isFavorite),Be("aria-label",e.isFavorite?"\uC990\uACA8\uCC3E\uAE30 \uC81C\uAC70":"\uC990\uACA8\uCC3E\uAE30 \uCD94\uAC00"),l(),p("src",e.isFavorite?"images/icons/btn-bookmark-on.svg":"images/icons/btn-bookmark-off.svg",ce)}}function _l(r,t){if(r&1){let e=y();o(0,"button",124),u("click",function(i){m(e);let s=g().$implicit,d=g(2);return f(d.onMoreClick(s,i))}),h(1,"img",125),a()}if(r&2){let e=g().$implicit;Be("aria-label","\uB354\uBCF4\uAE30: "+e.name)}}function Cl(r,t){if(r&1){let e=y();o(0,"div",69),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.onItemClick(i))}),b(1,Zs,3,3,"div",70),o(2,"div",71),b(3,Qs,1,0,"img",72)(4,el,1,0,"img",73)(5,tl,1,0,"img",74)(6,nl,1,0,"img",75)(7,il,1,0,"img",76)(8,ol,2,0,"div",77)(9,rl,2,0,"div",78)(10,al,1,3,"img",79)(11,sl,2,0,"div",80)(12,ll,2,0,"div",81)(13,cl,2,0,"div",82)(14,dl,2,0,"div",83)(15,pl,2,0,"div",84),a(),o(16,"div",85)(17,"div",86),c(18),b(19,gl,2,1,"span",87),a(),b(20,ul,3,4,"div",88)(21,fl,5,5,"div",89),a(),b(22,hl,2,4,"button",90)(23,_l,2,1,"button",91),a()}if(r&2){let e=t.$implicit,n=g(2);k("selected",n.isItemSelected(e.id))("special-folder",e.id==="recent-files")("disabled",n.isItemDisabled(e)),Be("data-file-id",e.id),l(),p("ngIf",n.isSelectionMode&&((n.pendingAction==null?null:n.pendingAction.action)==="merge-pdf"||!n.pendingAction)&&n.canSelectItem(e)),l(),k("folder-icon",e.type==="folder")("special-folder-icon",e.isSpecialFolder)("my-files-icon",e.folderType==="my-files")("favorites-icon",e.folderType==="favorites")("results-icon",e.folderType==="results")("recent-folder-icon",e.folderType==="recent-files"),l(),p("ngIf",e.folderType==="my-files"),l(),p("ngIf",e.folderType==="favorites"),l(),p("ngIf",e.folderType==="results"),l(),p("ngIf",e.folderType==="recent-files"),l(),p("ngIf",e.type==="folder"&&!e.isSpecialFolder),l(),p("ngIf",e.type==="pdf"&&e.isEncrypted&&!n.isLoadingThumbnail(e.id)),l(),p("ngIf",e.type==="pdf"&&n.isLoadingThumbnail(e.id)),l(),p("ngIf",e.type==="pdf"&&!e.isEncrypted&&e.thumbnail&&!n.isLoadingThumbnail(e.id)),l(),p("ngIf",e.type==="pdf"&&!e.isEncrypted&&!e.thumbnail&&!n.isLoadingThumbnail(e.id)&&e.documentType!=="image"&&e.documentType!=="excel"&&e.documentType!=="word"&&e.documentType!=="ppt"),l(),p("ngIf",e.documentType==="image"),l(),p("ngIf",e.documentType==="excel"),l(),p("ngIf",e.documentType==="word"),l(),p("ngIf",e.documentType==="ppt"),l(3),S(" ",e.name," "),l(),p("ngIf",e.type==="folder"&&e.fileCount&&e.fileCount>0),l(),p("ngIf",e.type==="folder"&&!e.isSpecialFolder&&e.date),l(),p("ngIf",e.type==="pdf"),l(),p("ngIf",e.type==="pdf"&&!n.isSelectionMode&&(n.pendingAction==null?null:n.pendingAction.action)!=="convert-to-pdf"&&(n.pendingAction==null?null:n.pendingAction.action)!=="convert-pdf"),l(),p("ngIf",!n.isSelectionMode&&!e.isSpecialFolder&&(n.pendingAction==null?null:n.pendingAction.action)!=="convert-to-pdf"&&(n.pendingAction==null?null:n.pendingAction.action)!=="convert-pdf")}}function bl(r,t){if(r&1&&(o(0,"div",67),b(1,Cl,24,39,"div",68),a()),r&2){let e=g();l(),p("ngForOf",e.items)}}function vl(r,t){r&1&&(re(0),o(1,"p",128),c(2,"\uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"),a(),o(3,"p",129),c(4,"\uC6B0\uCE21 \uC0C1\uB2E8\uC758 '\uAC00\uC838\uC624\uAE30' \uBC84\uD2BC\uC744 \uB20C\uB7EC"),h(5,"br"),c(6,"\uD30C\uC77C\uC744 \uBA3C\uC800 \uCD94\uAC00\uD574\uC8FC\uC138\uC694"),a(),ae())}function xl(r,t){r&1&&(o(0,"p",128),c(1,"\uD3F4\uB354\uB97C \uC120\uD0DD\uD558\uC138\uC694"),a())}function Pl(r,t){r&1&&(o(0,"p",128),c(1,"\uD3F4\uB354\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4"),a())}function Ml(r,t){r&1&&(o(0,"p",128),c(1,"\uCD5C\uADFC \uBCF8 \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"),a())}function yl(r,t){r&1&&(o(0,"p",128),c(1,"\uC990\uACA8\uCC3E\uAE30\uD55C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"),a())}function wl(r,t){r&1&&(o(0,"p",128),c(1,"\uC0DD\uC131\uB41C \uACB0\uACFC\uBB3C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"),a())}function Sl(r,t){r&1&&(o(0,"p",128),c(1,"\uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"),a())}function Ol(r,t){r&1&&(o(0,"p",129),c(1,"\uD558\uB2E8\uC758 + \uBC84\uD2BC\uC744 \uB20C\uB7EC \uD30C\uC77C\uC744 \uCD94\uAC00\uD558\uC138\uC694"),a())}function El(r,t){r&1&&(o(0,"p",129),c(1,"\uD30C\uC77C \uBAA9\uB85D\uC5D0\uC11C \uBCC4 \uC544\uC774\uCF58\uC744 \uB20C\uB7EC \uC990\uACA8\uCC3E\uAE30\uC5D0 \uCD94\uAC00\uD558\uC138\uC694"),a())}function kl(r,t){r&1&&(o(0,"p",129),c(1,"AI \uC694\uC57D, \uBC88\uC5ED \uB4F1\uC758 \uAE30\uB2A5\uC744 \uC0AC\uC6A9\uD558\uBA74 \uACB0\uACFC\uBB3C\uC774 \uC5EC\uAE30\uC5D0 \uC800\uC7A5\uB429\uB2C8\uB2E4"),a())}function Dl(r,t){if(r&1&&(re(0),b(1,xl,2,0,"p",130)(2,Pl,2,0,"p",130)(3,Ml,2,0,"p",130)(4,yl,2,0,"p",130)(5,wl,2,0,"p",130)(6,Sl,2,0,"p",130)(7,Ol,2,0,"p",131)(8,El,2,0,"p",131)(9,kl,2,0,"p",131),ae()),r&2){let e=g(2);l(),p("ngIf",!e.currentFolder),l(),p("ngIf",e.currentFolder==="my-files"),l(),p("ngIf",e.currentFolder==="recent-files"),l(),p("ngIf",e.currentFolder==="favorites"),l(),p("ngIf",e.currentFolder==="results"),l(),p("ngIf",e.currentFolder&&e.currentFolder!=="my-files"&&e.currentFolder!=="recent-files"&&e.currentFolder!=="favorites"&&e.currentFolder!=="results"),l(),p("ngIf",e.shouldShowFab),l(),p("ngIf",e.currentFolder==="favorites"),l(),p("ngIf",e.currentFolder==="results")}}function Il(r,t){if(r&1&&(o(0,"div",126),h(1,"img",127),b(2,vl,7,0,"ng-container",2)(3,Dl,10,9,"ng-container",2),a()),r&2){let e=g();l(2),p("ngIf",e.pendingAction),l(),p("ngIf",!e.pendingAction)}}function Tl(r,t){if(r&1&&(re(0),c(1),ae()),r&2){let e=g(2);l(),S("",e.selectedItems.size,"\uAC1C \uC120\uD0DD\uB428")}}function Al(r,t){r&1&&(re(0),c(1,"\uD56D\uBAA9\uC744 \uC120\uD0DD\uD558\uC138\uC694"),ae())}function Fl(r,t){if(r&1){let e=y();o(0,"div",132)(1,"div",133)(2,"span",134),b(3,Tl,2,1,"ng-container",2)(4,Al,2,0,"ng-container",2),a(),o(5,"button",135),u("click",function(){m(e);let i=g();return f(i.selectAll())}),c(6," \uC804\uCCB4\uC120\uD0DD "),a(),o(7,"button",136),u("click",function(){m(e);let i=g();return f(i.deselectAll())}),c(8," \uC120\uD0DD\uD574\uC81C "),a()(),o(9,"button",137),u("click",function(){m(e);let i=g();return f(i.deleteSelectedItems())}),h(10,"img",138),c(11," \uC0AD\uC81C "),a()()}if(r&2){let e=g();l(3),p("ngIf",e.selectedItems.size>0),l(),p("ngIf",e.selectedItems.size===0),l(3),p("disabled",e.selectedItems.size===0),l(2),p("disabled",e.selectedItems.size===0)}}function zl(r,t){if(r&1){let e=y();o(0,"div",139)(1,"span",134),c(2,"\uC120\uD0DD\uB41C \uD30C\uC77C "),o(3,"strong"),c(4),a(),c(5,"\uAC1C"),a(),o(6,"button",140),u("click",function(){m(e);let i=g();return f(i.onConfirmSelection())}),c(7),a()()}if(r&2){let e=g();l(4),x(e.selectedItems.size),l(2),k("active",e.canConfirmSelection()),p("disabled",!e.canConfirmSelection()),l(),S(" ",e.getConfirmButtonLabel()," ")}}function Rl(r,t){if(r&1&&h(0,"ez-reader-mobile-bottom-nav",141),r&2){let e=g();p("activeTab",e.currentActiveTab)}}function Bl(r,t){if(r&1){let e=y();re(0),o(1,"div",142)(2,"h3",143),c(3),a()(),o(4,"div",144)(5,"div",145)(6,"button",146),u("click",function(){m(e);let i=g();return f(i.onImportSelected("file"))}),o(7,"div",147),h(8,"img",148),a(),o(9,"span",149),c(10,"\uD30C\uC77C"),a()()()(),ae()}if(r&2){let e=g();l(3),x(e.getImportSheetTitle())}}function Vl(r,t){if(r&1){let e=y();re(0),o(1,"div",142)(2,"h3",143),c(3,"PDF \uD30C\uC77C\uC744 \uC5F4\uC5B4\uBCF4\uC138\uC694."),a()(),o(4,"div",144)(5,"div",150)(6,"button",146),u("click",function(){m(e);let i=g();return f(i.onActionSelected("file"))}),o(7,"div",147),h(8,"img",148),a(),o(9,"span",149),c(10,"\uD30C\uC77C"),a()()(),h(11,"div",151),o(12,"div",152)(13,"button",153),u("click",function(){m(e);let i=g();return f(i.onActionSelected("create-pdf"))}),o(14,"div",154),h(15,"img",155),a(),o(16,"span",156),c(17,"PDF \uB9CC\uB4E4\uAE30"),a()()()(),ae()}}function Ll(r,t){r&1&&(o(0,"p",168),c(1,".pdf \uD655\uC7A5\uC790\uB294 \uC790\uB3D9\uC73C\uB85C \uCD94\uAC00\uB429\uB2C8\uB2E4."),a())}function Nl(r,t){if(r&1){let e=y();re(0),o(1,"div",158)(2,"button",159),u("click",function(){m(e);let i=g(2);return f(i.cancelRenameFromSheet())}),h(3,"img",160),a(),o(4,"h3",19),c(5,"\uC774\uB984 \uBCC0\uACBD"),a()(),o(6,"div",161)(7,"label",162),c(8,"\uC0C8 \uC774\uB984"),a(),o(9,"input",163),u("input",function(i){m(e);let s=g(2);return f(s.renameInputValue=i.target.value||"")}),a(),b(10,Ll,2,0,"p",164),o(11,"div",165)(12,"button",166),u("click",function(){m(e);let i=g(2);return f(i.cancelRenameFromSheet())}),c(13,"\uCDE8\uC18C"),a(),o(14,"button",167),u("click",function(){m(e);let i=g(2);return f(i.confirmRenameFromSheet())}),c(15,"\uC644\uB8CC"),a()()(),ae()}if(r&2){let e=g(2);l(9),p("value",e.renameInputValue),l(),p("ngIf",(e.renameTarget==null?null:e.renameTarget.type)==="pdf")}}function jl(r,t){if(r&1){let e=y();re(0),o(1,"button",170),u("click",function(){m(e);let i=g(3);return f(i.onItemAction("share"))}),h(2,"img",171),o(3,"span"),c(4,"\uACF5\uC720"),a()(),o(5,"button",170),u("click",function(){m(e);let i=g(3);return f(i.onItemAction("rename"))}),h(6,"img",172),o(7,"span"),c(8,"\uC774\uB984 \uBCC0\uACBD"),a()(),o(9,"button",170),u("click",function(){m(e);let i=g(3);return f(i.onItemAction("move"))}),h(10,"img",173),o(11,"span"),c(12,"\uD30C\uC77C \uC774\uB3D9"),a()(),o(13,"button",174),u("click",function(){m(e);let i=g(3);return f(i.onItemAction("delete"))}),h(14,"img",175),o(15,"span"),c(16,"\uC0AD\uC81C"),a()(),ae()}}function Ul(r,t){if(r&1){let e=y();re(0),o(1,"button",170),u("click",function(){m(e);let i=g(3);return f(i.onItemAction("rename"))}),h(2,"img",172),o(3,"span"),c(4,"\uC774\uB984 \uBCC0\uACBD"),a()(),o(5,"button",174),u("click",function(){m(e);let i=g(3);return f(i.onItemAction("delete"))}),h(6,"img",175),o(7,"span"),c(8,"\uC0AD\uC81C"),a()(),ae()}}function $l(r,t){if(r&1&&(o(0,"div",18)(1,"h3",19),c(2),a()(),o(3,"div",169),b(4,jl,17,0,"ng-container",2)(5,Ul,9,0,"ng-container",2),a()),r&2){let e=g(2);l(2),x(e.selectedItem.name),l(2),p("ngIf",e.selectedItem.type==="pdf"),l(),p("ngIf",e.selectedItem.type==="folder")}}function Hl(r,t){if(r&1&&(o(0,"div",17),b(1,Nl,16,2,"ng-container",157)(2,$l,6,3,"ng-template",null,1,$t),a()),r&2){let e=Ut(3),n=g();l(),p("ngIf",n.isRenameMode)("ngIfElse",e)}}function Wl(r,t){r&1&&h(0,"img",176)}function Kl(r,t){r&1&&h(0,"img",177)}function Gl(r,t){if(r&1&&(o(0,"p",178),c(1),a()),r&2){let e=g();l(),x(e.decryptError)}}function Yl(r,t){r&1&&h(0,"img",198)}function ql(r,t){r&1&&h(0,"div",199)}function Xl(r,t){r&1&&h(0,"img",200)}function Jl(r,t){r&1&&h(0,"img",201)}function Zl(r,t){if(r&1&&(o(0,"span",202),c(1),L(2,"date"),a()),r&2){let e=g().$implicit;l(),ue("",me(2,2,e.updatedAt,"yyyy.MM.dd HH:mm")," ",e.fileCount||0," MB")}}function Ql(r,t){if(r&1&&(o(0,"span",202),c(1),a()),r&2){let e=g().$implicit;l(),S("\uD30C\uC77C ",e.fileCount||0,"\uAC1C")}}function ec(r,t){if(r&1){let e=y();o(0,"div",188),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.onSelectMoveFolder(i.id))}),o(1,"div",189),b(2,Yl,1,0,"img",190)(3,ql,1,0,"div",191),a(),o(4,"div",192),b(5,Xl,1,0,"img",193)(6,Jl,1,0,"img",194),a(),o(7,"div",195)(8,"span",196),c(9),a(),b(10,Zl,3,5,"span",197)(11,Ql,2,1,"span",197),a()()}if(r&2){let e=t.$implicit,n=g(2);k("selected",n.selectedMoveTargetFolderId===e.id),l(2),p("ngIf",n.selectedMoveTargetFolderId===e.id),l(),p("ngIf",n.selectedMoveTargetFolderId!==e.id),l(2),p("ngIf",e.id==="__home__"),l(),p("ngIf",e.id!=="__home__"),l(3),x(e.name),l(),p("ngIf",e.id!=="__home__"),l(),p("ngIf",e.id==="__home__")}}function tc(r,t){r&1&&(o(0,"div",203)(1,"p"),c(2,"\uC774\uB3D9 \uAC00\uB2A5\uD55C \uD3F4\uB354\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),a()())}function nc(r,t){if(r&1){let e=y();o(0,"div",179)(1,"div",180)(2,"button",38),u("click",function(){m(e);let i=g();return f(i.closeFileMoveSheet())}),h(3,"img",160),a(),o(4,"h3",181),c(5,"\uD30C\uC77C \uC774\uB3D9"),a()(),o(6,"div",182),b(7,ec,12,9,"div",183)(8,tc,3,0,"div",184),a(),o(9,"div",185)(10,"span",186),c(11),a(),o(12,"button",187),u("click",function(){m(e);let i=g();return f(i.onFileMoveConfirm())}),c(13," \uC774\uB3D9\uD558\uAE30 "),a()()()}if(r&2){let e=g();l(7),p("ngForOf",e.availableFolders),l(),p("ngIf",e.availableFolders.length===0),l(3),S("\uC120\uD0DD\uB41C \uD30C\uC77C ",e.selectedFilesForMove.length,"\uAC1C"),l(),p("disabled",!e.selectedMoveTargetFolderId)}}function ic(r,t){if(r&1&&h(0,"ez-reader-mobile-bottom-nav",141),r&2){let e=g();p("activeTab",e.currentActiveTab)}}var cn=class r{currentActiveTab="files";sheetState="collapsed";selectedItems=new Set;isSelectionMode=!1;isAuthenticated=!1;userPoints=2450;userProfile=null;isSideMenuOpen=!1;authSubscription;userProfileSubscription;authService=P(Ce);pendingAction=null;pendingActionSubscription;slideDirection="left";currentFolder=null;currentFolderName="";recentFilesCount=0;favoritesCount=0;resultsCount=0;rootDocumentsCount=0;showFolderDialog=!1;folderDialogTitle="\uD3F4\uB354 \uB9CC\uB4E4\uAE30";folderDialogInitialValue="";editingFolderId=null;isMyFilesFromRoot=!1;itemSheetState="collapsed";selectedItem=null;decryptSheetState="collapsed";decryptPassword="";showDecryptPassword=!1;decryptError="";pendingDecryptDocument=null;thumbnailOrientations={};fileMoveSheetState="collapsed";availableFolders=[];selectedMoveTargetFolderId=null;selectedFilesForMove=[];FILE_ITEM_HEIGHT=72;isDataLoading=!1;shimmerStartTime=0;MIN_SHIMMER_DURATION=500;loadingDocIds=new Set;isLoadingThumbnail(t){return this.loadingDocIds.has(t)}isUploading=!1;uploadProgress=0;uploadingFileName="";uploadQueue={current:0,total:0};MAX_FILE_SIZE=100*1024*1024;WARNING_FILE_SIZE=30*1024*1024;sortSheetState="collapsed";sortCriteria="date";sortOrder="desc";loadingService=P(Ct);isDestroyed=!1;folders=[];documents=[];childFolders=[];activeFileMenuId=null;isRenameMode=!1;renameInputValue="";renameTarget=null;get items(){if(this.currentFolder){if(this.currentFolder==="my-files"){let n=this.isMyFilesFromRoot?[]:[{id:"recent-files",name:"\uCD5C\uADFC \uBCF8 \uD30C\uC77C",type:"folder",date:null,fileCount:this.recentFilesCount,isSpecialFolder:!0,folderType:"recent-files"},{id:"favorites",name:"\uC990\uACA8\uCC3E\uAE30",type:"folder",date:null,fileCount:this.favoritesCount,isSpecialFolder:!0,folderType:"favorites"}],i=this.folders.map(d=>{let _=this.getFolderLastModifiedDate(d);return{id:d.id,name:d.name,type:"folder",date:_,createdAt:this.safeParseDate(d.createdAt),updatedAt:this.safeParseDate(d.updatedAt),fileCount:d.fileCount||0,folderType:"normal"}}),s=this.documents.map(d=>({id:d.id,name:d.fileName||d.title,type:"pdf",date:this.getDocumentLastModifiedDate(d),size:d.fileSize||0,isFavorite:d.isFavorite,documentType:d.documentType,thumbnail:d.thumbnail,isEncrypted:d.isEncrypted}));return[...n,...i,...s]}if(this.currentFolder==="recent-files")return this.documents.map(n=>({id:n.id,name:n.fileName||n.title,type:"pdf",date:this.getDocumentLastModifiedDate(n),size:0,isFavorite:n.isFavorite,documentType:n.documentType,thumbnail:n.thumbnail,isEncrypted:n.isEncrypted}));if(this.currentFolder==="favorites")return this.documents.map(n=>({id:n.id,name:n.fileName||n.title,type:"pdf",date:this.getDocumentLastModifiedDate(n),size:0,isFavorite:n.isFavorite,documentType:n.documentType,thumbnail:n.thumbnail,isEncrypted:n.isEncrypted}));if(this.currentFolder==="results")return this.documents.map(n=>({id:n.id,name:n.fileName||n.title,type:"pdf",date:this.getDocumentLastModifiedDate(n),size:0,isFavorite:n.isFavorite,documentType:n.documentType,thumbnail:n.thumbnail,isEncrypted:n.isEncrypted}));let t=this.childFolders.map(n=>({id:n.id,name:n.name,type:"folder",date:this.getFolderLastModifiedDate(n),fileCount:n.fileCount||0,folderType:"normal",isSpecialFolder:!1})),e=this.documents.map(n=>({id:n.id,name:n.fileName||n.title,type:"pdf",date:this.getDocumentLastModifiedDate(n),size:n.fileSize||0,isFavorite:n.isFavorite,documentType:n.documentType,thumbnail:n.thumbnail,isEncrypted:n.isEncrypted}));return[...t,...e]}else{let t={id:"my-files",name:this.i18n.translate("files.myFiles"),type:"folder",date:null,fileCount:this.folders.length+this.rootDocumentsCount,isSpecialFolder:!0,folderType:"my-files"},e={id:"recent-files",name:this.i18n.translate("files.recentFiles"),type:"folder",date:null,fileCount:this.recentFilesCount,isSpecialFolder:!0,folderType:"recent-files"},n={id:"favorites",name:this.i18n.translate("files.favorites"),type:"folder",date:null,fileCount:this.favoritesCount,isSpecialFolder:!0,folderType:"favorites"},i={id:"results",name:this.i18n.translate("files.results"),type:"folder",date:null,fileCount:this.resultsCount,isSpecialFolder:!0,folderType:"results"};return[t,e,n,i]}}router=P(N);route=P(et);snackbar=P(G);indexedDbService=P(ee);cdr=P(fe);toolActionService=P(le);reversePdfConverter=P(_t);pdfFormatConverter=P(Bn);i18n=P(nt);filePicker=P(je);pdfjsLibService=P(Me);pdfPasswordService=P(Ke);homeDataCache=P(Xt);onLoginClick(){this.authService.startGoogleLogin()}navigateToSearch(){this.router.navigate(["/ezm/search"])}getAvatarText(){return this.userProfile?(this.userProfile.name||this.userProfile.email||"").charAt(0).toUpperCase():""}onMenuClick(){this.isSideMenuOpen=!0}onSideMenuClose(){this.isSideMenuOpen=!1}ngOnInit(){window.scrollTo(0,0),this.router.url.includes("/favorites")?this.currentActiveTab="favorites":this.currentActiveTab="files",this.authSubscription=this.authService.isAuthenticated$.subscribe(i=>this.isAuthenticated=i),this.userProfileSubscription=this.authService.userProfile$.subscribe(i=>this.userProfile=i),this.pendingActionSubscription=this.toolActionService.pendingAction$.subscribe(i=>{this.pendingAction=i,i?.action==="merge-pdf"&&(this.isSelectionMode=!0,this.selectedItems.clear()),i?.action==="open-pdf"&&(this.isSelectionMode=!0,this.selectedItems.clear()),i?.action==="convert-to-pdf"&&(this.isSelectionMode=!0,this.selectedItems.clear()),this.cdr.detectChanges()});let n=this.router.getCurrentNavigation()?.extras?.state||history.state;n&&n.selectMode==="merge"&&n.currentDocument&&(this.pendingAction={toolId:"merge-additional",toolLabel:"PDF \uBCD1\uD569 - \uCD94\uAC00 \uD30C\uC77C \uC120\uD0DD",action:"merge-additional",requiresFileSelection:!0,data:{currentDocument:n.currentDocument}}),this.route.params.subscribe(i=>C(this,null,function*(){let s=i.folderId;if(!s){let d=this.restoreFolderState();if(d){this.router.navigate(["/ezm/myfiles",d],{replaceUrl:!0});return}}s?yield this.loadFolderById(s):this.loadFolders()}))}loadFolders(t=!0){return C(this,null,function*(){try{this.folders=yield this.indexedDbService.getFolders(null),this.childFolders=[],this.currentFolder==="my-files"?yield this.loadRootDocuments(t):this.documents=[];for(let d of this.folders){let _=yield this.indexedDbService.getFolderDocumentCount(d.id);d.fileCount=_}let e=yield this.indexedDbService.getRecentFileEntries(30);this.recentFilesCount=e.length;let n=yield this.indexedDbService.getFavoriteDocuments();this.favoritesCount=n.length;let i=yield this.indexedDbService.getResultDocuments();this.resultsCount=i.length;let s=yield this.indexedDbService.getFolderContentsMetadataOnly(null);this.rootDocumentsCount=s.length,this.cdr.detectChanges()}catch{this.snackbar.showError("\uD3F4\uB354 \uBAA9\uB85D\uC744 \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}loadFolderById(t){return C(this,null,function*(){try{if(t==="my-files"){this.currentFolder="my-files",this.currentFolderName="\uD30C\uC77C";let n=history.state;this.isMyFilesFromRoot=n?.fromRoot===!0,yield this.loadFolders();return}if(t==="recent-files"){this.currentFolder="recent-files",this.currentFolderName="\uCD5C\uADFC \uBCF8 \uD30C\uC77C",this.childFolders=[],yield this.loadRecentFiles();return}if(t==="favorites"){this.currentFolder="favorites",this.currentFolderName="\uC990\uACA8\uCC3E\uAE30",this.childFolders=[],yield this.loadFavoriteFiles();return}if(t==="results"){this.currentFolder="results",this.currentFolderName="\uB0B4 \uC791\uC5C5 \uD30C\uC77C",this.childFolders=[],yield this.loadResultFiles(),this.cdr.detectChanges();return}let e=yield this.indexedDbService.getFolderById(t);if(!e){this.snackbar.showError("\uD3F4\uB354\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.router.navigate(["/ezm"]);return}this.currentFolder=e.id,this.currentFolderName=e.name,yield this.loadChildFolders(t),yield this.loadFolderContents(t)}catch{this.snackbar.showError("\uD3F4\uB354\uB97C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.router.navigate(["/ezm"])}})}startShimmer(){this.shimmerStartTime=Date.now(),this.isDataLoading=!0}hideShimmer(){return C(this,null,function*(){let t=Date.now()-this.shimmerStartTime,e=this.MIN_SHIMMER_DURATION-t;e>0&&(yield new Promise(n=>setTimeout(n,e))),this.isDataLoading=!1})}saveCurrentFolderState(){this.currentFolder&&(sessionStorage.setItem("ezm_current_folder",this.currentFolder),sessionStorage.setItem("ezm_folder_name",this.currentFolderName||""),console.log("[saveCurrentFolderState] Saved:",this.currentFolder))}restoreFolderState(){let t=sessionStorage.getItem("ezm_current_folder");return t?(console.log("[restoreFolderState] Restoring:",t),sessionStorage.removeItem("ezm_current_folder"),sessionStorage.removeItem("ezm_folder_name"),t):null}loadFolderContents(t,e=!0){return C(this,null,function*(){try{e&&this.startShimmer(),this.documents=yield this.indexedDbService.getFolderContentsMetadataOnly(t),e&&(yield this.hideShimmer()),this.applySorting(),this.cdr.detectChanges(),this.generateMissingThumbnailsOptimized()}catch{this.isDataLoading=!1,this.snackbar.showError("\uD3F4\uB354 \uB0B4\uC6A9\uC744 \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}loadChildFolders(t){return C(this,null,function*(){try{this.childFolders=yield this.indexedDbService.getFolders(t);for(let e of this.childFolders){let n=yield this.indexedDbService.getFolderDocumentCount(e.id);e.fileCount=n}}catch{this.childFolders=[]}})}loadRootDocuments(t=!0){return C(this,null,function*(){try{t&&this.startShimmer(),this.documents=yield this.indexedDbService.getFolderContentsMetadataOnly(null),t&&(yield this.hideShimmer()),this.applySorting(),this.cdr.detectChanges(),this.generateMissingThumbnailsOptimized()}catch{this.isDataLoading=!1,this.documents=[]}})}loadRecentFiles(t=!0){return C(this,null,function*(){try{t&&this.startShimmer();let e=yield this.indexedDbService.getRecentFileEntries(30),n=[];for(let i of e){let s=yield this.indexedDbService.getDocumentMetadataById(i.documentId);s&&n.push(s)}this.documents=n,t&&(yield this.hideShimmer()),this.applySorting(),this.cdr.detectChanges(),this.generateMissingThumbnailsOptimized()}catch{this.isDataLoading=!1,this.snackbar.showError("\uCD5C\uADFC \uD30C\uC77C\uC744 \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}loadFavoriteFiles(t=!0){return C(this,null,function*(){console.log("\u{1F516} [MyFiles] loadFavoriteFiles \uD638\uCD9C\uB428");try{t&&(this.startShimmer(),console.log("\u{1F516} [MyFiles] shimmer \uC2DC\uC791, IndexedDB \uC870\uD68C \uC2DC\uC791...")),this.documents=yield this.indexedDbService.getFavoriteDocuments(),console.log("\u2705 [MyFiles] \uC990\uACA8\uCC3E\uAE30 \uBB38\uC11C \uC870\uD68C \uC644\uB8CC:",this.documents.length,"\uAC1C"),console.log("\u{1F516} [MyFiles] \uBB38\uC11C \uBAA9\uB85D:",this.documents.map(e=>({id:e.id,title:e.title,isFavorite:e.isFavorite}))),t&&(yield this.hideShimmer()),this.applySorting(),this.cdr.detectChanges(),this.generateMissingThumbnailsOptimized(),console.log("\u2705 [MyFiles] loadFavoriteFiles \uC644\uB8CC")}catch(e){console.error("\u274C [MyFiles] loadFavoriteFiles \uC5D0\uB7EC:",e),console.error("\u274C [MyFiles] \uC5D0\uB7EC \uC0C1\uC138:",JSON.stringify(e,null,2)),this.isDataLoading=!1,this.snackbar.showError("\uC990\uACA8\uCC3E\uAE30 \uD30C\uC77C\uC744 \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}loadResultFiles(t=!0){return C(this,null,function*(){try{t&&this.startShimmer(),this.documents=yield this.indexedDbService.getResultDocuments(),t&&(yield this.hideShimmer()),this.applySorting(),this.cdr.detectChanges(),this.generateMissingThumbnailsOptimized()}catch{this.isDataLoading=!1,this.snackbar.showError("\uACB0\uACFC\uBB3C \uD30C\uC77C\uC744 \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}formatFileSize(t){return t<1024?t+" B":t<1024*1024?(t/1024).toFixed(2)+" KB":(t/(1024*1024)).toFixed(2)+" MB"}trackByItemId(t,e){return e.id}safeParseDate(t){if(!t)return null;let e=new Date(t);return isNaN(e.getTime())?null:e}getDocumentLastModifiedDate(t){return this.safeParseDate(t.updatedAt)||this.safeParseDate(t.createdAt)||new Date}getFolderLastModifiedDate(t){return this.safeParseDate(t.updatedAt)||this.safeParseDate(t.createdAt)}isRestrictedSystemFolder(t){return t==="favorites"||t==="results"||t==="recent-files"}isFolderListingContext(){return!this.currentFolder||this.currentFolder==="my-files"}getActiveFolderId(){return!this.currentFolder||this.currentFolder==="my-files"?null:this.currentFolder==="results"?"results":this.isRestrictedSystemFolder(this.currentFolder)?null:this.currentFolder}toggleFileMenu(t){this.activeFileMenuId=this.activeFileMenuId===t?null:t}closeFileMenu(){this.activeFileMenuId&&(this.activeFileMenuId=null)}resetRenameState(){this.isRenameMode=!1,this.renameInputValue="",this.renameTarget=null}openRenameSheet(t){this.isRenameMode=!0,this.renameTarget=t,this.renameInputValue=t.name,this.selectedItem=t,this.itemSheetState="full"}cancelRenameFromSheet(){this.resetRenameState(),this.selectedItem=null,this.itemSheetState="collapsed"}confirmRenameFromSheet(){return C(this,null,function*(){if(!this.renameTarget)return;let t=this.renameInputValue.trim();if(!t){this.snackbar.showWarning("\uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694.");return}try{this.renameTarget.type==="folder"?(yield this.indexedDbService.updateFolder(this.renameTarget.id,t),this.snackbar.showSuccess("\uD3F4\uB354 \uC774\uB984\uC774 \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")):(yield this.renamePdfDocument(this.renameTarget,t),this.snackbar.showSuccess("\uD30C\uC77C \uC774\uB984\uC774 \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")),yield this.refreshCurrentView(),this.cancelRenameFromSheet()}catch{this.snackbar.showError("\uC774\uB984\uC744 \uBCC0\uACBD\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}onFabFilesAdded(t){return C(this,null,function*(){console.log("[onFabFilesAdded] documents:",t.length,"currentFolder:",this.currentFolder);let e=t.map(n=>n.id).filter(n=>n);e.length>0&&(this.loadingDocIds=new Set([...this.loadingDocIds,...e]),console.log("[onFabFilesAdded] loadingDocIds \uCD94\uAC00:",e)),yield this.refreshCurrentView(!1),this.cdr.detectChanges(),console.log("[onFabFilesAdded] Refresh complete")})}onAddClick(){if(this.pendingAction){this.importPdfFile();return}this.sheetState="full"}toggleSelectionMode(){if(this.items.length===0){this.snackbar.showWarning("\uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.isSelectionMode=!this.isSelectionMode,this.isSelectionMode||this.selectedItems.clear()}selectAll(){this.isSelectionMode&&(this.selectedItems.clear(),this.items.forEach(t=>{this.canSelectItem(t)&&this.selectedItems.add(t.id)}))}deselectAll(){this.selectedItems.clear()}isAllSelected(){if(!this.isSelectionMode||this.items.length===0)return!1;let t=this.items.filter(e=>this.canSelectItem(e));return t.length===0?!1:t.every(e=>this.selectedItems.has(e.id))}toggleItemSelection(t){this.isSelectionMode&&this.canSelectItem(t)&&(this.selectedItems.has(t.id)?this.selectedItems.delete(t.id):this.selectedItems.add(t.id))}isItemSelected(t){return this.selectedItems.has(t)}canSelectItem(t){if(!this.isSelectionMode||t.isSpecialFolder)return!1;if(this.pendingAction){if(this.pendingAction.action==="open-pdf"||this.pendingAction.action==="merge-pdf")return t.type==="pdf";if(this.pendingAction.action==="convert-to-pdf"){let e=this.pendingAction.data?.sourceFileType;return e&&t.type==="pdf"?t.documentType===e:!1}return this.isFolderListingContext()?t.type==="folder":t.type==="pdf"}return t.type==="pdf"}isItemDisabled(t){if(t.isSpecialFolder)return!1;if(this.pendingAction?.action==="convert-to-pdf"){if(t.type==="folder")return!1;let e=this.pendingAction.data?.sourceFileType;return t.documentType!==e}return this.pendingAction?.action==="convert-pdf"?t.type==="folder"?!1:!(!t.documentType||t.documentType==="viewer"||t.documentType==="editor"||t.documentType==="converted"):!1}onItemClick(t){if(this.closeFileMenu(),this.isSelectionMode&&(this.pendingAction?.action==="merge-pdf"||!this.pendingAction)){if(t.type==="folder"){this.openFolder(t);return}this.toggleItemSelection(t);return}if(this.pendingAction&&this.pendingAction.requiresFileSelection){if(this.pendingAction.action==="convert-to-pdf"&&t.type==="folder"){this.openFolder(t);return}if(this.pendingAction.action==="convert-to-pdf"&&t.type==="pdf"){let e=this.pendingAction.data?.sourceFileType;if(t.documentType===e){this.handlePendingAction(t);return}}if(this.pendingAction.action!=="merge-pdf"&&t.type==="pdf"){this.handlePendingAction(t);return}if(this.pendingAction.action==="merge-pdf"&&t.type==="folder"){this.openFolder(t);return}}t.type==="folder"?this.openFolder(t):t.type==="pdf"&&this.openPdf(t)}handlePendingAction(t){return C(this,null,function*(){if(this.pendingAction)try{let e=yield this.indexedDbService.getDocumentById(t.id);if(!e){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if(e.isEncrypted&&this.pendingAction.action!=="decrypt-pdf"){let n=yield this.pdfPasswordService.verifyPassword(e);if(n.cancelled)return;if(!n.success){n.error&&this.snackbar.showError(n.error);return}n.decryptedBase64&&(e=Z(K({},e),{pdfBase64:n.decryptedBase64,isEncrypted:!1}))}if(this.pendingAction.action==="open-pdf"){let i=(e.fileName||e.title||"").toLowerCase().split(".").pop();if(i!=="pdf"){["jpg","jpeg","png","gif","bmp","webp"].includes(i||"")?this.snackbar.showError("\uC774\uBBF8\uC9C0 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["xlsx","xls","csv"].includes(i||"")?this.snackbar.showError("\uC5D1\uC140 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["docx","doc"].includes(i||"")?this.snackbar.showError("\uC6CC\uB4DC \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["pptx","ppt"].includes(i||"")?this.snackbar.showError("\uD30C\uC6CC\uD3EC\uC778\uD2B8 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):this.snackbar.showError("PDF \uD30C\uC77C\uB9CC \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC788\uC2B5\uB2C8\uB2E4."),this.toolActionService.clearPendingAction();return}this.router.navigate(["/ezm/viewer"],{state:{document:e,mode:"viewer"}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="ai-summary"){this.router.navigate(["/ezm/ai-summary"],{state:{document:e}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="ai-translate"){this.router.navigate(["/ezm/ai-translate"],{state:{document:e}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="convert-pdf"){yield this.convertPdfToFormat(e,this.pendingAction.toolId),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="convert-to-pdf"){let n=this.pendingAction.data?.sourceFileType;if(e.documentType!==n){this.snackbar.showError(`${n} \uD30C\uC77C\uB9CC \uC120\uD0DD\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.`);return}if(!e.originalFileData||!e.mimeType){this.snackbar.showError("\uC6D0\uBCF8 \uD30C\uC77C \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}yield this.convertFileToPdf(e,this.pendingAction.data?.convertType),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="rotate-pdf"){this.router.navigate(["/ezm/rotate"],{state:{document:e}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="split-pdf"){this.router.navigate(["/ezm/split"],{state:{document:e}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="encrypt-pdf"){this.router.navigate(["/ezm/encrypt"],{state:{document:e}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="decrypt-pdf"){this.router.navigate(["/ezm/decrypt"],{state:{document:e}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="edit"){let i=(e.fileName||e.title||"").toLowerCase().split(".").pop();if(i!=="pdf"){["jpg","jpeg","png","gif","bmp","webp"].includes(i||"")?this.snackbar.showError("\uC774\uBBF8\uC9C0 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["xlsx","xls","csv"].includes(i||"")?this.snackbar.showError("\uC5D1\uC140 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["docx","doc"].includes(i||"")?this.snackbar.showError("\uC6CC\uB4DC \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["pptx","ppt"].includes(i||"")?this.snackbar.showError("\uD30C\uC6CC\uD3EC\uC778\uD2B8 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):this.snackbar.showError("PDF \uD30C\uC77C\uB9CC \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC788\uC2B5\uB2C8\uB2E4."),this.toolActionService.clearPendingAction();return}this.router.navigate(["/ezm/viewer"],{state:{document:e,mode:"convert"}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="organize-pdf"){this.router.navigate(["/ezm/organize"],{state:{document:e}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="add-page-numbers"){this.router.navigate(["/ezm/page-number"],{state:{docData:e}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="add-watermark"){this.router.navigate(["/ezm/watermark"],{state:{docData:e}}),this.toolActionService.clearPendingAction();return}if(this.pendingAction.action==="merge-additional"){let n=this.pendingAction.data?.currentDocument;if(!n){this.snackbar.showError("\uC6D0\uBCF8 \uBB38\uC11C \uC815\uBCF4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.router.navigate(["/ezm/organize"],{state:{document:n,additionalDocument:e}}),this.pendingAction=null;return}}catch{this.snackbar.showError("\uC791\uC5C5\uC744 \uC218\uD589\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}onCancelPendingAction(){this.toolActionService.clearPendingAction(),this.isSelectionMode=!1,this.selectedItems.clear(),this.snackbar.showInfo("\uCDE8\uC18C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.router.navigate(["/ezm/tools"])}onMoreClick(t,e){e.stopPropagation(),this.resetRenameState(),!(this.pendingAction&&this.pendingAction.action==="merge-additional")&&(this.selectedItem=t,this.itemSheetState="full")}onItemSheetClose(){this.itemSheetState="collapsed",this.resetRenameState(),this.selectedItem=null}onFileMenuAction(t,e,n){return C(this,null,function*(){if(n.stopPropagation(),e.type==="pdf")switch(this.closeFileMenu(),t){case"share":yield this.sharePdfFile(e);break;case"rename":this.openRenameSheet(e);return;case"duplicate":yield this.duplicatePdfFile(e);break;case"delete":yield this.deletePdfFile(e);break}})}onItemAction(t){return C(this,null,function*(){if(!this.selectedItem)return;let e=this.selectedItem;if(t==="rename"){this.openRenameSheet(e);return}if(t==="share"){this.itemSheetState="collapsed",this.selectedItem=null,yield this.sharePdfFile(e);return}if(t==="duplicate"){this.itemSheetState="collapsed",this.selectedItem=null,yield this.duplicatePdfFile(e);return}if(t==="move"){this.itemSheetState="collapsed",yield this.openFileMoveSheet(e);return}if(this.itemSheetState="collapsed",this.selectedItem=null,e.type==="pdf"&&t==="open"){try{let n=yield this.indexedDbService.getDocumentById(e.id);if(!n){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let s=(n.fileName||n.title||"").toLowerCase().split(".").pop();if(s!=="pdf"){["jpg","jpeg","png","gif","bmp","webp"].includes(s||"")?this.snackbar.showError("\uC774\uBBF8\uC9C0 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["xlsx","xls","csv"].includes(s||"")?this.snackbar.showError("\uC5D1\uC140 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["docx","doc"].includes(s||"")?this.snackbar.showError("\uC6CC\uB4DC \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):["pptx","ppt"].includes(s||"")?this.snackbar.showError("\uD30C\uC6CC\uD3EC\uC778\uD2B8 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):this.snackbar.showError("PDF \uD30C\uC77C\uB9CC \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC788\uC2B5\uB2C8\uB2E4.");return}this.router.navigate(["/ezm/viewer"],{state:{document:n,mode:"editor"}})}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}return}if(t==="delete")if(e.type==="folder")yield this.deleteSingleFolder(e);else{if(!(yield xe(`"${e.name}" \uD30C\uC77C\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`)))return;try{yield this.indexedDbService.deleteDocument(e.id);let i=this.documents.findIndex(s=>s.id===e.id);i!==-1&&(this.documents.splice(i,1),this.cdr.detectChanges()),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.currentFolder?yield this.loadFolderContents(this.currentFolder):yield this.loadFolders()}catch{this.snackbar.showError("\uD30C\uC77C \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}}})}deleteSingleFolder(t){return C(this,null,function*(){if(yield xe(`"${t.name}" \uD3F4\uB354\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?
(\uD3F4\uB354 \uB0B4 \uD30C\uC77C\uC740 \uB8E8\uD2B8\uB85C \uC774\uB3D9\uB429\uB2C8\uB2E4)`))try{yield this.indexedDbService.deleteFolder(t.id),this.snackbar.showSuccess("\uD3F4\uB354\uAC00 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),yield this.loadFolders()}catch{this.snackbar.showError("\uD3F4\uB354 \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}openFolder(t){this.slideDirection="left";let e=t.id==="my-files"&&!this.currentFolder?{state:{fromRoot:!0}}:{};this.router.navigate(["/ezm/myfiles",t.id],e)}openPdf(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t.id);if(!e){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if(e.isEncrypted){let s=yield this.pdfPasswordService.verifyPassword(e);if(s.cancelled)return;if(!s.success){s.error&&this.snackbar.showError(s.error);return}let d=K({},e);s.decryptedBase64&&(d.pdfBase64=s.decryptedBase64,d.isEncrypted=!1),this.router.navigate(["/ezm/viewer"],{state:{document:d,mode:"viewer"}});return}let i=(e.fileName||e.title||"").toLowerCase().split(".").pop();if(i&&["jpg","jpeg","png","gif","bmp","webp"].includes(i)){this.snackbar.showError("\uC774\uBBF8\uC9C0 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}else if(i&&["xlsx","xls","csv"].includes(i)){this.snackbar.showError("\uC5D1\uC140 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}else if(i&&["docx","doc"].includes(i)){this.snackbar.showError("\uC6CC\uB4DC \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}else if(i&&["pptx","ppt"].includes(i)){this.snackbar.showError("\uD30C\uC6CC\uD3EC\uC778\uD2B8 \uD30C\uC77C\uC740 \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}else if(i!=="pdf"){this.snackbar.showError("PDF \uD30C\uC77C\uB9CC \uBDF0\uC5B4\uC5D0\uC11C \uC5F4 \uC218 \uC788\uC2B5\uB2C8\uB2E4.");return}this.router.navigate(["/ezm/viewer"],{queryParams:{docId:e.id}})}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}goBack(){if(this.pendingAction){this.toolActionService.clearPendingAction(),this.router.navigate(["/ezm/tools"]);return}if(this.isSelectionMode=!1,this.selectedItems.clear(),this.slideDirection="right",this.currentFolder==="recent-files"||this.currentFolder==="favorites"||this.currentFolder==="results"){this.router.navigate(["/ezm/home"]);return}if(this.currentFolder==="my-files"||!this.currentFolder){this.router.navigate(["/ezm/home"]);return}this.indexedDbService.getFolderById(this.currentFolder).then(t=>{console.log("[goBack] folder:",t,"parentId:",t?.parentId),t&&t.parentId?this.router.navigate(["/ezm/myfiles",t.parentId]):this.router.navigate(["/ezm/home"])}).catch(t=>{console.error("[goBack] Error:",t),this.router.navigate(["/ezm/home"])})}toggleFavorite(t,e){return C(this,null,function*(){e.stopPropagation();try{if(yield this.indexedDbService.toggleFavorite(t.id),t.isFavorite=!t.isFavorite,this.currentFolder==="favorites")yield this.loadFavoriteFiles();else{let i=this.documents.find(s=>s.id===t.id);i&&(i.isFavorite=t.isFavorite)}let n=yield this.indexedDbService.getFavoriteDocuments();this.favoritesCount=n.length,this.snackbar.showSuccess(t.isFavorite?"\uC990\uACA8\uCC3E\uAE30\uC5D0 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.":"\uC990\uACA8\uCC3E\uAE30\uC5D0\uC11C \uC81C\uAC70\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.cdr.detectChanges()}catch{this.snackbar.showError("\uC990\uACA8\uCC3E\uAE30 \uBCC0\uACBD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}get shouldShowFab(){return!!(this.currentFolder==="my-files"||this.currentFolder==="results"||this.currentFolder&&!this.isRestrictedSystemFolder(this.currentFolder))}get canCreateFolderOption(){return!this.isRestrictedSystemFolder(this.currentFolder)}get canAddFileOption(){return this.currentFolder==="my-files"||this.currentFolder==="results"?!0:!!this.getActiveFolderId()}get isFirstDepth(){return!this.currentFolder||this.currentFolder==="favorites"}onDocumentClick(){this.closeFileMenu()}onWindowScroll(){this.closeFileMenu()}closeBottomSheet(){this.sheetState="collapsed"}onSheetStateChange(t){this.sheetState=t}onActionSelected(t){switch(this.sheetState="collapsed",t){case"folder":this.createFolder();break;case"image":this.uploadImage();break;case"file":this.uploadFile();break;case"gallery":this.uploadImage();break;case"create-pdf":this.createPdf();break}}onImportOptionSelected(t){switch(this.sheetState="collapsed",t){case"file":this.importPdfFile();break;case"gallery":this.importFromGallery();break;case"camera":this.importFromCamera();break}}getConvertTypeLabel(){let t=this.pendingAction?.data?.sourceFileType;return{image:"\uC774\uBBF8\uC9C0",excel:"\uC5D1\uC140",word:"\uC6CC\uB4DC",ppt:"\uD30C\uC6CC\uD3EC\uC778\uD2B8"}[t]||"\uBB38\uC11C"}onConvertImportSelected(t){this.sheetState="collapsed";let e=this.pendingAction?.data?.sourceFileType;switch(t){case"file":this.importConvertFile(e);break;case"gallery":e==="image"&&this.importFromGalleryForConvert();break;case"camera":e==="image"&&this.importFromCameraForConvert();break}}importConvertFile(t){return C(this,null,function*(){let e={image:"image/*",excel:".xlsx,.xls,.csv",word:".docx,.doc",ppt:".pptx,.ppt"},n=yield this.filePicker.pick({multiple:!0,accept:e[t]||"*/*",onFilesSelected:i=>C(this,null,function*(){let s=this.getConvertTypeLabel();this.snackbar.showInfo(`${i.length}\uAC1C ${s} \uD30C\uC77C \uAC00\uC838\uC624\uB294 \uC911...`);for(let d of i)yield this.saveOriginalFileForConvert(d,t);this.snackbar.showSuccess(`${i.length}\uAC1C \uD30C\uC77C\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),yield this.refreshCurrentView()}),onError:i=>{this.snackbar.showError(i||"\uD30C\uC77C \uAC00\uC838\uC624\uAE30\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})})}importFromGalleryForConvert(){return C(this,null,function*(){yield this.filePicker.pick({multiple:!0,accept:"image/*",onFilesSelected:t=>C(this,null,function*(){this.snackbar.showInfo(`${t.length}\uAC1C \uC774\uBBF8\uC9C0 \uAC00\uC838\uC624\uB294 \uC911...`);for(let e of t)yield this.saveOriginalFileForConvert(e,"image");this.snackbar.showSuccess(`${t.length}\uAC1C \uC774\uBBF8\uC9C0\uAC00 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),yield this.refreshCurrentView()}),onError:t=>{this.snackbar.showError(t||"\uC774\uBBF8\uC9C0 \uAC00\uC838\uC624\uAE30\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})})}importFromCameraForConvert(){return C(this,null,function*(){yield this.filePicker.pick({multiple:!1,accept:"image/*",source:"camera",capture:"environment",onFilesSelected:t=>C(this,null,function*(){this.snackbar.showInfo("\uC0AC\uC9C4 \uAC00\uC838\uC624\uB294 \uC911..."),yield this.saveOriginalFileForConvert(t[0],"image"),this.snackbar.showSuccess("\uC0AC\uC9C4\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),yield this.refreshCurrentView()}),onError:t=>{this.snackbar.showError(t||"\uC0AC\uC9C4 \uAC00\uC838\uC624\uAE30\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})})}getConvertFilePrefix(t){return{image:"\uC774\uBBF8\uC9C0\uBCC0\uD658",excel:"\uC5D1\uC140\uBCC0\uD658",word:"\uC6CC\uB4DC\uBCC0\uD658",ppt:"PPT\uBCC0\uD658"}[t]||"PDF\uBCC0\uD658"}saveOriginalFileForConvert(t,e){return C(this,null,function*(){let n=yield this.fileToBase64(t),s={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,title:t.name,fileName:t.name,pages:[],elementCount:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:"1.0",documentType:e,originalFileData:n,mimeType:t.type,fileSize:t.size,folderId:this.currentFolder&&this.currentFolder!=="my-files"?this.currentFolder:null};yield this.indexedDbService.saveDocument(s)})}convertImagesToPdfAndSave(t){return C(this,null,function*(){let e=yield this.reversePdfConverter.imageToPdf(t);if(!e)throw new Error("\uC774\uBBF8\uC9C0 \uBCC0\uD658 \uC2E4\uD328");let n=new Blob([e.buffer],{type:"application/pdf"}),i=t.length===1?t[0].name.replace(/\.[^.]+$/,".pdf"):`\uC774\uBBF8\uC9C0\uBCC0\uD658_${t.length}\uAC1C_${Date.now()}.pdf`,s=new File([n],i,{type:"application/pdf"});yield this.handleFileUpload(s)})}convertDocumentToPdfAndSave(t,e){return C(this,null,function*(){let n=null;switch(e){case"word":n=yield this.reversePdfConverter.wordToPdf(t);break;case"excel":n=yield this.reversePdfConverter.excelToPdf(t);break;case"ppt":n=yield this.reversePdfConverter.powerPointToPdf(t);break}if(!n)throw new Error("\uBB38\uC11C \uBCC0\uD658 \uC2E4\uD328");let i=new Blob([n.buffer],{type:"application/pdf"}),s=t.name.replace(/\.[^.]+$/,".pdf"),d=new File([i],s,{type:"application/pdf"});yield this.handleFileUpload(d)})}importPdfFile(){return C(this,null,function*(){console.log("[importPdfFile] Starting PDF file import"),this.saveCurrentFolderState();let t=yield this.filePicker.pick({multiple:!0,accept:je.getAcceptString("pdf"),onFilesSelected:e=>C(this,null,function*(){console.log("[importPdfFile] onFilesSelected called with",e.length,"files"),this.snackbar.showInfo(`${e.length}\uAC1C \uD30C\uC77C \uAC00\uC838\uC624\uB294 \uC911...`);for(let n of e)console.log("[importPdfFile] Processing file:",n.name,n.type,n.size),yield this.handleFileUpload(n);this.snackbar.showSuccess(`${e.length}\uAC1C \uD30C\uC77C\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),console.log("[importPdfFile] refreshCurrentView - currentFolder:",this.currentFolder),yield this.refreshCurrentView(),this.cdr.detectChanges(),console.log("[importPdfFile] Refresh complete")}),onError:e=>{console.error("[importPdfFile] Error:",e),this.snackbar.showError(e||"\uD30C\uC77C \uAC00\uC838\uC624\uAE30\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}});console.log("[importPdfFile] pick() result:",t)})}importFromGallery(){return C(this,null,function*(){this.saveCurrentFolderState(),yield this.filePicker.pick({multiple:!0,accept:"image/*",onFilesSelected:t=>C(this,null,function*(){this.snackbar.showInfo("\uC774\uBBF8\uC9C0\uB97C PDF\uB85C \uBCC0\uD658 \uC911...");let e=yield this.reversePdfConverter.imageToPdf(t);if(!e){this.snackbar.showError("\uC774\uBBF8\uC9C0 \uBCC0\uD658\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.");return}let n=new Blob([e.buffer],{type:"application/pdf"}),i=yield this.blobToBase64(n),s=t.length===1?t[0].name.replace(/\.[^/.]+$/,"")+".pdf":`\uC774\uBBF8\uC9C0_${t.length}\uC7A5_${Date.now()}.pdf`,d={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,title:s.replace(".pdf",""),fileName:s,pdfBase64:i,pages:[],elementCount:0,version:"1.0",folderId:this.getActiveFolderId()??null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:"converted",fileSize:n.size};yield this.indexedDbService.saveDocument(d),this.snackbar.showSuccess("\uC774\uBBF8\uC9C0\uAC00 PDF\uB85C \uBCC0\uD658\uB418\uC5B4 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),yield this.refreshCurrentView()}),onError:t=>{this.snackbar.showError(t||"\uAC24\uB7EC\uB9AC\uC5D0\uC11C \uAC00\uC838\uC624\uAE30\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})})}importFromCamera(){return C(this,null,function*(){this.saveCurrentFolderState(),yield this.filePicker.pick({multiple:!1,accept:"image/*",source:"camera",capture:"environment",onFilesSelected:t=>C(this,null,function*(){this.snackbar.showInfo("\uC0AC\uC9C4\uC744 PDF\uB85C \uBCC0\uD658 \uC911...");let e=yield this.reversePdfConverter.imageToPdf(t);if(!e){this.snackbar.showError("\uC0AC\uC9C4 \uBCC0\uD658\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.");return}let n=new Blob([e.buffer],{type:"application/pdf"}),i=yield this.blobToBase64(n),s=`\uC0AC\uC9C4_${new Date().toISOString().slice(0,10)}_${Date.now()}.pdf`,d={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,title:s.replace(".pdf",""),fileName:s,pdfBase64:i,pages:[],elementCount:0,version:"1.0",folderId:this.getActiveFolderId()??null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:"converted",fileSize:n.size};yield this.indexedDbService.saveDocument(d),this.snackbar.showSuccess("\uC0AC\uC9C4\uC774 PDF\uB85C \uBCC0\uD658\uB418\uC5B4 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),yield this.refreshCurrentView()}),onError:t=>{this.snackbar.showError(t||"\uCE74\uBA54\uB77C \uCD2C\uC601\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})})}createFolder(){this.folderDialogTitle="\uD3F4\uB354 \uB9CC\uB4E4\uAE30",this.folderDialogInitialValue="",this.editingFolderId=null,this.showFolderDialog=!0}onFolderDialogConfirm(t){return C(this,null,function*(){try{if(this.editingFolderId)yield this.indexedDbService.updateFolder(this.editingFolderId,t),this.snackbar.showSuccess("\uD3F4\uB354 \uC774\uB984\uC774 \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4.");else{let e=this.getActiveFolderId();yield this.indexedDbService.createFolder(t,e),this.snackbar.showSuccess(`"${t}" \uD3F4\uB354\uAC00 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),e&&(yield this.loadChildFolders(e))}this.isFolderListingContext()&&(yield this.loadFolders())}catch{this.snackbar.showError("\uD3F4\uB354 \uC791\uC5C5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onFolderDialogCancel(){this.showFolderDialog=!1,this.editingFolderId=null}uploadImage(){this.snackbar.showInfo("\uC0AC\uC9C4 \uC5C5\uB85C\uB4DC \uAE30\uB2A5\uC740 \uC900\uBE44 \uC911\uC785\uB2C8\uB2E4.")}uploadFile(){return C(this,null,function*(){if(this.isUploading){this.snackbar.showWarning("\uD30C\uC77C \uC5C5\uB85C\uB4DC\uAC00 \uC9C4\uD589 \uC911\uC785\uB2C8\uB2E4. \uC644\uB8CC \uD6C4 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.");return}yield this.filePicker.pick({multiple:!0,accept:je.getAcceptString("pdf"),onFilesSelected:t=>C(this,null,function*(){if(t.length===0){this.snackbar.showWarning("\uC120\uD0DD\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let e=[],n=[],i=[];for(let d of t)d.size>this.MAX_FILE_SIZE?n.push(`${d.name} (${this.formatFileSize(d.size)})`):(d.size>this.WARNING_FILE_SIZE&&i.push(d.name),e.push(d));if(n.length>0&&(this.snackbar.showError(`\uD30C\uC77C \uD06C\uAE30 \uCD08\uACFC (\uCD5C\uB300 100MB):
${n.join(", ")}`),e.length===0)||i.length>0&&!(yield xe(`\uB300\uC6A9\uB7C9 \uD30C\uC77C \uACBD\uACE0

\uB2E4\uC74C \uD30C\uC77C\uC740 \uD06C\uAE30\uAC00 \uCEE4\uC11C \uCC98\uB9AC \uC2DC\uAC04\uC774 \uC624\uB798 \uAC78\uB9B4 \uC218 \uC788\uC2B5\uB2C8\uB2E4:
${i.join(", ")}

\uACC4\uC18D\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`)))return;this.isUploading=!0,this.uploadQueue={current:0,total:e.length},this.cdr.detectChanges();let s=0;try{for(let d=0;d<e.length;d++){let _=e[d];this.uploadQueue.current=d+1,this.uploadingFileName=_.name,this.uploadProgress=0,this.cdr.detectChanges(),(yield this.handleFileUploadWithProgress(_))&&s++}s>0&&(this.snackbar.showSuccess(`${s}\uAC1C \uD30C\uC77C\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),yield this.refreshCurrentView())}finally{this.isUploading=!1,this.uploadProgress=0,this.uploadingFileName="",this.uploadQueue={current:0,total:0},this.cdr.detectChanges()}}),onError:t=>{this.isUploading=!1,this.snackbar.showError(t||"\uD30C\uC77C \uC5C5\uB85C\uB4DC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})})}handleFileUploadWithProgress(t){return C(this,null,function*(){try{this.uploadProgress=10,this.cdr.detectChanges();let e=yield this.handleFileUploadAndReturn(t);return this.uploadProgress=100,this.cdr.detectChanges(),e}catch(e){return console.error("[handleFileUploadWithProgress] Error:",e),this.snackbar.showError(`"${t.name}" \uC5C5\uB85C\uB4DC \uC2E4\uD328`),null}})}handleFileUpload(t){return C(this,null,function*(){console.log("[handleFileUpload] Called with file:",t.name),yield this.handleFileUploadAndReturn(t)})}handleFileUploadAndReturn(t){return C(this,null,function*(){console.log("[handleFileUploadAndReturn] Starting upload for:",t.name,"type:",t.type,"size:",t.size);try{let e=this.getActiveFolderId(),n=this.currentFolder==="my-files";if(console.log("[handleFileUploadAndReturn] targetFolderId:",e,"isMyFilesView:",n),!e&&!n)return console.warn("[handleFileUploadAndReturn] No target folder selected"),this.snackbar.showWarning("\uD30C\uC77C\uC744 \uCD94\uAC00\uD560 \uD3F4\uB354\uB97C \uBA3C\uC800 \uC120\uD0DD\uD558\uC138\uC694."),null;this.snackbar.showInfo(`"${t.name}" \uC5C5\uB85C\uB4DC \uC911...`);let i=t.name.split(".").pop()?.toLowerCase()||"",s=t.type==="application/pdf"||i==="pdf",d=t.type.startsWith("image/")||["jpg","jpeg","png","gif"].includes(i),_=["xlsx","xls"].includes(i),v=i==="docx",w=i==="pptx",M=yield this.fileToBase64(t),O="viewer";d?O="image":_?O="excel":v?O="word":w&&(O="ppt");let E={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,title:t.name.replace(/\.[^/.]+$/,""),fileName:t.name,pages:[],elementCount:0,version:"1.0",folderId:e??null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:O,fileSize:t.size};return s?E.pdfBase64=M:(E.originalFileData=M,E.mimeType=t.type),console.log("[handleFileUploadAndReturn] Saving document to IndexedDB:",E.id,E.fileName),yield this.indexedDbService.saveDocument(E),console.log("[handleFileUploadAndReturn] Document saved successfully"),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),E}catch(e){return console.error("[handleFileUploadAndReturn] Error uploading file:",e),this.snackbar.showError("\uD30C\uC77C \uC5C5\uB85C\uB4DC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),null}})}performMerge(t,e){return C(this,null,function*(){try{this.snackbar.showInfo("PDF \uBCD1\uD569 \uC911...");let n=this.createBlobUrl(t.pdfBase64||""),i=this.createBlobUrl(e.pdfBase64||""),s=window.PDFLib,d=yield s.PDFDocument.create(),v=yield(yield fetch(n)).arrayBuffer(),w=yield s.PDFDocument.load(v);(yield d.copyPages(w,Array.from({length:w.getPageCount()},(te,ie)=>ie))).forEach(te=>d.addPage(te));let E=yield(yield fetch(i)).arrayBuffer(),D=yield s.PDFDocument.load(E);(yield d.copyPages(D,Array.from({length:D.getPageCount()},(te,ie)=>ie))).forEach(te=>d.addPage(te));let I=yield d.save(),z=new Blob([I],{type:"application/pdf"}),A=yield this.blobToBase64(z),Y=this.getActiveFolderId(),Q={id:`merged-${Date.now()}`,title:`${t.title||t.fileName} + ${e.title||e.fileName}`,fileName:`\uBCD1\uD569_${t.fileName||t.title}_${e.fileName||e.title}.pdf`,pdfBase64:A,pages:[],elementCount:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:"1.0",documentType:"viewer",folderId:Y,pageCount:w.getPageCount()+D.getPageCount()};yield this.indexedDbService.saveDocument(Q),URL.revokeObjectURL(n),URL.revokeObjectURL(i),this.snackbar.showSuccess("PDF \uBCD1\uD569\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),Y?yield this.loadFolderContents(Y):yield this.loadFolders(),this.pendingAction=null}catch{this.snackbar.showError("PDF \uBCD1\uD569\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}createBlobUrl(t){let e=t;e.includes(",")&&(e=e.split(",")[1]);let n=atob(e),i=new Uint8Array(n.length);for(let d=0;d<n.length;d++)i[d]=n.charCodeAt(d);let s=new Blob([i],{type:"application/pdf"});return URL.createObjectURL(s)}blobToBase64(t){return new Promise((e,n)=>{let i=new FileReader;i.onloadend=()=>{let s=i.result.split(",")[1];e(s)},i.onerror=n,i.readAsDataURL(t)})}showImportButton(){return this.pendingAction?["open-pdf","convert-to-pdf","merge-pdf","split-pdf","encrypt-pdf","decrypt-pdf","rotate-pdf","organize-pdf","add-page-numbers","add-watermark","ai-summary","ai-translate","convert-pdf"].includes(this.pendingAction.action):!1}showGalleryOption(){if(!this.pendingAction)return!1;let t=this.pendingAction.action;return t==="open-pdf"?!1:t==="convert-to-pdf"?this.pendingAction.data?.sourceFileType==="image":!1}showCameraOption(){if(!this.pendingAction)return!1;let t=this.pendingAction.action;return t==="open-pdf"?!1:t==="convert-to-pdf"?this.pendingAction.data?.sourceFileType==="image":!1}getImportSheetTitle(){if(!this.pendingAction)return"\uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.";switch(this.pendingAction.action){case"open-pdf":return"PDF \uD30C\uC77C\uC744 \uC5F4\uC5B4\uBCF4\uC138\uC694.";case"convert-to-pdf":return`${this.getConvertTypeLabel()} \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.`;case"merge-pdf":return"PDF \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.";case"split-pdf":return"\uBD84\uD560\uD560 PDF \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.";case"encrypt-pdf":return"\uC554\uD638\uD654\uD560 PDF \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.";case"decrypt-pdf":return"\uC554\uD638 \uD574\uC81C\uD560 PDF \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.";case"rotate-pdf":return"\uD68C\uC804\uD560 PDF \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.";case"organize-pdf":return"\uAD6C\uC131\uD560 PDF \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.";case"add-page-numbers":return"\uD398\uC774\uC9C0 \uBC88\uD638\uB97C \uCD94\uAC00\uD560 PDF\uB97C \uAC00\uC838\uC624\uC138\uC694.";case"add-watermark":return"\uC6CC\uD130\uB9C8\uD06C\uB97C \uCD94\uAC00\uD560 PDF\uB97C \uAC00\uC838\uC624\uC138\uC694.";case"ai-summary":return"\uC694\uC57D\uD560 PDF \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.";case"ai-translate":return"\uBC88\uC5ED\uD560 PDF \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.";case"convert-pdf":return"\uBCC0\uD658\uD560 PDF \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694.";default:return"PDF \uD30C\uC77C\uC744 \uAC00\uC838\uC624\uC138\uC694."}}getAcceptTypes(){if(!this.pendingAction)return"*/*";switch(this.pendingAction.action){case"open-pdf":case"merge-pdf":return"application/pdf";case"convert-to-pdf":let e=this.pendingAction.data?.sourceFileType;return{image:"image/*",excel:".xlsx,.xls,.csv",word:".docx,.doc",ppt:".pptx,.ppt"}[e]||"*/*";default:return"*/*"}}onImportSelected(t){if(this.sheetState="collapsed",!this.pendingAction)return;switch(this.pendingAction.action){case"open-pdf":this.onImportOptionSelected(t);break;case"convert-to-pdf":this.onConvertImportSelected(t);break;case"merge-pdf":t==="file"&&this.importPdfFile();break;default:this.onImportOptionSelected(t);break}}canConfirmSelection(){if(!this.pendingAction)return!1;let t=this.pendingAction.action,e=this.selectedItems.size;switch(t){case"merge-pdf":return e>=2;default:return e>0}}getConfirmButtonLabel(){if(!this.pendingAction)return"\uACC4\uC18D\uD558\uAE30";switch(this.pendingAction.action){case"open-pdf":return"\uACC4\uC18D\uD558\uAE30";case"convert-to-pdf":return"\uBCC0\uD658\uD558\uAE30";case"merge-pdf":return"\uBCD1\uD569\uD558\uAE30";default:return"\uACC4\uC18D\uD558\uAE30"}}onConfirmSelection(){return C(this,null,function*(){if(!this.pendingAction)return;switch(this.pendingAction.action){case"open-pdf":yield this.onConfirmOpenSelection();break;case"convert-to-pdf":yield this.onConfirmConvertSelection();break;case"merge-pdf":yield this.onConfirmMergeSelection();break;default:yield this.navigateToFileSaved();break}})}navigateToFileSaved(t){return C(this,null,function*(){this.isSelectionMode=!1,this.selectedItems.clear(),this.toolActionService.clearPendingAction(),this.router.navigate(["/ezm/file-saved"],{state:{fileId:t?.fileId,fileIds:t?.fileIds||[],fileName:t?.fileName||"",fileCount:t?.fileCount||0,title:t?.title||"\uC644\uB8CC!",subtitle:t?.subtitle||"\uC791\uC5C5\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",folderId:this.currentFolder&&this.currentFolder!=="my-files"?this.currentFolder:null}})})}onConfirmOpenSelection(){return C(this,null,function*(){if(this.selectedItems.size===0){this.snackbar.showWarning("\uD30C\uC77C\uC744 \uC120\uD0DD\uD558\uC138\uC694.");return}let t=Array.from(this.selectedItems)[0];try{let e=yield this.indexedDbService.getDocumentById(t);if(!e){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if((e.fileName||e.title||"").toLowerCase().split(".").pop()!=="pdf"){this.snackbar.showError("PDF \uD30C\uC77C\uB9CC \uC5F4 \uC218 \uC788\uC2B5\uB2C8\uB2E4.");return}this.isSelectionMode=!1,this.selectedItems.clear(),this.toolActionService.clearPendingAction(),this.router.navigate(["/ezm/viewer"],{state:{document:e,mode:"viewer"}})}catch{this.snackbar.showError("\uD30C\uC77C\uC744 \uC5EC\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}onConfirmConvertSelection(){return C(this,null,function*(){if(this.selectedItems.size===0){this.snackbar.showWarning("\uD30C\uC77C\uC744 \uC120\uD0DD\uD558\uC138\uC694.");return}let t=this.pendingAction?.data?.sourceFileType;if(!t){this.snackbar.showError("\uBCC0\uD658 \uD0C0\uC785 \uC815\uBCF4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let e=Array.from(this.selectedItems);try{let n=this.getConvertTypeLabel();this.snackbar.showInfo(`${e.length}\uAC1C ${n} \uD30C\uC77C\uC744 PDF\uB85C \uBCC0\uD658 \uC911...`);let i=0,s=[],d="";for(let _ of e){let v=yield this.indexedDbService.getDocumentById(_),w=v?.originalFileData||v?.pdfBase64;if(!(!v||!w))try{let M=w.split(",")[1]||w,O=atob(M),E=new Uint8Array(O.length);for(let Y=0;Y<O.length;Y++)E[Y]=O.charCodeAt(Y);let D={image:"image/png",excel:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",word:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",ppt:"application/vnd.openxmlformats-officedocument.presentationml.presentation"},T=v.mimeType||D[t]||"application/octet-stream",I=new Blob([E],{type:T}),z=new File([I],v.fileName||v.title||"document",{type:I.type}),A=null;switch(t){case"image":A=yield this.reversePdfConverter.imageToPdf([z]);break;case"word":A=yield this.reversePdfConverter.wordToPdf(z);break;case"excel":A=yield this.reversePdfConverter.excelToPdf(z);break;case"ppt":A=yield this.reversePdfConverter.powerPointToPdf(z);break}if(A){let Y=new Blob([A.buffer],{type:"application/pdf"}),Q=this.getConvertFilePrefix(t),te=(v.fileName||v.title||"document").replace(/\.[^.]+$/,""),ie=`${Q}_${te}.pdf`,Ie=new File([Y],ie,{type:"application/pdf"}),qe=yield this.handleFileUploadAndReturn(Ie);qe&&(s.push(qe.id),d=ie),i++}}catch{}}this.isSelectionMode=!1,this.selectedItems.clear(),this.toolActionService.clearPendingAction(),i>0?this.router.navigate(["/ezm/file-saved"],{state:{fileId:s[0],fileIds:s,fileName:d,fileCount:i,title:"PDF \uBCC0\uD658 \uC644\uB8CC!",subtitle:`${i}\uAC1C \uD30C\uC77C\uC774 PDF\uB85C \uBCC0\uD658\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,folderId:this.currentFolder&&this.currentFolder!=="my-files"?this.currentFolder:null}}):this.snackbar.showError("\uBCC0\uD658\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}catch{this.snackbar.showError("\uD30C\uC77C \uBCC0\uD658 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}onConfirmMergeSelection(){return C(this,null,function*(){if(this.selectedItems.size<2){this.snackbar.showWarning("\uCD5C\uC18C 2\uAC1C \uC774\uC0C1\uC758 PDF\uB97C \uC120\uD0DD\uD558\uC138\uC694.");return}let t=Array.from(this.selectedItems);this.isSelectionMode=!1,this.selectedItems.clear(),this.toolActionService.clearPendingAction(),this.pendingAction=null,this.router.navigate(["/ezm/merge"],{state:{documentIds:t,folderId:this.getActiveFolderId()}})})}performMultiMerge(t){return C(this,null,function*(){try{this.snackbar.showInfo(`${t.length}\uAC1C PDF \uBCD1\uD569 \uC911...`);let n=(yield Promise.all(t.map(D=>this.indexedDbService.getDocumentById(D)))).filter(D=>D!==void 0);if(n.length<2){this.snackbar.showError("\uC720\uD6A8\uD55C PDF \uD30C\uC77C\uC774 \uBD80\uC871\uD569\uB2C8\uB2E4.");return}let i=window.PDFLib;if(!i){this.snackbar.showError("PDF \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let s=yield i.PDFDocument.create(),d=0;for(let D of n){let T=this.createBlobUrl(D.pdfBase64||"");try{let z=yield(yield fetch(T)).arrayBuffer(),A=yield i.PDFDocument.load(z),Y=A.getPageCount();(yield s.copyPages(A,Array.from({length:Y},(te,ie)=>ie))).forEach(te=>s.addPage(te)),d+=Y}catch{}finally{URL.revokeObjectURL(T)}}if(d===0){this.snackbar.showError("\uBCD1\uD569\uD560 \uD398\uC774\uC9C0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let _=yield s.save(),v=new Blob([_],{type:"application/pdf"}),w=yield this.blobToBase64(v),M=this.getActiveFolderId(),O=new Date().toISOString().slice(0,19).replace(/[:-]/g,"").replace("T","_"),E={id:`merged-${Date.now()}`,title:`PDF\uBCD1\uD569_${n.length}\uAC1C`,fileName:`PDF\uBCD1\uD569_${n.length}\uAC1C_${O}.pdf`,pdfBase64:w,pages:[],elementCount:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:"1.0",documentType:"viewer",folderId:M,pageCount:d};yield this.indexedDbService.saveDocument(E),this.snackbar.showSuccess(`${n.length}\uAC1C PDF\uAC00 \uBCD1\uD569\uB418\uC5C8\uC2B5\uB2C8\uB2E4. (\uCD1D ${d}\uD398\uC774\uC9C0)`),this.isSelectionMode=!1,this.selectedItems.clear(),this.toolActionService.clearPendingAction(),this.pendingAction=null,this.router.navigate(["/ezm/organize"],{state:{document:E}})}catch{this.snackbar.showError("PDF \uBCD1\uD569\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}fileToBase64(t){return new Promise((e,n)=>{let i=new FileReader;i.onload=()=>{let s=i.result;e(s)},i.onerror=n,i.readAsDataURL(t)})}createPdf(){this.snackbar.showInfo("PDF \uB9CC\uB4E4\uAE30 \uAE30\uB2A5\uC740 \uC900\uBE44 \uC911\uC785\uB2C8\uB2E4.")}deleteSelectedItems(){return C(this,null,function*(){if(this.selectedItems.size===0){this.snackbar.showWarning("\uC120\uD0DD\uB41C \uD56D\uBAA9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if(yield xe(`${this.selectedItems.size}\uAC1C \uD56D\uBAA9\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?${this.currentFolder?"":`
(\uD3F4\uB354 \uB0B4 \uD30C\uC77C\uC740 \uB8E8\uD2B8\uB85C \uC774\uB3D9\uB429\uB2C8\uB2E4)`}`))try{let e=Array.from(this.selectedItems);for(let n of e)this.folders.some(s=>s.id===n)||this.childFolders.some(s=>s.id===n)?yield this.indexedDbService.deleteFolder(n):yield this.indexedDbService.deleteDocument(n);this.folders=this.folders.filter(n=>!e.includes(n.id)),this.childFolders=this.childFolders.filter(n=>!e.includes(n.id)),this.documents=this.documents.filter(n=>!e.includes(n.id)),this.cdr.detectChanges(),this.snackbar.showSuccess(`${e.length}\uAC1C \uD56D\uBAA9\uC774 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),this.selectedItems.clear(),this.isSelectionMode=!1,this.isFolderListingContext()?yield this.loadFolders():this.currentFolder&&(yield this.loadFolderContents(this.currentFolder))}catch{this.snackbar.showError("\uD56D\uBAA9 \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}ngOnDestroy(){this.isDestroyed=!0,this.pendingActionSubscription&&this.pendingActionSubscription.unsubscribe(),this.authSubscription&&this.authSubscription.unsubscribe(),this.userProfileSubscription&&this.userProfileSubscription.unsubscribe(),this.documents=[],this.folders=[],this.childFolders=[],this.thumbnailOrientations={},this.selectedItems.clear()}sharePdfFile(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t.id);if(!e){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=e.pdfBase64||e.originalPdfBase64;if(!n){this.snackbar.showError("\uACF5\uC720\uD560 PDF \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let i=this.ensurePdfExtension(e.fileName||e.title||t.name||"document.pdf");if(this.tryNativeShare(i,n)){this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uACF5\uC720\uD588\uC2B5\uB2C8\uB2E4.");return}if(typeof navigator<"u"&&navigator.share){let s=this.base64ToBlob(n,"application/pdf"),d=[];try{d.push(new File([s],i,{type:"application/pdf"}))}catch{}let _={title:i,text:`${i} \uBB38\uC11C\uB97C \uACF5\uC720\uD569\uB2C8\uB2E4.`};d.length&&(typeof navigator.canShare!="function"||navigator.canShare({files:d}))&&(_.files=d),yield navigator.share(_),this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uACF5\uC720\uD588\uC2B5\uB2C8\uB2E4.");return}this.downloadFile(i,n),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch(e){if(e?.name==="AbortError")return;this.snackbar.showError("\uBB38\uC11C \uACF5\uC720\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}tryNativeShare(t,e){if(typeof window<"u"&&window.parent!==window)try{return window.parent.postMessage({type:"share",fileName:t,data:e},"*"),!0}catch{}return window.ReactNativeWebView?(window.ReactNativeWebView.postMessage(JSON.stringify({type:"share",fileName:t,data:e})),!0):window.webkit?.messageHandlers?.shareFile?(window.webkit.messageHandlers.shareFile.postMessage({fileName:t,data:e}),!0):window.Android?.shareFile?(window.Android.shareFile(t,e),!0):!1}downloadFile(t,e){let n=this.base64ToBlob(e,"application/pdf"),i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}renamePdfDocument(t,e){return C(this,null,function*(){let n=yield this.indexedDbService.getDocumentById(t.id);if(!n)throw new Error("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");let i=e.replace(/\.pdf$/i,""),s=this.ensurePdfExtension(e);n.title=i,n.fileName=s,yield this.indexedDbService.updateDocument(n)})}duplicatePdfFile(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t.id);if(!e){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=new Date().toISOString(),i=(e.title||e.fileName||t.name||"\uBB38\uC11C").replace(/\.pdf$/i,""),s=Z(K({},e),{id:this.generateDocumentId(),title:`${i} \uC0AC\uBCF8`,fileName:`${i}_\uC0AC\uBCF8.pdf`,createdAt:n,updatedAt:n});yield this.indexedDbService.saveDocument(s),this.snackbar.showSuccess("\uC0AC\uBCF8\uC774 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),yield this.refreshCurrentView()}catch{this.snackbar.showError("\uD30C\uC77C\uC744 \uBCF5\uC81C\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}deletePdfFile(t){return C(this,null,function*(){try{if(!(yield xe(`"${t.name}" \uD30C\uC77C\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`)))return;yield this.indexedDbService.deleteDocument(t.id);let n=this.documents.findIndex(i=>i.id===t.id);n!==-1&&(this.documents.splice(n,1),this.cdr.detectChanges()),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),yield this.refreshCurrentView()}catch{this.snackbar.showError("\uD30C\uC77C \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}refreshCurrentView(t=!0){return C(this,null,function*(){if(console.log("[refreshCurrentView] currentFolder:",this.currentFolder,"showShimmer:",t),!this.currentFolder){yield this.loadFolders(t),this.cdr.detectChanges();return}switch(this.currentFolder){case"my-files":yield this.loadFolders(t);break;case"recent-files":yield this.loadRecentFiles(t);break;case"favorites":yield this.loadFavoriteFiles(t);break;case"results":yield this.loadResultFiles(t);break;default:yield this.loadFolderContents(this.currentFolder,t),yield this.loadChildFolders(this.currentFolder);break}this.cdr.detectChanges()})}ensurePdfExtension(t){let e=t.trim();return/\.pdf$/i.test(e)?e:`${e}.pdf`}base64ToBlob(t,e="application/pdf"){let n=t.includes(",")?t.split(",")[1]:t,i=atob(n),s=new Array(i.length);for(let _=0;_<i.length;_++)s[_]=i.charCodeAt(_);let d=new Uint8Array(s);return new Blob([d],{type:e})}generateDocumentId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}convertFileToPdf(t,e){return C(this,null,function*(){try{this.snackbar.showInfo("\uD30C\uC77C \uBCC0\uD658 \uC911...");let n=t.originalFileData.includes(",")?t.originalFileData.split(",")[1]:t.originalFileData,i=atob(n),s=new Uint8Array(i.length);for(let D=0;D<i.length;D++)s[D]=i.charCodeAt(D);let d=new File([s],t.fileName||"file",{type:t.mimeType}),_=null,v="",w=new Date,M=w.getHours().toString().padStart(2,"0")+w.getMinutes().toString().padStart(2,"0")+w.getSeconds().toString().padStart(2,"0");switch(e){case"image-to-pdf":case"photo-to-pdf":_=yield this.reversePdfConverter.imageToPdf([d]),v=`\uC774\uBBF8\uC9C0\uBCC0\uD658_${M}.pdf`;break;case"excel-to-pdf":_=yield this.reversePdfConverter.excelToPdf(d),v=`\uC5D1\uC140\uBCC0\uD658_${M}.pdf`;break;case"word-to-pdf":_=yield this.reversePdfConverter.wordToPdf(d),v=`\uC6CC\uB4DC\uBCC0\uD658_${M}.pdf`;break;case"ppt-to-pdf":_=yield this.reversePdfConverter.powerPointToPdf(d),v=`PPT\uBCC0\uD658_${M}.pdf`;break}if(!_)throw new Error("PDF \uC0DD\uC131 \uC2E4\uD328");let O=`doc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,E=this.uint8ArrayToBase64(_);yield this.indexedDbService.saveDocument({id:O,title:v,fileName:v,pdfBase64:E,thumbnail:"",pages:[],elementCount:0,version:"1.0",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:"converted"}),this.router.navigate(["/ezm/file-saved"],{state:{fileId:O,fileName:v,fileCount:1,title:"\uBCC0\uD658 \uC644\uB8CC!",subtitle:`${v} \uD30C\uC77C\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`}})}catch{this.snackbar.showError("\uBCC0\uD658 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}uint8ArrayToBase64(t){let n="";for(let i=0;i<t.length;i+=32768){let s=t.subarray(i,Math.min(i+32768,t.length));n+=String.fromCharCode(...Array.from(s))}return btoa(n)}convertPdfToFormat(t,e){return C(this,null,function*(){try{if(this.snackbar.showInfo("\uBCC0\uD658 \uC911..."),!t.pdfBase64){this.snackbar.showError("PDF \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=t.pdfBase64.split(",")[1]||t.pdfBase64,i=atob(n),s=new Uint8Array(i.length);for(let Q=0;Q<i.length;Q++)s[Q]=i.charCodeAt(Q);let d=new Blob([s],{type:"application/pdf"}),_=URL.createObjectURL(d),v=yield this.pdfFormatConverter.loadPdfDocument(_),M=(t.fileName||"document").replace(/\.pdf$/i,""),O=new Date,E=O.getHours().toString().padStart(2,"0")+O.getMinutes().toString().padStart(2,"0")+O.getSeconds().toString().padStart(2,"0"),D=null,T="",I="",z="image";switch(e){case"pdf-to-powerpoint":D=yield this.pdfFormatConverter.exportToPptBlob(v,M),T=`${M}_\uBCC0\uD658_${E}.pptx`,I="application/vnd.openxmlformats-officedocument.presentationml.presentation",z="ppt";break;case"pdf-to-word":D=yield this.pdfFormatConverter.exportToDocxBlob(v,M),T=`${M}_\uBCC0\uD658_${E}.docx`,I="application/vnd.openxmlformats-officedocument.wordprocessingml.document",z="word";break;case"pdf-to-excel":D=yield this.pdfFormatConverter.exportToExcelBlob(v,M),T=`${M}_\uBCC0\uD658_${E}.xlsx`,I="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",z="excel";break;case"pdf-to-image":D=yield this.pdfFormatConverter.exportToImageBlob(v,M,{scale:2,format:"png"}),T=`${M}_\uBCC0\uD658_${E}.png`,I="image/png",z="image";break;case"pdf-to-jpg":D=yield this.pdfFormatConverter.exportToImageBlob(v,M,{scale:2,format:"jpeg",quality:.9}),T=`${M}_\uBCC0\uD658_${E}.jpg`,I="image/jpeg",z="image";break}if(!D)throw new Error("\uBCC0\uD658 \uC2E4\uD328");URL.revokeObjectURL(_);let A=yield this.blobToBase64(D),Y=`doc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;yield this.indexedDbService.saveDocument({id:Y,title:T,fileName:T,originalFileData:A,mimeType:I,fileSize:D.size,thumbnail:"",pages:[],elementCount:0,version:"1.0",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:z}),this.router.navigate(["/ezm/file-saved"],{state:{fileId:Y,fileName:T,fileCount:1,title:"\uBCC0\uD658 \uC644\uB8CC!",subtitle:`${T} \uD30C\uC77C\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`}})}catch{this.snackbar.showError("\uBCC0\uD658 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}onCloseDecryptSheet(){this.decryptSheetState="collapsed",this.decryptPassword="",this.decryptError="",this.pendingDecryptDocument=null}toggleDecryptPasswordVisibility(){this.showDecryptPassword=!this.showDecryptPassword}onConfirmDecrypt(){return C(this,null,function*(){if(!this.pendingDecryptDocument)return;if(!this.decryptPassword){this.decryptError="\uBE44\uBC00\uBC88\uD638\uB97C \uC785\uB825\uD574\uC8FC\uC138\uC694.";return}let t=this.pendingDecryptDocument.encryptionMetadata?.password;if(this.decryptPassword!==t){this.decryptError="\uBE44\uBC00\uBC88\uD638\uAC00 \uC77C\uCE58\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.";return}this.decryptSheetState="collapsed",this.decryptPassword="",this.decryptError="",this.router.navigate(["/ezm/viewer"],{queryParams:{docId:this.pendingDecryptDocument.id}}),this.pendingDecryptDocument=null})}generateMissingThumbnails(){return C(this,null,function*(){return this.generateMissingThumbnailsOptimized()})}generateMissingThumbnailsOptimized(){return C(this,null,function*(){if(this.isDestroyed)return;let t=500,e=500,n=this.documents.filter(i=>!i.thumbnail&&(!i.documentType||i.documentType==="viewer"||i.documentType==="editor"||i.documentType==="converted"||i.documentType==="page-numbered"));if(console.log("[Thumbnail-Optimized] \uC378\uB124\uC77C \uC5C6\uB294 \uBB38\uC11C \uC218:",n.length),n.length!==0){for(let i=0;i<n.length;i++){if(this.isDestroyed){console.log("[Thumbnail-Optimized] \uCEF4\uD3EC\uB10C\uD2B8 destroy\uB428 - \uC911\uB2E8");return}let s=n[i],d=this.loadingDocIds.has(s.id),_=Date.now();if(yield this.waitForIdle(),this.isDestroyed)return;try{if(yield this.generateSingleThumbnailOptimized(s),d){let v=Date.now()-_;v<e&&(yield new Promise(w=>setTimeout(w,e-v)))}}catch(v){if(console.warn("[Thumbnail-Optimized] \uC2E4\uD328:",s.id,v),this.loadingDocIds.has(s.id)){let w=new Set(this.loadingDocIds);w.delete(s.id),this.loadingDocIds=w,this.cdr.detectChanges()}}i+1<n.length&&(yield new Promise(v=>setTimeout(v,t)))}console.log("[Thumbnail-Optimized] \uBAA8\uB4E0 \uC378\uB124\uC77C \uC0DD\uC131 \uC644\uB8CC")}})}waitForIdle(){return new Promise(t=>{"requestIdleCallback"in window?window.requestIdleCallback(()=>t(),{timeout:2e3}):requestAnimationFrame(()=>setTimeout(t,100))})}generateSingleThumbnailOptimized(t){return C(this,null,function*(){let e=null,n=null;try{let i=yield this.indexedDbService.getDocumentPdfData(t.id);if(!i){console.log("[Thumbnail-Optimized] PDF \uB370\uC774\uD130 \uC5C6\uC74C:",t.id);return}let s=i.includes(",")?i.split(",")[1]:i,d=Uint8Array.from(atob(s),I=>I.charCodeAt(0)),_=new Blob([d],{type:"application/pdf"});e=URL.createObjectURL(_),n=yield this.pdfjsLibService.getDocument(e);let v=yield n.getPage(1),w=v.getViewport({scale:1}),M=100,O=Math.min(M/w.width,M/w.height),E=v.getViewport({scale:O}),D=document.createElement("canvas");D.width=E.width,D.height=E.height;let T=D.getContext("2d");if(T){yield v.render({canvasContext:T,viewport:E}).promise;let I=D.toDataURL("image/jpeg",.5);if(yield this.indexedDbService.updateDocumentThumbnail(t.id,I),!this.isDestroyed){if(t.thumbnail=I,this.documents=[...this.documents],this.loadingDocIds.has(t.id)){let z=new Set(this.loadingDocIds);z.delete(t.id),this.loadingDocIds=z}this.cdr.detectChanges(),console.log("[Thumbnail-Optimized] \uC644\uB8CC:",t.id)}}}finally{if(n)try{yield n.destroy()}catch{}e&&URL.revokeObjectURL(e)}})}generateThumbnailFromBase64(t){return C(this,null,function*(){let e=null,n=null;try{let i=t.includes(",")?t.split(",")[1]:t,s=atob(i),d=new Uint8Array(s.length);for(let I=0;I<s.length;I++)d[I]=s.charCodeAt(I);let _=new Blob([d],{type:"application/pdf"});e=URL.createObjectURL(_),n=yield this.pdfjsLibService.getDocument(e);let v=yield n.getPage(1),w=v.getViewport({scale:1}),M=200,O=Math.min(M/w.width,M/w.height),E=v.getViewport({scale:O}),D=document.createElement("canvas");D.width=E.width,D.height=E.height;let T=D.getContext("2d");return T?(yield v.render({canvas:D,canvasContext:T,viewport:E}).promise,D.toDataURL("image/jpeg",.7)):null}finally{if(n)try{yield n.destroy()}catch{}e&&URL.revokeObjectURL(e)}})}openFileMoveSheet(t){return C(this,null,function*(){this.selectedFilesForMove=[t],this.availableFolders=yield this.indexedDbService.getFolders(null);for(let e of this.availableFolders){let n=yield this.indexedDbService.getFolderDocumentCount(e.id);e.fileCount=n}if(this.currentFolder&&this.currentFolder!=="my-files"&&this.currentFolder!=="recent-files"&&this.currentFolder!=="favorites"){this.availableFolders=this.availableFolders.filter(i=>i.id!==this.currentFolder);let e={id:"__home__",name:"\uD648(\uD30C\uC77C)",parentId:null,createdAt:"",updatedAt:"",fileCount:0},n=yield this.indexedDbService.getFolderContentsMetadataOnly(null);e.fileCount=n.length,this.availableFolders.unshift(e)}this.selectedMoveTargetFolderId=null,this.selectedItem=null,this.fileMoveSheetState="full"})}onFileMoveSheetStateChange(t){this.fileMoveSheetState=t,t==="collapsed"&&(this.selectedFilesForMove=[],this.selectedMoveTargetFolderId=null)}closeFileMoveSheet(){this.fileMoveSheetState="collapsed",this.selectedFilesForMove=[],this.selectedMoveTargetFolderId=null}onSelectMoveFolder(t){this.selectedMoveTargetFolderId=t}onFileMoveConfirm(){return C(this,null,function*(){if(!(!this.selectedMoveTargetFolderId||this.selectedFilesForMove.length===0))try{this.loadingService.showSpinner("\uD30C\uC77C\uC744 \uC774\uB3D9\uD558\uB294 \uC911...");let t=this.selectedMoveTargetFolderId==="__home__"?null:this.selectedMoveTargetFolderId;for(let i of this.selectedFilesForMove)yield this.indexedDbService.moveDocumentToFolder(i.id,t);let n=this.availableFolders.find(i=>i.id===this.selectedMoveTargetFolderId)?.name||"\uC120\uD0DD\uD55C \uD3F4\uB354";this.loadingService.hide(),this.snackbar.showSuccess(`${this.selectedFilesForMove.length}\uAC1C \uD30C\uC77C\uC774 "${n}"\uB85C \uC774\uB3D9\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),this.closeFileMoveSheet(),this.homeDataCache.invalidate(),yield this.refreshCurrentView()}catch{this.loadingService.hide(),this.snackbar.showError("\uD30C\uC77C \uC774\uB3D9\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onSortClick(){this.sortSheetState="full"}onSortSheetStateChange(t){this.sortSheetState=t}closeSortSheet(){this.sortSheetState="collapsed"}onSortApply(t){this.sortCriteria=t.criteria,this.sortOrder=t.order,this.applySorting()}applySorting(){this.documents=[...this.documents].sort((t,e)=>{let n=0,i=t.fileName||t.title,s=e.fileName||e.title;switch(this.sortCriteria){case"title":n=i.localeCompare(s,"ko");break;case"type":let d=i.split(".").pop()||"",_=s.split(".").pop()||"";n=d.localeCompare(_);break;case"date":let v=t.updatedAt?new Date(t.updatedAt).getTime():t.createdAt?new Date(t.createdAt).getTime():0,w=e.updatedAt?new Date(e.updatedAt).getTime():e.createdAt?new Date(e.createdAt).getTime():0;n=v-w;break;case"size":n=(t.fileSize||0)-(e.fileSize||0);break}return this.sortOrder==="asc"?n:-n}),this.childFolders=[...this.childFolders].sort((t,e)=>{let n=0;switch(this.sortCriteria){case"title":n=t.name.localeCompare(e.name,"ko");break;case"type":n=t.name.localeCompare(e.name,"ko");break;case"date":let i=t.updatedAt?new Date(t.updatedAt).getTime():t.createdAt?new Date(t.createdAt).getTime():0,s=e.updatedAt?new Date(e.updatedAt).getTime():e.createdAt?new Date(e.createdAt).getTime():0;n=i-s;break;case"size":n=t.name.localeCompare(e.name,"ko");break}return this.sortOrder==="asc"?n:-n})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-myfiles"]],hostBindings:function(e,n){e&1&&u("click",function(){return n.onDocumentClick()},to)("scroll",function(){return n.onWindowScroll()},Lt)},standalone:!1,decls:49,vars:40,consts:[["decryptPasswordInput",""],["itemActionsTemplate",""],[4,"ngIf"],["class","pending-action-banner",4,"ngIf"],[1,"main-content"],["class","upload-progress-bar",4,"ngIf"],[1,"view-container"],["type","file-myfiles",3,"count",4,"ngIf"],["class","files-list",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","selection-bar",4,"ngIf"],["class","selection-bar continue-bar",4,"ngIf"],[3,"filesAdded","visible","folderId","autoOpen","multiple"],[3,"activeTab",4,"ngIf"],[3,"sheetStateChange","close","sheetState"],[3,"isOpenChange","confirm","cancel","isOpen","title","placeholder","initialValue"],["class","item-sheet-content",4,"ngIf"],[1,"item-sheet-content"],[1,"sheet-header"],[1,"sheet-title"],[1,"decrypt-content"],[1,"decrypt-message"],[1,"decrypt-input-group"],[1,"password-input-wrapper"],["placeholder","",1,"decrypt-input",3,"ngModelChange","keyup.enter","type","ngModel"],["type","button",1,"toggle-visibility-btn",3,"click"],["src","images/icons/btn-top-find.svg","alt","\uBCF4\uC774\uAE30","width","20","height","20",4,"ngIf"],["src","images/icons/btn-top-find.svg","alt","\uC228\uAE30\uAE30","width","20","height","20","style","opacity: 0.5;",4,"ngIf"],["class","decrypt-error",4,"ngIf"],[1,"decrypt-actions"],[1,"btn-cancel",3,"click"],[1,"btn-confirm",3,"click"],["class","file-move-sheet",4,"ngIf"],[3,"sheetStateChange","sortApply","close","sheetState","criteria","order"],[3,"menuClick"],[3,"close","isOpen"],["class","header folder-header",4,"ngIf"],[1,"header","folder-header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"header-title"],[1,"header-actions"],["class","header-btn select-btn",3,"click",4,"ngIf"],["class","header-btn sort-btn",3,"click",4,"ngIf"],[1,"header-btn","select-btn",3,"click"],[1,"header-btn","sort-btn",3,"click"],["src","images/icons/btn-list-filter.svg","alt","\uC815\uB82C","width","20","height","20"],["class","header file-select-header",4,"ngIf"],[1,"header","file-select-header"],[1,"header-btn","import-btn",3,"click"],[1,"pending-action-banner"],[1,"banner-content"],[1,"banner-icon"],["src","images/icons/ico-recently.svg","alt","\uC120\uD0DD","width","20","height","20"],["class","banner-text",4,"ngIf"],[1,"banner-close",3,"click"],["src","images/icons/ico-close.svg","alt","\uB2EB\uAE30","width","18","height","18"],[1,"banner-text"],[1,"upload-progress-bar"],[1,"upload-info"],[1,"upload-icon"],[1,"upload-details"],[1,"upload-filename"],[1,"upload-status"],[1,"progress-track"],[1,"progress-fill"],["type","file-myfiles",3,"count"],[1,"files-list"],["class","file-item",3,"selected","special-folder","disabled","click",4,"ngFor","ngForOf"],[1,"file-item",3,"click"],["class","selection-checkbox",4,"ngIf"],[1,"file-icon"],["src","images/icons/ico-myfile.svg","alt","\uB0B4\uD30C\uC77C","width","20","height","20",4,"ngIf"],["src","images/icons/ico-bookmark.svg","alt","\uC990\uACA8\uCC3E\uAE30","width","20","height","20",4,"ngIf"],["src","images/icons/ico-complete.svg","alt","\uACB0\uACFC\uBB3C","width","20","height","20",4,"ngIf"],["src","images/icons/ico-recently.svg","alt","\uCD5C\uADFC\uD30C\uC77C","width","20","height","20",4,"ngIf"],["src","images/icons/ico-myfile.svg","alt","\uD3F4\uB354","width","20","height","20",4,"ngIf"],["class","file-type-icon encrypted-file-icon",4,"ngIf"],["class","thumbnail-shimmer",4,"ngIf"],["alt","PDF \uC378\uB124\uC77C","class","file-thumbnail-image",3,"src","landscape",4,"ngIf"],["class","file-type-icon pdf-icon",4,"ngIf"],["class","file-type-icon image-icon",4,"ngIf"],["class","file-type-icon excel-icon",4,"ngIf"],["class","file-type-icon word-icon",4,"ngIf"],["class","file-type-icon ppt-icon",4,"ngIf"],[1,"file-info"],[1,"file-name"],["class","file-count",4,"ngIf"],["class","folder-last-updated",4,"ngIf"],["class","file-meta",4,"ngIf"],["class","favorite-btn",3,"active","click",4,"ngIf"],["class","more-btn",3,"click",4,"ngIf"],[1,"selection-checkbox"],[1,"checkbox"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","16","height","16",4,"ngIf"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","16","height","16"],["src","images/icons/ico-myfile.svg","alt","\uB0B4\uD30C\uC77C","width","20","height","20"],["src","images/icons/ico-bookmark.svg","alt","\uC990\uACA8\uCC3E\uAE30","width","20","height","20"],["src","images/icons/ico-complete.svg","alt","\uACB0\uACFC\uBB3C","width","20","height","20"],["src","images/icons/ico-recently.svg","alt","\uCD5C\uADFC\uD30C\uC77C","width","20","height","20"],["src","images/icons/ico-myfile.svg","alt","\uD3F4\uB354","width","20","height","20"],[1,"file-type-icon","encrypted-file-icon"],["src","images/icons/ico-tool-main-password.svg","alt","\uC554\uD638\uD654","width","40","height","50"],[1,"thumbnail-shimmer"],[1,"shimmer-animation"],["alt","PDF \uC378\uB124\uC77C",1,"file-thumbnail-image",3,"src"],[1,"file-type-icon","pdf-icon"],["src","images/icons/ico-pdf.svg","alt","PDF","width","30","height","30"],[1,"file-type-icon","image-icon"],["src","images/icons/ico-img.svg","alt","\uC774\uBBF8\uC9C0","width","30","height","30"],[1,"file-type-icon","excel-icon"],["src","images/icons/ico-xlsx.svg","alt","\uC5D1\uC140","width","30","height","30"],[1,"file-type-icon","word-icon"],["src","images/icons/ico-word.svg","alt","\uC6CC\uB4DC","width","30","height","30"],[1,"file-type-icon","ppt-icon"],["src","images/icons/ico-ppt.svg","alt","PPT","width","30","height","30"],[1,"file-count"],[1,"folder-last-updated"],[1,"file-meta"],[1,"file-date"],["class","file-size",4,"ngIf"],[1,"file-size"],[1,"favorite-btn",3,"click"],["alt","\uC990\uACA8\uCC3E\uAE30","width","20","height","20",3,"src"],[1,"more-btn",3,"click"],["src","images/icons/btn-more-main.svg","alt","\uB354\uBCF4\uAE30","width","20","height","20"],[1,"empty-state"],["src","images/icons/ico-pdf.svg","alt","\uD30C\uC77C\uC5C6\uC74C","width","64","height","64",2,"opacity","0.5"],[1,"empty-text"],[1,"empty-subtext"],["class","empty-text",4,"ngIf"],["class","empty-subtext",4,"ngIf"],[1,"selection-bar"],[1,"selection-bar-left"],[1,"selection-count"],[1,"select-all-text-btn",3,"click"],[1,"select-all-text-btn",3,"click","disabled"],[1,"delete-btn",3,"click","disabled"],["src","images/icons/ico-tool-cut.svg","alt","\uC0AD\uC81C","width","20","height","20"],[1,"selection-bar","continue-bar"],[1,"continue-btn",3,"click","disabled"],[3,"activeTab"],[1,"bottom-sheet-header"],[1,"bottom-sheet-title"],[1,"bottom-sheet-content"],[1,"import-option-grid"],[1,"import-option-card",3,"click"],[1,"import-option-icon","file-icon"],["src","images/icons/ico-myfile.svg","alt","\uD30C\uC77C","width","40","height","40"],[1,"import-option-label"],[1,"import-option-single"],[1,"divider"],[1,"option-list"],[1,"option-item",3,"click"],[1,"option-icon"],["src","images/icons/ico-pdf.svg","alt","PDF","width","24","height","24"],[1,"option-label"],[4,"ngIf","ngIfElse"],[1,"sheet-header","rename-mode"],["aria-label","\uC774\uB984 \uBCC0\uACBD \uCDE8\uC18C",1,"sheet-back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","20","height","20"],[1,"rename-form"],["for","renameInput",1,"rename-label"],["id","renameInput","type","text","maxlength","80","placeholder","\uC0C8 \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694",1,"rename-input",3,"input","value"],["class","rename-helper",4,"ngIf"],[1,"rename-actions"],["type","button",1,"rename-cancel",3,"click"],["type","button",1,"rename-confirm",3,"click"],[1,"rename-helper"],[1,"sheet-options"],[1,"sheet-option",3,"click"],["src","images/icons/ico-share.svg","alt","\uACF5\uC720","width","24","height","24"],["src","images/icons/btn-top-edit.svg","alt","\uC774\uB984\uBCC0\uACBD","width","24","height","24"],["src","images/icons/ico-folder.svg","alt","\uD30C\uC77C \uC774\uB3D9","width","24","height","24"],[1,"sheet-option","danger",3,"click"],["src","images/icons/ico-tool-cut.svg","alt","\uC0AD\uC81C","width","24","height","24"],["src","images/icons/btn-top-find.svg","alt","\uBCF4\uC774\uAE30","width","20","height","20"],["src","images/icons/btn-top-find.svg","alt","\uC228\uAE30\uAE30","width","20","height","20",2,"opacity","0.5"],[1,"decrypt-error"],[1,"file-move-sheet"],[1,"file-move-header"],[1,"file-move-title"],[1,"folder-list-container"],["class","folder-select-item",3,"selected","click",4,"ngFor","ngForOf"],["class","empty-folders",4,"ngIf"],[1,"file-move-footer"],[1,"selected-count"],[1,"move-btn",3,"click","disabled"],[1,"folder-select-item",3,"click"],[1,"folder-select-check"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","24","height","24",4,"ngIf"],["class","empty-check",4,"ngIf"],[1,"folder-select-icon"],["src","images/icons/ico-folder.svg","alt","\uD648","width","24","height","24",4,"ngIf"],["src","images/icons/ico-folder.svg","alt","\uD3F4\uB354","width","24","height","24",4,"ngIf"],[1,"folder-select-info"],[1,"folder-select-name"],["class","folder-select-date",4,"ngIf"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","24","height","24"],[1,"empty-check"],["src","images/icons/ico-folder.svg","alt","\uD648","width","24","height","24"],["src","images/icons/ico-folder.svg","alt","\uD3F4\uB354","width","24","height","24"],[1,"folder-select-date"],[1,"empty-folders"]],template:function(e,n){if(e&1){let i=y();b(0,zs,3,1,"ng-container",2)(1,Ls,2,1,"ng-container",2)(2,Us,3,2,"ng-container",2)(3,Ys,9,3,"div",3),o(4,"div",4),b(5,qs,11,5,"div",5),o(6,"div",6),b(7,Xs,1,1,"ez-shimmer-skeleton",7)(8,bl,2,1,"div",8)(9,Il,4,2,"div",9),a()(),b(10,Fl,12,4,"div",10)(11,zl,8,5,"div",11),o(12,"ez-reader-mobile-fab",12),u("filesAdded",function(d){return m(i),f(n.onFabFilesAdded(d))}),a(),b(13,Rl,1,1,"ez-reader-mobile-bottom-nav",13),o(14,"app-bottom-sheet",14),u("sheetStateChange",function(d){return m(i),f(n.onSheetStateChange(d))})("close",function(){return m(i),f(n.closeBottomSheet())}),b(15,Bl,11,1,"ng-container",2)(16,Vl,18,0,"ng-container",2),a(),o(17,"app-input-dialog",15),$("isOpenChange",function(d){return m(i),U(n.showFolderDialog,d)||(n.showFolderDialog=d),f(d)}),u("confirm",function(d){return m(i),f(n.onFolderDialogConfirm(d))})("cancel",function(){return m(i),f(n.onFolderDialogCancel())}),a(),o(18,"app-bottom-sheet",14),$("sheetStateChange",function(d){return m(i),U(n.itemSheetState,d)||(n.itemSheetState=d),f(d)}),u("close",function(){return m(i),f(n.onItemSheetClose())}),b(19,Hl,4,2,"div",16),a(),o(20,"app-bottom-sheet",14),$("sheetStateChange",function(d){return m(i),U(n.decryptSheetState,d)||(n.decryptSheetState=d),f(d)}),u("close",function(){return m(i),f(n.onCloseDecryptSheet())}),o(21,"div",17)(22,"div",18)(23,"h3",19),c(24,"\uC554\uD638\uD654\uB41C \uD30C\uC77C"),a()(),o(25,"div",20)(26,"p",21),c(27,"\uC774 \uD30C\uC77C\uC744 \uC5F4\uAE30 \uC704\uD574\uC11C\uB294 \uBE44\uBC00\uBC88\uD638 \uC785\uB825\uC774 \uD544\uC694\uD569\uB2C8\uB2E4."),a(),o(28,"div",22)(29,"label"),c(30,"\uBE44\uBC00\uBC88\uD638\uB97C \uC785\uB825\uD574 \uC8FC\uC138\uC694."),a(),o(31,"div",23)(32,"input",24,0),$("ngModelChange",function(d){return m(i),U(n.decryptPassword,d)||(n.decryptPassword=d),f(d)}),u("keyup.enter",function(){return m(i),f(n.onConfirmDecrypt())}),a(),o(34,"button",25),u("click",function(){return m(i),f(n.toggleDecryptPasswordVisibility())}),b(35,Wl,1,0,"img",26)(36,Kl,1,0,"img",27),a()(),b(37,Gl,2,1,"p",28),a(),o(38,"div",29)(39,"button",30),u("click",function(){return m(i),f(n.onCloseDecryptSheet())}),c(40,"\uCDE8\uC18C"),a(),o(41,"button",31),u("click",function(){return m(i),f(n.onConfirmDecrypt())}),c(42,"\uD655\uC778"),a()()()()(),h(43,"pdf-password-modal"),o(44,"app-bottom-sheet",14),u("sheetStateChange",function(d){return m(i),f(n.onFileMoveSheetStateChange(d))})("close",function(){return m(i),f(n.closeFileMoveSheet())}),b(45,nc,14,4,"div",32),a(),b(46,ic,1,1,"ez-reader-mobile-bottom-nav",13),o(47,"ez-sort-bottom-sheet",33),u("sheetStateChange",function(d){return m(i),f(n.onSortSheetStateChange(d))})("sortApply",function(d){return m(i),f(n.onSortApply(d))})("close",function(){return m(i),f(n.closeSortSheet())}),a(),h(48,"ez-loading-overlay")}e&2&&(p("ngIf",!n.currentFolder&&!n.pendingAction),l(),p("ngIf",!n.pendingAction),l(),p("ngIf",n.pendingAction),l(),p("ngIf",n.pendingAction),l(),k("has-banner",n.pendingAction)("has-upload",n.isUploading),l(),p("ngIf",n.isUploading),l(2),p("ngIf",n.isDataLoading),l(),p("ngIf",!n.isDataLoading&&n.items.length>0),l(),p("ngIf",!n.isDataLoading&&n.items.length===0),l(),p("ngIf",n.isSelectionMode&&!n.pendingAction),l(),p("ngIf",n.pendingAction&&n.pendingAction.action==="merge-pdf"),l(),p("visible",!n.isSelectionMode&&n.shouldShowFab&&!n.pendingAction)("folderId",n.getActiveFolderId())("autoOpen",!1)("multiple",!1),l(),p("ngIf",!n.pendingAction&&n.isFirstDepth),l(),p("sheetState",n.sheetState),l(),p("ngIf",n.pendingAction&&n.showImportButton()),l(),p("ngIf",!n.pendingAction||!n.showImportButton()),l(),j("isOpen",n.showFolderDialog),p("title",n.folderDialogTitle)("placeholder","\uD3F4\uB354 \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694")("initialValue",n.folderDialogInitialValue),l(),j("sheetState",n.itemSheetState),l(),p("ngIf",n.selectedItem),l(),j("sheetState",n.decryptSheetState),l(12),p("type",n.showDecryptPassword?"text":"password"),j("ngModel",n.decryptPassword),l(3),p("ngIf",!n.showDecryptPassword),l(),p("ngIf",n.showDecryptPassword),l(),p("ngIf",n.decryptError),l(7),p("sheetState",n.fileMoveSheetState),l(),p("ngIf",n.fileMoveSheetState!=="collapsed"),l(),p("ngIf",!n.pendingAction&&n.isFirstDepth),l(),p("sheetState",n.sortSheetState)("criteria",n.sortCriteria)("order",n.sortOrder))},dependencies:[oe,B,he,pe,ge,Pe,bt,vt,xt,tt,Pt,it,Ot,Et,kt,Oe],styles:['.header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fff;border-bottom:1px solid #e0e0e0;display:flex;align-items:center;justify-content:space-between;padding-left:16px;padding-right:16px;z-index:100;box-sizing:border-box}.header.folder-header[_ngcontent-%COMP%]{justify-content:flex-start;gap:12px}.header.folder-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{flex:1}.header.folder-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.header.folder-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .select-btn[_ngcontent-%COMP%]{padding:8px 12px}.header.folder-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .sort-btn[_ngcontent-%COMP%]{padding:8px;background:none;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center}.header.folder-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .sort-btn[_ngcontent-%COMP%]:active{opacity:.7}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.header-left[_ngcontent-%COMP%]   .header-logo-icon[_ngcontent-%COMP%]{height:28px;width:28px;object-fit:contain}.header-left[_ngcontent-%COMP%]   .header-logo-title[_ngcontent-%COMP%]{height:auto;width:auto}.header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.header-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600}.points-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:4px 8px;background:#fff;border-radius:4px;cursor:pointer;transition:background .2s}.points-display[_ngcontent-%COMP%]:active{background:#f5f5f5}.points-display[_ngcontent-%COMP%]   .points-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;background:#f44;border-radius:50%;color:#fff;font-size:11px;font-weight:700}.points-display[_ngcontent-%COMP%]   .points-value[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#333;white-space:nowrap}.login-btn[_ngcontent-%COMP%]{padding:6px 16px;background:#fff;border:1px solid #ff4444;border-radius:20px;color:#f44;font-size:13px;font-weight:500;cursor:pointer;white-space:nowrap;transition:all .2s}.login-btn[_ngcontent-%COMP%]:active{background:#fff5f5;border-color:#f22;color:#f22}.user-avatar[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;overflow:hidden;cursor:pointer;display:flex;align-items:center;justify-content:center;background:#4285f4;transition:opacity .2s}.user-avatar[_ngcontent-%COMP%]:active{opacity:.8}.user-avatar[_ngcontent-%COMP%]   .avatar-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.user-avatar[_ngcontent-%COMP%]   .avatar-text[_ngcontent-%COMP%]{color:#fff;font-size:14px;font-weight:600;-webkit-user-select:none;user-select:none}.header-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.icon-btn[_ngcontent-%COMP%], .back-btn[_ngcontent-%COMP%], .close-btn[_ngcontent-%COMP%]{width:40px;height:40px;padding:0;background:none;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;border-radius:50%}.icon-btn[_ngcontent-%COMP%]:active, .back-btn[_ngcontent-%COMP%]:active, .close-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.back-btn[_ngcontent-%COMP%]{margin-left:-8px}.header-btn[_ngcontent-%COMP%]{padding:8px 16px;background:none;border:none;color:#007acc;font-size:15px;font-weight:500;cursor:pointer}.header-btn[_ngcontent-%COMP%]:active{opacity:.6}.pending-action-banner[_ngcontent-%COMP%]{position:fixed;top:calc(56px + var(--android-status-bar-height, 0px));left:0;right:0;height:44px;background:linear-gradient(135deg,#e3f2fd,#bbdefb);border-bottom:1px solid #90CAF9;z-index:99;animation:_ngcontent-%COMP%_slideDown .3s ease-out}.banner-content[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 16px;gap:12px;height:100%}.banner-icon[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_pulse 2s ease-in-out infinite}.banner-text[_ngcontent-%COMP%]{flex:1;font-size:14px;color:#1565c0;line-height:1.4}.banner-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600;color:#0d47a1}.banner-close[_ngcontent-%COMP%]{flex-shrink:0;width:32px;height:32px;padding:0;background:none;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;border-radius:50%;transition:background .2s}.banner-close[_ngcontent-%COMP%]:active{background:#0000001a}.banner-close[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:.6}@keyframes _ngcontent-%COMP%_slideDown{0%{transform:translateY(-100%);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}.main-content[_ngcontent-%COMP%]{margin-top:calc(56px + var(--android-status-bar-height, 0px));background:#f5f5f5;position:relative}.main-content.has-banner[_ngcontent-%COMP%]{margin-top:calc(100px + var(--android-status-bar-height, 0px))}.main-content.has-upload[_ngcontent-%COMP%]{margin-top:calc(128px + var(--android-status-bar-height, 0px))}.main-content.has-upload.has-banner[_ngcontent-%COMP%]{margin-top:calc(172px + var(--android-status-bar-height, 0px))}.upload-progress-bar[_ngcontent-%COMP%]{position:fixed;top:calc(56px + var(--android-status-bar-height, 0px));left:0;right:0;background:#fff;padding:12px 16px;box-shadow:0 2px 8px #0000001a;z-index:99}.has-banner[_ngcontent-%COMP%]   .upload-progress-bar[_ngcontent-%COMP%]{top:calc(100px + var(--android-status-bar-height, 0px))}.upload-progress-bar[_ngcontent-%COMP%]   .upload-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:8px}.upload-progress-bar[_ngcontent-%COMP%]   .upload-info[_ngcontent-%COMP%]   .upload-icon[_ngcontent-%COMP%]{font-size:24px}.upload-progress-bar[_ngcontent-%COMP%]   .upload-info[_ngcontent-%COMP%]   .upload-details[_ngcontent-%COMP%]{flex:1;min-width:0}.upload-progress-bar[_ngcontent-%COMP%]   .upload-info[_ngcontent-%COMP%]   .upload-details[_ngcontent-%COMP%]   .upload-filename[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.upload-progress-bar[_ngcontent-%COMP%]   .upload-info[_ngcontent-%COMP%]   .upload-details[_ngcontent-%COMP%]   .upload-status[_ngcontent-%COMP%]{font-size:12px;color:#666;margin-top:2px}.upload-progress-bar[_ngcontent-%COMP%]   .progress-track[_ngcontent-%COMP%]{height:4px;background:#e0e0e0;border-radius:2px;overflow:hidden}.upload-progress-bar[_ngcontent-%COMP%]   .progress-track[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#4285f4,#34a853);border-radius:2px;transition:width .3s ease}.view-container[_ngcontent-%COMP%]{position:relative;width:100%;background:#fff}.view-container.slide-in-left[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInLeft .3s cubic-bezier(.4,0,.2,1) forwards}.view-container.slide-out-left[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideOutLeft .3s cubic-bezier(.4,0,.2,1) forwards}.view-container.slide-in-right[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInRight .3s cubic-bezier(.4,0,.2,1) forwards}.view-container.slide-out-right[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideOutRight .3s cubic-bezier(.4,0,.2,1) forwards}@keyframes _ngcontent-%COMP%_slideInLeft{0%{transform:translate(100%)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_slideOutLeft{0%{transform:translate(0)}to{transform:translate(-100%)}}@keyframes _ngcontent-%COMP%_slideInRight{0%{transform:translate(-100%)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_slideOutRight{0%{transform:translate(0)}to{transform:translate(100%)}}.categories-section[_ngcontent-%COMP%]{background:#fff;margin-bottom:8px}.category-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;border-bottom:1px solid #f0f0f0;cursor:pointer;transition:background .2s}.category-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.category-item[_ngcontent-%COMP%]:active{background:#f5f5f5}.category-icon[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;justify-content:center}.category-info[_ngcontent-%COMP%]{flex:1;min-width:0}.category-label[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#333;display:flex;align-items:center;gap:8px}.category-count[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;min-width:20px;height:20px;padding:0 6px;background:#ef5350;color:#fff;font-size:12px;font-weight:600;border-radius:10px}.category-arrow[_ngcontent-%COMP%]{flex-shrink:0}.files-list[_ngcontent-%COMP%]{padding:8px 0 80px}.file-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;background:#fff;border-bottom:1px solid #f0f0f0;cursor:pointer;transition:background .2s;position:relative;overflow:visible}.file-item[_ngcontent-%COMP%]:active{background:#f5f5f5}.file-item.selected[_ngcontent-%COMP%]{background:#e3f2fd}.file-item.disabled[_ngcontent-%COMP%]{opacity:1;cursor:default;background:#fafafa}.file-item.disabled[_ngcontent-%COMP%]:active{background:#fafafa}.file-item.disabled[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{color:#bdbdbd!important}.file-item.disabled[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-meta[_ngcontent-%COMP%]{color:#e0e0e0!important}.file-item.disabled[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]{opacity:.3;filter:grayscale(100%)}.file-item.disabled[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#bdbdbd!important}.file-item.disabled[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-type-icon[_ngcontent-%COMP%]{opacity:.3}.file-item.disabled[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-type-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:.3}.file-item.disabled[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-type-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%], .file-item.disabled[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-type-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   rect[_ngcontent-%COMP%], .file-item.disabled[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-type-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%], .file-item.disabled[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-type-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   text[_ngcontent-%COMP%]{fill:#bdbdbd!important;stroke:#bdbdbd!important}.file-item[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0 120px 0 0;z-index:1}.selection-checkbox[_ngcontent-%COMP%]{flex-shrink:0;position:relative;z-index:2}.selection-checkbox[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{width:24px;height:24px;border:2px solid #ccc;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .2s}.selection-checkbox[_ngcontent-%COMP%]   .checkbox.checked[_ngcontent-%COMP%]{background:#007acc;border-color:#007acc}.file-icon[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;justify-content:center;position:relative;z-index:2;width:70px;height:80px;border:1px solid #e8e8e8;border-radius:8px;background:#fafafa}.file-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;color:#999}.file-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px;height:24px}.file-icon[_ngcontent-%COMP%]   .file-thumbnail-image[_ngcontent-%COMP%]{max-width:58px;max-height:68px;width:auto;height:auto;object-fit:contain;border-radius:4px;box-shadow:0 1px 3px #0000001a}.file-icon[_ngcontent-%COMP%]   .file-thumbnail-image.landscape[_ngcontent-%COMP%]{max-width:62px;max-height:45px}.file-icon[_ngcontent-%COMP%]   .thumbnail-shimmer[_ngcontent-%COMP%]{position:absolute;inset:4px;background:#e0e0e0;border-radius:4px;overflow:hidden}.file-icon[_ngcontent-%COMP%]   .thumbnail-shimmer[_ngcontent-%COMP%]   .shimmer-animation[_ngcontent-%COMP%]{width:100%;height:100%;background:linear-gradient(90deg,#e0e0e0,#f0f0f0,#e0e0e0);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite}.file-icon[_ngcontent-%COMP%]   .encrypted-file-icon[_ngcontent-%COMP%]{width:40px;height:50px;display:flex;align-items:center;justify-content:center}.file-icon[_ngcontent-%COMP%]   .encrypted-file-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:40px;height:50px}.file-icon.folder-icon[_ngcontent-%COMP%]{border:none;background:transparent;width:auto;height:auto}.file-icon.folder-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#999}.file-icon.special-folder-icon[_ngcontent-%COMP%]{border:none;background:transparent;width:auto;height:auto}.file-icon.special-folder-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.file-icon.my-files-icon[_ngcontent-%COMP%]{border:none;background:transparent;width:auto;height:auto}.file-icon.my-files-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#666}.file-icon.favorites-icon[_ngcontent-%COMP%]{border:none;background:transparent;width:auto;height:auto}.file-icon.favorites-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#666}.file-icon.results-icon[_ngcontent-%COMP%]{border:none;background:transparent;width:auto;height:auto}.file-icon.results-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#666}.file-icon.recent-folder-icon[_ngcontent-%COMP%]{border:none;background:transparent;width:auto;height:auto}.file-icon.recent-folder-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#666}.file-type-icon[_ngcontent-%COMP%]{width:30px;height:30px;display:flex;align-items:center;justify-content:center}.file-type-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:30px;height:30px}.file-type-icon.pdf-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 1px 3px rgba(0,0,0,.2))}.file-type-icon.image-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 1px 3px rgba(0,0,0,.15))}.file-type-icon.excel-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 1px 3px rgba(0,0,0,.15))}.file-type-icon.word-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 1px 3px rgba(0,0,0,.15))}.file-type-icon.ppt-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 1px 3px rgba(0,0,0,.15))}.file-info[_ngcontent-%COMP%]{flex:1;min-width:0;position:relative;z-index:2}.favorite-btn[_ngcontent-%COMP%]{flex-shrink:0;width:36px;height:36px;padding:0;background:none;border:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#ccc;transition:all .2s;position:relative;z-index:3}.favorite-btn[_ngcontent-%COMP%]:active{transform:scale(1.2)}.favorite-btn.active[_ngcontent-%COMP%]{color:#f44336;animation:_ngcontent-%COMP%_heartBeat .3s ease-in-out}.favorite-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}@keyframes _ngcontent-%COMP%_heartBeat{0%,to{transform:scale(1)}25%{transform:scale(1.3)}50%{transform:scale(1.1)}75%{transform:scale(1.2)}}.more-btn[_ngcontent-%COMP%]{flex-shrink:0;width:36px;height:36px;padding:0;background:#0000000d;border:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#666;transition:all .2s;position:relative;z-index:3}.more-btn[_ngcontent-%COMP%]:active{background:#0000001a;transform:scale(.95)}.more-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.more-menu-wrapper[_ngcontent-%COMP%]{position:relative;flex-shrink:0;display:flex;align-items:center;z-index:4}.file-dropdown[_ngcontent-%COMP%]{position:absolute;top:44px;right:0;min-width:148px;padding:4px 0;background:#fff;border-radius:12px;box-shadow:0 12px 24px #0f172a2e;border:1px solid rgba(15,23,42,.08);animation:_ngcontent-%COMP%_dropdownFade .18s ease}.file-dropdown[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-6px;right:16px;width:12px;height:12px;background:#fff;border-left:1px solid rgba(15,23,42,.08);border-top:1px solid rgba(15,23,42,.08);transform:rotate(45deg);z-index:-1}.file-dropdown-option[_ngcontent-%COMP%]{width:100%;padding:10px 18px;background:none;border:none;text-align:left;font-size:14px;color:#111;cursor:pointer;transition:background .15s ease}.file-dropdown-option[_ngcontent-%COMP%]:active{background:#f3f4f6}.file-dropdown-option.danger[_ngcontent-%COMP%]{color:#e53935}@keyframes _ngcontent-%COMP%_dropdownFade{0%{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:translateY(0)}}.file-name[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;word-break:break-all;margin-bottom:4px}.file-name[_ngcontent-%COMP%]   .encrypted-icon[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;margin-left:4px;flex-shrink:0}.folder-last-updated[_ngcontent-%COMP%]{font-size:13px;color:#777;margin-bottom:2px}.file-count[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;min-width:20px;height:20px;padding:0 6px;background:#ef5350;color:#fff;font-size:12px;font-weight:600;border-radius:10px}.file-date[_ngcontent-%COMP%]{font-size:13px;color:#999}.file-meta[_ngcontent-%COMP%]{font-size:13px;color:#999;display:flex;align-items:center}.file-size[_ngcontent-%COMP%]{color:#999}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 20px;text-align:center}.empty-text[_ngcontent-%COMP%]{margin:16px 0 8px;font-size:16px;font-weight:500;color:#666}.empty-subtext[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#999}.selection-bar[_ngcontent-%COMP%]{position:fixed;bottom:calc(60px + var(--android-navigation-bar-height, 0px));left:0;right:0;height:56px;background:#fff;border-top:1px solid #e0e0e0;display:flex;align-items:center;justify-content:space-between;padding:0 16px;z-index:99}.selection-bar-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.selection-count[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333}.select-all-text-btn[_ngcontent-%COMP%]{padding:6px 12px;background:none;border:1px solid #007acc;border-radius:4px;color:#007acc;font-size:13px;font-weight:500;cursor:pointer;white-space:nowrap}.select-all-text-btn[_ngcontent-%COMP%]:active{background:#f0f0f0}.select-all-text-btn[_ngcontent-%COMP%]:disabled{border-color:#ccc;color:#ccc;cursor:not-allowed}.select-all-text-btn[_ngcontent-%COMP%]:disabled:active{background:none}.delete-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;background:#ef5350;color:#fff;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer}.delete-btn[_ngcontent-%COMP%]:active{background:#e53935}.delete-btn[_ngcontent-%COMP%]:disabled{background:#bdbdbd;cursor:not-allowed;opacity:.6}.merge-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;background:#2196f3;color:#fff;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer}.merge-btn[_ngcontent-%COMP%]:active{background:#1976d2}.merge-btn[_ngcontent-%COMP%]:disabled{background:#bdbdbd;cursor:not-allowed;opacity:.6}.merge-bar[_ngcontent-%COMP%]{background:linear-gradient(to right,#e3f2fd,#bbdefb);border-top:1px solid #90CAF9}.continue-bar[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;padding:16px;gap:12px;height:auto;background:#fff}.continue-bar[_ngcontent-%COMP%]   .selection-count[_ngcontent-%COMP%]{font-size:14px;color:#333}.continue-bar[_ngcontent-%COMP%]   .selection-count[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#ff5722;font-weight:600}.continue-btn[_ngcontent-%COMP%]{width:100%;padding:14px;background:#e0e0e0;color:#9e9e9e;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:not-allowed;transition:all .2s}.continue-btn.active[_ngcontent-%COMP%]{background:#ff5722;color:#fff;cursor:pointer}.continue-btn.active[_ngcontent-%COMP%]:active{background:#e64a19}.continue-btn[_ngcontent-%COMP%]:disabled{background:#e0e0e0;color:#9e9e9e;cursor:not-allowed}.file-select-header[_ngcontent-%COMP%]{justify-content:space-between}.file-select-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{margin-left:-8px}.file-select-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{flex:1;text-align:center}.file-select-header[_ngcontent-%COMP%]   .import-btn[_ngcontent-%COMP%]{color:#333;font-weight:500;padding:8px 12px}.fab-button[_ngcontent-%COMP%]{position:fixed;bottom:calc(76px + var(--android-navigation-bar-height, 0px));right:16px;width:56px;height:56px;background:#e53935;border:none;border-radius:50%;box-shadow:0 4px 12px #e5393566;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:98;transition:all .2s}.fab-button[_ngcontent-%COMP%]:active{transform:scale(.95);box-shadow:0 2px 8px #e5393566}.bottom-sheet-header[_ngcontent-%COMP%]{padding:20px 20px 0}.bottom-sheet-title[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#333}.bottom-sheet-content[_ngcontent-%COMP%]{padding:20px}.upload-options[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px}.upload-option-large[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;padding:24px 16px;background:#f8f9fa;border:1px solid #e0e0e0;border-radius:12px;cursor:pointer;transition:all .2s}.upload-option-large[_ngcontent-%COMP%]:active{background:#e9ecef;transform:scale(.98)}.option-icon-large[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.option-label-large[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333}.option-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.option-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;background:#fff;border:1px solid #e0e0e0;border-radius:8px;cursor:pointer;transition:all .2s}.option-item[_ngcontent-%COMP%]:active{background:#f5f5f5}.option-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.option-label[_ngcontent-%COMP%]{font-size:15px;color:#333}.context-menu-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:10000;display:flex;align-items:flex-end;animation:fadeIn .2s ease}.context-menu[_ngcontent-%COMP%]{width:100%;background:#fff;border-radius:16px 16px 0 0;animation:slideUp .3s ease}.context-menu-header[_ngcontent-%COMP%]{padding:20px;border-bottom:1px solid #e5e7eb}.context-menu-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#222}.context-menu-options[_ngcontent-%COMP%]{padding:8px 0}.context-menu-option[_ngcontent-%COMP%]{width:100%;padding:16px 20px;background:none;border:none;display:flex;align-items:center;gap:16px;cursor:pointer;font-size:16px;color:#333;transition:background .2s ease}.context-menu-option[_ngcontent-%COMP%]:active{background:#f3f4f6}.context-menu-option.delete[_ngcontent-%COMP%]{color:#ef5350}.context-menu-option[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.context-menu-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;text-align:left}.item-sheet-content[_ngcontent-%COMP%]   .sheet-header[_ngcontent-%COMP%]{padding:20px;border-bottom:1px solid #e5e7eb}.item-sheet-content[_ngcontent-%COMP%]   .sheet-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#222;margin:0;text-align:center}.item-sheet-content[_ngcontent-%COMP%]   .sheet-options[_ngcontent-%COMP%]{padding:8px 0}.item-sheet-content[_ngcontent-%COMP%]   .rename-mode[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.item-sheet-content[_ngcontent-%COMP%]   .sheet-back-btn[_ngcontent-%COMP%]{width:40px;height:40px;border:none;background:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer}.item-sheet-content[_ngcontent-%COMP%]   .sheet-back-btn[_ngcontent-%COMP%]:active{background:#f3f4f6}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]{width:100%;padding:16px 20px;background:none;border:none;display:flex;align-items:center;gap:16px;cursor:pointer;font-size:16px;color:#333;transition:background .2s ease}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]:active{background:#f3f4f6}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option.danger[_ngcontent-%COMP%]{color:#ef5350}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%], .item-sheet-content[_ngcontent-%COMP%]   .sheet-option.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]   line[_ngcontent-%COMP%]{stroke:#ef5350!important}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.item-sheet-content[_ngcontent-%COMP%]   .sheet-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;text-align:left}.item-sheet-content[_ngcontent-%COMP%]   .rename-form[_ngcontent-%COMP%]{padding:20px;display:flex;flex-direction:column;gap:16px}.item-sheet-content[_ngcontent-%COMP%]   .rename-label[_ngcontent-%COMP%]{font-size:14px;color:#555}.item-sheet-content[_ngcontent-%COMP%]   .rename-input[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #e0e0e0;border-radius:10px;font-size:15px;outline:none;transition:border .15s ease}.item-sheet-content[_ngcontent-%COMP%]   .rename-input[_ngcontent-%COMP%]:focus{border-color:#007acc;box-shadow:0 0 0 2px #007acc1f}.item-sheet-content[_ngcontent-%COMP%]   .rename-helper[_ngcontent-%COMP%]{margin:0;font-size:13px;color:#888}.item-sheet-content[_ngcontent-%COMP%]   .rename-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px}.item-sheet-content[_ngcontent-%COMP%]   .rename-cancel[_ngcontent-%COMP%], .item-sheet-content[_ngcontent-%COMP%]   .rename-confirm[_ngcontent-%COMP%]{min-width:80px;padding:10px 16px;border-radius:8px;border:none;font-size:14px;font-weight:500;cursor:pointer}.item-sheet-content[_ngcontent-%COMP%]   .rename-cancel[_ngcontent-%COMP%]{background:#f3f4f6;color:#555}.item-sheet-content[_ngcontent-%COMP%]   .rename-cancel[_ngcontent-%COMP%]:active{background:#e2e6ea}.item-sheet-content[_ngcontent-%COMP%]   .rename-confirm[_ngcontent-%COMP%]{background:#007acc;color:#fff;box-shadow:0 4px 10px #007acc40}.item-sheet-content[_ngcontent-%COMP%]   .rename-confirm[_ngcontent-%COMP%]:active{background:#0061b5}.import-option-grid[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:16px;padding:20px 16px 32px}.import-option-single[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:20px 16px 32px}.import-option-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;padding:20px 24px;background:#fff;border:1px solid #E0E0E0;border-radius:12px;cursor:pointer;transition:all .2s;min-width:90px}.import-option-card[_ngcontent-%COMP%]:active{background:#f5f5f5;transform:scale(.98)}.import-option-card[_ngcontent-%COMP%]:hover{border-color:#bdbdbd;box-shadow:0 2px 8px #00000014}.import-option-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:48px;height:48px}.import-option-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:40px;height:40px}.import-option-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333;text-align:center}.divider[_ngcontent-%COMP%]{height:1px;background:#e0e0e0;margin:0 16px}.decrypt-content[_ngcontent-%COMP%]{padding:20px}.decrypt-message[_ngcontent-%COMP%]{margin:0 0 24px;font-size:14px;color:#666;text-align:center}.decrypt-input-group[_ngcontent-%COMP%]{margin-bottom:24px}.decrypt-input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:500;color:#333}.password-input-wrapper[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.password-input-wrapper[_ngcontent-%COMP%]   .decrypt-input[_ngcontent-%COMP%]{flex:1;width:100%;padding:12px 40px 12px 12px;border:1px solid #E0E0E0;border-radius:8px;font-size:15px;outline:none;transition:border .2s}.password-input-wrapper[_ngcontent-%COMP%]   .decrypt-input[_ngcontent-%COMP%]:focus{border-color:#007acc}.password-input-wrapper[_ngcontent-%COMP%]   .toggle-visibility-btn[_ngcontent-%COMP%]{position:absolute;right:8px;width:32px;height:32px;padding:0;background:none;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#999}.password-input-wrapper[_ngcontent-%COMP%]   .toggle-visibility-btn[_ngcontent-%COMP%]:active{opacity:.6}.decrypt-error[_ngcontent-%COMP%]{margin:8px 0 0;font-size:13px;color:#ef5350}.decrypt-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.decrypt-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%], .decrypt-actions[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{flex:1;padding:14px;border:none;border-radius:8px;font-size:15px;font-weight:600;cursor:pointer;transition:all .2s}.decrypt-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.decrypt-actions[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:active{background:#e0e0e0}.decrypt-actions[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]{background:#ef5350;color:#fff}.decrypt-actions[_ngcontent-%COMP%]   .btn-confirm[_ngcontent-%COMP%]:active{background:#e53935}.file-move-sheet[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;max-height:70vh}.file-move-sheet[_ngcontent-%COMP%]   .file-move-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:16px;border-bottom:1px solid #eee}.file-move-sheet[_ngcontent-%COMP%]   .file-move-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:none;border:none;padding:4px;cursor:pointer;display:flex;align-items:center;justify-content:center}.file-move-sheet[_ngcontent-%COMP%]   .file-move-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:active{opacity:.7}.file-move-sheet[_ngcontent-%COMP%]   .file-move-header[_ngcontent-%COMP%]   .file-move-title[_ngcontent-%COMP%]{font-size:17px;font-weight:600;color:#333;margin:0}.file-move-sheet[_ngcontent-%COMP%]   .folder-list-container[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:8px 0}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;cursor:pointer;transition:background .2s}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]:active, .file-move-sheet[_ngcontent-%COMP%]   .folder-select-item.selected[_ngcontent-%COMP%]{background:#f0f8ff}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-check[_ngcontent-%COMP%]{width:24px;height:24px;display:flex;align-items:center;justify-content:center}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-check[_ngcontent-%COMP%]   .empty-check[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid #ddd;border-radius:50%}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-icon[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:#f5f5f5;border-radius:8px}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-info[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:2px}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-info[_ngcontent-%COMP%]   .folder-select-name[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333}.file-move-sheet[_ngcontent-%COMP%]   .folder-select-item[_ngcontent-%COMP%]   .folder-select-info[_ngcontent-%COMP%]   .folder-select-date[_ngcontent-%COMP%]{font-size:12px;color:#999}.file-move-sheet[_ngcontent-%COMP%]   .empty-folders[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:40px 20px}.file-move-sheet[_ngcontent-%COMP%]   .empty-folders[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#999;font-size:14px}.file-move-sheet[_ngcontent-%COMP%]   .file-move-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-top:1px solid #eee;background:#fff}.file-move-sheet[_ngcontent-%COMP%]   .file-move-footer[_ngcontent-%COMP%]   .selected-count[_ngcontent-%COMP%]{font-size:14px;color:#666}.file-move-sheet[_ngcontent-%COMP%]   .file-move-footer[_ngcontent-%COMP%]   .move-btn[_ngcontent-%COMP%]{background:#ddd;border:none;padding:12px 32px;border-radius:8px;font-size:15px;font-weight:500;color:#999;cursor:not-allowed;transition:all .2s}.file-move-sheet[_ngcontent-%COMP%]   .file-move-footer[_ngcontent-%COMP%]   .move-btn[_ngcontent-%COMP%]:not(:disabled){background:#2196f3;color:#fff;cursor:pointer}.file-move-sheet[_ngcontent-%COMP%]   .file-move-footer[_ngcontent-%COMP%]   .move-btn[_ngcontent-%COMP%]:not(:disabled):active{background:#1976d2}.shimmer-loading-container[_ngcontent-%COMP%]{padding:16px}.shimmer-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid #f0f0f0}.shimmer-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.shimmer-item[_ngcontent-%COMP%]   .shimmer-thumb[_ngcontent-%COMP%]{width:48px;height:64px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;border-radius:4px;animation:_ngcontent-%COMP%_shimmer 1.5s infinite}.shimmer-item[_ngcontent-%COMP%]   .shimmer-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:8px}.shimmer-item[_ngcontent-%COMP%]   .shimmer-content[_ngcontent-%COMP%]   .shimmer-title[_ngcontent-%COMP%]{width:70%;height:16px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;border-radius:4px;animation:_ngcontent-%COMP%_shimmer 1.5s infinite;animation-delay:.1s}.shimmer-item[_ngcontent-%COMP%]   .shimmer-content[_ngcontent-%COMP%]   .shimmer-subtitle[_ngcontent-%COMP%]{width:40%;height:12px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;border-radius:4px;animation:_ngcontent-%COMP%_shimmer 1.5s infinite;animation-delay:.2s}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}']})};var ei=vr(xr());var Fe=class r{constructor(t){this.router=t;this.initHistoryTracking()}history=[];MAX_HISTORY=50;initHistoryTracking(){this.router.events.pipe(fn(t=>t instanceof ho)).subscribe(t=>{t.urlAfterRedirects.includes("/splash")||this.addToHistory(t.urlAfterRedirects)})}addToHistory(t){(this.history.length===0||this.history[this.history.length-1]!==t)&&(this.history.push(t),this.history.length>this.MAX_HISTORY&&this.history.shift())}getPreviousUrl(){return this.history.length<2?null:this.history[this.history.length-2]}goBack(t="/ezm/home"){let e=this.getPreviousUrl();e?(this.history.pop(),this.router.navigateByUrl(e)):this.router.navigateByUrl(t)}getCurrentUrl(){return this.history.length>0?this.history[this.history.length-1]:null}clearHistory(){this.history=[]}getHistory(){return[...this.history]}static \u0275fac=function(e){return new(e||r)(X(N))};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};function oc(r,t){if(r&1&&(o(0,"div",78)(1,"span",79),c(2),a(),o(3,"span",26),c(4),a()()),r&2){let e=g();l(2),S("\u2705 ",e.i18n.translate("settings.googleOAuth")),l(2),x(e.oauthTokenMasked)}}function rc(r,t){if(r&1&&(o(0,"div",78)(1,"span",79),c(2),a(),o(3,"span",26),c(4),a()()),r&2){let e=g();l(2),S("\u2705 ",e.i18n.translate("settings.geminiApiKey")),l(2),x(e.testGeminiApiKeyMasked)}}function ac(r,t){if(r&1&&(o(0,"div",80)(1,"span",79),c(2),a(),o(3,"span",26),c(4),a()()),r&2){let e=g();l(2),S("\u26A0\uFE0F ",e.i18n.translate("settings.noAuth")),l(2),x(e.i18n.translate("settings.noAuthDesc"))}}function sc(r,t){if(r&1){let e=y();o(0,"button",81),u("click",function(){m(e);let i=g();return f(i.showApiKeyInput=!0)}),o(1,"div",82),h(2,"img",83),a(),o(3,"div",40)(4,"span",41),c(5),a(),o(6,"span",42),c(7),a()(),h(8,"img",23),a()}if(r&2){let e=g();l(5),x(e.i18n.translate("settings.geminiInputTitle")),l(2),x(e.i18n.translate("settings.geminiInputDesc"))}}function lc(r,t){if(r&1){let e=y();o(0,"div",84)(1,"div",85)(2,"span"),c(3),a(),o(4,"button",86),u("click",function(){m(e);let i=g();return f(i.onCancelApiKeyInput())}),h(5,"img",87),a()(),o(6,"input",88),$("ngModelChange",function(i){m(e);let s=g();return U(s.apiKeyInput,i)||(s.apiKeyInput=i),f(i)}),a(),o(7,"p",89)(8,"a",90),c(9,"Google AI Studio"),a()(),o(10,"button",91),u("click",function(){m(e);let i=g();return f(i.onSaveApiKey())}),h(11,"img",92),c(12),a()()}if(r&2){let e=g();l(3),x(e.i18n.translate("settings.geminiInputTitle")),l(3),j("ngModel",e.apiKeyInput),l(6),S(" ",e.i18n.translate("common.save")," ")}}function cc(r,t){if(r&1&&(o(0,"span",101),c(1),a()),r&2){let e=g(2);l(),S(" \u{1F510} ",e.i18n.translate("settings.googleOAuth")," ")}}function dc(r,t){if(r&1&&(o(0,"span",101),c(1),a()),r&2){let e=g(2);l(),S(" \u{1F511} ",e.i18n.translate("settings.geminiApiKey")," ")}}function pc(r,t){if(r&1&&(o(0,"span",102),c(1),a()),r&2){let e=g(2);l(),S(" ",e.i18n.translate("settings.oauthQuotaDesc")," ")}}function gc(r,t){r&1&&(o(0,"span",102),c(1," Google AI Studio API \uD0A4 \uC0AC\uC6A9 "),a())}function uc(r,t){if(r&1&&(o(0,"div",93)(1,"div",37),c(2),a(),o(3,"div",94)(4,"div",95),h(5,"img",96),a(),o(6,"div",97),b(7,cc,2,1,"span",98)(8,dc,2,1,"span",98)(9,pc,2,1,"span",99)(10,gc,2,0,"span",99),a()(),o(11,"p",100),c(12),a()()),r&2){let e=g();l(2),x(e.i18n.translate("settings.authModeSection")),l(2),k("oauth-active",e.useOAuthForAI)("apikey-active",!e.useOAuthForAI),l(3),p("ngIf",e.useOAuthForAI),l(),p("ngIf",!e.useOAuthForAI),l(),p("ngIf",e.useOAuthForAI),l(),p("ngIf",!e.useOAuthForAI),l(2),S(" \u{1F4A1} ",e.useOAuthForAI?"Google \uACC4\uC815 \uC778\uC99D\uC73C\uB85C AI\uB97C \uC0AC\uC6A9\uD569\uB2C8\uB2E4":"API \uD0A4\uB85C AI\uB97C \uC0AC\uC6A9\uD569\uB2C8\uB2E4"," ")}}function mc(r,t){if(r&1){let e=y();o(0,"div",103)(1,"div",104),c(2),a(),o(3,"button",50),u("click",function(){m(e);let i=g();return f(i.onRemoveApiKey())}),h(4,"img",51),c(5),a()()}if(r&2){let e=g();l(2),x(e.i18n.translate("settings.authManagement")),l(3),S(" ",e.i18n.translate("settings.deleteAllAuth")," ")}}function fc(r,t){if(r&1&&(o(0,"div",105)(1,"div",67)(2,"span",106),c(3),a(),o(4,"span",107),c(5),a()(),o(6,"p",108),c(7),a()()),r&2){let e=g();l(3),x(e.i18n.translate("settings.googleAuthKey")),l(2),x(e.oauthTokenMasked),l(2),ue("",e.i18n.translate("settings.oauthUsing"),"",e.useOAuthForAI?"\u2705":"\u274C",")")}}function hc(r,t){if(r&1&&(o(0,"div",105)(1,"div",67)(2,"span",106),c(3),a(),o(4,"span",107),c(5),a()(),o(6,"p",108),c(7),a()()),r&2){let e=g();l(3),x(e.i18n.translate("settings.geminiApiKey")),l(2),x(e.testGeminiApiKeyMasked),l(2),ue("",e.i18n.translate("settings.testDevUsing"),"",e.useOAuthForAI?"\u274C":"\u2705",")")}}function _c(r,t){if(r&1&&(o(0,"div",71)(1,"div",72),c(2,"\u{1F3AB} \uBC31\uC5D4\uB4DC \uD1A0\uD070 \uC815\uBCF4"),a(),o(3,"div",109),c(4," \u2705 \uBC31\uC5D4\uB4DC API\uB85C\uBD80\uD130 JWT \uD1A0\uD070\uC744 \uC131\uACF5\uC801\uC73C\uB85C \uBC1B\uC558\uC2B5\uB2C8\uB2E4! "),a(),o(5,"div",67)(6,"span",68),c(7,"Provider:"),a(),o(8,"span",69),c(9),a()(),o(10,"div",67)(11,"span",68),c(12,"\uC218\uC2E0 \uC2DC\uAC01:"),a(),o(13,"span",69),c(14),L(15,"date"),a()(),o(16,"div",67)(17,"span",68),c(18,"Access Token:"),a(),o(19,"code",110),c(20),a()(),o(21,"div",67)(22,"span",68),c(23,"Access \uB9CC\uB8CC:"),a(),o(24,"span",69),c(25),a()(),o(26,"div",67)(27,"span",68),c(28,"Refresh Token:"),a(),o(29,"code",110),c(30),a()(),o(31,"div",67)(32,"span",68),c(33,"Refresh \uB9CC\uB8CC:"),a(),o(34,"span",69),c(35),a()(),o(36,"div",111),c(37," \u{1F4A1} \uC704 \uD1A0\uD070\uC740 localStorage\uC5D0 \uC800\uC7A5\uB418\uC5B4 \uC788\uC73C\uBA70, API \uC694\uCCAD \uC2DC \uC790\uB3D9\uC73C\uB85C \uC0AC\uC6A9\uB429\uB2C8\uB2E4. "),a()()),r&2){let e=g();l(9),x(e.getBackendTokenInfo().provider),l(5),x(me(15,6,e.getBackendTokenInfo().receivedAt,"yyyy-MM-dd HH:mm:ss")),l(6),x(e.getBackendTokenInfo().accessToken),l(5),x(e.getBackendTokenInfo().accessExpiresAt),l(5),x(e.getBackendTokenInfo().refreshToken),l(5),x(e.getBackendTokenInfo().refreshExpiresAt)}}function Cc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Provider:"),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(4),x(e.debugOAuthCallback.provider)}}function bc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Domain:"),a(),o(3,"code",114),c(4),a()()),r&2){let e=g(2);l(4),x(e.debugOAuthCallback.domain)}}function vc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Code:"),a(),o(3,"code",110),c(4),a()()),r&2){let e=g(2);l(4),x(e.debugOAuthCallback.code)}}function xc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"State:"),a(),o(3,"code",113),c(4),a()()),r&2){let e=g(2);l(4),x(e.debugOAuthCallback.state)}}function Pc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"State (Decoded):"),a(),o(3,"pre",115),c(4),a()()),r&2){let e=g(2);l(4),x(e.decodeState())}}function Mc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Scope:"),a(),o(3,"code",114),c(4),a()()),r&2){let e=g(2);l(4),x(e.debugOAuthCallback.scope)}}function yc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Authuser:"),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(4),x(e.debugOAuthCallback.authuser)}}function wc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Prompt:"),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(4),x(e.debugOAuthCallback.prompt)}}function Sc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Error:"),a(),o(3,"span",116),c(4),a()()),r&2){let e=g(2);l(4),x(e.debugOAuthCallback.error)}}function Oc(r,t){if(r&1&&(o(0,"div",71)(1,"div",72),c(2,"\uFFFD OAuth \uCF5C\uBC31 \uC815\uBCF4"),a(),b(3,Cc,5,1,"div",112)(4,bc,5,1,"div",112),o(5,"div",67)(6,"span",68),c(7,"Timestamp:"),a(),o(8,"span",69),c(9),L(10,"date"),a()(),b(11,vc,5,1,"div",112)(12,xc,5,1,"div",112)(13,Pc,5,1,"div",112)(14,Mc,5,1,"div",112)(15,yc,5,1,"div",112)(16,wc,5,1,"div",112)(17,Sc,5,1,"div",112),o(18,"div",67)(19,"span",68),c(20,"Full URL:"),a(),o(21,"code",113),c(22),a()()()),r&2){let e=g();l(3),p("ngIf",e.debugOAuthCallback.provider),l(),p("ngIf",e.debugOAuthCallback.domain),l(5),x(me(10,11,e.debugOAuthCallback.timestamp,"yyyy-MM-dd HH:mm:ss")),l(2),p("ngIf",e.debugOAuthCallback.code),l(),p("ngIf",e.debugOAuthCallback.state),l(),p("ngIf",e.debugOAuthCallback.state),l(),p("ngIf",e.debugOAuthCallback.scope),l(),p("ngIf",e.debugOAuthCallback.authuser),l(),p("ngIf",e.debugOAuthCallback.prompt),l(),p("ngIf",e.debugOAuthCallback.error),l(5),x(e.debugOAuthCallback.fullUrl)}}function Ec(r,t){if(r&1&&(o(0,"div",71)(1,"div",72),c(2,"\u{1F511} Access Token"),a(),o(3,"div",67)(4,"code",117),c(5),a()()()),r&2){let e=g();l(5),x(e.debugAccessToken)}}function kc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"User ID:"),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(4),x(e.userProfile.backendUserId)}}function Dc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Nickname:"),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(4),x(e.userProfile.nickname)}}function Ic(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Social Type:"),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(4),x(e.userProfile.socialType)}}function Tc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Referral Code:"),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(4),x(e.userProfile.referralCode)}}function Ac(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Linked Accounts:"),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(4),S("",e.userProfile.linkedAccounts.length,"\uAC1C")}}function Fc(r,t){if(r&1&&(o(0,"div",71)(1,"div",72),c(2,"\u{1F464} \uC0AC\uC6A9\uC790 \uD504\uB85C\uD544"),a(),b(3,kc,5,1,"div",112),o(4,"div",67)(5,"span",68),c(6,"Email:"),a(),o(7,"span",69),c(8),a()(),b(9,Dc,5,1,"div",112),o(10,"div",67)(11,"span",68),c(12,"Name:"),a(),o(13,"span",69),c(14),a()(),b(15,Ic,5,1,"div",112),o(16,"div",67)(17,"span",68),c(18,"Login Type:"),a(),o(19,"span",69),c(20),a()(),b(21,Tc,5,1,"div",112)(22,Ac,5,1,"div",112),a()),r&2){let e=g();l(3),p("ngIf",e.userProfile.backendUserId),l(5),x(e.userProfile.email),l(),p("ngIf",e.userProfile.nickname),l(5),x(e.userProfile.name),l(),p("ngIf",e.userProfile.socialType),l(5),x(e.userProfile.loginType),l(),p("ngIf",e.userProfile.referralCode),l(),p("ngIf",e.userProfile.linkedAccounts&&e.userProfile.linkedAccounts.length>0)}}function zc(r,t){if(r&1){let e=y();o(0,"div",71)(1,"div",72),c(2,"\u{1F4F1} \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4"),a(),o(3,"div",67)(4,"span",68),c(5,"\uC81C\uC870\uC0AC:"),a(),o(6,"span",69),c(7),a()(),o(8,"div",67)(9,"span",68),c(10,"\uBAA8\uB378:"),a(),o(11,"span",69),c(12),a()(),o(13,"div",67)(14,"span",68),c(15,"Android:"),a(),o(16,"span",69),c(17),a()(),o(18,"button",118),u("click",function(){m(e);let i=g();return f(i.copyToClipboard(i.toJson(i.debugDeviceInfo)))}),c(19,"\uC804\uCCB4 JSON \uBCF5\uC0AC"),a()()}if(r&2){let e=g();l(7),x(e.debugDeviceInfo.manufacturer),l(5),x(e.debugDeviceInfo.model),l(5),ue("",e.debugDeviceInfo.androidVersion," (SDK ",e.debugDeviceInfo.sdkVersion,")")}}function Rc(r,t){if(r&1&&(o(0,"span",127),c(1),a()),r&2){let e=g().$implicit;l(),x(e.provider)}}function Bc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Provider/Domain:"),a(),o(3,"code",114),c(4),a()()),r&2){let e=g().$implicit;l(4),ue("",e.provider||"unknown"," @ ",e.domain||"unknown")}}function Vc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Code:"),a(),o(3,"code",114),c(4),a()()),r&2){let e=g().$implicit;l(4),S("",e.code.substring(0,30),"...")}}function Lc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Scope:"),a(),o(3,"code",114),c(4),a()()),r&2){let e=g().$implicit;l(4),x(e.scope)}}function Nc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Error:"),a(),o(3,"span",116),c(4),a()()),r&2){let e=g().$implicit;l(4),x(e.error)}}function jc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Full URL:"),a(),o(3,"code",114),c(4),a()()),r&2){let e=g().$implicit;l(4),S("",e.fullUrl.substring(0,50),"...")}}function Uc(r,t){if(r&1){let e=y();o(0,"div",121)(1,"div",122)(2,"span",123),c(3),L(4,"date"),a(),b(5,Rc,2,1,"span",124),o(6,"button",125),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.copyToClipboard(s.toJson(i)))}),c(7,"\u{1F4CB}"),a()(),o(8,"div",126),b(9,Bc,5,2,"div",112)(10,Vc,5,1,"div",112)(11,Lc,5,1,"div",112)(12,Nc,5,1,"div",112)(13,jc,5,1,"div",112),a()()}if(r&2){let e=t.$implicit;l(3),x(me(4,7,e.timestamp,"MM/dd HH:mm:ss")),l(2),p("ngIf",e.provider),l(4),p("ngIf",e.provider||e.domain),l(),p("ngIf",e.code),l(),p("ngIf",e.scope),l(),p("ngIf",e.error),l(),p("ngIf",e.fullUrl)}}function $c(r,t){if(r&1&&(o(0,"div",71)(1,"div",72),c(2,"\u{1F4DC} OAuth \uD788\uC2A4\uD1A0\uB9AC (\uCD5C\uADFC 20\uAC1C)"),a(),o(3,"div",119),b(4,Uc,14,10,"div",120),a()()),r&2){let e=g();l(4),p("ngForOf",e.getOAuthHistory().slice(0,20))}}function Hc(r,t){if(r&1&&(o(0,"pre",135),c(1),a()),r&2){let e=g().$implicit,n=g(2);l(),x(n.toJson(e.data))}}function Wc(r,t){if(r&1&&(o(0,"div",130)(1,"div",131)(2,"span",132),c(3),a(),o(4,"span",123),c(5),L(6,"date"),a()(),o(7,"div",133),c(8),a(),b(9,Hc,2,1,"pre",134),a()),r&2){let e=t.$implicit;k("log-info",e.type==="info")("log-success",e.type==="success")("log-error",e.type==="error")("log-warning",e.type==="warning"),l(3),x(e.type),l(2),x(me(6,12,e.timestamp,"MM/dd HH:mm:ss")),l(3),x(e.message),l(),p("ngIf",e.data)}}function Kc(r,t){if(r&1&&(o(0,"div",71)(1,"div",72),c(2,"\u{1F4CB} \uB514\uBC84\uADF8 \uB85C\uADF8 (\uCD5C\uADFC 50\uAC1C)"),a(),o(3,"div",128),b(4,Wc,10,15,"div",129),a()()),r&2){let e=g();l(4),p("ngForOf",e.getDebugLogs().slice(0,50))}}function Gc(r,t){r&1&&(o(0,"div",136)(1,"p"),c(2,"\uB514\uBC84\uADF8 \uC815\uBCF4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4"),a(),o(3,"p",137),c(4,"\uB85C\uADF8\uC778\uD558\uAC70\uB098 Android\uC5D0\uC11C \uB370\uC774\uD130\uB97C \uC804\uB2EC\uBC1B\uC73C\uBA74 \uD45C\uC2DC\uB429\uB2C8\uB2E4"),a()())}function Yc(r,t){if(r&1&&(o(0,"div",141)(1,"span",68),c(2),a(),o(3,"span",142),c(4),a()()),r&2){let e=g(2);l(2),S("\u26A0\uFE0F ",e.i18n.translate("settings.status")),l(2),x(e.i18n.translate("settings.nativePending"))}}function qc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(2),x(e.i18n.translate("settings.manufacturer")),l(2),x(e.deviceInfo.manufacturer)}}function Xc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(2),x(e.i18n.translate("settings.model")),l(2),x(e.deviceInfo.model)}}function Jc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2,"Android"),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(4),ue("",e.deviceInfo.androidVersion," (SDK ",e.deviceInfo.sdkVersion,")")}}function Zc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(2),x(e.i18n.translate("settings.screenSize")),l(2),ue("",e.deviceInfo.screenWidth," \xD7 ",e.deviceInfo.screenHeight)}}function Qc(r,t){if(r&1&&(o(0,"div",67)(1,"span",68),c(2),a(),o(3,"span",69),c(4),a()()),r&2){let e=g(2);l(2),x(e.i18n.translate("settings.notch")),l(2),x(e.deviceInfo.hasNotch?"\u2705 "+e.i18n.translate("settings.hasNotch"):"\u274C "+e.i18n.translate("settings.noNotch"))}}function ed(r,t){if(r&1){let e=y();o(0,"div",143)(1,"div",144),c(2),a(),o(3,"div",145)(4,"span",68),c(5),a(),o(6,"div",146)(7,"input",147),$("ngModelChange",function(i){m(e);let s=g(2);return U(s.editableStatusBarHeight,i)||(s.editableStatusBarHeight=i),f(i)}),a(),o(8,"span",148),c(9,"px"),a()()(),o(10,"div",145)(11,"span",68),c(12),a(),o(13,"div",146)(14,"input",147),$("ngModelChange",function(i){m(e);let s=g(2);return U(s.editableNavigationBarHeight,i)||(s.editableNavigationBarHeight=i),f(i)}),a(),o(15,"span",148),c(16,"px"),a()()(),o(17,"button",149),u("click",function(){m(e);let i=g(2);return f(i.applyLayoutAdjustment())}),c(18),a()()}if(r&2){let e=g(2);l(2),x(e.i18n.translate("settings.layoutAdjust")),l(3),x(e.i18n.translate("settings.statusBarHeight")),l(2),j("ngModel",e.editableStatusBarHeight),l(5),x(e.i18n.translate("settings.navBarHeight")),l(2),j("ngModel",e.editableNavigationBarHeight),l(4),S(" \u{1F3A8} ",e.i18n.translate("settings.applyLayout")," ")}}function td(r,t){if(r&1){let e=y();o(0,"div",138)(1,"h4",64),u("click",function(){m(e);let i=g();return f(i.toggleDeviceInfo())}),c(2),h(3,"img",65),a(),o(4,"div",66),b(5,Yc,5,2,"div",139)(6,qc,5,2,"div",112)(7,Xc,5,2,"div",112)(8,Jc,5,2,"div",112)(9,Zc,5,3,"div",112)(10,Qc,5,2,"div",112)(11,ed,19,6,"div",140),a()()}if(r&2){let e=g();l(2),S(" \u{1F4F1} ",e.i18n.translate("settings.deviceInfo")," "),l(),k("expanded",e.isDeviceInfoExpanded),l(),k("expanded",e.isDeviceInfoExpanded),l(),p("ngIf",!e.deviceInfo.isNativeResponse),l(),p("ngIf",e.deviceInfo.manufacturer),l(),p("ngIf",e.deviceInfo.model),l(),p("ngIf",e.deviceInfo.androidVersion),l(),p("ngIf",e.deviceInfo.screenWidth&&e.deviceInfo.screenHeight),l(),p("ngIf",e.deviceInfo.hasNotch!==void 0),l(),p("ngIf",e.isDeviceInfoExpanded)}}var Qn=class r{constructor(t,e,n,i,s,d,_,v,w){this.authService=t;this.geminiApiManager=e;this.googleOAuthService=n;this.navigationHistory=i;this.router=s;this.preferencesService=d;this.i18n=_;this.platformDetection=v;this.androidBridge=w}currentActiveTab="profile";currentSubPage=null;oauthToken=null;oauthTokenMasked="";testGeminiApiKey=null;testGeminiApiKeyMasked="";geminiApiKey=null;apiKeyMasked="";isLoggedIn=!1;userProfile=null;loginType=null;userPoints=0;isProfilePage=!0;isSideMenuOpen=!1;pointsService=P(Ue);pointsSubscription;useOAuthForAI=!1;isWebEnvironment=!1;showApiKeyInput=!1;apiKeyInput="";showSnackbar=!1;selectedLanguage="ko";buildVersion="0.0.0.100";buildInfo="EZ Reader Mobile";deviceInfo=null;isDeviceInfoExpanded=!1;editableStatusBarHeight=0;editableNavigationBarHeight=0;debugDeviceInfo=null;debugOAuthCallback=null;debugAccessToken=null;isDebugExpanded=!1;authSubscription;androidAuthSubscription;snackbar=P(G);ngOnInit(){window.scrollTo(0,0),this.isProfilePage=!0,this.isWebEnvironment=!this.platformDetection.isNative(),this.showSnackbar=this.preferencesService.getShowSnackbar(),this.selectedLanguage=this.preferencesService.getLanguage(),this.initializeAuthenticationSettings(),this.checkLoginStatus(),this.subscribeToAndroidAuth(),this.requestDeviceInfo(),this.loadDebugInfo(),this.pointsSubscription=this.pointsService.totalPoints$.subscribe(t=>this.userPoints=t)}loadDebugInfo(){this.androidBridge.deviceInfo$.subscribe(t=>{this.debugDeviceInfo=t}),this.androidBridge.oauthCallback$.subscribe(t=>{this.debugOAuthCallback=t}),this.refreshDebugInfo()}refreshDebugInfo(){let t=localStorage.getItem("gemini_api_keys");if(t)try{let n=JSON.parse(t);n.length>0&&(this.debugAccessToken=n[0].apiKey)}catch(n){console.error("API \uD0A4 \uD30C\uC2F1 \uC2E4\uD328:",n)}this.debugOAuthCallback=this.androidBridge.getLastOAuthCallback();let e=this.getBackendTokenInfo();e&&console.log("\u{1F3AB} \uBC31\uC5D4\uB4DC \uD1A0\uD070 \uC815\uBCF4 \uAC31\uC2E0\uB428:",{provider:e.provider,receivedAt:new Date(e.receivedAt),accessExpiresAt:e.accessExpiresAt,refreshExpiresAt:e.refreshExpiresAt}),this.debugDeviceInfo=this.androidBridge.getDeviceInfo()}getFullDebugInfo(){return this.androidBridge.getDebugInfo()}getOAuthHistory(){return this.androidBridge.getOAuthCallbackHistory()}getDebugLogs(){return this.androidBridge.getDebugLogs()}clearAllDebugInfo(){this.androidBridge.clearDebugInfo(),this.refreshDebugInfo(),this.snackbar.showSuccess("\uB514\uBC84\uADF8 \uC815\uBCF4\uAC00 \uCD08\uAE30\uD654\uB418\uC5C8\uC2B5\uB2C8\uB2E4")}toggleDebug(){this.isDebugExpanded=!this.isDebugExpanded}toJson(t){return JSON.stringify(t,null,2)}copyToClipboard(t){navigator.clipboard.writeText(t).then(()=>{this.snackbar.showSuccess("\uD074\uB9BD\uBCF4\uB4DC\uC5D0 \uBCF5\uC0AC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!")}).catch(e=>{console.error("\uBCF5\uC0AC \uC2E4\uD328:",e),this.snackbar.showError("\uBCF5\uC0AC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")})}getBackendTokenInfo(){return this.getFullDebugInfo()?.backendTokens||null}hasBackendToken(){return!!this.getBackendTokenInfo()}decodeState(){if(!this.debugOAuthCallback?.state)return"N/A";try{let t=atob(this.debugOAuthCallback.state);return JSON.stringify(JSON.parse(t),null,2)}catch(t){return`\uB514\uCF54\uB529 \uC2E4\uD328: ${t}`}}requestDeviceInfo(){console.log("\u{1F50D} [DeviceInfo] requestDeviceInfo \uD638\uCD9C\uB428"),console.log("\u{1F50D} [DeviceInfo] isAndroidWebView:",ye()),console.log("\u{1F50D} [DeviceInfo] userAgent:",navigator.userAgent),ye()?(console.log("\u2705 [DeviceInfo] Android WebView \uD658\uACBD \uAC10\uC9C0"),this.deviceInfo={model:navigator.userAgent,manufacturer:"Android Device (Native \uC751\uB2F5 \uB300\uAE30 \uC911)",brand:"Android",androidVersion:"N/A (Native \uC751\uB2F5 \uD544\uC694)",hasNotch:!1,safeAreaTop:0,safeAreaBottom:0,safeAreaLeft:0,safeAreaRight:0,screenWidth:window.screen.width,screenHeight:window.screen.height,isNativeResponse:!1},console.log("\u{1F4DD} [DeviceInfo] \uAE30\uBCF8 \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4 \uC124\uC815 \uC644\uB8CC (Native \uC751\uB2F5 \uB300\uAE30):",this.deviceInfo),console.warn("\u26A0\uFE0F\u26A0\uFE0F\u26A0\uFE0F [DeviceInfo] \uD604\uC7AC \uAE30\uBCF8\uAC12\uC785\uB2C8\uB2E4!"),console.warn('\u26A0\uFE0F [DeviceInfo] \uB178\uCE58 \uC815\uBCF4\uAC00 "\uC5C6\uC74C"\uC73C\uB85C \uD45C\uC2DC\uB418\uBA74 = Native \uC751\uB2F5\uC774 \uC624\uC9C0 \uC54A\uC558\uB2E4\uB294 \uC758\uBBF8\uC785\uB2C8\uB2E4.'),console.log("\u{1F4CB} [DeviceInfo] Android Native \uC571 \uAD6C\uD604 \uAC00\uC774\uB4DC: docs/android/DEVICE_INFO_INTEGRATION.md"),window.onAndroidMessage=(t,e)=>{console.log("=".repeat(80)),console.log("\u{1F4E9}\u{1F4E9}\u{1F4E9} [DeviceInfo] onAndroidMessage \uD638\uCD9C\uB428! Native\uC5D0\uC11C \uBA54\uC2DC\uC9C0 \uB3C4\uCC29!"),console.log("=".repeat(80)),console.log("\u{1F4E9} [DeviceInfo] Message Type:",t),console.log("\u{1F4E9} [DeviceInfo] Received Time:",new Date().toISOString()),console.log("\u{1F4E9} [DeviceInfo] Data Keys:",Object.keys(e)),console.log("\u{1F4E9} [DeviceInfo] Full Data:",JSON.stringify(e,null,2)),t==="deviceInfo"?(console.log("\u2705\u2705\u2705 [DeviceInfo] deviceInfo \uD0C0\uC785 \uD655\uC778! \uB370\uC774\uD130 \uCC98\uB9AC \uC2DC\uC791..."),this.deviceInfo=Z(K({},e),{isNativeResponse:!0}),this.deviceInfo.hasNotch?(this.editableStatusBarHeight=20,this.editableNavigationBarHeight=40,console.log("\u{1F534} [DeviceInfo] \uB178\uCE58 \uAC10\uC9C0! \uC0C1\uB2E8 20px / \uD558\uB2E8 40px \uCD94\uAC00 \uD328\uB529 \uC801\uC6A9")):(this.editableStatusBarHeight=0,this.editableNavigationBarHeight=0,console.log("\u2139\uFE0F [DeviceInfo] \uB178\uCE58 \uC5C6\uC74C. \uCD94\uAC00 \uD328\uB529 0px")),this.applyLayoutAdjustment(),console.log("=".repeat(80)),console.log("\u{1F389}\u{1F389}\u{1F389} [DeviceInfo] Native \uC751\uB2F5 \uC218\uC2E0 \uC131\uACF5! \uC2E4\uC81C \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4:"),console.log("=".repeat(80)),console.log("\u{1F4F1} [DeviceInfo] \uBAA8\uB378\uBA85:",this.deviceInfo.model),console.log("\u{1F3ED} [DeviceInfo] \uC81C\uC870\uC0AC:",this.deviceInfo.manufacturer),console.log("\u{1F916} [DeviceInfo] \uBE0C\uB79C\uB4DC:",this.deviceInfo.brand),console.log("\u{1F4CA} [DeviceInfo] Android \uBC84\uC804:",this.deviceInfo.androidVersion),console.log("\u{1F4CA} [DeviceInfo] SDK \uBC84\uC804:",this.deviceInfo.sdkVersion),console.log("\u{1F4F1} [DeviceInfo] \uD654\uBA74 \uD06C\uAE30:",`${this.deviceInfo.screenWidth} \xD7 ${this.deviceInfo.screenHeight}`),console.log("\u{1F534} [DeviceInfo] \uB178\uCE58 \uC815\uBCF4:",this.deviceInfo.hasNotch?"\u2705 \uC788\uC74C":"\u274C \uC5C6\uC74C"),console.log("\u{1F4CA} [DeviceInfo] \uC0C1\uD0DC\uBC14 \uB192\uC774:",this.deviceInfo.statusBarHeight,"px"),console.log("\u{1F4CA} [DeviceInfo] \uB124\uBE44\uAC8C\uC774\uC158\uBC14:",this.deviceInfo.navigationBarHeight,"px"),console.log("=".repeat(80)),setTimeout(()=>{console.log("\u{1F504} [DeviceInfo] UI \uBCC0\uACBD \uAC10\uC9C0 \uD2B8\uB9AC\uAC70 \uC644\uB8CC")},0)):(console.warn("\u26A0\uFE0F\u26A0\uFE0F\u26A0\uFE0F [DeviceInfo] deviceInfo \uD0C0\uC785\uC774 \uC544\uB2D8!"),console.warn("\u26A0\uFE0F [DeviceInfo] Type:",t)),console.log("=".repeat(80))},console.log("\u2705 [DeviceInfo] window.onAndroidMessage \uD578\uB4E4\uB7EC \uB4F1\uB85D \uC644\uB8CC!"),console.log("\u{1F440} [DeviceInfo] Native\uC5D0\uC11C \uBA54\uC2DC\uC9C0\uB97C \uBCF4\uB0B4\uBA74 \uC704 \uD578\uB4E4\uB7EC\uAC00 \uD638\uCD9C\uB429\uB2C8\uB2E4."),console.log('\u{1F440} [DeviceInfo] "\u{1F4E9}\u{1F4E9}\u{1F4E9}" \uB85C\uADF8\uAC00 \uBCF4\uC774\uBA74 = Native \uC751\uB2F5 \uC218\uC2E0 \uC131\uACF5!'),console.log("=".repeat(80)),import("./chunk-DFKPY5PG.js").then(t=>{t.requestDeviceInfo(),console.log("\u{1F4E4} [DeviceInfo] \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4 \uC694\uCCAD \uC804\uC1A1 \uC644\uB8CC")}).catch(t=>{console.error("\u274C [DeviceInfo] \uBAA8\uB4C8 \uB85C\uB4DC \uC2E4\uD328:",t)})):(console.log("\u2139\uFE0F [DeviceInfo] Android WebView \uD658\uACBD\uC774 \uC544\uB2D9\uB2C8\uB2E4"),(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&(this.deviceInfo={model:"TEST-DEVICE",manufacturer:"Test Manufacturer",brand:"TestBrand",androidVersion:"13",sdkVersion:33,hasNotch:!0,screenWidth:1080,screenHeight:2400,statusBarHeight:96,navigationBarHeight:126,safeAreaTop:96,safeAreaBottom:126},console.log("\u{1F4F1} [DeviceInfo] \uD14C\uC2A4\uD2B8 \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4 \uC124\uC815:",this.deviceInfo)))}toggleDeviceInfo(){this.isDeviceInfoExpanded=!this.isDeviceInfoExpanded}applyLayoutAdjustment(){let t=this.editableStatusBarHeight||0,e=this.editableNavigationBarHeight||0;console.log("=".repeat(80)),console.log("\u{1F3A8} [Layout] applyLayoutAdjustment() \uD638\uCD9C\uB428"),console.log("\u{1F4CA} [Layout] \uC0C1\uD0DC\uBC14 \uB192\uC774:",t,"px"),console.log("\u{1F4CA} [Layout] \uB124\uBE44\uAC8C\uC774\uC158\uBC14 \uB192\uC774:",e,"px"),this.preferencesService.setAndroidLayout(t,e),console.log("\u{1F4BE} [Layout] localStorage\uC5D0 \uC800\uC7A5 \uC644\uB8CC"),document.documentElement.style.setProperty("--android-status-bar-height",`${t}px`),document.documentElement.style.setProperty("--android-navigation-bar-height",`${e}px`),document.documentElement.style.setProperty("--safe-area-top",`${t}px`),document.documentElement.style.setProperty("--safe-area-bottom",`${e}px`),document.documentElement.style.setProperty("--status-bar-height",`${t}px`),document.documentElement.style.setProperty("--navigation-bar-height",`${e}px`),console.log("\u2705 [Layout] CSS \uBCC0\uC218 \uC124\uC815 \uC644\uB8CC"),console.log("   --android-status-bar-height:",t,"px"),console.log("   --android-navigation-bar-height:",e,"px"),console.log("=".repeat(80))}initializeAuthenticationSettings(){return C(this,null,function*(){try{yield this.geminiApiManager.ensureInitialized(),this.useOAuthForAI=this.geminiApiManager.getOAuthMode(),yield this.loadAuthenticationKeys(),console.log("\u2705 \uC778\uC99D \uC124\uC815 \uCD08\uAE30\uD654 \uC644\uB8CC"),console.log("\u{1F4CA} OAuth \uBAA8\uB4DC:",this.useOAuthForAI?"ON (Google \uACC4\uC815 \uC778\uC99D)":"OFF (API \uD0A4)")}catch(t){console.error("\u274C \uC778\uC99D \uC124\uC815 \uCD08\uAE30\uD654 \uC2E4\uD328:",t)}})}checkLoginStatus(){this.authService.userProfile$.subscribe(t=>{this.isLoggedIn=!!t,this.userProfile=t,this.loginType=t?.loginType||null}),this.authService.isAuthenticated$.subscribe(t=>{this.isLoggedIn=t})}subscribeToAndroidAuth(){this.androidAuthSubscription=this.googleOAuthService.nativeAuth$.subscribe(t=>C(this,null,function*(){if(t.purpose==="apiKey")if(console.log("\u{1F511} [OAuth] \uBC1B\uC740 \uD1A0\uD070:",t.geminiApiKey?.substring(0,20)+"..."),console.log("\u{1F511} [OAuth] \uD1A0\uD070 \uAE38\uC774:",t.geminiApiKey?.length),console.log("\u{1F511} [OAuth] \uD1A0\uD070 \uC2DC\uC791:",t.geminiApiKey?.substring(0,5)),t.success&&t.geminiApiKey)try{yield this.geminiApiManager.setOAuthToken(t.geminiApiKey,"android-user",t.userInfo?.email||"android@local"),this.useOAuthForAI=this.geminiApiManager.getOAuthMode(),yield this.loadAuthenticationKeys(),this.snackbar.showSuccess(`\u{1F389} Google \uC778\uC99D \uC131\uACF5!
OAuth \uD1A0\uD070\uC73C\uB85C AI\uB97C \uC0AC\uC6A9\uD569\uB2C8\uB2E4.`)}catch{this.snackbar.showError("OAuth \uD1A0\uD070 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}else this.snackbar.showError(`Google \uC778\uC99D \uC2E4\uD328
${t.error||"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958"}`)}))}loadAuthenticationKeys(){return C(this,null,function*(){try{let t=yield this.geminiApiManager.getAuthenticationStatus();t.oauthTokenInfo&&t.oauthTokenInfo.apiKey?(this.oauthToken=t.oauthTokenInfo.apiKey,this.oauthTokenMasked=this.maskToken(this.oauthToken)):(this.oauthToken=null,this.oauthTokenMasked=""),t.testApiKeyInfo&&t.testApiKeyInfo.apiKey?(this.testGeminiApiKey=t.testApiKeyInfo.apiKey,this.testGeminiApiKeyMasked=this.maskToken(this.testGeminiApiKey)):(this.testGeminiApiKey=null,this.testGeminiApiKeyMasked=""),t.currentMode==="oauth"&&this.oauthToken?(this.geminiApiKey=this.oauthToken,this.apiKeyMasked=this.oauthTokenMasked):this.testGeminiApiKey?(this.geminiApiKey=this.testGeminiApiKey,this.apiKeyMasked=this.testGeminiApiKeyMasked):(this.geminiApiKey=null,this.apiKeyMasked="")}catch(t){console.error("\uC778\uC99D \uD0A4 \uB85C\uB4DC \uC2E4\uD328:",t)}})}maskToken(t){if(!t)return"";if(t.length>20){let e=t.substring(0,12),n=t.substring(t.length-8);return`${e}...${n}`}else if(t.length>15){let e=t.substring(0,8),n=t.substring(t.length-4);return`${e}...${n}`}else return"**********"}loadGeminiApiKey(){return C(this,null,function*(){yield this.loadAuthenticationKeys()})}ngOnDestroy(){this.authSubscription&&this.authSubscription.unsubscribe(),this.androidAuthSubscription&&this.androidAuthSubscription.unsubscribe(),this.pointsSubscription&&this.pointsSubscription.unsubscribe()}onBack(){this.navigationHistory.goBack("/ezm/home")}goBack(){this.navigationHistory.goBack("/ezm/home")}navigateToPointInfo(){this.router.navigate(["/ezm/point-info"])}openSubPage(t){this.currentSubPage=t}closeSubPage(){this.currentSubPage=null}onToggleOAuthMode(){return C(this,null,function*(){this.useOAuthForAI=!this.useOAuthForAI,yield this.geminiApiManager.setOAuthMode(this.useOAuthForAI),this.useOAuthForAI?this.snackbar.showSuccess("OAuth \uD1A0\uD070\uC73C\uB85C AI\uB97C \uD638\uCD9C\uD569\uB2C8\uB2E4"):this.snackbar.showInfo("API \uD0A4\uB85C AI\uB97C \uD638\uCD9C\uD569\uB2C8\uB2E4")})}onPrivacyPolicy(){this.snackbar.showInfo(this.i18n.translate("common.preparing"))}onCustomerSupport(){this.snackbar.showInfo(this.i18n.translate("common.preparing"))}onVersionInfo(){this.snackbar.showInfo(this.i18n.translate("common.preparing"))}onGetGoogleApiKey(){if(this.isWebEnvironment){this.showApiKeyInput=!0;return}ye(),this.snackbar.showInfo(this.i18n.translate("snackbar.apiKeyFetchStart")),this.googleOAuthService.startGoogleLogin("apiKey")}onCancelApiKeyInput(){this.showApiKeyInput=!1,this.apiKeyInput=""}onSaveApiKey(){return C(this,null,function*(){let t=this.apiKeyInput.trim();if(!t){this.snackbar.showWarning("API \uD0A4\uB97C \uC785\uB825\uD574\uC8FC\uC138\uC694.");return}if(!t.startsWith("AIza")||t.length<30){this.snackbar.showWarning("\uC62C\uBC14\uB978 Gemini API \uD0A4 \uD615\uC2DD\uC774 \uC544\uB2D9\uB2C8\uB2E4.");return}try{yield this.geminiApiManager.setTestApiKey(t,"web-user","web@local"),yield this.loadAuthenticationKeys(),this.showApiKeyInput=!1,this.apiKeyInput="",this.snackbar.showSuccess("Gemini API \uD0A4\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch{this.snackbar.showError("API \uD0A4 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onRemoveApiKey(){return C(this,null,function*(){if(yield xe(`\uBAA8\uB4E0 \uC778\uC99D \uC815\uBCF4\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?

- Google OAuth \uD1A0\uD070
- Gemini API \uD0A4

AI \uAE30\uB2A5\uC744 \uC0AC\uC6A9\uD560 \uC218 \uC5C6\uAC8C \uB429\uB2C8\uB2E4.`))try{yield this.geminiApiManager.clearAllAuthentication(),yield this.loadAuthenticationKeys(),this.snackbar.showSuccess("\uBAA8\uB4E0 \uC778\uC99D \uC815\uBCF4\uAC00 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch{this.snackbar.showError("\uC778\uC99D \uC815\uBCF4 \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onGetTestGeminiApiKey(){return C(this,null,function*(){console.log("\u{1F9EA} [\uD14C\uC2A4\uD2B8] Gemini API \uD0A4 \uAC00\uC838\uC624\uAE30 \uC2DC\uC791"),console.log("\u{1F9EA} [\uD50C\uB7AB\uD3FC] isWebEnvironment:",this.isWebEnvironment),console.log("\u{1F9EA} [\uD50C\uB7AB\uD3FC] isAndroidWebView:",ye()),console.log("\u{1F9EA} [\uD50C\uB7AB\uD3FC] User Agent:",navigator.userAgent);try{let n=ei.AES.decrypt("U2FsdGVkX184mAiYUKguR4G/nD84XUV6Caf1fLhjU5FOKmxzcx14BuFF0RZRi5Hxy2wgI+3G9ea+Q3cwTYzhtA==","ezReaderMobile").toString(ei.enc.Utf8);yield this.geminiApiManager.setTestApiKey(n,"test-user","test@local"),yield this.loadAuthenticationKeys(),this.snackbar.showSuccess("\u{1F9EA} Gemini API \uD0A4\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),console.log("\u{1F9EA} [\uD14C\uC2A4\uD2B8] Gemini API \uD0A4 \uC800\uC7A5 \uC644\uB8CC")}catch(t){console.error("\u{1F9EA} [\uD14C\uC2A4\uD2B8] Gemini API \uD0A4 \uC800\uC7A5 \uC2E4\uD328:",t),this.snackbar.showError("\u{1F9EA} Gemini API \uD0A4 \uC800\uC7A5 \uC2E4\uD328")}})}onToggleSnackbar(){this.showSnackbar=!this.showSnackbar,this.preferencesService.setShowSnackbar(this.showSnackbar),this.showSnackbar?this.snackbar.showSuccessAlways(this.i18n.translate("snackbar.snackbarEnabled"),2e3):this.snackbar.showInfoAlways(this.i18n.translate("snackbar.snackbarDisabled"),2e3)}onLanguageChange(t){let n=t.target.value;this.selectedLanguage=n,this.preferencesService.setLanguage(n);let s={ko:"\uD55C\uAD6D\uC5B4",en:"English",zh:"\u4E2D\u6587",ja:"\u65E5\u672C\u8A9E"}[n];this.snackbar.showSuccess(this.i18n.translate("snackbar.languageChanged",{language:s}))}navigateToSearch(){this.router.navigate(["/ezm/search"])}navigateToPoints(){this.closeSideMenu(),this.router.navigate(["/ezm/points"])}navigateToMyPage(){this.closeSideMenu(),this.router.navigate(["/ezm/profile"])}navigateToSettings(){this.closeSideMenu(),this.router.navigate(["/ezm/profile"])}onMenuClick(){this.isSideMenuOpen=!0}onSideMenuClose(){this.isSideMenuOpen=!1}toggleSideMenu(){this.isSideMenuOpen=!this.isSideMenuOpen}closeSideMenu(){this.isSideMenuOpen=!1}getAvatarText(){return this.userProfile?.name?this.userProfile.name.charAt(0).toUpperCase():"U"}onLoginClick(){this.toggleSideMenu()}onLogout(){return C(this,null,function*(){(yield xe("\uB85C\uADF8\uC544\uC6C3 \uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"))&&(this.closeSideMenu(),this.authService.logout(),this.isLoggedIn=!1,this.userProfile=null,this.snackbar.showSuccess("\uB85C\uADF8\uC544\uC6C3\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.router.navigate(["/ezm/home"]))})}navigateToLogin(){this.closeSideMenu(),this.router.navigate(["/ezm/login"])}static \u0275fac=function(e){return new(e||r)(V(Ce),V(Ne),V(ft),V(Fe),V(N),V(Mt),V(nt),V(mt),V(Ae))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-settings"]],standalone:!1,decls:215,vars:83,consts:[[1,"settings-container"],[1,"settings-header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C\uAC00\uAE30","width","24","height","24"],[1,"header-title"],[1,"header-spacer"],[1,"settings-list"],[1,"settings-item","toggle-item"],[1,"item-label"],[1,"toggle-switch"],["type","checkbox",3,"change","checked"],[1,"toggle-slider"],[1,"settings-divider"],[1,"settings-item","select-item"],[1,"language-select",3,"change","value"],["value","ko",3,"selected"],["value","en",3,"selected"],["value","zh",3,"selected"],["value","ja",3,"selected"],[1,"settings-item","arrow-item","ai-settings",3,"click"],["src","images/icons/btn-top-ai.svg","alt","AI","width","18","height","18",2,"margin-right","8px","vertical-align","middle"],[1,"item-right"],[1,"status-badge"],["src","images/icons/btn-view-next.svg","alt","\uD654\uC0B4\uD45C","width","20","height","20"],[1,"settings-item","arrow-item","point-info",3,"click"],["src","images/icons/point-ico.svg","alt","\uD3EC\uC778\uD2B8","width","18","height","18",2,"margin-right","8px","vertical-align","middle"],[1,"status-value"],[1,"settings-item","arrow-item",3,"click"],[1,"sub-page"],[1,"sub-page-content"],[1,"ai-status-card"],[1,"status-header"],["src","images/icons/btn-top-ai.svg","alt","AI","width","24","height","24"],[1,"status-title"],[1,"status-content"],["class","status-row",4,"ngIf"],["class","status-row warning",4,"ngIf"],[1,"section-title"],[1,"auth-btn","google",3,"click"],[1,"auth-btn-icon"],[1,"auth-btn-text"],[1,"auth-btn-title"],[1,"auth-btn-desc"],["class","auth-btn gemini",3,"click",4,"ngIf"],["class","api-key-input-card",4,"ngIf"],[1,"auth-btn","test-key",3,"click"],[1,"auth-btn-icon","test-icon"],["class","current-auth-info",4,"ngIf"],["class","danger-section",4,"ngIf"],["class","api-key-info-card",4,"ngIf"],[1,"danger-btn",3,"click"],["src","images/icons/ico-tool-cut.svg","alt","\uC0AD\uC81C","width","20","height","20"],[1,"content-card"],[1,"contact-item"],["src","images/icons/ico-tooltip-info.svg","alt","\uC774\uBA54\uC77C","width","20","height","20"],["src","images/icons/ico-tooltip-info.svg","alt","\uC804\uD654","width","20","height","20"],[1,"note"],[1,"version-card"],[1,"app-icon"],["src","./images/title/a-2@3x.png","alt","EzReader","width","80","height","80"],[1,"app-name"],[1,"version-number"],[1,"copyright"],[1,"device-card","debug-card"],[1,"card-title",3,"click"],["src","images/icons/btn-view-next.svg","alt","\uD654\uC0B4\uD45C","width","20","height","20",1,"expand-icon"],[1,"device-info-grid"],[1,"info-row"],[1,"label"],[1,"value"],["class","debug-section",4,"ngIf"],[1,"debug-section"],[1,"section-label"],[1,"action-btn",3,"click"],[1,"action-btn","danger",3,"click"],["class","empty-debug",4,"ngIf"],["class","device-card",4,"ngIf"],[3,"activeTab"],[1,"status-row"],[1,"status-label"],[1,"status-row","warning"],[1,"auth-btn","gemini",3,"click"],[1,"auth-btn-icon","gemini-icon"],["src","images/icons/btn-top-ai.svg","alt","Gemini","width","24","height","24"],[1,"api-key-input-card"],[1,"input-header"],[1,"close-input-btn",3,"click"],["src","images/icons/ico-close.svg","alt","\uB2EB\uAE30","width","20","height","20"],["type","text","placeholder","AIza...","autocomplete","off",1,"api-key-input",3,"ngModelChange","ngModel"],[1,"input-hint"],["href","https://aistudio.google.com/apikey","target","_blank"],[1,"save-btn",3,"click"],["src","images/icons/ico-complete.svg","alt","\uC800\uC7A5","width","16","height","16"],[1,"current-auth-info"],[1,"info-card"],[1,"info-icon"],["src","images/icons/ico-tooltip-info.svg","alt","\uC815\uBCF4","width","24","height","24"],[1,"info-text"],["class","info-title",4,"ngIf"],["class","info-subtitle",4,"ngIf"],[1,"auth-mode-hint"],[1,"info-title"],[1,"info-subtitle"],[1,"danger-section"],[1,"section-title","danger-title"],[1,"api-key-info-card"],[1,"info-label"],[1,"info-value"],[1,"info-desc"],[1,"alert-success",2,"margin-bottom","12px","padding","8px","background","#d4edda","border-radius","4px","color","#155724"],[1,"code-value",2,"word-break","break-all","white-space","normal"],[1,"info-note",2,"margin-top","12px","padding","8px","background","#fff3cd","border-radius","4px","color","#856404","font-size","0.85em"],["class","info-row",4,"ngIf"],[1,"code-value","small",2,"word-break","break-all","white-space","normal"],[1,"code-value","small"],[1,"json-value"],[1,"value","error"],[1,"code-value",2,"word-break","break-all","white-space","normal","display","block"],[1,"copy-btn",3,"click"],[1,"history-list"],["class","history-item",4,"ngFor","ngForOf"],[1,"history-item"],[1,"history-header"],[1,"timestamp"],["class","provider-badge",4,"ngIf"],[1,"copy-mini-btn",3,"click"],[1,"history-content"],[1,"provider-badge"],[1,"log-list"],["class","log-item",3,"log-info","log-success","log-error","log-warning",4,"ngFor","ngForOf"],[1,"log-item"],[1,"log-header"],[1,"log-type"],[1,"log-message"],["class","log-data",4,"ngIf"],[1,"log-data"],[1,"empty-debug"],[1,"hint"],[1,"device-card"],["class","info-row warning-row",4,"ngIf"],["class","layout-section",4,"ngIf"],[1,"info-row","warning-row"],[1,"value","warning"],[1,"layout-section"],[1,"layout-title"],[1,"info-row","input-row"],[1,"input-wrapper"],["type","number","min","0","max","200",1,"layout-input",3,"ngModelChange","ngModel"],[1,"unit"],[1,"layout-apply-btn",3,"click"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),u("click",function(){return n.goBack()}),h(3,"img",3),a(),o(4,"h1",4),c(5),a(),h(6,"div",5),a(),o(7,"div",6)(8,"div",7)(9,"span",8),c(10),a(),o(11,"label",9)(12,"input",10),u("change",function(){return n.onToggleSnackbar()}),a(),h(13,"span",11),a()(),h(14,"div",12),o(15,"div",13)(16,"span",8),c(17),a(),o(18,"select",14),u("change",function(s){return n.onLanguageChange(s)}),o(19,"option",15),c(20,"\uD55C\uAD6D\uC5B4"),a(),o(21,"option",16),c(22,"English"),a(),o(23,"option",17),c(24,"\u4E2D\u6587\uFF08\u53F0\u7063\uFF09"),a(),o(25,"option",18),c(26,"\u65E5\u672C\u8A9E"),a()()(),h(27,"div",12),o(28,"button",19),u("click",function(){return n.openSubPage("aiSettings")}),o(29,"span",8),h(30,"img",20),c(31),a(),o(32,"div",21)(33,"span",22),c(34),a(),h(35,"img",23),a()(),h(36,"div",12),o(37,"button",24),u("click",function(){return n.navigateToPointInfo()}),o(38,"span",8),h(39,"img",25),c(40," \uD3EC\uC778\uD2B8 \uC815\uBCF4 "),a(),o(41,"div",21)(42,"span",26),c(43),L(44,"number"),a(),h(45,"img",23),a()(),h(46,"div",12),o(47,"button",27),u("click",function(){return n.openSubPage("privacy")}),o(48,"span",8),c(49),a(),h(50,"img",23),a(),h(51,"div",12),o(52,"button",27),u("click",function(){return n.openSubPage("support")}),o(53,"span",8),c(54),a(),h(55,"img",23),a(),h(56,"div",12),o(57,"button",27),u("click",function(){return n.openSubPage("version")}),o(58,"span",8),c(59),a(),h(60,"img",23),a()()(),o(61,"div",28)(62,"div",1)(63,"button",2),u("click",function(){return n.closeSubPage()}),h(64,"img",3),a(),o(65,"h1",4),c(66),a(),h(67,"div",5),a(),o(68,"div",29)(69,"div",30)(70,"div",31),h(71,"img",32),o(72,"span",33),c(73),a()(),o(74,"div",34),b(75,oc,5,2,"div",35)(76,rc,5,2,"div",35)(77,ac,5,2,"div",36),a()(),o(78,"div",37),c(79),a(),o(80,"button",38),u("click",function(){return n.onGetGoogleApiKey()}),h(81,"div",39),o(82,"div",40)(83,"span",41),c(84),a(),o(85,"span",42),c(86),a()(),h(87,"img",23),a(),b(88,sc,9,2,"button",43)(89,lc,13,3,"div",44),o(90,"button",45),u("click",function(){return n.onGetTestGeminiApiKey()}),o(91,"div",46)(92,"span"),c(93,"\u{1F9EA}"),a()(),o(94,"div",40)(95,"span",41),c(96),a(),o(97,"span",42),c(98),a()(),h(99,"img",23),a(),b(100,uc,13,10,"div",47)(101,mc,6,2,"div",48),a()(),o(102,"div",28)(103,"div",1)(104,"button",2),u("click",function(){return n.closeSubPage()}),h(105,"img",3),a(),o(106,"h1",4),c(107),a(),h(108,"div",5),a(),o(109,"div",29),b(110,fc,8,4,"div",49)(111,hc,8,4,"div",49),o(112,"button",50),u("click",function(){return n.onRemoveApiKey()}),h(113,"img",51),c(114),a()()(),o(115,"div",28)(116,"div",1)(117,"button",2),u("click",function(){return n.closeSubPage()}),h(118,"img",3),a(),o(119,"h1",4),c(120),a(),h(121,"div",5),a(),o(122,"div",29)(123,"div",52)(124,"h3"),c(125),a(),o(126,"p"),c(127),a(),h(128,"br"),o(129,"h4"),c(130),a(),o(131,"p"),c(132),a(),h(133,"br"),o(134,"h4"),c(135),a(),o(136,"p"),c(137),a(),h(138,"br"),o(139,"h4"),c(140),a(),o(141,"p"),c(142),a()()()(),o(143,"div",28)(144,"div",1)(145,"button",2),u("click",function(){return n.closeSubPage()}),h(146,"img",3),a(),o(147,"h1",4),c(148),a(),h(149,"div",5),a(),o(150,"div",29)(151,"div",52)(152,"h3"),c(153),a(),o(154,"p"),c(155),a(),h(156,"br"),o(157,"div",53),h(158,"img",54),o(159,"span"),c(160,"support@ezreader.com"),a()(),o(161,"div",53),h(162,"img",55),o(163,"span"),c(164,"1588-0000"),a()(),h(165,"br"),o(166,"p",56),c(167),a()()()(),o(168,"div",28)(169,"div",1)(170,"button",2),u("click",function(){return n.closeSubPage()}),h(171,"img",3),a(),o(172,"h1",4),c(173),a(),h(174,"div",5),a(),o(175,"div",29)(176,"div",57)(177,"div",58),h(178,"img",59),a(),o(179,"h2",60),c(180,"EzReader"),a(),o(181,"p",61),c(182),a(),o(183,"p",62),c(184),a()(),o(185,"div",63)(186,"h4",64),u("click",function(){return n.toggleDebug()}),c(187," \u{1F50D} \uB514\uBC84\uADF8 \uC815\uBCF4 "),h(188,"img",65),a(),o(189,"div",66)(190,"div",67)(191,"span",68),c(192,"\u{1F510} \uC778\uC99D \uC0C1\uD0DC"),a(),o(193,"span",69),c(194),a()(),b(195,_c,38,9,"div",70)(196,Oc,23,14,"div",70)(197,Ec,6,1,"div",70)(198,Fc,23,8,"div",70)(199,zc,20,4,"div",70)(200,$c,5,1,"div",70)(201,Kc,5,1,"div",70),o(202,"div",71)(203,"div",72),c(204,"\u{1F50D} \uC804\uCCB4 \uB514\uBC84\uADF8 \uC815\uBCF4"),a(),o(205,"div",67)(206,"button",73),u("click",function(){return n.refreshDebugInfo()}),c(207,"\u{1F504} \uC0C8\uB85C\uACE0\uCE68"),a(),o(208,"button",73),u("click",function(){return n.copyToClipboard(n.toJson(n.getFullDebugInfo()))}),c(209,"\u{1F4CB} \uC804\uCCB4 \uBCF5\uC0AC"),a(),o(210,"button",74),u("click",function(){return n.clearAllDebugInfo()}),c(211,"\u{1F5D1}\uFE0F \uCD08\uAE30\uD654"),a()()(),b(212,Gc,5,0,"div",75),a()(),b(213,td,12,12,"div",76),a()(),h(214,"ez-reader-mobile-bottom-nav",77)),e&2&&(k("slide-out",n.currentSubPage),l(5),x(n.i18n.translate("settings.title")),l(5),x(n.i18n.translate("settings.snackbar")),l(2),p("checked",n.showSnackbar),l(5),x(n.i18n.translate("settings.language")),l(),p("value",n.selectedLanguage),l(),p("selected",n.selectedLanguage==="ko"),l(2),p("selected",n.selectedLanguage==="en"),l(2),p("selected",n.selectedLanguage==="zh"),l(2),p("selected",n.selectedLanguage==="ja"),l(6),S(" ",n.i18n.translate("settings.aiSettings")," "),l(2),k("active",n.oauthToken||n.testGeminiApiKey),l(),x(n.oauthToken||n.testGeminiApiKey?n.i18n.translate("settings.active"):n.i18n.translate("settings.inactive")),l(9),S("",J(44,81,n.userPoints),"P"),l(6),x(n.i18n.translate("settings.privacy")),l(5),x(n.i18n.translate("settings.support")),l(5),x(n.i18n.translate("settings.version")),l(2),k("slide-in",n.currentSubPage==="aiSettings"),l(5),x(n.i18n.translate("settings.aiSettings")),l(7),x(n.i18n.translate("settings.aiAuthStatus")),l(2),p("ngIf",n.oauthToken),l(),p("ngIf",n.testGeminiApiKey),l(),p("ngIf",!n.oauthToken&&!n.testGeminiApiKey),l(2),x(n.i18n.translate("settings.authMethod")),l(5),x(n.i18n.translate("settings.googleAuthTitle")),l(2),x(n.i18n.translate("settings.googleAuthDesc")),l(2),p("ngIf",!n.showApiKeyInput),l(),p("ngIf",n.showApiKeyInput),l(7),x(n.i18n.translate("settings.testKeyTitle")),l(2),x(n.i18n.translate("settings.testKeyDesc")),l(2),p("ngIf",n.oauthToken||n.testGeminiApiKey),l(),p("ngIf",n.oauthToken||n.testGeminiApiKey),l(),k("slide-in",n.currentSubPage==="apiKey"),l(5),x(n.i18n.translate("settings.apiKeyManagement")),l(3),p("ngIf",n.oauthToken),l(),p("ngIf",n.testGeminiApiKey),l(3),S(" ",n.i18n.translate("settings.deleteApiKey")," "),l(),k("slide-in",n.currentSubPage==="privacy"),l(5),x(n.i18n.translate("settings.privacy")),l(5),x(n.i18n.translate("settings.privacyTitle")),l(2),x(n.i18n.translate("settings.privacyIntro")),l(3),S("1. ",n.i18n.translate("settings.privacyCollect")),l(2),x(n.i18n.translate("settings.privacyCollectContent")),l(3),S("2. ",n.i18n.translate("settings.privacyPurpose")),l(2),x(n.i18n.translate("settings.privacyPurposeContent")),l(3),S("3. ",n.i18n.translate("settings.privacyPeriod")),l(2),x(n.i18n.translate("settings.privacyPeriodContent")),l(),k("slide-in",n.currentSubPage==="support"),l(5),x(n.i18n.translate("settings.support")),l(5),x(n.i18n.translate("settings.supportInquiry")),l(2),x(n.i18n.translate("settings.supportDesc")),l(12),x(n.i18n.translate("settings.supportHours")),l(),k("slide-in",n.currentSubPage==="version"),l(5),x(n.i18n.translate("settings.version")),l(9),ue("",n.i18n.translate("settings.versionLabel")," ",n.buildVersion),l(2),x(n.i18n.translate("settings.copyright")),l(4),k("expanded",n.isDebugExpanded),l(),k("expanded",n.isDebugExpanded),l(4),k("success",n.isLoggedIn),l(),x(n.isLoggedIn?"\u2705 \uB85C\uADF8\uC778\uB428":"\u274C \uB85C\uADF8\uC778 \uC548\uB428"),l(),p("ngIf",n.hasBackendToken()),l(),p("ngIf",n.debugOAuthCallback),l(),p("ngIf",n.debugAccessToken),l(),p("ngIf",n.userProfile),l(),p("ngIf",n.debugDeviceInfo),l(),p("ngIf",n.getOAuthHistory().length>0),l(),p("ngIf",n.getDebugLogs().length>0),l(11),p("ngIf",!n.debugOAuthCallback&&!n.debugAccessToken&&!n.userProfile&&!n.debugDeviceInfo&&n.getOAuthHistory().length===0&&n.getDebugLogs().length===0),l(),p("ngIf",n.deviceInfo),l(),p("activeTab",n.currentActiveTab))},dependencies:[oe,B,Ve,Le,he,Pn,pe,wn,yn,ge,it,Te,Oe],styles:[`*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}[_nghost-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;background-color:#f5f5f5;min-height:100vh;display:block;position:relative;overflow-x:hidden}.settings-container[_ngcontent-%COMP%]{position:relative;min-height:100vh;background:#f5f5f5;transition:transform .3s ease;padding-bottom:calc(70px + var(--android-navigation-bar-height, 0px))}.settings-container.slide-out[_ngcontent-%COMP%]{transform:translate(-30%);pointer-events:none}.settings-header[_ngcontent-%COMP%]{position:sticky;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fff;display:flex;align-items:center;justify-content:space-between;padding-left:8px;padding-right:16px;z-index:100;border-bottom:1px solid #eee}.settings-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:none;border:none;padding:12px;cursor:pointer;color:#333;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background .2s}.settings-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.settings-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0;flex:1;text-align:center}.settings-header[_ngcontent-%COMP%]   .header-spacer[_ngcontent-%COMP%]{width:48px}.settings-list[_ngcontent-%COMP%]{background:#fff;margin-top:12px}.settings-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:18px 20px;background:#fff;border:none;width:100%;cursor:pointer;transition:background .2s}.settings-item[_ngcontent-%COMP%]:active{background:#f8f9fa}.settings-item[_ngcontent-%COMP%]   .item-label[_ngcontent-%COMP%]{font-size:16px;color:#333;font-weight:400}.settings-item[_ngcontent-%COMP%]   .arrow-icon[_ngcontent-%COMP%]{flex-shrink:0}.settings-item.toggle-item[_ngcontent-%COMP%]{cursor:default}.settings-item.toggle-item[_ngcontent-%COMP%]:active{background:#fff}.settings-item.select-item[_ngcontent-%COMP%]{cursor:default}.settings-item.select-item[_ngcontent-%COMP%]:active{background:#fff}.settings-item.arrow-item[_ngcontent-%COMP%]{text-align:left}.settings-divider[_ngcontent-%COMP%]{height:1px;background:#f0f0f0;margin:0 20px}.toggle-switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:52px;height:32px;flex-shrink:0}.toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-slider[_ngcontent-%COMP%]{background-color:#4cd964}.toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-slider[_ngcontent-%COMP%]:before{transform:translate(20px)}.toggle-switch[_ngcontent-%COMP%]   .toggle-slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#e0e0e0;transition:.3s;border-radius:32px}.toggle-switch[_ngcontent-%COMP%]   .toggle-slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:28px;width:28px;left:2px;bottom:2px;background-color:#fff;transition:.3s;border-radius:50%;box-shadow:0 2px 4px #0003}.language-select[_ngcontent-%COMP%]{padding:8px 32px 8px 12px;font-size:15px;border:1px solid #e0e0e0;border-radius:8px;background:#fff;color:#333;cursor:pointer;outline:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 10px center}.language-select[_ngcontent-%COMP%]:focus{border-color:#4285f4}.sub-page[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;bottom:calc(70px + var(--android-navigation-bar-height, 0px));background:#f5f5f5;z-index:200;transform:translate(100%);transition:transform .3s ease;overflow-y:auto}.sub-page.slide-in[_ngcontent-%COMP%]{transform:translate(0)}.sub-page-content[_ngcontent-%COMP%]{padding:16px 16px 32px}.api-key-info-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;margin-bottom:12px;box-shadow:0 1px 3px #00000014}.api-key-info-card[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.api-key-info-card[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-size:14px;color:#666;font-weight:500}.api-key-info-card[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{font-size:14px;color:#333;font-family:Courier New,monospace}.api-key-info-card[_ngcontent-%COMP%]   .info-desc[_ngcontent-%COMP%]{font-size:13px;color:#888;margin:0}.danger-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;gap:8px;padding:14px;background:#f44;color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:500;cursor:pointer;transition:background .2s;margin-top:20px}.danger-btn[_ngcontent-%COMP%]:active{background:#d33}.danger-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#fff}.content-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;box-shadow:0 1px 3px #00000014}.content-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0 0 12px}.content-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#333;margin:0 0 8px}.content-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#666;line-height:1.6;margin:0}.content-card[_ngcontent-%COMP%]   .contact-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid #f0f0f0}.content-card[_ngcontent-%COMP%]   .contact-item[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.content-card[_ngcontent-%COMP%]   .contact-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:15px;color:#333}.content-card[_ngcontent-%COMP%]   .note[_ngcontent-%COMP%]{font-size:13px;color:#888}.version-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:40px 20px;text-align:center;box-shadow:0 1px 3px #00000014;margin-bottom:16px}.version-card[_ngcontent-%COMP%]   .app-icon[_ngcontent-%COMP%]{width:80px;height:80px;margin:0 auto 16px}.version-card[_ngcontent-%COMP%]   .app-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:20px}.version-card[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#333;margin:0 0 8px}.version-card[_ngcontent-%COMP%]   .version-number[_ngcontent-%COMP%]{font-size:16px;color:#666;margin:0 0 8px}.version-card[_ngcontent-%COMP%]   .copyright[_ngcontent-%COMP%]{font-size:12px;color:#999;margin:0}.debug-card[_ngcontent-%COMP%]   .debug-section[_ngcontent-%COMP%]{margin-top:16px;padding-top:16px;border-top:1px solid #f0f0f0}.debug-card[_ngcontent-%COMP%]   .debug-section[_ngcontent-%COMP%]:first-child{margin-top:0;padding-top:0;border-top:none}.debug-card[_ngcontent-%COMP%]   .debug-section[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#4285f4;margin-bottom:12px}.debug-card[_ngcontent-%COMP%]   .code-value[_ngcontent-%COMP%]{font-family:Monaco,Courier New,monospace;font-size:12px;color:#48bb78;background:#2d3748;padding:4px 8px;border-radius:4px;word-break:break-all;display:block}.debug-card[_ngcontent-%COMP%]   .code-value.small[_ngcontent-%COMP%]{font-size:11px}.debug-card[_ngcontent-%COMP%]   .json-value[_ngcontent-%COMP%]{font-family:Monaco,Courier New,monospace;font-size:11px;color:#68d391;background:#2d3748;padding:8px;border-radius:4px;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word;margin:0}.debug-card[_ngcontent-%COMP%]   .value-with-btn[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;flex:1}.debug-card[_ngcontent-%COMP%]   .copy-mini-btn[_ngcontent-%COMP%]{padding:4px 8px;background:#4299e1;border:none;border-radius:4px;cursor:pointer;font-size:12px;flex-shrink:0}.debug-card[_ngcontent-%COMP%]   .copy-mini-btn[_ngcontent-%COMP%]:hover{background:#3182ce}.debug-card[_ngcontent-%COMP%]   .copy-mini-btn[_ngcontent-%COMP%]:active{background:#2c5282}.debug-card[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]{width:100%;margin-top:12px;padding:10px;background:#4299e1;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:13px;font-weight:600}.debug-card[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]:hover{background:#3182ce}.debug-card[_ngcontent-%COMP%]   .copy-btn[_ngcontent-%COMP%]:active{background:#2c5282}.debug-card[_ngcontent-%COMP%]   .empty-debug[_ngcontent-%COMP%]{padding:24px;text-align:center;color:#999}.debug-card[_ngcontent-%COMP%]   .empty-debug[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px}.debug-card[_ngcontent-%COMP%]   .empty-debug[_ngcontent-%COMP%]   p.hint[_ngcontent-%COMP%]{font-size:12px;color:#bbb}.debug-card[_ngcontent-%COMP%]   .value.success[_ngcontent-%COMP%]{color:#48bb78}.device-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;box-shadow:0 1px 3px #00000014}.device-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin:0;padding-bottom:12px;border-bottom:1px solid #f0f0f0;display:flex;justify-content:space-between;align-items:center;cursor:pointer}.device-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]   .expand-icon[_ngcontent-%COMP%]{transition:transform .3s ease;color:#666}.device-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]   .expand-icon.expanded[_ngcontent-%COMP%]{transform:rotate(180deg)}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]{max-height:0;overflow:hidden;opacity:0;transition:max-height .3s ease,opacity .3s ease}.device-card[_ngcontent-%COMP%]   .device-info-grid.expanded[_ngcontent-%COMP%]{max-height:800px;opacity:1;margin-top:12px}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid #f5f5f5}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:14px;color:#666}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:14px;color:#333;font-weight:500}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .info-row[_ngcontent-%COMP%]   .value.warning[_ngcontent-%COMP%]{color:#ff9800;font-size:13px}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .warning-row[_ngcontent-%COMP%]{background:#fff3e0;margin:0 -16px 8px;padding:10px 16px;border-radius:8px}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .layout-input[_ngcontent-%COMP%]{width:80px;padding:8px 12px;border:1px solid #e0e0e0;border-radius:8px;font-size:14px;text-align:right}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .layout-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4285f4}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]   .unit[_ngcontent-%COMP%]{font-size:13px;color:#666}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .layout-section[_ngcontent-%COMP%]{margin-top:16px;padding-top:16px;border-top:1px dashed #e0e0e0}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .layout-section[_ngcontent-%COMP%]   .layout-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#4285f4;margin-bottom:12px}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .layout-apply-btn[_ngcontent-%COMP%]{width:100%;padding:12px 16px;margin-top:16px;background:linear-gradient(135deg,#4285f4,#34a853);color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:transform .2s,box-shadow .2s}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .layout-apply-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}.device-card[_ngcontent-%COMP%]   .device-info-grid[_ngcontent-%COMP%]   .layout-apply-btn[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #4285f44d}.ai-settings[_ngcontent-%COMP%]   .item-label[_ngcontent-%COMP%]{display:flex;align-items:center}.ai-settings[_ngcontent-%COMP%]   .item-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.ai-settings[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{font-size:12px;padding:4px 8px;border-radius:12px;background:#f0f0f0;color:#666}.ai-settings[_ngcontent-%COMP%]   .status-badge.active[_ngcontent-%COMP%]{background:#e8f5e9;color:#4caf50}.ai-status-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-radius:16px;padding:20px;margin-bottom:20px;color:#fff}.ai-status-card[_ngcontent-%COMP%]   .status-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:16px}.ai-status-card[_ngcontent-%COMP%]   .status-header[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#fff}.ai-status-card[_ngcontent-%COMP%]   .status-header[_ngcontent-%COMP%]   .status-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600}.ai-status-card[_ngcontent-%COMP%]   .status-content[_ngcontent-%COMP%]{background:#ffffff26;border-radius:12px;padding:12px}.ai-status-card[_ngcontent-%COMP%]   .status-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid rgba(255,255,255,.1)}.ai-status-card[_ngcontent-%COMP%]   .status-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.ai-status-card[_ngcontent-%COMP%]   .status-row.warning[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:4px}.ai-status-card[_ngcontent-%COMP%]   .status-row.warning[_ngcontent-%COMP%]   .status-value[_ngcontent-%COMP%]{font-size:12px;opacity:.8}.ai-status-card[_ngcontent-%COMP%]   .status-row[_ngcontent-%COMP%]   .status-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.ai-status-card[_ngcontent-%COMP%]   .status-row[_ngcontent-%COMP%]   .status-value[_ngcontent-%COMP%]{font-size:13px;font-family:Courier New,monospace;opacity:.9}.section-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#666;margin:24px 0 12px;padding:0 4px}.section-title.danger-title[_ngcontent-%COMP%]{color:#f44}.auth-btn[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:16px;padding:16px;background:#fff;border:1px solid #e0e0e0;border-radius:12px;cursor:pointer;transition:all .2s;margin-bottom:12px}.auth-btn[_ngcontent-%COMP%]:active{background:#f8f9fa;transform:scale(.98)}.auth-btn[_ngcontent-%COMP%]   .auth-btn-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:#f5f5f5;flex-shrink:0}.auth-btn[_ngcontent-%COMP%]   .auth-btn-icon.gemini-icon[_ngcontent-%COMP%]{background:#e8f0fe}.auth-btn[_ngcontent-%COMP%]   .auth-btn-icon.test-icon[_ngcontent-%COMP%]{background:#fff3cd;font-size:24px}.auth-btn[_ngcontent-%COMP%]   .auth-btn-text[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:flex-start;gap:4px}.auth-btn[_ngcontent-%COMP%]   .auth-btn-text[_ngcontent-%COMP%]   .auth-btn-title[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#333}.auth-btn[_ngcontent-%COMP%]   .auth-btn-text[_ngcontent-%COMP%]   .auth-btn-desc[_ngcontent-%COMP%]{font-size:13px;color:#888}.auth-btn[_ngcontent-%COMP%]   .auth-btn-arrow[_ngcontent-%COMP%]{flex-shrink:0}.auth-btn.google[_ngcontent-%COMP%]{border-color:#4285f4}.auth-btn.google[_ngcontent-%COMP%]   .auth-btn-icon[_ngcontent-%COMP%]{background:#fff}.auth-btn.test-key[_ngcontent-%COMP%]{border-color:#ffc107;background:#fffde7}.api-key-input-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:12px;padding:16px;margin-bottom:12px}.api-key-input-card[_ngcontent-%COMP%]   .input-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.api-key-input-card[_ngcontent-%COMP%]   .input-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#333}.api-key-input-card[_ngcontent-%COMP%]   .input-header[_ngcontent-%COMP%]   .close-input-btn[_ngcontent-%COMP%]{background:none;border:none;padding:4px;cursor:pointer;color:#666}.api-key-input-card[_ngcontent-%COMP%]   .input-header[_ngcontent-%COMP%]   .close-input-btn[_ngcontent-%COMP%]:active{color:#333}.api-key-input-card[_ngcontent-%COMP%]   .api-key-input[_ngcontent-%COMP%]{width:100%;padding:14px;border:1.5px solid #e0e0e0;border-radius:8px;font-size:14px;font-family:Courier New,monospace}.api-key-input-card[_ngcontent-%COMP%]   .api-key-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4285f4;box-shadow:0 0 0 3px #4285f426}.api-key-input-card[_ngcontent-%COMP%]   .api-key-input[_ngcontent-%COMP%]::placeholder{color:#999;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.api-key-input-card[_ngcontent-%COMP%]   .input-hint[_ngcontent-%COMP%]{margin-top:10px;font-size:13px;color:#666;line-height:1.5}.api-key-input-card[_ngcontent-%COMP%]   .input-hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#4285f4;text-decoration:none;font-weight:500}.api-key-input-card[_ngcontent-%COMP%]   .input-hint[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active{text-decoration:underline}.api-key-input-card[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]{width:100%;margin-top:16px;padding:14px;background:#4285f4;color:#fff;border:none;border-radius:8px;font-size:15px;font-weight:500;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:background .2s}.api-key-input-card[_ngcontent-%COMP%]   .save-btn[_ngcontent-%COMP%]:active{background:#3367d6}.current-auth-info[_ngcontent-%COMP%]{margin-top:8px}.current-auth-info[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]{background:#fff;border:2px solid #e0e0e0;border-radius:12px;padding:16px;display:flex;align-items:center;gap:16px;transition:all .3s ease}.current-auth-info[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.current-auth-info[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   .info-icon.oauth-active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4285f4,#34a853);color:#fff;border:2px solid #4285f4}.current-auth-info[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   .info-icon.apikey-active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fbbc05,#ea4335);color:#fff;border:2px solid #fbbc05}.current-auth-info[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}.current-auth-info[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:4px}.current-auth-info[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   .info-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333}.current-auth-info[_ngcontent-%COMP%]   .info-card[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]   .info-subtitle[_ngcontent-%COMP%]{font-size:13px;color:#888}.current-auth-info[_ngcontent-%COMP%]   .auth-mode-hint[_ngcontent-%COMP%]{margin-top:12px;padding:12px 16px;background:#f8f9fa;border-radius:8px;font-size:13px;color:#666;text-align:center;border-left:3px solid #4285f4}.oauth-toggle-section[_ngcontent-%COMP%]{margin-top:8px}.oauth-toggle-section[_ngcontent-%COMP%]   .toggle-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:12px;padding:16px;display:flex;align-items:center;justify-content:space-between}.oauth-toggle-section[_ngcontent-%COMP%]   .toggle-card[_ngcontent-%COMP%]   .toggle-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.oauth-toggle-section[_ngcontent-%COMP%]   .toggle-card[_ngcontent-%COMP%]   .toggle-info[_ngcontent-%COMP%]   .toggle-label[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333}.oauth-toggle-section[_ngcontent-%COMP%]   .toggle-card[_ngcontent-%COMP%]   .toggle-info[_ngcontent-%COMP%]   .toggle-desc[_ngcontent-%COMP%]{font-size:13px;color:#888}.danger-section[_ngcontent-%COMP%]{margin-top:24px;padding-top:16px;border-top:1px solid #f0f0f0}.history-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;max-height:400px;overflow-y:auto}.history-item[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:8px;padding:12px;border-left:3px solid #4285f4}.history-item[_ngcontent-%COMP%]   .history-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.history-item[_ngcontent-%COMP%]   .history-header[_ngcontent-%COMP%]   .timestamp[_ngcontent-%COMP%]{font-size:11px;color:#666;font-family:monospace}.history-item[_ngcontent-%COMP%]   .history-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.log-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;max-height:400px;overflow-y:auto}.log-item[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:6px;padding:10px;border-left:3px solid #666}.log-item.log-info[_ngcontent-%COMP%]{border-left-color:#4299e1;background:#ebf8ff}.log-item.log-success[_ngcontent-%COMP%]{border-left-color:#48bb78;background:#f0fff4}.log-item.log-error[_ngcontent-%COMP%]{border-left-color:#f56565;background:#fff5f5}.log-item.log-warning[_ngcontent-%COMP%]{border-left-color:#ed8936;background:#fffaf0}.log-item[_ngcontent-%COMP%]   .log-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}.log-item[_ngcontent-%COMP%]   .log-header[_ngcontent-%COMP%]   .log-type[_ngcontent-%COMP%]{font-size:10px;font-weight:600;text-transform:uppercase;padding:2px 6px;border-radius:3px;background:#0000001a}.log-item[_ngcontent-%COMP%]   .log-header[_ngcontent-%COMP%]   .timestamp[_ngcontent-%COMP%]{font-size:10px;color:#666;font-family:monospace}.log-item[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{font-size:12px;color:#333;margin-bottom:4px}.log-item[_ngcontent-%COMP%]   .log-data[_ngcontent-%COMP%]{font-family:Monaco,Courier New,monospace;font-size:10px;color:#555;background:#0000000d;padding:6px;border-radius:4px;margin:0;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word}.provider-badge[_ngcontent-%COMP%]{display:inline-block;padding:2px 8px;font-size:10px;font-weight:600;text-transform:uppercase;border-radius:3px;background:#4285f4;color:#fff;margin:0 8px}.value.error[_ngcontent-%COMP%]{color:#ea4335;font-weight:600}.action-btn[_ngcontent-%COMP%]{padding:8px 12px;background:#4285f4;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:12px;font-weight:500;margin-right:8px;transition:background .2s}.action-btn[_ngcontent-%COMP%]:hover{background:#3367d6}.action-btn[_ngcontent-%COMP%]:active{background:#2451b7}.action-btn.danger[_ngcontent-%COMP%]{background:#ea4335}.action-btn.danger[_ngcontent-%COMP%]:hover{background:#d33426}.action-btn.danger[_ngcontent-%COMP%]:active{background:#b72818}`]})};function nd(r,t){r&1&&(o(0,"p",14),c(1,"\uC678\uBD80 \uB85C\uADF8\uC778 \uD398\uC774\uC9C0\uB85C \uC774\uB3D9\uD569\uB2C8\uB2E4"),a())}function id(r,t){r&1&&(o(0,"p",14),c(1,"\uB85C\uADF8\uC778 \uCC3D\uC774 \uC5F4\uB9BD\uB2C8\uB2E4"),a())}var ti=class r{constructor(t,e,n,i){this.authService=t;this.navigationHistory=e;this.router=n;this.androidBridge=i}isAndroid=!1;ngOnInit(){if(this.isAndroid=this.androidBridge.isAndroid(),console.log("\u{1F4F1} Android \uD658\uACBD:",this.isAndroid),this.authService.isAuthenticated()){this.router.navigate(["/ezm/home"]);return}}onBack(){this.navigationHistory.goBack("/ezm/home")}onGoogleLogin(){console.log("\u{1F510} Google \uB85C\uADF8\uC778 \uC2DC\uC791 - \uC678\uBD80 URL\uB85C \uC774\uB3D9"),this.authService.startGoogleLogin()}static \u0275fac=function(e){return new(e||r)(V(Ce),V(Fe),V(N),V(Ae))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-login"]],standalone:!1,decls:21,vars:2,consts:[[1,"header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"header-spacer"],[1,"main-content"],[1,"logo-section"],[1,"logo-container"],[1,"logo-icon"],["src","./images/logo-ezreader@3x.png","alt","EZ Reader","height","48"],[1,"app-description"],[1,"login-form-section"],["type","button",1,"google-login-btn",3,"click"],[1,"google-icon"],["class","google-login-note",4,"ngIf"],[1,"google-login-note"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"button",1),u("click",function(){return n.onBack()}),h(2,"img",2),a(),o(3,"h2"),c(4,"\uB85C\uADF8\uC778"),a(),h(5,"div",3),a(),o(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),h(10,"img",8),a(),o(11,"p",9),c(12,"\uB85C\uADF8\uC778\uD558\uC5EC \uC2DC\uC791\uD558\uC138\uC694"),a()()(),o(13,"div",10)(14,"button",11),u("click",function(){return n.onGoogleLogin()}),o(15,"span",12),c(16,"\u{1F535}"),a(),o(17,"span"),c(18,"Google\uB85C \uB85C\uADF8\uC778"),a()(),b(19,nd,2,0,"p",13)(20,id,2,0,"p",13),a()()),e&2&&(l(19),p("ngIf",!n.isAndroid),l(),p("ngIf",n.isAndroid))},dependencies:[B],styles:['.header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;padding-top:calc(16px + var(--android-status-bar-height, 0px));background:#fff;border-bottom:1px solid #f0f0f0;position:sticky;top:0;z-index:100}.header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#333;display:flex;align-items:center;justify-content:center}.header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{opacity:.7}.header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0}.header[_ngcontent-%COMP%]   .header-spacer[_ngcontent-%COMP%]{width:40px}.main-content[_ngcontent-%COMP%]{min-height:calc(100vh - 56px - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));display:flex;flex-direction:column;justify-content:center;padding:40px 20px;max-width:400px;margin:0 auto;background:linear-gradient(135deg,#f5f7fa,#c3cfe2)}.logo-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:48px}.logo-section[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]   .logo-icon[_ngcontent-%COMP%]{margin-bottom:24px}.logo-section[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]   .logo-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:48px;width:auto;object-fit:contain;filter:drop-shadow(0 2px 8px rgba(0,0,0,.1))}.logo-section[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#2c3e50;margin:0 0 8px;letter-spacing:-.5px}.logo-section[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]   .app-description[_ngcontent-%COMP%]{font-size:15px;color:#7f8c8d;margin:0;font-weight:400}.error-message[_ngcontent-%COMP%]{background:#fff5f5;border:2px solid #fc8181;border-radius:12px;padding:14px 18px;margin-bottom:24px;display:flex;align-items:center;gap:10px;color:#c53030;font-size:14px;font-weight:500;box-shadow:0 2px 8px #fc818133;animation:_ngcontent-%COMP%_shake .4s ease}.error-message[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:20px;flex-shrink:0}.error-message[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{flex:1}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}25%{transform:translate(-8px)}75%{transform:translate(8px)}}.login-form-section[_ngcontent-%COMP%]{background:#fff;padding:32px 24px;border-radius:16px;box-shadow:0 8px 32px #0000001a;margin-bottom:0}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:24px}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:10px;font-size:14px;font-weight:600;color:#2c3e50}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]   .label-icon[_ngcontent-%COMP%]{font-size:18px}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]   .label-text[_ngcontent-%COMP%]{flex:1}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:100%;padding:16px;border:2px solid #e8ecef;border-radius:12px;font-size:16px;transition:all .3s ease;box-sizing:border-box;background:#f8f9fa}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4a90e2;background:#fff;box-shadow:0 0 0 4px #4a90e21a}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:disabled{background:#e9ecef;cursor:not-allowed;opacity:.6}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]::placeholder{color:#adb5bd}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]{position:relative}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding-right:50px}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;padding:8px;cursor:pointer;font-size:20px;display:flex;align-items:center;justify-content:center;transition:transform .2s}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-50%) scale(1.1)}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(-50%) scale(.95)}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .toggle-password-btn[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.3}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-btn[_ngcontent-%COMP%]{width:100%;padding:18px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;font-size:17px;font-weight:700;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 16px #667eea66;letter-spacing:.5px}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #667eea80}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-btn[_ngcontent-%COMP%]:disabled{background:linear-gradient(135deg,#b8b8b8,#9a9a9a);cursor:not-allowed;box-shadow:none}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-btn.loading[_ngcontent-%COMP%]{background:linear-gradient(135deg,#999,#777);cursor:wait}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-btn[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-btn[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:18px;height:18px;border:3px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.login-divider[_ngcontent-%COMP%]{display:flex;align-items:center;margin:24px 0;padding:0 24px}.login-divider[_ngcontent-%COMP%]:before, .login-divider[_ngcontent-%COMP%]:after{content:"";flex:1;height:1px;background:linear-gradient(to right,transparent,#e2e8f0,transparent)}.login-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:0 16px;color:#a0aec0;font-size:13px;font-weight:500}.social-login-section[_ngcontent-%COMP%]{padding:0 24px 24px}.google-login-btn[_ngcontent-%COMP%]{width:100%;height:52px;display:flex;align-items:center;justify-content:center;gap:12px;background:#fff;border:2px solid #e2e8f0;border-radius:12px;cursor:pointer;transition:all .3s ease;font-size:15px;font-weight:600;color:#2d3748;box-shadow:0 2px 8px #0000000d}.google-login-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f7fafc;border-color:#cbd5e0;box-shadow:0 4px 12px #0000001a;transform:translateY(-1px)}.google-login-btn[_ngcontent-%COMP%]:active:not(:disabled){background:#edf2f7;transform:translateY(0)}.google-login-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.google-login-btn[_ngcontent-%COMP%]   .google-icon[_ngcontent-%COMP%]{width:20px;height:20px;flex-shrink:0}@media (max-width: 480px){.main-content[_ngcontent-%COMP%]{padding:24px 16px}.logo-section[_ngcontent-%COMP%]{margin-bottom:32px}.logo-section[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]   .logo-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px}.logo-section[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{font-size:24px}.logo-section[_ngcontent-%COMP%]   .logo-container[_ngcontent-%COMP%]   .app-description[_ngcontent-%COMP%]{font-size:14px}.login-form-section[_ngcontent-%COMP%]{padding:24px 20px}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:20px}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{padding:14px;font-size:15px}.login-form-section[_ngcontent-%COMP%]   .login-form[_ngcontent-%COMP%]   .login-btn[_ngcontent-%COMP%]{padding:16px;font-size:16px}}.login-footer[_ngcontent-%COMP%]{background:#f7fafc;padding:20px 30px;text-align:center;border-top:1px solid #e2e8f0}.login-footer[_ngcontent-%COMP%]   .footer-text[_ngcontent-%COMP%]{margin:0 0 4px;font-size:13px;color:#718096;font-weight:500}.login-footer[_ngcontent-%COMP%]   .footer-info[_ngcontent-%COMP%]{margin:0 0 12px;font-size:12px;color:#a0aec0}.login-footer[_ngcontent-%COMP%]   .version-info[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:1px solid #e2e8f0}.login-footer[_ngcontent-%COMP%]   .version-info[_ngcontent-%COMP%]   .version-text[_ngcontent-%COMP%]{margin:0 0 4px;font-size:11px;color:#667eea;font-weight:600;font-family:Monaco,Courier New,monospace}.login-footer[_ngcontent-%COMP%]   .version-info[_ngcontent-%COMP%]   .build-info[_ngcontent-%COMP%]{margin:0;font-size:10px;color:#a0aec0;font-style:italic}']})};var lt=class r{pdfjsLibService=P(Me);constructor(){}generatePdfThumbnailsOptimized(t,e){return C(this,null,function*(){if(!t){console.warn("\u26A0\uFE0F PDF \uC18C\uC2A4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}try{let n=yield this.pdfjsLibService.getDocument(t);for(let i=1;i<=n.numPages;i++)yield this.generateOptimizedThumbnail(n,i,e)}catch(n){throw console.error("\u274C PDF \uC378\uB124\uC77C \uC0DD\uC131 \uC2E4\uD328:",n),n}})}generateOptimizedThumbnail(t,e,n){return C(this,null,function*(){try{let i=yield t.getPage(e),s=yield this.extractNativeThumbnail(i);if(s){n&&n(e,s);return}let d=yield this.renderHighQualityThumbnail(i,e);d&&n&&n(e,d)}catch(i){console.error(`\u274C \uD398\uC774\uC9C0 ${e} \uC378\uB124\uC77C \uC0DD\uC131 \uC2E4\uD328:`,i)}})}extractNativeThumbnail(t){return C(this,null,function*(){try{let e=yield t.getOperatorList();if(e&&e.fnArray&&e.fnArray.length>0){for(let n=0;n<e.fnArray.length;n++)if(e.fnArray[n]===85){let d=e.argsArray[n][0];try{let _=t.objs,v=yield new Promise((w,M)=>{_.get(d,O=>{O?w(O):M(new Error("\uC774\uBBF8\uC9C0\uB97C \uAC00\uC838\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."))})});if(v){let w=document.createElement("canvas"),M=w.getContext("2d");if(M&&v.width&&v.height){w.width=v.width,w.height=v.height;let O=M.createImageData(w.width,w.height);return O.data.set(v.data),M.putImageData(O,0,0),w.toDataURL("image/jpeg",.7)}}}catch(_){console.warn(`\u26A0\uFE0F \uC774\uBBF8\uC9C0 ${d} \uCD94\uCD9C \uC2E4\uD328:`,_)}}}return null}catch(e){return console.warn("\u26A0\uFE0F \uB124\uC774\uD2F0\uBE0C \uC378\uB124\uC77C \uCD94\uCD9C \uC2E4\uD328:",e),null}})}renderHighQualityThumbnail(t,e){return C(this,null,function*(){try{let n=t.getViewport({scale:1}),i=200,s=Math.min(i/n.width,i/n.height),d=t.getViewport({scale:s}),_=document.createElement("canvas");_.width=d.width,_.height=d.height;let v=_.getContext("2d");if(!v)throw new Error("Canvas \uCEE8\uD14D\uC2A4\uD2B8\uB97C \uC0DD\uC131\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return yield t.render({canvas:_,canvasContext:v,viewport:d}).promise,_.toDataURL("image/jpeg",.7)}catch(n){return console.error(`\u274C \uD398\uC774\uC9C0 ${e} \uACE0\uD488\uC9C8 \uB80C\uB354\uB9C1 \uC2E4\uD328:`,n),null}})}generateSinglePageThumbnail(t,e,n){return C(this,null,function*(){try{let i=yield this.pdfjsLibService.getDocument(t);if(e<1||e>i.numPages)throw new Error(`\uD398\uC774\uC9C0 \uBC88\uD638\uAC00 \uBC94\uC704\uB97C \uBC97\uC5B4\uB0AC\uC2B5\uB2C8\uB2E4: ${e}`);yield this.generateOptimizedThumbnail(i,e,n)}catch(i){throw console.error(`\u274C \uD398\uC774\uC9C0 ${e} \uC378\uB124\uC77C \uC0DD\uC131 \uC2E4\uD328:`,i),i}})}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};function od(r,t){if(r&1&&(o(0,"p",11),c(1),a()),r&2){let e=g(2);l(),x(e.isFailed?e.failedSubtitle:e.subtitle)}}function rd(r,t){if(r&1){let e=y();re(0),h(1,"div",12),o(2,"button",13),u("click",function(){m(e);let i=g(2);return f(i.onNavigate())}),c(3),a(),ae()}if(r&2){let e=g(2);l(3),S(" ",e.buttonText," ")}}function ad(r,t){if(r&1){let e=y();re(0),h(1,"div",14),o(2,"button",15),u("click",function(){m(e);let i=g(2);return f(i.onRetry())}),c(3),a(),ae()}if(r&2){let e=g(2);l(3),S(" ",e.retryButtonText," ")}}function sd(r,t){if(r&1&&(o(0,"div",1)(1,"div",2)(2,"div",3),ve(),o(3,"svg",4),h(4,"path",5)(5,"path",6),a()(),Vt(),o(6,"div",7)(7,"h2",8),c(8),a(),b(9,od,2,1,"p",9),a(),b(10,rd,4,1,"ng-container",10)(11,ad,4,1,"ng-container",10),a()()),r&2){let e=g();l(8),x(e.isFailed?e.failedTitle:e.title),l(),p("ngIf",e.isFailed?e.failedSubtitle:e.subtitle),l(),p("ngIf",e.isComplete&&!e.isFailed),l(),p("ngIf",e.isFailed)}}var Ee=class r{isVisible=!1;isComplete=!1;isFailed=!1;title="\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.";subtitle="";buttonText="\uD30C\uC77C\uB85C \uC774\uB3D9";failedTitle="\uC791\uC5C5\uC5D0 \uC2E4\uD328\uD558\uC600\uC2B5\uB2C8\uB2E4";failedSubtitle="\uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694";retryButtonText="\uC7AC\uC2DC\uB3C4";navigate=new W;retry=new W;onNavigate(){this.navigate.emit()}onRetry(){this.retry.emit()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["app-processing-modal"]],inputs:{isVisible:"isVisible",isComplete:"isComplete",isFailed:"isFailed",title:"title",subtitle:"subtitle",buttonText:"buttonText",failedTitle:"failedTitle",failedSubtitle:"failedSubtitle",retryButtonText:"retryButtonText"},outputs:{navigate:"navigate",retry:"retry"},decls:1,vars:1,consts:[["class","modal-overlay",4,"ngIf"],[1,"modal-overlay"],[1,"modal-content"],[1,"file-icon"],["width","80","height","100","viewBox","0 0 80 100","fill","none"],["d","M10 0h40l20 20v70a10 10 0 0 1-10 10H10a10 10 0 0 1-10-10V10A10 10 0 0 1 10 0z","fill","#E0E0E0"],["d","M50 0v15a5 5 0 0 0 5 5h15L50 0z","fill","#BDBDBD"],[1,"message-container"],[1,"title"],["class","subtitle",4,"ngIf"],[4,"ngIf"],[1,"subtitle"],[1,"arrow-line"],[1,"action-button",3,"click"],[1,"arrow-line","failed"],[1,"action-button","retry",3,"click"]],template:function(e,n){e&1&&b(0,sd,12,4,"div",0),e&2&&p("ngIf",n.isVisible)},dependencies:[_e,B],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#f5f5f5;display:flex;align-items:center;justify-content:center;z-index:10000}.modal-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:40px 32px}.file-icon[_ngcontent-%COMP%]{margin-bottom:30px;animation:_ngcontent-%COMP%_iconFloat .6s ease-out both}@keyframes _ngcontent-%COMP%_iconFloat{0%{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}.message-container[_ngcontent-%COMP%]{text-align:center;animation:_ngcontent-%COMP%_fadeIn .5s ease-out .2s both}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.title[_ngcontent-%COMP%]{font-size:22px;font-weight:700;color:#212121;margin:0 0 12px;line-height:1.3}.subtitle[_ngcontent-%COMP%]{font-size:14px;color:#757575;margin:0;line-height:1.5}.arrow-line[_ngcontent-%COMP%]{width:2px;height:60px;background:linear-gradient(to bottom,#667eea,#764ba2);margin:30px 0 20px;animation:_ngcontent-%COMP%_arrowDraw .5s ease-out .3s both}.arrow-line.failed[_ngcontent-%COMP%]{background:linear-gradient(to bottom,#667eea,#764ba2)}@keyframes _ngcontent-%COMP%_arrowDraw{0%{height:0}to{height:60px}}.action-button[_ngcontent-%COMP%]{width:280px;height:52px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;font-size:16px;font-weight:600;border:none;border-radius:26px;cursor:pointer;box-shadow:0 6px 20px #667eea59;transition:all .3s ease;animation:_ngcontent-%COMP%_buttonAppear .5s ease-out .6s both}.action-button.retry[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.action-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 24px #667eea66}.action-button[_ngcontent-%COMP%]:active{transform:scale(.98)}@keyframes _ngcontent-%COMP%_buttonAppear{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}"]})};function ld(r,t){if(r&1&&h(0,"div",56),r&2){let e=g();q("left",e.getDropIndicatorLeft(),"px")("top",e.getDropIndicatorTop(),"px")("height",e.getDropIndicatorHeight(),"px")}}function cd(r,t){if(r&1){let e=y();o(0,"div",63),u("touchstart",function(i){m(e);let s=g().index,d=g();return f(d.onTouchStart(i,s))})("touchmove",function(i){m(e);let s=g(2);return f(s.onTouchMove(i))})("touchend",function(i){m(e);let s=g(2);return f(s.onTouchEnd(i))}),h(1,"img",64),a()}}function dd(r,t){r&1&&(o(0,"div",65),h(1,"img",66),a())}function pd(r,t){if(r&1){let e=y();o(0,"div",57),u("touchstart",function(i){let s=m(e).index,d=g();return f(d.onPageTouchStart(i,s))})("touchmove",function(i){m(e);let s=g();return f(s.onPageTouchMove(i))})("touchend",function(i){m(e);let s=g();return f(s.onPageTouchEnd(i))})("contextmenu",function(i){return m(e),f(i.preventDefault())}),b(1,cd,2,0,"div",58),o(2,"div",59),u("click",function(){let i=m(e).$implicit,s=g();return f(!s.isDragMode&&s.togglePageSelection(i))}),h(3,"img",60),b(4,dd,2,0,"div",61),o(5,"div",62),c(6),a()()()}if(r&2){let e=t.$implicit,n=t.index,i=g();k("selected",e.selected)("drag-mode",i.isDragMode&&e.selected)("dragging-source",i.isDragging&&i.draggingPageIndex===n),l(),p("ngIf",i.isDragMode&&e.selected),l(2),q("transform","rotate("+e.rotation+"deg)"),p("src",e.thumbnail,ce)("alt","\uD398\uC774\uC9C0 "+e.pageNumber),l(),p("ngIf",e.selected),l(2),x(e.pageNumber)}}var ni=class r{constructor(t){this.router=t;let e=this.router.getCurrentNavigation();e?.extras?.state&&(this.documentData=e.extras.state.document)}pages=[];documentData=null;sheetState="collapsed";completeSheetState="collapsed";addPageSheetState="collapsed";saveAsSheetState="collapsed";saveAsFileName="";isProcessing=!1;isComplete=!1;isFailed=!1;processingTitle="\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.";processingSubtitle="";savedDocId="";savedFolderId=null;newPageConfig={backgroundColor:"#FFFFFF",pageCount:1,insertAfterPage:0};selectedPages=[];clipboard=[];clipboardMode=null;history=[];historyIndex=-1;isDragging=!1;draggingPageIndex=-1;dropTargetIndex=-1;dropPosition="after";touchStartX=0;touchStartY=0;dragThreshold=10;hasMoved=!1;dragPreviewElement=null;isDragMode=!1;longPressTimer=null;longPressTouchIndex=-1;LONG_PRESS_DURATION=800;indexedDbService=P(ee);snackbar=P(G);cdr=P(fe);toolActionService=P(le);pdfjsLibService=P(Me);pdfThumbnailService=P(lt);ngOnInit(){return C(this,null,function*(){let t=this.toolActionService.getPendingAction();if(t&&t.data?.documentId){yield this.loadDocumentById(t.data.documentId),this.toolActionService.clearPendingAction();return}this.documentData?yield this.loadPdfPages():(this.snackbar.showWarning("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.goBack())})}loadDocumentById(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t);e?(this.documentData=e,yield this.loadPdfPages()):(this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin()}})}loadPdfPages(){return C(this,null,function*(){try{let t=this.getPdfSource(this.documentData),e=yield this.pdfjsLibService.getDocument(t);this.pages=[];for(let n=1;n<=e.numPages;n++){let i=yield e.getPage(n),s=i.getViewport({scale:.5}),d=s.width>s.height,_=document.createElement("canvas"),v=_.getContext("2d");_.width=s.width,_.height=s.height,yield i.render({canvas:_,canvasContext:v,viewport:s}).promise,this.pages.push({pageNumber:n,thumbnail:_.toDataURL(),selected:!1,rotation:0,isLandscape:d,originalPageNumber:n})}this.history=[JSON.parse(JSON.stringify(this.pages))],this.historyIndex=0}catch{this.snackbar.showError("PDF \uD398\uC774\uC9C0\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}getPdfSource(t){if(t.pdfBase64)return{url:t.pdfBase64.includes(",")?t.pdfBase64:`data:application/pdf;base64,${t.pdfBase64}`};if(t.originalPdfBase64)return{url:t.originalPdfBase64.includes(",")?t.originalPdfBase64:`data:application/pdf;base64,${t.originalPdfBase64}`};if(t.pdfSrc)return{url:t.pdfSrc};throw new Error("PDF \uC18C\uC2A4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}togglePageSelection(t){t.selected=!t.selected,this.updateSelectedPages()}selectAllPages(){let t=this.pages.every(e=>e.selected);this.pages.forEach(e=>e.selected=!t),this.updateSelectedPages()}updateSelectedPages(){this.selectedPages=this.pages.filter(t=>t.selected).map(t=>t.pageNumber)}addPage(){this.addPageSheetState="full"}closeAddPageSheet(){this.addPageSheetState="collapsed",this.newPageConfig={backgroundColor:"#FFFFFF",pageCount:1,insertAfterPage:0}}onAddPageSheetStateChange(t){this.addPageSheetState=t}confirmAddPage(){return C(this,null,function*(){try{this.snackbar.showInfo("\uD398\uC774\uC9C0\uB97C \uC0DD\uC131 \uC911...");let t=window.PDFLib;if(!t)throw new Error("PDF \uB77C\uC774\uBE0C\uB7EC\uB9AC\uAC00 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");let e=this.hexToRgb(this.newPageConfig.backgroundColor),n=this.pages.length,i=yield t.PDFDocument.create();i.addPage([595,842]).drawRectangle({x:0,y:0,width:595,height:842,color:t.rgb(e.r/255,e.g/255,e.b/255)});let d=yield i.save(),_=new Blob([d],{type:"application/pdf"}),v=URL.createObjectURL(_),M=yield(yield this.pdfjsLibService.getDocument(v)).getPage(1),O=M.getViewport({scale:.5}),E=document.createElement("canvas"),D=E.getContext("2d");E.width=O.width,E.height=O.height,yield M.render({canvas:E,canvasContext:D,viewport:O}).promise;let T=E.toDataURL();URL.revokeObjectURL(v);let I={pageNumber:n+1,thumbnail:T,selected:!1,rotation:0,isLandscape:!1,originalPageNumber:-1,backgroundColor:this.newPageConfig.backgroundColor};this.pages.push(I),this.pages.forEach((z,A)=>{z.pageNumber=A+1}),this.snackbar.showSuccess("\uD398\uC774\uC9C0\uB97C \uCD94\uAC00\uD588\uC2B5\uB2C8\uB2E4."),this.closeAddPageSheet()}catch{this.snackbar.showError("\uD398\uC774\uC9C0 \uCD94\uAC00\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}hexToRgb(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:255,g:255,b:255}}openBottomSheet(){this.sheetState="full",this.cdr.detectChanges()}openCompleteSheet(){this.completeSheetState="full"}closeCompleteSheet(){this.completeSheetState="collapsed"}onCompleteSheetStateChange(t){this.completeSheetState=t}onCompleteAction(t){switch(this.completeSheetState="collapsed",t){case"save":this.saveDocument(!1);break;case"save-as":this.openSaveAsSheet();break;case"discard":this.discardChanges();break;case"cancel":break}}openSaveAsSheet(){let e=(this.documentData.title||this.documentData.fileName||"\uBB38\uC11C").replace(/\.pdf$/i,"");this.saveAsFileName=e,this.saveAsSheetState="full"}closeSaveAsSheet(){this.saveAsSheetState="collapsed",this.saveAsFileName=""}onSaveAsSheetStateChange(t){this.saveAsSheetState=t}confirmSaveAs(){if(!this.saveAsFileName.trim()){this.snackbar.showWarning("\uD30C\uC77C\uBA85\uC744 \uC785\uB825\uD558\uC138\uC694.");return}this.saveAsSheetState="collapsed",this.saveDocument(!0,this.saveAsFileName.trim())}saveDocument(t,e){return C(this,null,function*(){if(this.pages.length===0){this.snackbar.showWarning("\uD398\uC774\uC9C0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}try{this.snackbar.showInfo("PDF \uAD6C\uC131 \uC911...");let n=window.PDFLib;if(!n)throw new Error("PDF \uB77C\uC774\uBE0C\uB7EC\uB9AC\uAC00 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");let i=yield n.PDFDocument.create(),s=this.getPdfSource(this.documentData),_=yield(yield this.pdfjsLibService.getDocument(s)).getData(),v=yield n.PDFDocument.load(_);for(let A of this.pages){let Y;if(A.originalPageNumber===-1){if(Y=i.addPage([595,842]),A.backgroundColor){let Q=this.hexToRgb(A.backgroundColor);Y.drawRectangle({x:0,y:0,width:595,height:842,color:n.rgb(Q.r/255,Q.g/255,Q.b/255)})}}else[Y]=yield i.copyPages(v,[A.originalPageNumber-1]),i.addPage(Y);A.rotation!==0&&Y.setRotation(n.degrees(A.rotation))}let w=yield i.save(),M=new Blob([w],{type:"application/pdf"}),E=`data:application/pdf;base64,${yield this.blobToBase64(M)}`,D=null;try{let A=URL.createObjectURL(M),Q=yield(yield this.pdfjsLibService.getDocument(A)).getPage(1);D=yield this.pdfThumbnailService.renderHighQualityThumbnail(Q,1),URL.revokeObjectURL(A)}catch(A){console.warn("\uC378\uB124\uC77C \uC0DD\uC131 \uC2E4\uD328:",A)}let T,I;t?(T=`organized-${Date.now()}`,e?I=e.endsWith(".pdf")?e:`${e}.pdf`:I=`${(this.documentData.title||this.documentData.fileName).replace(/\.pdf$/i,"")}(\uBCF5\uC0AC).pdf`):(T=this.documentData.id,I=this.documentData.fileName||this.documentData.title);let z={id:T,title:I.replace(/\.pdf$/i,""),fileName:I,pdfBase64:E,originalPdfBase64:E,thumbnail:D||"",pages:[],elementCount:0,createdAt:this.documentData.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString(),version:"1.0",documentType:"viewer",pageCount:this.pages.length,folderId:this.documentData.folderId||null};yield this.indexedDbService.saveDocument(z),this.savedDocId=T,this.savedFolderId=this.documentData.folderId||null,this.isProcessing=!0,setTimeout(()=>{let A=t?"PDF \uAD6C\uC131\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.":"\uBB38\uC11C\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.";this.processingTitle=A,this.processingSubtitle=`${this.pages.length}\uAC1C \uD398\uC774\uC9C0\uB85C \uAD6C\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,this.isComplete=!0},1e3)}catch{this.isFailed=!0,this.isProcessing=!0}})}discardChanges(){this.toolActionService.navigateToOrigin()}goBack(){this.router.navigate(["/ezm/home"])}onNavigateToFile(){this.savedDocId?this.router.navigate(["/ezm/viewer"],{queryParams:{docId:this.savedDocId}}):this.savedFolderId?this.router.navigate(["/ezm/myfiles",this.savedFolderId]):this.router.navigate(["/ezm/myfiles","my-files"])}onRetry(){this.isFailed=!1,this.isProcessing=!1,this.isComplete=!1}onMenuAction(t){switch(t!=="select-all"&&(this.sheetState="collapsed"),t){case"select-all":this.selectAllPages();break;case"cut":this.cutPages();break;case"copy":this.copyPages();break;case"paste":this.pastePages();break;case"paste-into":this.pasteIntoPages();break;case"undo":this.undo();break;case"redo":this.redo();break}}saveHistory(){this.historyIndex<this.history.length-1&&(this.history=this.history.slice(0,this.historyIndex+1)),this.history.push(JSON.parse(JSON.stringify(this.pages))),this.historyIndex++,this.history.length>50&&(this.history.shift(),this.historyIndex--)}cutPages(){if(this.selectedPages.length===0){this.snackbar.showWarning("\uC798\uB77C\uB0BC \uD398\uC774\uC9C0\uB97C \uC120\uD0DD\uD558\uC138\uC694.");return}this.saveHistory(),this.clipboard=this.pages.filter(t=>t.selected).map(t=>Z(K({},t),{selected:!1})),this.clipboardMode="cut",this.pages=this.pages.filter(t=>!t.selected),this.renumberPages(),this.selectedPages=[],this.snackbar.showSuccess(`${this.clipboard.length}\uAC1C \uD398\uC774\uC9C0\uB97C \uC798\uB77C\uB0C8\uC2B5\uB2C8\uB2E4.`)}copyPages(){if(this.selectedPages.length===0){this.snackbar.showWarning("\uBCF5\uC0AC\uD560 \uD398\uC774\uC9C0\uB97C \uC120\uD0DD\uD558\uC138\uC694.");return}this.clipboard=this.pages.filter(t=>t.selected).map(t=>Z(K({},t),{selected:!1})),this.clipboardMode="copy",this.snackbar.showSuccess(`${this.clipboard.length}\uAC1C \uD398\uC774\uC9C0\uB97C \uBCF5\uC0AC\uD588\uC2B5\uB2C8\uB2E4.`)}pastePages(){if(this.clipboard.length===0){this.snackbar.showWarning("\uBD99\uC5EC\uB123\uC744 \uD398\uC774\uC9C0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.saveHistory();let t=this.clipboard.map(e=>K({},e));this.pages.push(...t),this.renumberPages(),this.clipboardMode==="cut"&&(this.clipboard=[],this.clipboardMode=null),this.snackbar.showSuccess(`${t.length}\uAC1C \uD398\uC774\uC9C0\uB97C \uBD99\uC5EC\uB123\uC5C8\uC2B5\uB2C8\uB2E4.`)}pasteIntoPages(){if(this.clipboard.length===0){this.snackbar.showWarning("\uBD99\uC5EC\uB123\uC744 \uD398\uC774\uC9C0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if(this.selectedPages.length===0){this.snackbar.showWarning("\uBD99\uC5EC\uB123\uC744 \uC704\uCE58\uB97C \uC120\uD0DD\uD558\uC138\uC694.");return}this.saveHistory();let t=this.pages.findIndex(n=>n.selected),e=this.clipboard.map(n=>Z(K({},n),{selected:!1}));this.pages.splice(t+1,0,...e),this.renumberPages(),this.clipboardMode==="cut"&&(this.clipboard=[],this.clipboardMode=null),this.snackbar.showSuccess(`${e.length}\uAC1C \uD398\uC774\uC9C0\uB97C \uC0BD\uC785\uD588\uC2B5\uB2C8\uB2E4.`)}renumberPages(){this.pages.forEach((t,e)=>{t.pageNumber=e+1})}canUndo(){return this.historyIndex>0}canRedo(){return this.historyIndex<this.history.length-1}undo(){if(!this.canUndo()){this.snackbar.showWarning("\uC2E4\uD589 \uCDE8\uC18C\uD560 \uB0B4\uC5ED\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.historyIndex--,this.pages=JSON.parse(JSON.stringify(this.history[this.historyIndex])),this.updateSelectedPages(),this.snackbar.showSuccess("\uC2E4\uD589 \uCDE8\uC18C\uD588\uC2B5\uB2C8\uB2E4.")}redo(){if(!this.canRedo()){this.snackbar.showWarning("\uC2E4\uD589 \uBCF5\uAD6C\uD560 \uB0B4\uC5ED\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.historyIndex++,this.pages=JSON.parse(JSON.stringify(this.history[this.historyIndex])),this.updateSelectedPages(),this.snackbar.showSuccess("\uC2E4\uD589 \uBCF5\uAD6C\uD588\uC2B5\uB2C8\uB2E4.")}blobToBase64(t){return new Promise((e,n)=>{let i=new FileReader;i.onloadend=()=>{let s=i.result.split(",")[1];e(s)},i.onerror=n,i.readAsDataURL(t)})}closeBottomSheet(){this.sheetState="collapsed"}onSheetStateChange(t){this.sheetState=t}onPageTouchStart(t,e){this.touchStartX=t.touches[0].clientX,this.touchStartY=t.touches[0].clientY,this.longPressTouchIndex=e,this.hasMoved=!1,this.longPressTimer=setTimeout(()=>{this.hasMoved||this.activateDragMode(e)},this.LONG_PRESS_DURATION)}onPageTouchMove(t){let e=t.touches[0].clientX,n=t.touches[0].clientY,i=Math.abs(e-this.touchStartX),s=Math.abs(n-this.touchStartY);(i>this.dragThreshold||s>this.dragThreshold)&&(this.isDragging||(this.hasMoved=!0,this.cancelLongPress())),this.isDragging&&(t.preventDefault(),this.updateDragPreview(e,n),this.updateDropTarget(e,n))}onPageTouchEnd(t){this.cancelLongPress(),this.isDragging&&this.dropTargetIndex!==-1&&this.performMultiDrop(),this.resetDragState()}resetDragState(){this.isDragging=!1,this.draggingPageIndex=-1,this.dropTargetIndex=-1,this.hasMoved=!1,this.longPressTouchIndex=-1,this.removeDragPreview(),this.cdr.detectChanges()}cancelLongPress(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null)}activateDragMode(t){navigator.vibrate&&navigator.vibrate(50);let e=this.pages[t];e.selected||(e.selected=!0,this.updateSelectedPages()),this.isDragMode=!0,this.draggingPageIndex=t,this.isDragging=!0,this.createMultiDragPreview(t),this.cdr.detectChanges()}deactivateDragMode(){this.isDragMode=!1,this.isDragging=!1,this.draggingPageIndex=-1,this.dropTargetIndex=-1,this.removeDragPreview(),this.cdr.detectChanges()}onContainerClick(t){let e=t.target;(e.classList.contains("pages-grid")||e.classList.contains("main-content"))&&this.isDragMode&&this.deactivateDragMode()}onTouchStart(t,e){this.isDragMode&&(this.draggingPageIndex=e,this.touchStartX=t.touches[0].clientX,this.touchStartY=t.touches[0].clientY,this.hasMoved=!1)}onTouchMove(t){if(!this.isDragMode||this.draggingPageIndex===-1)return;let e=t.touches[0].clientX,n=t.touches[0].clientY,i=Math.abs(e-this.touchStartX),s=Math.abs(n-this.touchStartY);!this.hasMoved&&(i>this.dragThreshold||s>this.dragThreshold)&&(this.hasMoved=!0,this.isDragging=!0,this.createMultiDragPreview(this.draggingPageIndex),t.preventDefault()),this.isDragging&&(t.preventDefault(),this.updateDragPreview(e,n),this.updateDropTarget(e,n))}onTouchEnd(t){this.isDragging&&this.dropTargetIndex!==-1&&this.performMultiDrop(),this.resetDragState()}createDragPreview(t){let e=t.target.closest(".page-item");if(!e)return;this.dragPreviewElement=e.cloneNode(!0),this.dragPreviewElement.classList.add("drag-preview"),this.dragPreviewElement.style.position="fixed",this.dragPreviewElement.style.pointerEvents="none",this.dragPreviewElement.style.zIndex="1000",this.dragPreviewElement.style.width=e.offsetWidth+"px",this.dragPreviewElement.style.height=e.offsetHeight+"px";let n=t.touches[0];this.dragPreviewElement.style.left=n.clientX-e.offsetWidth/2+"px",this.dragPreviewElement.style.top=n.clientY-e.offsetHeight/2+"px",document.body.appendChild(this.dragPreviewElement)}createMultiDragPreview(t){let n=document.querySelectorAll(".page-item")[t];if(!n)return;let i=this.selectedPages.length;this.dragPreviewElement=n.cloneNode(!0),this.dragPreviewElement.classList.add("drag-preview"),this.dragPreviewElement.classList.remove("selected","drag-mode","dragging-source"),this.dragPreviewElement.style.position="fixed",this.dragPreviewElement.style.pointerEvents="none",this.dragPreviewElement.style.zIndex="1000",this.dragPreviewElement.style.width=n.offsetWidth+"px",this.dragPreviewElement.style.height=n.offsetHeight+"px",this.dragPreviewElement.style.left=this.touchStartX-n.offsetWidth/2+"px",this.dragPreviewElement.style.top=this.touchStartY-n.offsetHeight/2+"px";let s=this.dragPreviewElement.querySelector(".selection-overlay");s&&s.remove();let d=this.dragPreviewElement.querySelector(".drag-handle");if(d&&d.remove(),i>1){let _=document.createElement("div");_.className="multi-drag-badge",_.textContent=i.toString(),_.style.cssText=`
        position: absolute;
        top: -8px;
        right: -8px;
        width: 24px;
        height: 24px;
        background: #F44336;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        z-index: 10;
      `,this.dragPreviewElement.appendChild(_)}document.body.appendChild(this.dragPreviewElement)}updateDragPreview(t,e){if(!this.dragPreviewElement)return;let n=parseInt(this.dragPreviewElement.style.width),i=parseInt(this.dragPreviewElement.style.height);this.dragPreviewElement.style.left=t-n/2+"px",this.dragPreviewElement.style.top=e-i/2+"px"}updateDropTarget(t,e){let n=document.querySelector(".pages-grid");if(!n)return;let i=n.getBoundingClientRect(),s=t-i.left,d=e-i.top;if(s<0||s>i.width||d<0||d>i.height){this.dropTargetIndex=-1,this.cdr.detectChanges();return}let _=12,v=(i.width-_*2)/3,w=v,M=Math.floor(s/(v+_)),O=Math.floor(d/(w+_)),E=Math.min(O*3+M,this.pages.length-1),D=this.pages[E];if(D&&D.selected){this.dropTargetIndex=-1,this.cdr.detectChanges();return}let T=M*(v+_),z=s-T<v/2;this.dropTargetIndex=E,this.draggingPageIndex<E?this.dropPosition=z?"before":"after":this.dropPosition=z?"before":"after",this.cdr.detectChanges()}performMultiDrop(){if(this.dropTargetIndex===-1)return;let t=this.pages.map((i,s)=>i.selected?s:-1).filter(i=>i!==-1).sort((i,s)=>s-i);if(t.length===0)return;let e=t.slice().sort((i,s)=>i-s).map(i=>this.pages[i]),n=this.dropTargetIndex;this.dropPosition==="after"&&n++,t.forEach(i=>{this.pages.splice(i,1),i<n&&n--}),this.pages.splice(n,0,...e),this.pages.forEach((i,s)=>{i.pageNumber=s+1}),this.isDragMode=!1,this.pages.forEach(i=>i.selected=!1),this.updateSelectedPages(),this.snackbar.showSuccess(`${e.length}\uAC1C \uD398\uC774\uC9C0\uAC00 \uC774\uB3D9\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}performDrop(){if(this.draggingPageIndex===-1||this.dropTargetIndex===-1)return;let t=this.draggingPageIndex,e=this.dropTargetIndex;if(this.dropPosition==="after"&&e++,t===e||t+1===e)return;let[n]=this.pages.splice(t,1);t<e&&e--,this.pages.splice(e,0,n),this.pages.forEach((i,s)=>{i.pageNumber=s+1}),this.snackbar.showInfo("\uD398\uC774\uC9C0 \uC21C\uC11C\uAC00 \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}removeDragPreview(){this.dragPreviewElement&&this.dragPreviewElement.parentNode&&this.dragPreviewElement.parentNode.removeChild(this.dragPreviewElement),this.dragPreviewElement=null,document.querySelectorAll(".drag-preview").forEach(e=>e.remove())}getDropIndicatorLeft(){if(this.dropTargetIndex===-1)return 0;let t=document.querySelector(".pages-grid");if(!t)return 0;let e=t.getBoundingClientRect(),n=12,i=(e.width-n*2)/3,s=this.dropTargetIndex%3;return this.dropPosition==="before"?s*(i+n)-6:s*(i+n)+i+6}getDropIndicatorTop(){if(this.dropTargetIndex===-1)return 0;let t=document.querySelector(".pages-grid");if(!t)return 0;let e=t.querySelectorAll(".page-item");if(e.length===0)return 0;let n=Math.floor(this.dropTargetIndex/3),s=e[0].offsetHeight;return n*(s+12)}getDropIndicatorHeight(){let t=document.querySelector(".pages-grid");if(!t)return 100;let e=t.querySelectorAll(".page-item");return e.length===0?100:e[0].offsetHeight}rotatePages(t){if(this.selectedPages.length===0){this.snackbar.showWarning("\uD68C\uC804\uD560 \uD398\uC774\uC9C0\uB97C \uC120\uD0DD\uD558\uC138\uC694.");return}this.saveHistory(),this.pages.forEach(e=>{e.selected&&(e.rotation=(e.rotation+t+360)%360)}),this.snackbar.showSuccess(`${this.selectedPages.length}\uAC1C \uD398\uC774\uC9C0\uB97C ${t>0?"\uC624\uB978\uCABD":"\uC67C\uCABD"}\uC73C\uB85C \uD68C\uC804\uD588\uC2B5\uB2C8\uB2E4.`)}deletePages(){if(this.selectedPages.length===0){this.snackbar.showWarning("\uC0AD\uC81C\uD560 \uD398\uC774\uC9C0\uB97C \uC120\uD0DD\uD558\uC138\uC694.");return}if(this.selectedPages.length===this.pages.length){this.snackbar.showWarning("\uBAA8\uB4E0 \uD398\uC774\uC9C0\uB97C \uC0AD\uC81C\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.saveHistory(),this.pages=this.pages.filter(t=>!t.selected),this.renumberPages(),this.selectedPages=[],this.snackbar.showSuccess("\uC120\uD0DD\uD55C \uD398\uC774\uC9C0\uB97C \uC0AD\uC81C\uD588\uC2B5\uB2C8\uB2E4.")}duplicatePages(){if(this.selectedPages.length===0){this.snackbar.showWarning("\uBCF5\uC81C\uD560 \uD398\uC774\uC9C0\uB97C \uC120\uD0DD\uD558\uC138\uC694.");return}this.saveHistory();let t=[];this.pages.forEach(e=>{e.selected&&t.push(Z(K({},e),{pageNumber:0,selected:!1}))}),this.pages.push(...t),this.renumberPages(),this.pages.forEach(e=>e.selected=!1),this.selectedPages=[],this.snackbar.showSuccess(`${t.length}\uAC1C \uD398\uC774\uC9C0\uB97C \uBCF5\uC81C\uD588\uC2B5\uB2C8\uB2E4.`)}static \u0275fac=function(e){return new(e||r)(V(N))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-organize"]],standalone:!1,decls:155,vars:37,consts:[["pagesGrid",""],[3,"navigate","retry","isVisible","isComplete","isFailed","title","subtitle"],[1,"header"],[1,"header-left"],["title","\uD398\uC774\uC9C0 \uCD94\uAC00",1,"icon-btn",3,"click"],["src","images/icons/btn-top-add.svg","alt","\uD398\uC774\uC9C0 \uCD94\uAC00","width","22","height","22"],["title","\uC120\uD0DD \uC0AD\uC81C",1,"icon-btn",3,"click","disabled"],["src","images/icons/ico-tool-cut.svg","alt","\uC120\uD0DD \uC0AD\uC81C","width","22","height","22"],["title","\uC120\uD0DD \uBCF5\uC81C",1,"icon-btn",3,"click","disabled"],["src","images/icons/ico-tool-copy.svg","alt","\uC120\uD0DD \uBCF5\uC81C","width","22","height","22"],["title","\uC120\uD0DD \uD68C\uC804",1,"icon-btn",3,"click","disabled"],["src","images/icons/ico-rotation.svg","alt","\uC120\uD0DD \uD68C\uC804","width","22","height","22"],[1,"header-right"],["title","\uB354\uBCF4\uAE30",1,"icon-btn",3,"click"],["src","images/icons/btn-top-more.svg","alt","\uB354\uBCF4\uAE30","width","22","height","22"],["title","\uC644\uB8CC",1,"icon-btn",3,"click"],["src","images/icons/ico-complete.svg","alt","\uC644\uB8CC","width","22","height","22"],[1,"main-content",3,"click"],[1,"pages-container"],["class","drop-indicator",3,"left","top","height",4,"ngIf"],[1,"pages-grid"],["class","page-item",3,"selected","drag-mode","dragging-source","touchstart","touchmove","touchend","contextmenu",4,"ngFor","ngForOf"],[3,"sheetStateChange","close","sheetState"],[1,"bottom-sheet-header"],[1,"bottom-sheet-title"],[1,"bottom-sheet-content"],[1,"option-list"],[1,"option-item",3,"click"],[1,"option-icon"],["src","images/icons/ico-tool-pageall.svg","alt","\uBAA8\uB4E0 \uD398\uC774\uC9C0 \uC120\uD0DD","width","24","height","24"],[1,"option-text"],[1,"option-label"],[1,"option-desc"],["src","images/icons/ico-tool-cut.svg","alt","\uD398\uC774\uC9C0 \uC798\uB77C\uB0B4\uAE30","width","24","height","24"],["src","images/icons/ico-tool-copy.svg","alt","\uD398\uC774\uC9C0 \uBCF5\uC0AC","width","24","height","24"],["src","images/icons/ico-tool-paste.svg","alt","\uD398\uC774\uC9C0 \uBD99\uC5EC\uB123\uAE30","width","24","height","24"],["src","images/icons/ico-tool-lastpaste.svg","alt","\uD398\uC774\uC9C0 \uBD99\uC544\uAE30","width","24","height","24"],["src","images/icons/btn-view-prev.svg","alt","\uC2E4\uD589\uCDE8\uC18C","width","24","height","24"],["src","images/icons/btn-view-next.svg","alt","\uC2E4\uD589\uBCF5\uAD6C","width","24","height","24"],["src","images/icons/ico-tool-save.svg","alt","\uC800\uC7A5","width","24","height","24"],["src","images/icons/ico-tool-saveother.svg","alt","\uB2E4\uB978 \uC774\uB984\uC73C\uB85C \uC800\uC7A5","width","24","height","24"],["src","images/icons/ico-tool-ignoring.svg","alt","\uBCC0\uACBD\uC0AC\uD56D \uBB34\uC2DC","width","24","height","24"],["src","images/icons/ico-tool-cancel.svg","alt","\uCDE8\uC18C","width","24","height","24"],[1,"close-btn",3,"click"],["src","images/icons/ico-close.svg","alt","\uB2EB\uAE30","width","24","height","24"],[1,"bottom-sheet-content","add-page-content"],[1,"setting-group"],[1,"setting-label"],[1,"color-picker-wrapper"],["type","color","id","pageColorPicker",1,"color-input",3,"ngModelChange","ngModel"],["for","pageColorPicker",1,"color-display"],[1,"color-preview"],[1,"color-hex"],[1,"confirm-btn",3,"click"],["type","text","placeholder","\uD30C\uC77C\uBA85\uC744 \uC785\uB825\uD558\uC138\uC694",1,"file-name-input",3,"ngModelChange","ngModel"],[1,"setting-hint"],[1,"drop-indicator"],[1,"page-item",3,"touchstart","touchmove","touchend","contextmenu"],["class","drag-handle",3,"touchstart","touchmove","touchend",4,"ngIf"],[1,"page-thumbnail",3,"click"],[3,"src","alt"],["class","selection-overlay",4,"ngIf"],[1,"page-number-overlay"],[1,"drag-handle",3,"touchstart","touchmove","touchend"],["src","images/icons/btn-top-view.svg","alt","\uB4DC\uB798\uADF8","width","16","height","16"],[1,"selection-overlay"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","32","height","32"]],template:function(e,n){if(e&1){let i=y();o(0,"app-processing-modal",1),u("navigate",function(){return m(i),f(n.onNavigateToFile())})("retry",function(){return m(i),f(n.onRetry())}),a(),o(1,"div",2)(2,"div",3)(3,"button",4),u("click",function(){return m(i),f(n.addPage())}),h(4,"img",5),a(),o(5,"button",6),u("click",function(){return m(i),f(n.deletePages())}),h(6,"img",7),a(),o(7,"button",8),u("click",function(){return m(i),f(n.duplicatePages())}),h(8,"img",9),a(),o(9,"button",10),u("click",function(){return m(i),f(n.rotatePages(90))}),h(10,"img",11),a()(),o(11,"div",12)(12,"button",13),u("click",function(){return m(i),f(n.openBottomSheet())}),h(13,"img",14),a(),o(14,"button",15),u("click",function(){return m(i),f(n.openCompleteSheet())}),h(15,"img",16),a()()(),o(16,"div",17),u("click",function(d){return m(i),f(n.onContainerClick(d))}),o(17,"div",18),b(18,ld,1,6,"div",19),o(19,"div",20,0),b(21,pd,7,13,"div",21),a()()(),o(22,"app-bottom-sheet",22),u("sheetStateChange",function(d){return m(i),f(n.onSheetStateChange(d))})("close",function(){return m(i),f(n.closeBottomSheet())}),o(23,"div",23)(24,"h3",24),c(25,"\uB354\uBCF4\uAE30"),a()(),o(26,"div",25)(27,"div",26)(28,"button",27),u("click",function(){return m(i),f(n.onMenuAction("select-all"))}),o(29,"div",28),h(30,"img",29),a(),o(31,"div",30)(32,"span",31),c(33,"\uBAA8\uB4E0 \uD398\uC774\uC9C0 \uC120\uD0DD"),a(),o(34,"span",32),c(35,"\uD074\uB9AD \uC2DC \uBB38\uC11C\uD398\uC774\uC9C0 \uC804\uCCB4 \uC120\uD0DD"),a()()(),o(36,"button",27),u("click",function(){return m(i),f(n.onMenuAction("cut"))}),o(37,"div",28),h(38,"img",33),a(),o(39,"div",30)(40,"span",31),c(41,"\uD398\uC774\uC9C0 \uC798\uB77C\uB0B4\uAE30"),a(),o(42,"span",32),c(43,"\uC120\uD0DD\uD55C \uD56D\uBAA9 \uC798\uB77C\uB0B4\uAE30"),a()()(),o(44,"button",27),u("click",function(){return m(i),f(n.onMenuAction("copy"))}),o(45,"div",28),h(46,"img",34),a(),o(47,"div",30)(48,"span",31),c(49,"\uD398\uC774\uC9C0 \uBCF5\uC0AC"),a(),o(50,"span",32),c(51,"\uC120\uD0DD\uD55C \uD56D\uBAA9 \uBCF5\uC0AC"),a()()(),o(52,"button",27),u("click",function(){return m(i),f(n.onMenuAction("paste"))}),o(53,"div",28),h(54,"img",35),a(),o(55,"div",30)(56,"span",31),c(57,"\uD398\uC774\uC9C0 \uBD99\uC5EC\uB123\uAE30"),a(),o(58,"span",32),c(59,"\uBCF5\uC0AC\uB41C \uD398\uC774\uC9C0 \uD56D\uBAA9 \uB9E8\uB4A4 \uD398\uC774\uC9C0\uC5D0 \uBD99\uC774\uAE30"),a()()(),o(60,"button",27),u("click",function(){return m(i),f(n.onMenuAction("paste-into"))}),o(61,"div",28),h(62,"img",36),a(),o(63,"div",30)(64,"span",31),c(65,"\uD398\uC774\uC9C0 \uBD99\uC544\uAE30"),a(),o(66,"span",32),c(67,"\uC120\uD0DD\uD55C \uBB38\uC11C\uAC00 \uC788\uC744 \uC2DC \uBE44\uD65C\uC131\uD654 / \uC120\uD0DD \uC2DC \uD65C\uC131\uD654"),a()()(),o(68,"button",27),u("click",function(){return m(i),f(n.onMenuAction("undo"))}),o(69,"div",28),h(70,"img",37),a(),o(71,"div",30)(72,"span",31),c(73,"\uC2E4\uD589\uCDE8\uC18C"),a(),o(74,"span",32),c(75,"\uC774\uC804 \uD3B8\uC9D1\uB41C \uC0C1\uD0DC\uB85C \uB418\uB3CC\uB9AC\uAE30 (\uACC4\uC18D \uD074\uB9AD \uC2DC \uCC98\uC74C\uC0C1\uD0DC)"),a()()(),o(76,"button",27),u("click",function(){return m(i),f(n.onMenuAction("redo"))}),o(77,"div",28),h(78,"img",38),a(),o(79,"div",30)(80,"span",31),c(81,"\uC2E4\uD589\uBCF5\uAD6C"),a(),o(82,"span",32),c(83,"\uD3B8\uC9D1\uB41C \uC0C1\uD0DC\uB85C \uBCF5\uADC0 (\uACC4\uC18D \uD074\uB9AD \uC2DC \uCC98\uC74C\uC0C1\uD0DC)"),a()()()()()(),o(84,"app-bottom-sheet",22),u("sheetStateChange",function(d){return m(i),f(n.onCompleteSheetStateChange(d))})("close",function(){return m(i),f(n.closeCompleteSheet())}),o(85,"div",23)(86,"h3",24),c(87,"\uC791\uC5C5 \uC644\uB8CC"),a()(),o(88,"div",25)(89,"div",26)(90,"button",27),u("click",function(){return m(i),f(n.onCompleteAction("save"))}),o(91,"div",28),h(92,"img",39),a(),o(93,"div",30)(94,"span",31),c(95,"\uC800\uC7A5"),a(),o(96,"span",32),c(97,"\uAE30\uC874 \uBB38\uC11C\uC5D0 \uC800\uC7A5 / \uC800\uC7A5 \uC131\uACF5 \uBA54\uC138\uC9C0 \uC81C\uACF5"),a()()(),o(98,"button",27),u("click",function(){return m(i),f(n.onCompleteAction("save-as"))}),o(99,"div",28),h(100,"img",40),a(),o(101,"div",30)(102,"span",31),c(103,"\uB2E4\uB978 \uC774\uB984\uC73C\uB85C \uC800\uC7A5"),a(),o(104,"span",32),c(105,"\uD30C\uC77C\uBA85 \uB4A4\uC5D0 (\uBCF5\uC0AC) \uBD99\uC5EC\uC11C \uC800\uC7A5"),a()()(),o(106,"button",27),u("click",function(){return m(i),f(n.onCompleteAction("discard"))}),o(107,"div",28),h(108,"img",41),a(),o(109,"div",30)(110,"span",31),c(111,"\uBCC0\uACBD\uC0AC\uD56D \uBB34\uC2DC"),a(),o(112,"span",32),c(113,"\uD3B8\uC9D1\uB0B4\uC6A9 \uCDE8\uC18C \uD6C4 \uD604\uC7AC \uBB38\uC11C\uB85C \uB418\uB3CC\uC544\uAC10"),a()()(),o(114,"button",27),u("click",function(){return m(i),f(n.onCompleteAction("cancel"))}),o(115,"div",28),h(116,"img",42),a(),o(117,"div",30)(118,"span",31),c(119,"\uCDE8\uC18C"),a(),o(120,"span",32),c(121,"\uD31D\uC5C5 \uB2EB\uD798"),a()()()()()(),o(122,"app-bottom-sheet",22),u("sheetStateChange",function(d){return m(i),f(n.onAddPageSheetStateChange(d))})("close",function(){return m(i),f(n.closeAddPageSheet())}),o(123,"div",23)(124,"h3",24),c(125,"\uD398\uC774\uC9C0 \uCD94\uAC00"),a(),o(126,"button",43),u("click",function(){return m(i),f(n.closeAddPageSheet())}),h(127,"img",44),a()(),o(128,"div",45)(129,"div",46)(130,"label",47),c(131,"\uBC30\uACBD \uC0C9\uC0C1"),a(),o(132,"div",48)(133,"input",49),$("ngModelChange",function(d){return m(i),U(n.newPageConfig.backgroundColor,d)||(n.newPageConfig.backgroundColor=d),f(d)}),a(),o(134,"label",50),h(135,"div",51),o(136,"span",52),c(137),a()()()(),o(138,"button",53),u("click",function(){return m(i),f(n.confirmAddPage())}),c(139," \uBE48 \uD398\uC774\uC9C0 \uCD94\uAC00 "),a()()(),o(140,"app-bottom-sheet",22),u("sheetStateChange",function(d){return m(i),f(n.onSaveAsSheetStateChange(d))})("close",function(){return m(i),f(n.closeSaveAsSheet())}),o(141,"div",23)(142,"h3",24),c(143,"\uB2E4\uB978 \uC774\uB984\uC73C\uB85C \uC800\uC7A5"),a(),o(144,"button",43),u("click",function(){return m(i),f(n.closeSaveAsSheet())}),h(145,"img",44),a()(),o(146,"div",45)(147,"div",46)(148,"label",47),c(149,"\uD30C\uC77C\uBA85"),a(),o(150,"input",54),$("ngModelChange",function(d){return m(i),U(n.saveAsFileName,d)||(n.saveAsFileName=d),f(d)}),a(),o(151,"div",55),c(152,".pdf \uD655\uC7A5\uC790\uB294 \uC790\uB3D9\uC73C\uB85C \uCD94\uAC00\uB429\uB2C8\uB2E4"),a()(),o(153,"button",53),u("click",function(){return m(i),f(n.confirmSaveAs())}),c(154," \uC800\uC7A5 "),a()()()}e&2&&(p("isVisible",n.isProcessing)("isComplete",n.isComplete)("isFailed",n.isFailed)("title",n.processingTitle)("subtitle",n.processingSubtitle),l(5),k("disabled",n.selectedPages.length===0),p("disabled",n.selectedPages.length===0),l(2),k("disabled",n.selectedPages.length===0),p("disabled",n.selectedPages.length===0),l(2),k("disabled",n.selectedPages.length===0),p("disabled",n.selectedPages.length===0),l(9),p("ngIf",n.isDragging&&n.dropTargetIndex!==-1),l(3),p("ngForOf",n.pages),l(),p("sheetState",n.sheetState),l(14),k("disabled",n.selectedPages.length===0),l(8),k("disabled",n.selectedPages.length===0),l(8),k("disabled",n.clipboard.length===0),l(8),k("disabled",n.clipboard.length===0||n.selectedPages.length===0),l(8),k("disabled",!n.canUndo()),l(8),k("disabled",!n.canRedo()),l(8),p("sheetState",n.completeSheetState),l(38),p("sheetState",n.addPageSheetState),l(11),j("ngModel",n.newPageConfig.backgroundColor),l(2),q("background-color",n.newPageConfig.backgroundColor),l(2),x(n.newPageConfig.backgroundColor),l(3),p("sheetState",n.saveAsSheetState),l(10),j("ngModel",n.saveAsFileName))},dependencies:[oe,B,he,pe,ge,Pe,Ee],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:content-box;background:#f5f5f5}.header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:8px 12px;background:#fff;border-bottom:1px solid #e0e0e0;position:sticky;top:0;z-index:100;gap:12px}.header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{width:40px;height:40px;padding:0;background:none;border:none;cursor:pointer;color:#333;display:flex;align-items:center;justify-content:center;border-radius:8px;transition:all .2s}.header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]:active:not(:disabled){background:#f0f0f0;transform:scale(.95)}.header[_ngcontent-%COMP%]   .icon-btn.disabled[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.header[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none}.main-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px;padding-bottom:calc(80px + var(--android-navigation-bar-height, 0px))}.pages-container[_ngcontent-%COMP%]{position:relative}.pages-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}.drop-indicator[_ngcontent-%COMP%]{position:absolute;width:6px;background:linear-gradient(180deg,#007acc,#005a9e);border-radius:3px;box-shadow:0 0 16px #007acce6,0 0 32px #007acc80,inset 0 0 8px #ffffff4d;animation:_ngcontent-%COMP%_dropIndicatorPulse .8s ease-in-out infinite;z-index:10;pointer-events:none}@keyframes _ngcontent-%COMP%_dropIndicatorPulse{0%,to{opacity:1;transform:scaleX(1);box-shadow:0 0 16px #007acce6,0 0 32px #007acc80,inset 0 0 8px #ffffff4d}50%{opacity:.8;transform:scaleX(1.3);box-shadow:0 0 20px #007acc,0 0 40px #007accb3,inset 0 0 12px #ffffff80}}.drag-preview[_ngcontent-%COMP%]{opacity:.9;transform:scale(1.08) rotate(3deg);box-shadow:0 10px 40px #0000004d,0 0 0 2px #007acc80;transition:none}.drag-preview[_ngcontent-%COMP%]   .selection-overlay[_ngcontent-%COMP%]{display:none}.page-item[_ngcontent-%COMP%]{position:relative;cursor:default;background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 4px #0000001a;transition:all .2s;-webkit-user-select:none;user-select:none;aspect-ratio:1}.page-item[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{position:absolute;top:4px;right:4px;width:28px;height:28px;display:none;align-items:center;justify-content:center;background:#ff9800e6;border-radius:6px;color:#fff;z-index:10;touch-action:none;cursor:grab;box-shadow:0 1px 3px #00000026}.page-item[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]:active{cursor:grabbing;background:#ff9800}.page-item.drag-mode[_ngcontent-%COMP%]   .drag-handle[_ngcontent-%COMP%]{display:flex;animation:_ngcontent-%COMP%_handleAppear .2s ease-out}@keyframes _ngcontent-%COMP%_handleAppear{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}.page-item.selected[_ngcontent-%COMP%]{box-shadow:0 0 0 3px var(--selection-color, #F44336)}.page-item.dragging-source[_ngcontent-%COMP%]{opacity:.3;transform:scale(.95)}.page-item[_ngcontent-%COMP%]   .page-thumbnail[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;overflow:hidden;background:#fafafa;display:flex;align-items:center;justify-content:center;cursor:pointer}.page-item[_ngcontent-%COMP%]   .page-thumbnail[_ngcontent-%COMP%]:active{opacity:.8}.page-item[_ngcontent-%COMP%]   .page-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%;object-fit:contain;transition:transform .3s ease;pointer-events:none;transform-origin:center center}.page-item[_ngcontent-%COMP%]   .page-thumbnail[_ngcontent-%COMP%]   .selection-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#007acc33;display:flex;align-items:center;justify-content:center;pointer-events:none}.page-item[_ngcontent-%COMP%]   .page-thumbnail[_ngcontent-%COMP%]   .page-number-overlay[_ngcontent-%COMP%]{position:absolute;bottom:6px;left:50%;transform:translate(-50%);padding:2px 8px;background:#0009;color:#fff;text-align:center;font-size:11px;font-weight:500;border-radius:4px;pointer-events:none;min-width:20px}.bottom-sheet-header[_ngcontent-%COMP%]{padding:20px 20px 10px}.bottom-sheet-header[_ngcontent-%COMP%]   .bottom-sheet-title[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#333}.bottom-sheet-content[_ngcontent-%COMP%]{padding:10px 20px 30px}.option-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:0}.option-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;background:none;border:none;border-bottom:1px solid #f0f0f0;cursor:pointer;text-align:left;transition:background .2s}.option-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.option-item[_ngcontent-%COMP%]:active{background:#f5f5f5}.option-item[_ngcontent-%COMP%]:disabled, .option-item.disabled[_ngcontent-%COMP%]{opacity:.4;cursor:not-allowed;pointer-events:none}.option-item[_ngcontent-%COMP%]:disabled   .option-icon[_ngcontent-%COMP%], .option-item.disabled[_ngcontent-%COMP%]   .option-icon[_ngcontent-%COMP%]{background:#e0e0e0;color:#999}.option-item[_ngcontent-%COMP%]:disabled   .option-label[_ngcontent-%COMP%], .option-item.disabled[_ngcontent-%COMP%]   .option-label[_ngcontent-%COMP%]{color:#999}.option-item[_ngcontent-%COMP%]   .option-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;height:40px;border-radius:50%;background:#f5f5f5;color:#007acc;flex-shrink:0}.option-item[_ngcontent-%COMP%]   .option-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}.option-item[_ngcontent-%COMP%]   .option-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;flex:1}.option-item[_ngcontent-%COMP%]   .option-label[_ngcontent-%COMP%]{font-size:16px;color:#333;font-weight:500}.option-item[_ngcontent-%COMP%]   .option-desc[_ngcontent-%COMP%]{font-size:12px;color:#999;line-height:1.4}.add-page-content[_ngcontent-%COMP%]{padding:20px}.add-page-content[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]{margin-bottom:24px}.add-page-content[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]   .setting-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:600;color:#333;margin-bottom:12px}.add-page-content[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]   .setting-hint[_ngcontent-%COMP%]{font-size:12px;color:#999;margin-top:8px}.add-page-content[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]{position:relative}.add-page-content[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]   .color-input[_ngcontent-%COMP%]{position:absolute;opacity:0;width:0;height:0}.add-page-content[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]   .color-display[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;background:#f5f5f5;border-radius:8px;cursor:pointer;transition:background .2s}.add-page-content[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]   .color-display[_ngcontent-%COMP%]:active{background:#ebebeb}.add-page-content[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]   .color-display[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;border:2px solid #ddd;box-shadow:inset 0 2px 4px #0000001a}.add-page-content[_ngcontent-%COMP%]   .color-picker-wrapper[_ngcontent-%COMP%]   .color-display[_ngcontent-%COMP%]   .color-hex[_ngcontent-%COMP%]{font-family:monospace;font-size:14px;font-weight:600;color:#333}.add-page-content[_ngcontent-%COMP%]   .page-count-control[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:20px}.add-page-content[_ngcontent-%COMP%]   .page-count-control[_ngcontent-%COMP%]   .count-btn[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:#007acc;border:none;color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s}.add-page-content[_ngcontent-%COMP%]   .page-count-control[_ngcontent-%COMP%]   .count-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.95);background:#005a9e}.add-page-content[_ngcontent-%COMP%]   .page-count-control[_ngcontent-%COMP%]   .count-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.add-page-content[_ngcontent-%COMP%]   .page-count-control[_ngcontent-%COMP%]   .count-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{pointer-events:none}.add-page-content[_ngcontent-%COMP%]   .page-count-control[_ngcontent-%COMP%]   .count-value[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#333;min-width:80px;text-align:center}.add-page-content[_ngcontent-%COMP%]   .insert-position-control[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.add-page-content[_ngcontent-%COMP%]   .insert-position-control[_ngcontent-%COMP%]   .position-input[_ngcontent-%COMP%]{width:80px;padding:12px 16px;border:2px solid #ddd;border-radius:8px;font-size:18px;font-weight:600;text-align:center;color:#333}.add-page-content[_ngcontent-%COMP%]   .insert-position-control[_ngcontent-%COMP%]   .position-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007acc}.add-page-content[_ngcontent-%COMP%]   .insert-position-control[_ngcontent-%COMP%]   .position-label[_ngcontent-%COMP%]{font-size:14px;color:#666;flex:1}.add-page-content[_ngcontent-%COMP%]   .file-name-input[_ngcontent-%COMP%]{width:100%;padding:14px 16px;border:2px solid #ddd;border-radius:8px;font-size:16px;color:#333}.add-page-content[_ngcontent-%COMP%]   .file-name-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007acc}.add-page-content[_ngcontent-%COMP%]   .file-name-input[_ngcontent-%COMP%]::placeholder{color:#999}.add-page-content[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]{width:100%;padding:16px;background:#007acc;color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:background .2s;margin-top:20px}.add-page-content[_ngcontent-%COMP%]   .confirm-btn[_ngcontent-%COMP%]:active{background:#005a9e}.close-btn[_ngcontent-%COMP%]{position:absolute;right:20px;top:20px;width:32px;height:32px;padding:0;background:none;border:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#666;transition:all .2s}.close-btn[_ngcontent-%COMP%]:active{background:#f0f0f0}"]})};var Qt=class r{pdfGenerator=P(jo);fontManager=P(In);createAiResultPdf(t,e,n,i){return C(this,null,function*(){console.log(`\u{1F4DD} [AiPdfExport] PDF \uC0DD\uC131 \uC2DC\uC791: ${t}, \uC5B8\uC5B4: ${i||"\uC790\uB3D9\uAC10\uC9C0"}`);let s=this.convertTextToPdfData(n,e,t,i),d=yield this.pdfGenerator.createPdf(s,i);return console.log("\u2705 [AiPdfExport] PDF \uC0DD\uC131 \uC644\uB8CC"),d})}generateFileName(t,e,n){let i=new Date,s=i.getFullYear(),d=(i.getMonth()+1).toString().padStart(2,"0"),_=i.getDate().toString().padStart(2,"0"),v=`${s}-${d}-${_}`,w=e.replace(/\.[^/.]+$/,"");if(t==="AI\uC694\uC57D")return`${v}_${w}_AI\uC694\uC57D.pdf`;{let M=n?`_${n}`:"";return`${v}_${w}_AI\uBC88\uC5ED${M}.pdf`}}blobToBase64(t){return C(this,null,function*(){return new Promise((e,n)=>{let i=new FileReader;i.onloadend=()=>{let d=i.result.split(",")[1];e(d)},i.onerror=n,i.readAsDataURL(t)})})}convertTextToPdfData(t,e,n,i){let s=n==="AI\uC694\uC57D"?`AI \uC694\uC57D: ${e}`:`AI \uBC88\uC5ED (${i||""}): ${e}`,d=842,_=595,v=18,w=12,M=50,E=_-M-50,D=w*.85,T=Math.floor(E/D),I=[],z=[],A=d-50;z.push({text:s,x:M,y:A,fontSize:16,bold:!0}),A-=30,z.push({text:`\uC0DD\uC131\uC77C: ${new Date().toLocaleDateString("ko-KR")}`,x:M,y:A,fontSize:10}),A-=40;let Y=t.split(`
`);for(let te of Y){if(!te.trim()){A<50&&(I.push({pageIndex:I.length,width:_,height:d,textItems:z}),z=[],A=d-50),z.push({text:" ",x:M,y:A,fontSize:w}),A-=v;continue}let ie=this.wrapText(te,T);for(let Ie of ie)A<50&&(I.push({pageIndex:I.length,width:_,height:d,textItems:z}),z=[],A=d-50),z.push({text:Ie,x:M,y:A,fontSize:w}),A-=v}return z.length>0&&I.push({pageIndex:I.length,width:_,height:d,textItems:z}),{analysisResult:{textStreamData:{pages:I},imageData:null,vectorData:null,structureData:{pages:[],metadata:{fileName:this.generateFileName(n,e,i),fileSize:0,pageCount:I.length,title:s,author:"ezReader AI",subject:n,keywords:"",creator:"ezReader",producer:"ezReader",creationDate:new Date,modificationDate:new Date},statistics:{totalPages:I.length,totalWords:t.split(/\s+/).length,totalCharacters:t.length,totalImages:0,totalTables:0,averageWordsPerPage:t.split(/\s+/).length/I.length,averageImagesPerPage:0}}},fileName:this.generateFileName(n,e,i)}}wrapText(t,e){if(t.length<=e)return[t];let n=[],i="",s=t.split(/(\s+)/);for(let d of s)if((i+d).length<=e)i+=d;else if(i&&n.push(i),d.length>e){let _=d;for(;_.length>e;)n.push(_.substring(0,e)),_=_.substring(e);i=_}else i=d;return i&&n.push(i),n.length>0?n:[""]}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};function gd(r,t){if(r&1&&(o(0,"div",7)(1,"div",8),h(2,"img",9),a(),o(3,"div",10),c(4,"PDF\uB97C \uBD84\uC11D\uD558\uACE0 \uC788\uC2B5\uB2C8\uB2E4..."),a(),o(5,"div",11),h(6,"div",12),a(),o(7,"div",13),c(8),a()()),r&2){let e=g();l(6),q("width",e.analysisProgress,"%"),l(2),S("",e.analysisProgress,"%")}}function ud(r,t){if(r&1&&(o(0,"div",34),c(1),a()),r&2){let e=g(2);l(),S(" ",e.pdfContent.length>500?e.pdfContent.substring(0,500)+"...":e.pdfContent," ")}}function md(r,t){r&1&&(o(0,"div",35),c(1," \uD14D\uC2A4\uD2B8\uB97C \uCD94\uCD9C\uD558\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4. "),a())}function fd(r,t){r&1&&(o(0,"span"),c(1,"\u2705"),a())}function hd(r,t){r&1&&(o(0,"span"),c(1,"\u274C"),a())}function _d(r,t){r&1&&(o(0,"span"),c(1,"\u2139\uFE0F"),a())}function Cd(r,t){if(r&1&&(o(0,"div",45)(1,"span",46),re(2,47),b(3,fd,2,0,"span",48)(4,hd,2,0,"span",48)(5,_d,2,0,"span",48),ae(),a(),o(6,"span",49),c(7),a()()),r&2){let e=g(4);l(2),p("ngSwitch",e.statusType),l(),p("ngSwitchCase","success"),l(),p("ngSwitchCase","error"),l(),p("ngSwitchCase","info"),l(2),x(e.statusMessage)}}function bd(r,t){if(r&1&&(o(0,"div",40)(1,"div",41),h(2,"img",42),a(),o(3,"div",43),c(4,"AI \uC694\uC57D\uC744 \uC0DD\uC131\uD558\uACE0 \uC788\uC2B5\uB2C8\uB2E4..."),a(),b(5,Cd,8,5,"div",44),a()),r&2){let e=g(3);l(5),p("ngIf",e.statusMessage)}}function vd(r,t){r&1&&h(0,"img",57)}function xd(r,t){r&1&&h(0,"img",58)}function Pd(r,t){r&1&&(o(0,"span"),c(1,"\uB2E4\uC6B4\uB85C\uB4DC"),a())}function Md(r,t){r&1&&(o(0,"span"),c(1,"PDF \uC0DD\uC131 \uC911..."),a())}function yd(r,t){r&1&&(o(0,"span"),c(1,"\uC800\uC7A5 \uC911..."),a())}function wd(r,t){r&1&&(o(0,"span"),c(1,"\u2705 \uC800\uC7A5 \uC644\uB8CC"),a())}function Sd(r,t){if(r&1){let e=y();o(0,"div",50),c(1),o(2,"div",51)(3,"button",52),u("click",function(){m(e);let i=g(3);return f(i.onCopyToClipboard())}),h(4,"img",53),o(5,"span"),c(6,"\uBCF5\uC0AC\uD558\uAE30"),a()(),o(7,"button",54),u("click",function(){m(e);let i=g(3);return f(i.onExportToPdf())}),b(8,vd,1,0,"img",55)(9,xd,1,0,"img",56)(10,Pd,2,0,"span",32)(11,Md,2,0,"span",32)(12,yd,2,0,"span",32)(13,wd,2,0,"span",32),a()()()}if(r&2){let e=g(3);l(),S(" ",e.summaryText," "),l(6),p("disabled",e.exportStatus==="generating"||e.exportStatus==="saving"),l(),p("ngIf",e.exportStatus==="idle"||e.exportStatus==="complete"),l(),p("ngIf",e.exportStatus==="generating"||e.exportStatus==="saving"),l(),p("ngIf",e.exportStatus==="idle"),l(),p("ngIf",e.exportStatus==="generating"),l(),p("ngIf",e.exportStatus==="saving"),l(),p("ngIf",e.exportStatus==="complete")}}function Od(r,t){if(r&1&&(o(0,"div",59)(1,"div",60),c(2,"\u274C"),a(),o(3,"div",61),c(4),a()()),r&2){let e=g(3);l(4),x(e.statusMessage)}}function Ed(r,t){if(r&1&&(o(0,"div",36)(1,"div",21),c(2,"\uC694\uC57D \uACB0\uACFC"),a(),b(3,bd,6,1,"div",37)(4,Sd,14,8,"div",38)(5,Od,5,1,"div",39),a()),r&2){let e=g(2);l(3),p("ngIf",e.isGenerating&&!e.summaryText),l(),p("ngIf",e.summaryText),l(),p("ngIf",!e.isGenerating&&!e.summaryText&&e.statusType==="error")}}function kd(r,t){if(r&1&&(o(0,"option",62),c(1),a()),r&2){let e=t.$implicit;p("value",e.value),l(),S(" ",e.label," ")}}function Dd(r,t){if(r&1&&(o(0,"option",62),c(1),a()),r&2){let e=t.$implicit;p("value",e.value),l(),S(" ",e.label," ")}}function Id(r,t){r&1&&h(0,"img",63)}function Td(r,t){r&1&&h(0,"img",64)}function Ad(r,t){r&1&&(o(0,"span"),c(1,"Gemini AI \uC694\uC57D \uC0DD\uC131"),a())}function Fd(r,t){r&1&&(o(0,"span"),c(1,"\uC0DD\uC131 \uC911..."),a())}function zd(r,t){r&1&&(o(0,"span"),c(1,"\u{1F535}"),a())}function Rd(r,t){r&1&&(o(0,"span"),c(1,"\u2705"),a())}function Bd(r,t){r&1&&(o(0,"span"),c(1,"\u274C"),a())}function Vd(r,t){r&1&&(o(0,"span"),c(1,"\u26A0\uFE0F"),a())}function Ld(r,t){if(r&1&&(o(0,"span",76),c(1),a()),r&2){let e=g().$implicit;l(),x(e.details)}}function Nd(r,t){if(r&1&&(o(0,"div",71)(1,"span",72),c(2),L(3,"date"),a(),o(4,"span",73),re(5,47),b(6,zd,2,0,"span",48)(7,Rd,2,0,"span",48)(8,Bd,2,0,"span",48)(9,Vd,2,0,"span",48),ae(),a(),o(10,"span",74),c(11),a(),b(12,Ld,2,1,"span",75),a()),r&2){let e=t.$implicit;p("ngClass","log-"+e.type),l(2),x(me(3,9,e.timestamp,"HH:mm:ss.SSS")),l(3),p("ngSwitch",e.type),l(),p("ngSwitchCase","info"),l(),p("ngSwitchCase","success"),l(),p("ngSwitchCase","error"),l(),p("ngSwitchCase","warning"),l(2),x(e.message),l(),p("ngIf",e.details)}}function jd(r,t){r&1&&(o(0,"div",77)(1,"span",73),c(2,"\u23F3"),a(),o(3,"span",74),c(4,"API \uD638\uCD9C \uC900\uBE44 \uC911..."),a()())}function Ud(r,t){if(r&1&&(o(0,"div",68),b(1,Nd,13,12,"div",69)(2,jd,5,0,"div",70),a()),r&2){let e=g(3);l(),p("ngForOf",e.apiLogs),l(),p("ngIf",e.apiLogs.length===0&&e.isGenerating)}}function $d(r,t){if(r&1){let e=y();o(0,"div",65)(1,"div",21)(2,"span"),c(3,"API \uD638\uCD9C \uB85C\uADF8"),a(),o(4,"button",66),u("click",function(){m(e);let i=g(2);return f(i.showLogs=!i.showLogs)}),c(5),a()(),b(6,Ud,3,2,"div",67),a()}if(r&2){let e=g(2);l(5),S(" ",e.showLogs?"\uC228\uAE30\uAE30":"\uC0C1\uC138\uBCF4\uAE30"," "),l(),p("ngIf",e.showLogs)}}function Hd(r,t){if(r&1){let e=y();o(0,"div",14)(1,"div",15),h(2,"img",16),o(3,"div",17)(4,"div",18),c(5),a(),o(6,"div",19),c(7),L(8,"number"),a()()(),o(9,"div",20)(10,"div",21),c(11,"PDF \uBCF8\uBB38 \uB0B4\uC6A9"),a(),b(12,ud,2,1,"div",22)(13,md,2,0,"div",23),a(),b(14,Ed,6,3,"div",24),o(15,"div",20)(16,"div",21),c(17,"\uC694\uC57D \uC124\uC815"),a(),o(18,"div",25)(19,"label",26),c(20,"\uC694\uC57D \uAE38\uC774"),a(),o(21,"select",27),$("ngModelChange",function(i){m(e);let s=g();return U(s.summaryLength,i)||(s.summaryLength=i),f(i)}),b(22,kd,2,2,"option",28),a()(),o(23,"div",25)(24,"label",26),c(25,"\uC694\uC57D \uC720\uD615"),a(),o(26,"select",27),$("ngModelChange",function(i){m(e);let s=g();return U(s.summaryType,i)||(s.summaryType=i),f(i)}),b(27,Dd,2,2,"option",28),a()(),o(28,"button",29),u("click",function(){m(e);let i=g();return f(i.onGenerateSummary())}),b(29,Id,1,0,"img",30)(30,Td,1,0,"img",31)(31,Ad,2,0,"span",32)(32,Fd,2,0,"span",32),a()(),b(33,$d,7,2,"div",33),a()}if(r&2){let e=g();l(5),x(e.document==null?null:e.document.fileName),l(2),S(" \uCD1D ",J(8,15,e.pdfContent.length)," \uAE00\uC790 "),l(5),p("ngIf",e.pdfContent),l(),p("ngIf",!e.pdfContent),l(),p("ngIf",e.isGenerating||e.summaryText),l(7),j("ngModel",e.summaryLength),l(),p("ngForOf",e.summaryLengthOptions),l(4),j("ngModel",e.summaryType),l(),p("ngForOf",e.summaryTypeOptions),l(),p("disabled",e.isGenerating||!e.pdfContent),l(),p("ngIf",!e.isGenerating),l(),p("ngIf",e.isGenerating),l(),p("ngIf",!e.isGenerating),l(),p("ngIf",e.isGenerating),l(),p("ngIf",e.isGenerating||e.apiLogs.length>0)}}var ii=class r{document=null;pdfTextStreamData=null;pdfContent="";isAnalyzing=!1;analysisProgress=0;summaryLength="medium";summaryType="general";summaryLengthOptions=[{value:"short",label:"\uC9E7\uAC8C (1-2\uBB38\uB2E8)"},{value:"medium",label:"\uBCF4\uD1B5 (3-4\uBB38\uB2E8)"},{value:"long",label:"\uC790\uC138\uD788 (5-6\uBB38\uB2E8)"}];summaryTypeOptions=[{value:"general",label:"\uC77C\uBC18 \uC694\uC57D"},{value:"bullet",label:"\uD575\uC2EC \uD3EC\uC778\uD2B8"},{value:"qa",label:"Q&A \uD615\uC2DD"},{value:"structure",label:"\uAD6C\uC870\uC801 \uC694\uC57D"}];summaryText="";isGenerating=!1;statusMessage="";statusType="info";exportStatus="idle";exportedFolderId=null;apiLogs=[];showLogs=!1;logSubscription;router=P(N);snackbar=P(G);toolActionService=P(le);pdfTextAnalyzerService=P(En);geminiService=P(On);geminiApiManager=P(Ne);indexedDb=P(ee);aiPdfExport=P(Qt);ngOnInit(){this.geminiService.clearLogs();let e=this.router.getCurrentNavigation()?.extras?.state||history.state;if(!e?.document){this.snackbar.showError("\uBB38\uC11C \uC815\uBCF4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin();return}this.document=e.document,this.logSubscription=this.geminiService.allLogs$.subscribe(n=>{this.apiLogs=n}),this.analyzePdf()}ngOnDestroy(){this.logSubscription?.unsubscribe()}analyzePdf(){return C(this,null,function*(){if(!(!this.document||!this.document.pdfBase64)){this.isAnalyzing=!0,this.analysisProgress=0;try{let t=this.document.pdfBase64.split(",")[1]||this.document.pdfBase64,e=atob(t),n=new Uint8Array(e.length);for(let d=0;d<e.length;d++)n[d]=e.charCodeAt(d);let i=new Blob([n],{type:"application/pdf"});this.analysisProgress=30;let s=new File([i],this.document.fileName||"document.pdf",{type:"application/pdf"});this.pdfTextStreamData=yield this.pdfTextAnalyzerService.extractTextStreamAsJson(s),this.analysisProgress=70,this.pdfContent=this.extractTextFromPdf(),this.analysisProgress=100}catch{this.snackbar.showError("PDF \uBD84\uC11D\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}finally{this.isAnalyzing=!1}}})}extractTextFromPdf(){if(!this.pdfTextStreamData?.pages)return"";let t=[];for(let e of this.pdfTextStreamData.pages)if(e.sentences)for(let n of e.sentences){let i=n.text?.trim();i&&(this.isFooterText(n,e)||t.push(i))}return t.join(" ")}isFooterText(t,e){if(!t.position||!e.height)return!1;let n=t.position.y,s=(e.height||842)*.9;if(n>s){let d=t.text?.toLowerCase()||"";if(/\.(pdf|doc|docx|xls|xlsx)/.test(d)||/^(page\s*\d+|\d+\s*\/\s*\d+|p\.\s*\d+|\d+$)/.test(d)||/\d{4}[-/.]\d{1,2}[-/.]\d{1,2}/.test(d)||d.length<50)return!0}return!1}onGenerateSummary(){return C(this,null,function*(){if(!this.pdfContent){this.snackbar.showWarning("PDF \uB0B4\uC6A9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. \uBA3C\uC800 \uBD84\uC11D\uC744 \uC644\uB8CC\uD574\uC8FC\uC138\uC694.");return}this.isGenerating=!0,this.summaryText="",this.statusMessage="\u2139\uFE0F AI \uC694\uC57D \uC0DD\uC131 \uC911...",this.statusType="info";let t=0,e=2;for(;t<=e;)try{let n=this.generateSummaryPrompt(),i=yield new Promise((s,d)=>{this.geminiService.translateText(n,"korean").subscribe({next:_=>{_.success&&_.translatedText?s(_.translatedText):d(new Error(_.error||"\uC694\uC57D \uC0DD\uC131 \uC2E4\uD328"))},error:_=>{let v=_?.error||_?.message||(typeof _=="string"?_:JSON.stringify(_));d(new Error(v))}})});this.summaryText=i,this.statusMessage="\u2705 \uC694\uC57D\uC774 \uC131\uACF5\uC801\uC73C\uB85C \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",this.statusType="success",this.isGenerating=!1;return}catch(n){console.error("\uC694\uC57D \uC624\uB958 \uC0C1\uC138:",n);let i="\uC54C \uC218 \uC5C6\uB294 \uC624\uB958";if(n instanceof Error?i=n.message:typeof n=="object"&&n!==null?i=n.error||n.message||JSON.stringify(n):typeof n=="string"&&(i=n),i.includes("\uD560\uB2F9\uB7C9")||i.includes("429"))if(t<e){this.statusMessage=`\u26A0\uFE0F \uD560\uB2F9\uB7C9 \uCD08\uACFC - \uBC31\uC5C5 \uD0A4\uB85C \uC7AC\uC2DC\uB3C4 \uC911... (${t+1}/${e})`,this.statusType="info",t++,yield new Promise(s=>setTimeout(s,1e3));continue}else this.statusMessage="\u274C \uBAA8\uB4E0 \uBC31\uC5C5 \uD0A4\uC758 \uD560\uB2F9\uB7C9\uC774 \uCD08\uACFC\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uC7A0\uC2DC \uD6C4 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.",this.statusType="error";else i.includes("\uACFC\uBD80\uD558")||i.includes("overloaded")||i.includes("503")?(this.statusMessage="\u274C \uC11C\uBC84 \uACFC\uBD80\uD558: \uC7A0\uC2DC \uD6C4 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.",this.statusType="error"):i.includes("\uC778\uC99D")||i.includes("401")?(this.statusMessage="\u274C \uC778\uC99D \uC624\uB958: Google \uB85C\uADF8\uC778\uC744 \uB2E4\uC2DC \uD574\uC8FC\uC138\uC694.",this.statusType="error"):(this.statusMessage=`\u274C \uC694\uC57D \uC2E4\uD328: ${i}`,this.statusType="error");this.snackbar.showError("\uC694\uC57D\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),this.summaryText=`\uC694\uC57D \uC0DD\uC131 \uC2E4\uD328: ${i}`;break}this.isGenerating=!1})}generateSummaryPrompt(){let t="\uB2F9\uC2E0\uC740 \uC804\uBB38 \uBB38\uC11C \uC694\uC57D \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4. \uB2E4\uC74C \uBB38\uC11C\uB97C \uBD84\uC11D\uD558\uC5EC ";switch(this.summaryType){case"general":t+=`\uD575\uC2EC \uB0B4\uC6A9\uC744 \uBA85\uD655\uD558\uAC8C \uC694\uC57D\uD574\uC8FC\uC138\uC694.

\uC694\uAD6C\uC0AC\uD56D:
- \uC8FC\uC694 \uC544\uC774\uB514\uC5B4\uC640 \uACB0\uB860\uC744 \uD3EC\uD568
- \uC911\uC694\uD55C \uC138\uBD80\uC0AC\uD56D \uC720\uC9C0
- \uB17C\uB9AC\uC801 \uD750\uB984 \uBCF4\uC874`;break;case"bullet":t+=`\uD575\uC2EC \uD3EC\uC778\uD2B8\uB97C \uBC88\uD638 \uBAA9\uB85D\uC73C\uB85C \uC815\uB9AC\uD574\uC8FC\uC138\uC694.

\uC694\uAD6C\uC0AC\uD56D:
- \uAC01 \uD56D\uBAA9\uC740 \uD558\uB098\uC758 \uD575\uC2EC \uC544\uC774\uB514\uC5B4
- \uC911\uC694\uB3C4 \uC21C\uC73C\uB85C \uBC30\uC5F4
- \uAD6C\uCCB4\uC801\uC774\uACE0 \uBA85\uD655\uD55C \uD45C\uD604 \uC0AC\uC6A9`;break;case"qa":t+=`Q&A \uD615\uC2DD\uC73C\uB85C \uC815\uB9AC\uD574\uC8FC\uC138\uC694.

\uC694\uAD6C\uC0AC\uD56D:
- \uBB38\uC11C\uC758 \uC8FC\uC694 \uC8FC\uC81C\uB97C \uC9C8\uBB38\uC73C\uB85C
- \uD575\uC2EC \uB0B4\uC6A9\uC744 \uB2F5\uBCC0\uC73C\uB85C
- 3-5\uAC1C\uC758 \uC911\uC694\uD55C Q&A \uC30D`;break;case"structure":t+=`\uAD6C\uC870\uC801\uC73C\uB85C \uBD84\uC11D\uD558\uC5EC \uC139\uC158\uBCC4\uB85C \uC815\uB9AC\uD574\uC8FC\uC138\uC694.

\uC694\uAD6C\uC0AC\uD56D:
- \uBB38\uC11C\uC758 \uC804\uCCB4 \uAD6C\uC870 \uD30C\uC545
- \uAC01 \uC139\uC158\uC758 \uC8FC\uC694 \uB0B4\uC6A9
- \uC139\uC158 \uAC04 \uC5F0\uACB0\uC131 \uD45C\uD604`;break}switch(this.summaryLength){case"short":t+=`

\uAE38\uC774: \uD575\uC2EC\uB9CC \uAC04\uACB0\uD558\uAC8C 1-2\uBB38\uB2E8 (100-150\uC790)`;break;case"medium":t+=`

\uAE38\uC774: \uC801\uC808\uD55C \uC0C1\uC138\uB3C4\uB85C 3-4\uBB38\uB2E8 (200-300\uC790)`;break;case"long":t+=`

\uAE38\uC774: \uC0C1\uC138\uD558\uAC8C 5-6\uBB38\uB2E8 (400-500\uC790)`;break}return t+=`

\uCD9C\uB825 \uC5B8\uC5B4: \uD55C\uAD6D\uC5B4
\uCD9C\uB825 \uD615\uC2DD: \uC694\uC57D \uB0B4\uC6A9\uB9CC \uC791\uC131 (\uC124\uBA85\uC774\uB098 \uBA54\uD0C0\uC815\uBCF4 \uC81C\uC678)

\uBB38\uC11C \uB0B4\uC6A9:
---
`+this.pdfContent+`
---`,t}onCopyToClipboard(){return C(this,null,function*(){if(!this.summaryText){this.snackbar.showWarning("\uBCF5\uC0AC\uD560 \uC694\uC57D \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}try{yield navigator.clipboard.writeText(this.summaryText),this.snackbar.showSuccess("\uD074\uB9BD\uBCF4\uB4DC\uC5D0 \uBCF5\uC0AC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch(t){console.error("\uD074\uB9BD\uBCF4\uB4DC \uBCF5\uC0AC \uC2E4\uD328:",t),this.snackbar.showError("\uD074\uB9BD\uBCF4\uB4DC \uBCF5\uC0AC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}onExportToPdf(){return C(this,null,function*(){if(!this.summaryText||!this.document){this.snackbar.showWarning("\uC800\uC7A5\uD560 \uC694\uC57D \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.exportStatus="generating";try{let t=yield this.aiPdfExport.createAiResultPdf("AI\uC694\uC57D",this.document.fileName||this.document.title,this.summaryText);this.exportStatus="saving";let e=yield this.indexedDb.ensureAiFunctionFolder("AI\uC694\uC57D"),n=yield this.aiPdfExport.blobToBase64(t),i=this.aiPdfExport.generateFileName("AI\uC694\uC57D",this.document.fileName||this.document.title),s=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;yield this.indexedDb.saveDocument({id:s,title:i.replace(".pdf",""),fileName:i,folderId:e.id,pdfBase64:n,documentType:"converted",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),pages:[],elementCount:0,version:"1.0",fileSize:t.size}),this.exportStatus="complete",this.exportedFolderId=e.id,this.router.navigate(["/ezm/file-saved"],{state:{fileId:s,fileName:i,fileCount:1,title:"AI \uC694\uC57D PDF \uC800\uC7A5 \uC644\uB8CC!",subtitle:`${i} \uD30C\uC77C\uC774 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,folderId:e.id}})}catch(t){this.exportStatus="idle",this.snackbar.showError("PDF \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),console.error("PDF \uC800\uC7A5 \uC624\uB958:",t)}})}onGoBack(){this.toolActionService.navigateToOrigin()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-ai-summary"]],standalone:!1,decls:8,vars:2,consts:[[1,"header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"header-title"],[1,"main-content"],["class","analyzing-section",4,"ngIf"],["class","content-section",4,"ngIf"],[1,"analyzing-section"],[1,"analyzing-icon"],["src","images/icons/btn-search.svg","alt","\uBD84\uC11D \uC911","width","64","height","64",1,"spin"],[1,"analyzing-text"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"content-section"],[1,"document-info"],["src","images/icons/ico-pdf.svg","alt","PDF","width","40","height","40"],[1,"document-details"],[1,"document-name"],[1,"document-meta"],[1,"section"],[1,"section-title"],["class","pdf-preview",4,"ngIf"],["class","no-content",4,"ngIf"],["class","section summary-result-section",4,"ngIf"],[1,"setting-group"],[1,"setting-label"],[1,"setting-input",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"generate-btn",3,"click","disabled"],["src","images/icons/ico-tool-main-ai-summary.svg","alt","\uC694\uC57D","width","20","height","20",4,"ngIf"],["src","images/icons/btn-search.svg","alt","\uC0DD\uC131 \uC911","width","20","height","20","class","spin-slow",4,"ngIf"],[4,"ngIf"],["class","section api-log-section",4,"ngIf"],[1,"pdf-preview"],[1,"no-content"],[1,"section","summary-result-section"],["class","generating-container",4,"ngIf"],["class","summary-result",4,"ngIf"],["class","summary-error",4,"ngIf"],[1,"generating-container"],[1,"generating-icon"],["src","images/icons/btn-search.svg","alt","\uC0DD\uC131 \uC911","width","48","height","48",1,"spin-slow"],[1,"generating-text"],["class","inline-status-message",4,"ngIf"],[1,"inline-status-message"],[1,"status-icon"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"status-text"],[1,"summary-result"],[1,"action-buttons"],[1,"copy-btn",3,"click"],["src","images/icons/ico-tool-copy.svg","alt","\uBCF5\uC0AC","width","20","height","20"],[1,"export-pdf-btn",3,"click","disabled"],["src","images/icons/ico-share.svg","alt","\uB2E4\uC6B4\uB85C\uB4DC","width","20","height","20",4,"ngIf"],["src","images/icons/btn-search.svg","alt","\uC9C4\uD589 \uC911","width","20","height","20","class","spin-slow",4,"ngIf"],["src","images/icons/ico-share.svg","alt","\uB2E4\uC6B4\uB85C\uB4DC","width","20","height","20"],["src","images/icons/btn-search.svg","alt","\uC9C4\uD589 \uC911","width","20","height","20",1,"spin-slow"],[1,"summary-error"],[1,"error-icon"],[1,"error-text"],[3,"value"],["src","images/icons/ico-tool-main-ai-summary.svg","alt","\uC694\uC57D","width","20","height","20"],["src","images/icons/btn-search.svg","alt","\uC0DD\uC131 \uC911","width","20","height","20",1,"spin-slow"],[1,"section","api-log-section"],[1,"toggle-logs-btn",3,"click"],["class","api-log-container",4,"ngIf"],[1,"api-log-container"],["class","log-entry",3,"ngClass",4,"ngFor","ngForOf"],["class","log-entry log-info",4,"ngIf"],[1,"log-entry",3,"ngClass"],[1,"log-time"],[1,"log-icon"],[1,"log-message"],["class","log-details",4,"ngIf"],[1,"log-details"],[1,"log-entry","log-info"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"button",1),u("click",function(){return n.onGoBack()}),h(2,"img",2),a(),o(3,"div",3),c(4,"PDF AI \uC694\uC57D"),a()(),o(5,"div",4),b(6,gd,9,3,"div",5)(7,Hd,34,17,"div",6),a()),e&2&&(l(6),p("ngIf",n.isAnalyzing),l(),p("ngIf",!n.isAnalyzing))},dependencies:[Ze,oe,B,pt,gt,Ve,Le,Gt,pe,ge,Te,Oe],styles:[".header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fff;border-bottom:1px solid #e0e0e0;display:flex;align-items:center;padding-left:16px;padding-right:16px;gap:12px;z-index:100;box-sizing:border-box}.back-btn[_ngcontent-%COMP%]{width:40px;height:40px;padding:0;background:none;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;border-radius:50%;margin-left:-8px}.back-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.header-title[_ngcontent-%COMP%]{flex:1;font-size:18px;font-weight:600}.main-content[_ngcontent-%COMP%]{padding-top:calc(56px + var(--android-status-bar-height, 0px));padding-bottom:calc(24px + var(--android-navigation-bar-height, 0px));min-height:calc(100vh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));background:#f5f5f5}.analyzing-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 24px;background:#fff;margin:16px;border-radius:12px}.analyzing-icon[_ngcontent-%COMP%]{margin-bottom:24px}.analyzing-text[_ngcontent-%COMP%]{font-size:16px;color:#333;margin-bottom:24px;font-weight:500}.progress-bar[_ngcontent-%COMP%]{width:100%;max-width:300px;height:8px;background:#e0e0e0;border-radius:4px;overflow:hidden;margin-bottom:12px}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#2196f3,#64b5f6);transition:width .3s ease}.progress-text[_ngcontent-%COMP%]{font-size:14px;color:#666}.content-section[_ngcontent-%COMP%]{padding:16px}.document-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px;background:#fff;border-radius:12px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.document-details[_ngcontent-%COMP%]{flex:1}.document-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin-bottom:4px;word-break:break-word}.document-meta[_ngcontent-%COMP%]{font-size:13px;color:#666}.section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.section-title[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#333;margin-bottom:16px}.pdf-preview[_ngcontent-%COMP%]{padding:16px;background:#f8f9fa;border-radius:8px;font-size:14px;line-height:1.6;color:#555;max-height:200px;overflow-y:auto;white-space:pre-wrap;word-break:break-word}.no-content[_ngcontent-%COMP%]{padding:40px 16px;text-align:center;color:#999;font-size:14px}.setting-group[_ngcontent-%COMP%]{margin-bottom:16px}.setting-group[_ngcontent-%COMP%]:last-of-type{margin-bottom:20px}.setting-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#555;margin-bottom:8px}.setting-input[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:1px solid #e0e0e0;border-radius:8px;font-size:15px;background:#fff;cursor:pointer;transition:border-color .2s}.setting-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3}.generate-btn[_ngcontent-%COMP%]{width:100%;padding:16px;background:linear-gradient(135deg,#2196f3,#1976d2);color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:transform .2s}.generate-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98)}.generate-btn[_ngcontent-%COMP%]:disabled{background:#bdbdbd;cursor:not-allowed}.summary-result-section[_ngcontent-%COMP%]   .summary-result[_ngcontent-%COMP%]{padding:20px;background:#f8f9fa;border-radius:8px;font-size:15px;line-height:1.8;color:#333;white-space:pre-wrap;word-break:break-word}.generating-container[_ngcontent-%COMP%]{padding:32px 20px;text-align:center;background:#f8f9fa;border-radius:8px}.generating-container[_ngcontent-%COMP%]   .generating-icon[_ngcontent-%COMP%]{margin-bottom:16px}.generating-container[_ngcontent-%COMP%]   .generating-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{display:inline-block}.generating-container[_ngcontent-%COMP%]   .generating-text[_ngcontent-%COMP%]{font-size:15px;color:#555;margin-bottom:16px;font-weight:500}.generating-container[_ngcontent-%COMP%]   .inline-status-message[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:10px 16px;background:#fff;border-radius:20px;font-size:13px;color:#666;box-shadow:0 2px 4px #0000001a}.generating-container[_ngcontent-%COMP%]   .inline-status-message[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{font-size:16px}.generating-container[_ngcontent-%COMP%]   .inline-status-message[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{line-height:1.4}.summary-error[_ngcontent-%COMP%]{padding:24px 20px;text-align:center;background:#ffebee;border-radius:8px}.summary-error[_ngcontent-%COMP%]   .error-icon[_ngcontent-%COMP%]{font-size:32px;margin-bottom:12px}.summary-error[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{font-size:14px;color:#c62828;line-height:1.6}.result-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.action-btn[_ngcontent-%COMP%]{flex:1;padding:12px;border:1px solid #e0e0e0;border-radius:8px;background:#fff;font-size:14px;font-weight:500;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:6px;transition:all .2s}.action-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}.action-btn.copy-btn[_ngcontent-%COMP%]{color:#2196f3;border-color:#2196f3}.action-btn.copy-btn[_ngcontent-%COMP%]:active{background:#e3f2fd}.action-btn.export-btn[_ngcontent-%COMP%]{color:#4caf50;border-color:#4caf50}.action-btn.export-btn[_ngcontent-%COMP%]:active{background:#e8f5e9}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.spin-slow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 2s linear infinite}.status-message[_ngcontent-%COMP%]{background:#f5f5f5;border-radius:8px;padding:12px 16px;margin:16px 0;display:flex;align-items:center;gap:10px;font-size:14px;line-height:1.5}.status-message.status-success[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32;border-left:4px solid #4CAF50}.status-message.status-error[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;border-left:4px solid #F44336}.status-message.status-info[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0;border-left:4px solid #2196F3}.status-message[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0}.status-message[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{flex:1}.api-log-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.api-log-section[_ngcontent-%COMP%]   .toggle-logs-btn[_ngcontent-%COMP%]{background:#e3f2fd;border:none;padding:4px 12px;border-radius:12px;font-size:12px;color:#1976d2;cursor:pointer}.api-log-section[_ngcontent-%COMP%]   .toggle-logs-btn[_ngcontent-%COMP%]:active{background:#bbdefb}.api-log-container[_ngcontent-%COMP%]{background:#1a1a2e;border-radius:8px;padding:12px;max-height:300px;overflow-y:auto;font-family:SF Mono,Monaco,Consolas,monospace;font-size:11px;line-height:1.5}.log-entry[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;padding:4px 0;border-bottom:1px solid rgba(255,255,255,.1)}.log-entry[_ngcontent-%COMP%]:last-child{border-bottom:none}.log-entry[_ngcontent-%COMP%]   .log-time[_ngcontent-%COMP%]{color:#888;flex-shrink:0;font-size:10px}.log-entry[_ngcontent-%COMP%]   .log-icon[_ngcontent-%COMP%]{flex-shrink:0;font-size:12px}.log-entry[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{flex:1;word-break:break-all}.log-entry[_ngcontent-%COMP%]   .log-details[_ngcontent-%COMP%]{color:#888;font-size:10px;margin-left:8px}.log-entry.log-info[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{color:#64b5f6}.log-entry.log-success[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{color:#81c784}.log-entry.log-error[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{color:#e57373}.log-entry.log-warning[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{color:#ffb74d}.action-buttons[_ngcontent-%COMP%]{margin-top:20px;padding-top:20px;border-top:1px solid #e0e0e0;display:flex;flex-direction:row;gap:12px}.copy-btn[_ngcontent-%COMP%]{flex:1;padding:14px 20px;background:#fff;color:#2196f3;border:2px solid #2196F3;border-radius:8px;font-size:15px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:8px;cursor:pointer;transition:all .3s ease}.copy-btn[_ngcontent-%COMP%]:active{transform:translateY(1px);background:#e3f2fd}.copy-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;stroke:#2196f3}.export-pdf-btn[_ngcontent-%COMP%]{flex:1;padding:14px 20px;background:linear-gradient(135deg,#2196f3,#1976d2);color:#fff;border:none;border-radius:8px;font-size:15px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:8px;cursor:pointer;transition:all .3s ease;box-shadow:0 2px 8px #2196f34d}.export-pdf-btn[_ngcontent-%COMP%]:disabled{background:#bdbdbd;box-shadow:none;cursor:not-allowed}.export-pdf-btn[_ngcontent-%COMP%]:not(:disabled):active{transform:translateY(1px);box-shadow:0 1px 4px #2196f34d}.export-pdf-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}"]})};function Wd(r,t){if(r&1&&(o(0,"div",7)(1,"div",8),h(2,"img",9),a(),o(3,"div",10),c(4,"PDF\uB97C \uBD84\uC11D\uD558\uACE0 \uC788\uC2B5\uB2C8\uB2E4..."),a(),o(5,"div",11),h(6,"div",12),a(),o(7,"div",13),c(8),a()()),r&2){let e=g();l(6),q("width",e.analysisProgress,"%"),l(2),S("",e.analysisProgress,"%")}}function Kd(r,t){if(r&1&&(o(0,"option",37),c(1),a()),r&2){let e=t.$implicit;p("value",e.value),l(),S(" ",e.label," ")}}function Gd(r,t){r&1&&h(0,"img",38)}function Yd(r,t){r&1&&h(0,"img",39)}function qd(r,t){r&1&&(o(0,"span"),c(1,"Gemini AI \uBC88\uC5ED\uD558\uAE30"),a())}function Xd(r,t){r&1&&(o(0,"span"),c(1,"\uBC88\uC5ED \uC911..."),a())}function Jd(r,t){if(r&1&&(o(0,"div",43),c(1),a()),r&2){let e=g(3);l(),S(" ",e.pdfContent," ")}}function Zd(r,t){r&1&&(o(0,"div",44),c(1," \uD14D\uC2A4\uD2B8\uB97C \uCD94\uCD9C\uD558\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4. "),a())}function Qd(r,t){if(r&1&&(o(0,"div",40),b(1,Jd,2,1,"div",41)(2,Zd,2,0,"div",42),a()),r&2){let e=g(2);l(),p("ngIf",e.pdfContent),l(),p("ngIf",!e.pdfContent)}}function ep(r,t){if(r&1&&(o(0,"div",40)(1,"div",45),c(2),a()()),r&2){let e=g(2);l(2),S(" ",e.translationResult.translatedText," ")}}function tp(r,t){if(r&1&&(o(0,"div",48)(1,"div",49),c(2),a(),o(3,"div",50),c(4),a()()),r&2){let e=t.$implicit;l(2),x(e.original),l(2),x(e.translation)}}function np(r,t){if(r&1&&(o(0,"div",46),b(1,tp,5,2,"div",47),a()),r&2){let e=g(2);l(),p("ngForOf",e.parsedTranslation)}}function ip(r,t){if(r&1&&(o(0,"div",40)(1,"div",51),c(2),a()()),r&2){let e=g(2);l(2),S(" \uBC88\uC5ED \uC2E4\uD328: ",e.translationResult.error," ")}}function op(r,t){r&1&&(o(0,"span"),c(1,"\u2705"),a())}function rp(r,t){r&1&&(o(0,"span"),c(1,"\u274C"),a())}function ap(r,t){r&1&&(o(0,"span"),c(1,"\u2139\uFE0F"),a())}function sp(r,t){if(r&1&&(o(0,"div",52)(1,"span",53),re(2,54),b(3,op,2,0,"span",55)(4,rp,2,0,"span",55)(5,ap,2,0,"span",55),ae(),a(),o(6,"span",56),c(7),a()()),r&2){let e=g(2);p("ngClass","status-"+e.statusType),l(2),p("ngSwitch",e.statusType),l(),p("ngSwitchCase","success"),l(),p("ngSwitchCase","error"),l(),p("ngSwitchCase","info"),l(2),x(e.statusMessage)}}function lp(r,t){r&1&&h(0,"img",63)}function cp(r,t){r&1&&h(0,"img",64)}function dp(r,t){r&1&&(o(0,"span"),c(1,"\uB2E4\uC6B4\uB85C\uB4DC"),a())}function pp(r,t){r&1&&(o(0,"span"),c(1,"PDF \uC0DD\uC131 \uC911..."),a())}function gp(r,t){r&1&&(o(0,"span"),c(1,"\uC800\uC7A5 \uC911..."),a())}function up(r,t){r&1&&(o(0,"span"),c(1,"\u2705 \uC800\uC7A5 \uC644\uB8CC"),a())}function mp(r,t){if(r&1){let e=y();o(0,"div",57)(1,"button",58),u("click",function(){m(e);let i=g(2);return f(i.onCopyToClipboard())}),h(2,"img",59),o(3,"span"),c(4,"\uBCF5\uC0AC\uD558\uAE30"),a()(),o(5,"button",60),u("click",function(){m(e);let i=g(2);return f(i.onExportToPdf())}),b(6,lp,1,0,"img",61)(7,cp,1,0,"img",62)(8,dp,2,0,"span",31)(9,pp,2,0,"span",31)(10,gp,2,0,"span",31)(11,up,2,0,"span",31),a()()}if(r&2){let e=g(2);l(5),p("disabled",e.exportStatus==="generating"||e.exportStatus==="saving"),l(),p("ngIf",e.exportStatus==="idle"||e.exportStatus==="complete"),l(),p("ngIf",e.exportStatus==="generating"||e.exportStatus==="saving"),l(),p("ngIf",e.exportStatus==="idle"),l(),p("ngIf",e.exportStatus==="generating"),l(),p("ngIf",e.exportStatus==="saving"),l(),p("ngIf",e.exportStatus==="complete")}}function fp(r,t){r&1&&(o(0,"span"),c(1,"\u{1F535}"),a())}function hp(r,t){r&1&&(o(0,"span"),c(1,"\u2705"),a())}function _p(r,t){r&1&&(o(0,"span"),c(1,"\u274C"),a())}function Cp(r,t){r&1&&(o(0,"span"),c(1,"\u26A0\uFE0F"),a())}function bp(r,t){if(r&1&&(o(0,"span",76),c(1),a()),r&2){let e=g().$implicit;l(),x(e.details)}}function vp(r,t){if(r&1&&(o(0,"div",71)(1,"span",72),c(2),L(3,"date"),a(),o(4,"span",73),re(5,54),b(6,fp,2,0,"span",55)(7,hp,2,0,"span",55)(8,_p,2,0,"span",55)(9,Cp,2,0,"span",55),ae(),a(),o(10,"span",74),c(11),a(),b(12,bp,2,1,"span",75),a()),r&2){let e=t.$implicit;p("ngClass","log-"+e.type),l(2),x(me(3,9,e.timestamp,"HH:mm:ss.SSS")),l(3),p("ngSwitch",e.type),l(),p("ngSwitchCase","info"),l(),p("ngSwitchCase","success"),l(),p("ngSwitchCase","error"),l(),p("ngSwitchCase","warning"),l(2),x(e.message),l(),p("ngIf",e.details)}}function xp(r,t){r&1&&(o(0,"div",77)(1,"span",73),c(2,"\u23F3"),a(),o(3,"span",74),c(4,"API \uD638\uCD9C \uC900\uBE44 \uC911..."),a()())}function Pp(r,t){if(r&1&&(o(0,"div",68),b(1,vp,13,12,"div",69)(2,xp,5,0,"div",70),a()),r&2){let e=g(3);l(),p("ngForOf",e.apiLogs),l(),p("ngIf",e.apiLogs.length===0&&e.isTranslating)}}function Mp(r,t){if(r&1){let e=y();o(0,"div",65)(1,"div",21)(2,"span"),c(3,"API \uD638\uCD9C \uB85C\uADF8"),a(),o(4,"button",66),u("click",function(){m(e);let i=g(2);return f(i.showLogs=!i.showLogs)}),c(5),a()(),b(6,Pp,3,2,"div",67),a()}if(r&2){let e=g(2);l(5),S(" ",e.showLogs?"\uC228\uAE30\uAE30":"\uC0C1\uC138\uBCF4\uAE30"," "),l(),p("ngIf",e.showLogs)}}function yp(r,t){if(r&1){let e=y();o(0,"div",14)(1,"div",15),h(2,"img",16),o(3,"div",17)(4,"div",18),c(5),a(),o(6,"div",19),c(7),L(8,"number"),a()()(),o(9,"div",20)(10,"div",21),c(11,"\uBC88\uC5ED \uC124\uC815"),a(),o(12,"div",22)(13,"label",23),c(14,"\uBC88\uC5ED\uD560 \uC5B8\uC5B4"),a(),o(15,"select",24),$("ngModelChange",function(i){m(e);let s=g();return U(s.selectedLanguage,i)||(s.selectedLanguage=i),f(i)}),b(16,Kd,2,2,"option",25),a()(),o(17,"div",22)(18,"label",23),c(19,"\uBC88\uC5ED \uD615\uC2DD"),a(),o(20,"select",24),$("ngModelChange",function(i){m(e);let s=g();return U(s.translationFormat,i)||(s.translationFormat=i),f(i)}),o(21,"option",26),c(22,"\uC6D0\uBB38-\uBC88\uC5ED \uBCD1\uB82C"),a(),o(23,"option",27),c(24,"\uC77C\uBC18 \uBC88\uC5ED"),a()()(),o(25,"button",28),u("click",function(){m(e);let i=g();return f(i.onStartTranslation())}),b(26,Gd,1,0,"img",29)(27,Yd,1,0,"img",30)(28,qd,2,0,"span",31)(29,Xd,2,0,"span",31),a()(),o(30,"div",20)(31,"div",21),c(32,"PDF \uBCF8\uBB38 \uB0B4\uC6A9"),a(),b(33,Qd,3,2,"div",32)(34,ep,3,1,"div",32)(35,np,2,1,"div",33)(36,ip,3,1,"div",32),a(),b(37,sp,8,6,"div",34)(38,mp,12,7,"div",35)(39,Mp,7,2,"div",36),a()}if(r&2){let e=g();l(5),x(e.document==null?null:e.document.fileName),l(2),S(" \uCD1D ",J(8,17,e.pdfContent.length)," \uAE00\uC790 "),l(8),j("ngModel",e.selectedLanguage),l(),p("ngForOf",e.languages),l(4),j("ngModel",e.translationFormat),l(5),p("disabled",e.isTranslating||!e.pdfContent),l(),p("ngIf",!e.isTranslating),l(),p("ngIf",e.isTranslating),l(),p("ngIf",!e.isTranslating),l(),p("ngIf",e.isTranslating),l(4),p("ngIf",!e.translationResult),l(),p("ngIf",e.translationResult&&e.translationResult.success&&e.translationFormat==="simple"),l(),p("ngIf",e.translationResult&&e.translationResult.success&&e.translationFormat==="parallel"),l(),p("ngIf",e.translationResult&&!e.translationResult.success),l(),p("ngIf",e.statusMessage),l(),p("ngIf",e.translationResult&&e.translationResult.success),l(),p("ngIf",e.isTranslating||e.apiLogs.length>0)}}var oi=class r{document=null;pdfTextStreamData=null;pdfContent="";isAnalyzing=!1;analysisProgress=0;selectedLanguage="english";translationFormat="parallel";languages=[{value:"english",label:"\uC601\uC5B4 (English)"},{value:"korean",label:"\uD55C\uAD6D\uC5B4 (Korean)"},{value:"japanese",label:"\uC77C\uBCF8\uC5B4 (Japanese)"},{value:"chinese",label:"\uC911\uAD6D\uC5B4 (Chinese)"},{value:"spanish",label:"\uC2A4\uD398\uC778\uC5B4 (Spanish)"},{value:"french",label:"\uD504\uB791\uC2A4\uC5B4 (French)"},{value:"german",label:"\uB3C5\uC77C\uC5B4 (German)"}];translationResult=null;parsedTranslation=[];isTranslating=!1;statusMessage="";statusType="info";exportStatus="idle";exportedFolderId=null;apiLogs=[];showLogs=!1;logSubscription;router=P(N);snackbar=P(G);toolActionService=P(le);pdfTextAnalyzerService=P(En);geminiService=P(On);geminiApiManager=P(Ne);indexedDb=P(ee);aiPdfExport=P(Qt);ngOnInit(){this.geminiService.clearLogs();let e=this.router.getCurrentNavigation()?.extras?.state||history.state;if(!e?.document){this.snackbar.showError("\uBB38\uC11C \uC815\uBCF4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin();return}this.document=e.document,this.logSubscription=this.geminiService.allLogs$.subscribe(n=>{this.apiLogs=n}),this.analyzePdf()}ngOnDestroy(){this.logSubscription?.unsubscribe()}analyzePdf(){return C(this,null,function*(){if(!(!this.document||!this.document.pdfBase64)){this.isAnalyzing=!0,this.analysisProgress=0;try{let t=this.document.pdfBase64.split(",")[1]||this.document.pdfBase64,e=atob(t),n=new Uint8Array(e.length);for(let d=0;d<e.length;d++)n[d]=e.charCodeAt(d);let i=new Blob([n],{type:"application/pdf"});this.analysisProgress=30;let s=new File([i],this.document.fileName||"document.pdf",{type:"application/pdf"});this.pdfTextStreamData=yield this.pdfTextAnalyzerService.extractTextStreamAsJson(s),this.analysisProgress=70,this.pdfContent=this.extractTextFromPdf(),this.analysisProgress=100}catch{this.snackbar.showError("PDF \uBD84\uC11D\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}finally{this.isAnalyzing=!1}}})}extractTextFromPdf(){if(!this.pdfTextStreamData?.pages)return"";let t=[];for(let e of this.pdfTextStreamData.pages)if(e.sentences)for(let n of e.sentences){let i=n.text?.trim();i&&(this.isFooterText(n,e)||t.push(i))}return t.join(" ")}isFooterText(t,e){if(!t.position||!e.height)return!1;let n=t.position.y,s=(e.height||842)*.9;if(n>s){let d=t.text?.toLowerCase()||"";if(/\.(pdf|doc|docx|xls|xlsx)/.test(d)||/^(page\s*\d+|\d+\s*\/\s*\d+|p\.\s*\d+|\d+$)/.test(d)||/\d{4}[-/.]\d{1,2}[-/.]\d{1,2}/.test(d)||d.length<50)return!0}return!1}onStartTranslation(){return C(this,null,function*(){if(!this.pdfContent){this.snackbar.showWarning("PDF \uB0B4\uC6A9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. \uBA3C\uC800 \uBD84\uC11D\uC744 \uC644\uB8CC\uD574\uC8FC\uC138\uC694.");return}this.isTranslating=!0,this.translationResult=null,this.parsedTranslation=[],this.statusMessage="\u2139\uFE0F AI \uBC88\uC5ED \uC911...",this.statusType="info";let t=0,e=2;for(;t<=e;)try{let n=yield new Promise((i,s)=>{this.geminiService.translateText(this.pdfContent,this.selectedLanguage,this.translationFormat).subscribe({next:d=>{d.success?i(d):s(new Error(d.error||"\uBC88\uC5ED \uC2E4\uD328"))},error:d=>{let _=d?.error||d?.message||(typeof d=="string"?d:JSON.stringify(d));s(new Error(_))}})});this.translationResult=n,this.translationFormat==="parallel"&&n.success&&(this.parsedTranslation=this.parseParallelTranslation(n.translatedText)),this.statusMessage="\u2705 \uBC88\uC5ED\uC774 \uC131\uACF5\uC801\uC73C\uB85C \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",this.statusType="success",this.snackbar.showSuccess("\uBC88\uC5ED\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.isTranslating=!1;return}catch(n){console.error("\uBC88\uC5ED \uC624\uB958 \uC0C1\uC138:",n);let i="\uC54C \uC218 \uC5C6\uB294 \uC624\uB958";if(n instanceof Error?i=n.message:typeof n=="object"&&n!==null?i=n.error||n.message||JSON.stringify(n):typeof n=="string"&&(i=n),i.includes("\uD560\uB2F9\uB7C9")||i.includes("429"))if(t<e){this.statusMessage=`\u26A0\uFE0F \uD560\uB2F9\uB7C9 \uCD08\uACFC - \uBC31\uC5C5 \uD0A4\uB85C \uC7AC\uC2DC\uB3C4 \uC911... (${t+1}/${e})`,this.statusType="info",t++,yield new Promise(s=>setTimeout(s,1e3));continue}else this.statusMessage="\u274C \uBAA8\uB4E0 \uBC31\uC5C5 \uD0A4\uC758 \uD560\uB2F9\uB7C9\uC774 \uCD08\uACFC\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uC7A0\uC2DC \uD6C4 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.",this.statusType="error";else i.includes("\uACFC\uBD80\uD558")||i.includes("overloaded")||i.includes("503")?(this.statusMessage="\u274C \uC11C\uBC84 \uACFC\uBD80\uD558: \uC7A0\uC2DC \uD6C4 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.",this.statusType="error"):i.includes("\uC778\uC99D")||i.includes("401")?(this.statusMessage="\u274C \uC778\uC99D \uC624\uB958: Google \uB85C\uADF8\uC778\uC744 \uB2E4\uC2DC \uD574\uC8FC\uC138\uC694.",this.statusType="error"):(this.statusMessage=`\u274C \uBC88\uC5ED \uC2E4\uD328: ${i}`,this.statusType="error");this.snackbar.showError("\uBC88\uC5ED\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),this.translationResult={originalText:this.pdfContent,translatedText:"",targetLanguage:this.selectedLanguage,success:!1,error:i};break}this.isTranslating=!1})}onCopyToClipboard(){return C(this,null,function*(){if(!this.translationResult?.translatedText){this.snackbar.showWarning("\uBCF5\uC0AC\uD560 \uBC88\uC5ED \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}try{yield navigator.clipboard.writeText(this.translationResult.translatedText),this.snackbar.showSuccess("\uD074\uB9BD\uBCF4\uB4DC\uC5D0 \uBCF5\uC0AC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch(t){console.error("\uD074\uB9BD\uBCF4\uB4DC \uBCF5\uC0AC \uC2E4\uD328:",t),this.snackbar.showError("\uD074\uB9BD\uBCF4\uB4DC \uBCF5\uC0AC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}parseParallelTranslation(t){let e=[],n=t.split(`
`).filter(s=>s.trim()),i="";for(let s of n){let d=s.trim();if(d.startsWith("[Original]")||d.startsWith("[\uC6D0\uBB38]"))i=d.replace(/^\[(Original|)\]\s*/,"").trim();else if(d.startsWith("[Translation]")||d.startsWith("[\uBC88\uC5ED]")){let _=d.replace(/^\[(Translation|)\]\s*/,"").trim();i&&(e.push({original:i,translation:_}),i="")}}return e}onExportToPdf(){return C(this,null,function*(){if(!this.translationResult?.translatedText||!this.document){this.snackbar.showWarning("\uC800\uC7A5\uD560 \uBC88\uC5ED \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.exportStatus="generating";try{let t=this.languages.find(_=>_.value===this.selectedLanguage)?.label||this.selectedLanguage,e=yield this.aiPdfExport.createAiResultPdf("AI\uBC88\uC5ED",this.document.fileName||this.document.title,this.translationResult.translatedText,t);this.exportStatus="saving";let n=yield this.indexedDb.ensureAiFunctionFolder("AI\uBC88\uC5ED"),i=yield this.aiPdfExport.blobToBase64(e),s=this.aiPdfExport.generateFileName("AI\uBC88\uC5ED",this.document.fileName||this.document.title,t),d=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;yield this.indexedDb.saveDocument({id:d,title:s.replace(".pdf",""),fileName:s,folderId:n.id,pdfBase64:i,documentType:"converted",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),pages:[],elementCount:0,version:"1.0",fileSize:e.size}),this.exportStatus="complete",this.exportedFolderId=n.id,this.router.navigate(["/ezm/file-saved"],{state:{fileId:d,fileName:s,fileCount:1,title:"AI \uBC88\uC5ED PDF \uC800\uC7A5 \uC644\uB8CC!",subtitle:`${s} \uD30C\uC77C\uC774 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,folderId:n.id}})}catch(t){this.exportStatus="idle",this.snackbar.showError("PDF \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),console.error("PDF \uC800\uC7A5 \uC624\uB958:",t)}})}onGoBack(){this.toolActionService.navigateToOrigin()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-ai-translate"]],standalone:!1,decls:8,vars:2,consts:[[1,"header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C\uAC00\uAE30","width","24","height","24"],[1,"header-title"],[1,"main-content"],["class","analyzing-section",4,"ngIf"],["class","content-section",4,"ngIf"],[1,"analyzing-section"],[1,"analyzing-icon"],["src","images/icons/btn-search.svg","alt","\uBD84\uC11D \uC911","width","64","height","64",1,"spin"],[1,"analyzing-text"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"content-section"],[1,"document-info"],["src","images/icons/ico-pdf.svg","alt","PDF","width","40","height","40"],[1,"document-details"],[1,"document-name"],[1,"document-meta"],[1,"section"],[1,"section-title"],[1,"setting-group"],[1,"setting-label"],[1,"setting-input",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["value","parallel"],["value","simple"],[1,"generate-btn",3,"click","disabled"],["src","images/icons/ico-tool-main-ai-translation.svg","alt","\uBC88\uC5ED","width","20","height","20",4,"ngIf"],["src","images/icons/btn-search.svg","alt","\uBC88\uC5ED \uC911","width","20","height","20","class","spin-slow",4,"ngIf"],[4,"ngIf"],["class","pdf-content-container",4,"ngIf"],["class","pdf-content-container parallel-container",4,"ngIf"],["class","status-message",3,"ngClass",4,"ngIf"],["class","action-buttons",4,"ngIf"],["class","section api-log-section",4,"ngIf"],[3,"value"],["src","images/icons/ico-tool-main-ai-translation.svg","alt","\uBC88\uC5ED","width","20","height","20"],["src","images/icons/btn-search.svg","alt","\uBC88\uC5ED \uC911","width","20","height","20",1,"spin-slow"],[1,"pdf-content-container"],["class","pdf-preview",4,"ngIf"],["class","no-content",4,"ngIf"],[1,"pdf-preview"],[1,"no-content"],[1,"translation-result","simple"],[1,"pdf-content-container","parallel-container"],["class","parallel-item",4,"ngFor","ngForOf"],[1,"parallel-item"],[1,"original-text"],[1,"translated-text"],[1,"translation-error"],[1,"status-message",3,"ngClass"],[1,"status-icon"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"status-text"],[1,"action-buttons"],[1,"copy-btn",3,"click"],["src","images/icons/ico-tool-copy.svg","alt","\uBCF5\uC0AC","width","20","height","20"],[1,"export-pdf-btn",3,"click","disabled"],["src","images/icons/ico-share.svg","alt","\uB2E4\uC6B4\uB85C\uB4DC","width","20","height","20",4,"ngIf"],["src","images/icons/btn-search.svg","alt","\uC9C4\uD589 \uC911","width","20","height","20","class","spin-slow",4,"ngIf"],["src","images/icons/ico-share.svg","alt","\uB2E4\uC6B4\uB85C\uB4DC","width","20","height","20"],["src","images/icons/btn-search.svg","alt","\uC9C4\uD589 \uC911","width","20","height","20",1,"spin-slow"],[1,"section","api-log-section"],[1,"toggle-logs-btn",3,"click"],["class","api-log-container",4,"ngIf"],[1,"api-log-container"],["class","log-entry",3,"ngClass",4,"ngFor","ngForOf"],["class","log-entry log-info",4,"ngIf"],[1,"log-entry",3,"ngClass"],[1,"log-time"],[1,"log-icon"],[1,"log-message"],["class","log-details",4,"ngIf"],[1,"log-details"],[1,"log-entry","log-info"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"button",1),u("click",function(){return n.onGoBack()}),h(2,"img",2),a(),o(3,"div",3),c(4,"PDF AI \uBC88\uC5ED"),a()(),o(5,"div",4),b(6,Wd,9,3,"div",5)(7,yp,40,19,"div",6),a()),e&2&&(l(6),p("ngIf",n.isAnalyzing),l(),p("ngIf",!n.isAnalyzing))},dependencies:[Ze,oe,B,pt,gt,Ve,Le,Gt,pe,ge,Te,Oe],styles:[".header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fff;border-bottom:1px solid #e0e0e0;display:flex;align-items:center;padding-left:16px;padding-right:16px;gap:12px;z-index:100;box-sizing:border-box}.back-btn[_ngcontent-%COMP%]{width:40px;height:40px;padding:0;background:none;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;border-radius:50%;margin-left:-8px}.back-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.header-title[_ngcontent-%COMP%]{flex:1;font-size:18px;font-weight:600}.main-content[_ngcontent-%COMP%]{padding-top:calc(56px + var(--android-status-bar-height, 0px));padding-bottom:calc(24px + var(--android-navigation-bar-height, 0px));min-height:100vh;background:#f5f5f5}.analyzing-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 24px;background:#fff;margin:16px;border-radius:12px}.analyzing-icon[_ngcontent-%COMP%]{margin-bottom:24px}.analyzing-text[_ngcontent-%COMP%]{font-size:16px;color:#333;margin-bottom:24px;font-weight:500}.progress-bar[_ngcontent-%COMP%]{width:100%;max-width:300px;height:8px;background:#e0e0e0;border-radius:4px;overflow:hidden;margin-bottom:12px}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#2196f3,#64b5f6);transition:width .3s ease}.progress-text[_ngcontent-%COMP%]{font-size:14px;color:#666}.content-section[_ngcontent-%COMP%]{padding:16px}.document-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px;background:#fff;border-radius:12px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.document-details[_ngcontent-%COMP%]{flex:1}.document-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin-bottom:4px;word-break:break-word}.document-meta[_ngcontent-%COMP%]{font-size:13px;color:#666}.section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.section-title[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#333;margin-bottom:16px}.pdf-preview[_ngcontent-%COMP%]{padding:16px;background:#f8f9fa;border-radius:8px;font-size:14px;line-height:1.6;color:#555;max-height:200px;overflow-y:auto;white-space:pre-wrap;word-break:break-word}.no-content[_ngcontent-%COMP%]{padding:40px 16px;text-align:center;color:#999;font-size:14px}.setting-group[_ngcontent-%COMP%]{margin-bottom:20px}.setting-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#555;margin-bottom:8px}.setting-input[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:1px solid #e0e0e0;border-radius:8px;font-size:15px;background:#fff;cursor:pointer;transition:border-color .2s}.setting-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3}.generate-btn[_ngcontent-%COMP%]{width:100%;padding:16px;background:linear-gradient(135deg,#4caf50,#388e3c);color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:transform .2s}.generate-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98)}.generate-btn[_ngcontent-%COMP%]:disabled{background:#bdbdbd;cursor:not-allowed}.translation-result[_ngcontent-%COMP%]{padding:20px;background:#f8f9fa;border-radius:8px;font-size:15px;line-height:1.8;color:#333;white-space:pre-wrap;word-break:break-word;margin-bottom:16px}.translation-error[_ngcontent-%COMP%]{padding:20px;background:#ffebee;border-radius:8px;font-size:14px;color:#c62828}.result-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.action-btn[_ngcontent-%COMP%]{flex:1;padding:12px;border:1px solid #e0e0e0;border-radius:8px;background:#fff;font-size:14px;font-weight:500;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:6px;transition:all .2s}.action-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}.action-btn.copy-btn[_ngcontent-%COMP%]{color:#2196f3;border-color:#2196f3}.action-btn.copy-btn[_ngcontent-%COMP%]:active{background:#e3f2fd}.action-btn.export-btn[_ngcontent-%COMP%]{color:#4caf50;border-color:#4caf50}.action-btn.export-btn[_ngcontent-%COMP%]:active{background:#e8f5e9}.info-section[_ngcontent-%COMP%]{padding:16px;background:#fff3e0;border-radius:8px;margin:16px}.info-text[_ngcontent-%COMP%]{font-size:13px;line-height:1.6;color:#e65100;text-align:center}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.spin-slow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 2s linear infinite}.status-message[_ngcontent-%COMP%]{background:#f5f5f5;border-radius:8px;padding:12px 16px;margin:16px;display:flex;align-items:center;gap:10px;font-size:14px;line-height:1.5}.status-message.status-success[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32;border-left:4px solid #4CAF50}.status-message.status-error[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;border-left:4px solid #F44336}.status-message.status-info[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0;border-left:4px solid #2196F3}.status-message[_ngcontent-%COMP%]   .status-icon[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0}.status-message[_ngcontent-%COMP%]   .status-text[_ngcontent-%COMP%]{flex:1}.api-log-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.api-log-section[_ngcontent-%COMP%]   .toggle-logs-btn[_ngcontent-%COMP%]{background:#e3f2fd;border:none;padding:4px 12px;border-radius:12px;font-size:12px;color:#1976d2;cursor:pointer}.api-log-section[_ngcontent-%COMP%]   .toggle-logs-btn[_ngcontent-%COMP%]:active{background:#bbdefb}.api-log-container[_ngcontent-%COMP%]{background:#1a1a2e;border-radius:8px;padding:12px;max-height:300px;overflow-y:auto;font-family:SF Mono,Monaco,Consolas,monospace;font-size:11px;line-height:1.5}.log-entry[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;padding:4px 0;border-bottom:1px solid rgba(255,255,255,.1)}.log-entry[_ngcontent-%COMP%]:last-child{border-bottom:none}.log-entry[_ngcontent-%COMP%]   .log-time[_ngcontent-%COMP%]{color:#888;flex-shrink:0;font-size:10px}.log-entry[_ngcontent-%COMP%]   .log-icon[_ngcontent-%COMP%]{flex-shrink:0;font-size:12px}.log-entry[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{flex:1;word-break:break-all}.log-entry[_ngcontent-%COMP%]   .log-details[_ngcontent-%COMP%]{color:#888;font-size:10px;margin-left:8px}.log-entry.log-info[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{color:#64b5f6}.log-entry.log-success[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{color:#81c784}.log-entry.log-error[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{color:#e57373}.log-entry.log-warning[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{color:#ffb74d}.action-buttons[_ngcontent-%COMP%]{margin-top:20px;padding-top:20px;border-top:1px solid #e0e0e0;display:flex;flex-direction:row;gap:12px}.copy-btn[_ngcontent-%COMP%]{flex:1;padding:14px 20px;background:#fff;color:#2196f3;border:2px solid #2196F3;border-radius:8px;font-size:15px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:8px;cursor:pointer;transition:all .3s ease}.copy-btn[_ngcontent-%COMP%]:active{transform:translateY(1px);background:#e3f2fd}.copy-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;stroke:#2196f3}.export-pdf-btn[_ngcontent-%COMP%]{flex:1;padding:14px 20px;background:linear-gradient(135deg,#2196f3,#1976d2);color:#fff;border:none;border-radius:8px;font-size:15px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:8px;cursor:pointer;transition:all .3s ease;box-shadow:0 2px 8px #2196f34d}.export-pdf-btn[_ngcontent-%COMP%]:disabled{background:#bdbdbd;box-shadow:none;cursor:not-allowed}.export-pdf-btn[_ngcontent-%COMP%]:not(:disabled):active{transform:translateY(1px);box-shadow:0 1px 4px #2196f34d}.export-pdf-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.pdf-content-container[_ngcontent-%COMP%]{max-height:500px;overflow-y:auto;margin-top:8px}.pdf-content-container.parallel-container[_ngcontent-%COMP%]{background:transparent;padding:0}.pdf-content-container.parallel-container[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]{margin-bottom:16px;border-left:3px solid #4A90E2;padding-left:12px;transition:all .2s ease}.pdf-content-container.parallel-container[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]:hover{border-left-color:#357abd}.pdf-content-container.parallel-container[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .original-text[_ngcontent-%COMP%]{font-size:14px;line-height:1.6;color:#333;margin-bottom:8px;padding:8px 12px;font-weight:400}.pdf-content-container.parallel-container[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .translated-text[_ngcontent-%COMP%]{font-size:14px;line-height:1.6;color:#333;padding:10px 14px;background:#e9ecef;border-radius:6px;font-weight:400}.pdf-preview[_ngcontent-%COMP%]{font-size:14px;line-height:1.6;color:#333;white-space:pre-wrap;word-wrap:break-word;padding:12px;background:#f8f9fa;border-radius:8px}.translation-result.simple[_ngcontent-%COMP%]{font-size:14px;line-height:1.8;color:#333;white-space:pre-wrap;word-wrap:break-word;padding:12px;background:#f8f9fa;border-radius:8px}.translation-result.parallel[_ngcontent-%COMP%]{padding:0;background:transparent}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]{position:relative;margin-bottom:24px;padding:16px 16px 16px 50px;background:linear-gradient(135deg,#f8f9fa,#fff);border-radius:12px;border-left:4px solid #2196F3;box-shadow:0 2px 8px #00000014;transition:all .3s ease}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001f;transform:translateY(-2px)}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .sentence-number[_ngcontent-%COMP%]{position:absolute;left:16px;top:50%;transform:translateY(-50%);width:28px;height:28px;background:#2196f3;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .original-text[_ngcontent-%COMP%], .translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .translated-text[_ngcontent-%COMP%]{margin-bottom:12px}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .original-text[_ngcontent-%COMP%]:last-child, .translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .translated-text[_ngcontent-%COMP%]:last-child{margin-bottom:0}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .original-text[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .translated-text[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:inline-block;font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px;padding:4px 10px;border-radius:4px;margin-right:8px}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .original-text[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .translated-text[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:block;line-height:1.7;word-break:keep-all;padding-left:8px}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .original-text[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .original-text[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:#424242;font-weight:400}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .translated-text[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{background:#c8e6c9;color:#2e7d32}.translation-result.parallel[_ngcontent-%COMP%]   .parallel-item[_ngcontent-%COMP%]   .translated-text[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{color:#1976d2;font-weight:500}.translation-result.parallel[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{margin-top:0;padding-top:20px;border-top:1px solid #e0e0e0}"]})};function wp(r,t){if(r&1&&(o(0,"div",7)(1,"div",8),h(2,"img",9),a(),o(3,"div",10),c(4,"\uBCC0\uD658\uD558\uB294 \uC911..."),a(),o(5,"div",11),h(6,"div",12),a(),o(7,"div",13),c(8),a()()),r&2){let e=g();l(6),q("width",e.conversionProgress,"%"),l(2),S("",e.conversionProgress,"%")}}function Sp(r,t){r&1&&h(0,"img",41)}function Op(r,t){r&1&&h(0,"img",42)}function Ep(r,t){r&1&&h(0,"img",43)}function kp(r,t){r&1&&h(0,"img",44)}function Dp(r,t){r&1&&h(0,"img",45)}function Ip(r,t){r&1&&(o(0,"div",46),h(1,"img",47),a())}function Tp(r,t){if(r&1){let e=y();o(0,"button",29),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.onOptionSelect(i))}),o(1,"div",30),b(2,Sp,1,0,"img",31)(3,Op,1,0,"img",32)(4,Ep,1,0,"img",33)(5,kp,1,0,"img",34)(6,Dp,1,0,"img",35),a(),o(7,"div",36)(8,"div",37),c(9),a(),o(10,"div",38),c(11),a(),o(12,"div",39),c(13),a()(),b(14,Ip,2,0,"div",40),a()}if(r&2){let e=t.$implicit,n=g(2);k("selected",(n.selectedOption==null?null:n.selectedOption.id)===e.id),l(),q("color",e.color),l(),p("ngIf",e.icon==="ppt"),l(),p("ngIf",e.icon==="word"),l(),p("ngIf",e.icon==="excel"),l(),p("ngIf",e.icon==="image"),l(),p("ngIf",e.icon==="jpg"),l(3),x(e.title),l(2),x(e.description),l(2),S(".",e.extension),l(),p("ngIf",(n.selectedOption==null?null:n.selectedOption.id)===e.id)}}function Ap(r,t){if(r&1){let e=y();o(0,"div",14)(1,"div",15),h(2,"img",16),o(3,"div",17)(4,"div",18),c(5),a(),o(6,"div",19),c(7,"PDF \uBB38\uC11C"),a()()(),o(8,"div",20)(9,"div",21),c(10,"\uBCC0\uD658\uD560 \uD615\uC2DD\uC744 \uC120\uD0DD\uD558\uC138\uC694"),a(),o(11,"div",22),b(12,Tp,15,13,"button",23),a()(),o(13,"div",24)(14,"button",25),u("click",function(){m(e);let i=g();return f(i.onStartConversion())}),h(15,"img",26),c(16," \uBCC0\uD658 \uC2DC\uC791 "),a()(),o(17,"div",27)(18,"div",28),c(19," \u{1F4A1} \uBCC0\uD658\uB41C \uD30C\uC77C\uC740 \uC790\uB3D9\uC73C\uB85C \uB2E4\uC6B4\uB85C\uB4DC\uB429\uB2C8\uB2E4."),h(20,"br"),c(21," \uC774\uBBF8\uC9C0 \uBCC0\uD658 \uC2DC \uD398\uC774\uC9C0\uBCC4\uB85C \uAC1C\uBCC4 \uD30C\uC77C\uC774 \uC0DD\uC131\uB429\uB2C8\uB2E4. "),a()()()}if(r&2){let e=g();l(5),x(e.document==null?null:e.document.fileName),l(7),p("ngForOf",e.conversionOptions),l(2),p("disabled",!e.selectedOption)}}var ri=class r{document=null;convertType="";isConverting=!1;conversionProgress=0;conversionOptions=[{id:"pdf-to-powerpoint",title:"PowerPoint",description:"PDF\uB97C PPT \uD504\uB808\uC820\uD14C\uC774\uC158\uC73C\uB85C \uBCC0\uD658",icon:"ppt",extension:"pptx",color:"#F44336"},{id:"pdf-to-word",title:"Word \uBB38\uC11C",description:"PDF\uB97C Word \uBB38\uC11C\uB85C \uBCC0\uD658",icon:"word",extension:"docx",color:"#2196F3"},{id:"pdf-to-excel",title:"Excel",description:"PDF\uB97C Excel \uC2A4\uD504\uB808\uB4DC\uC2DC\uD2B8\uB85C \uBCC0\uD658",icon:"excel",extension:"xlsx",color:"#4CAF50"},{id:"pdf-to-image",title:"\uC774\uBBF8\uC9C0 (PNG)",description:"PDF\uB97C PNG \uC774\uBBF8\uC9C0\uB85C \uBCC0\uD658",icon:"image",extension:"png",color:"#9C27B0"},{id:"pdf-to-jpg",title:"\uC774\uBBF8\uC9C0 (JPG)",description:"PDF\uB97C JPG \uC774\uBBF8\uC9C0\uB85C \uBCC0\uD658",icon:"jpg",extension:"jpg",color:"#FF9800"}];selectedOption=null;router=P(N);snackbar=P(G);toolActionService=P(le);pdfConverter=P(Bn);indexedDbService=P(ee);ngOnInit(){let e=this.router.getCurrentNavigation()?.extras?.state||history.state;if(!e?.document){this.snackbar.showError("\uBB38\uC11C \uC815\uBCF4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin();return}this.document=e.document,this.convertType=e.convertType||"",this.convertType&&(this.selectedOption=this.conversionOptions.find(n=>n.id===this.convertType)||null)}onOptionSelect(t){this.selectedOption=t}onStartConversion(){return C(this,null,function*(){if(!this.selectedOption||!this.document||!this.document.pdfBase64){this.snackbar.showError("\uBCC0\uD658\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.isConverting=!0,this.conversionProgress=0;try{let t=this.document.pdfBase64.split(",")[1]||this.document.pdfBase64,e=atob(t),n=new Uint8Array(e.length);for(let A=0;A<e.length;A++)n[A]=e.charCodeAt(A);let i=new Blob([n],{type:"application/pdf"}),s=URL.createObjectURL(i);this.conversionProgress=30;let d=yield this.pdfConverter.loadPdfDocument(s);this.conversionProgress=50;let v=(this.document.fileName||"document").replace(/\.pdf$/i,""),w=new Date,M=w.getHours().toString().padStart(2,"0")+w.getMinutes().toString().padStart(2,"0")+w.getSeconds().toString().padStart(2,"0"),O=null,E="",D="",T="image";switch(this.selectedOption.id){case"pdf-to-powerpoint":O=yield this.pdfConverter.exportToPptBlob(d,v),E=`${v}_\uBCC0\uD658_${M}.pptx`,D="application/vnd.openxmlformats-officedocument.presentationml.presentation",T="ppt";break;case"pdf-to-word":O=yield this.pdfConverter.exportToDocxBlob(d,v),E=`${v}_\uBCC0\uD658_${M}.docx`,D="application/vnd.openxmlformats-officedocument.wordprocessingml.document",T="word";break;case"pdf-to-excel":O=yield this.pdfConverter.exportToExcelBlob(d,v),E=`${v}_\uBCC0\uD658_${M}.xlsx`,D="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",T="excel";break;case"pdf-to-image":O=yield this.pdfConverter.exportToImageBlob(d,v,{scale:2,format:"png"}),E=`${v}_\uBCC0\uD658_${M}.png`,D="image/png",T="image";break;case"pdf-to-jpg":O=yield this.pdfConverter.exportToImageBlob(d,v,{scale:2,format:"jpeg",quality:.9}),E=`${v}_\uBCC0\uD658_${M}.jpg`,D="image/jpeg",T="image";break}if(!O)throw new Error("\uBCC0\uD658 \uC2E4\uD328");this.conversionProgress=70,URL.revokeObjectURL(s);let I=yield this.blobToBase64(O);this.conversionProgress=80;let z=`doc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;yield this.indexedDbService.saveDocument({id:z,title:E,fileName:E,originalFileData:I,mimeType:D,fileSize:O.size,thumbnail:"",pages:[],elementCount:0,version:"1.0",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:T}),this.conversionProgress=100,this.router.navigate(["/ezm/file-saved"],{state:{fileId:z,fileName:E,fileCount:1,title:"\uBCC0\uD658 \uC644\uB8CC!",subtitle:`${E} \uD30C\uC77C\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`}})}catch{this.snackbar.showError("\uBCC0\uD658\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),this.isConverting=!1}})}blobToBase64(t){return C(this,null,function*(){return new Promise((e,n)=>{let i=new FileReader;i.onloadend=()=>e(i.result),i.onerror=n,i.readAsDataURL(t)})})}onGoBack(){this.toolActionService.navigateToOrigin()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-pdf-convert"]],standalone:!1,decls:8,vars:2,consts:[[1,"header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C\uAC00\uAE30","width","24","height","24"],[1,"header-title"],[1,"main-content"],["class","converting-section",4,"ngIf"],["class","content-section",4,"ngIf"],[1,"converting-section"],[1,"converting-icon"],["src","images/icons/btn-search.svg","alt","\uBCC0\uD658 \uC911","width","64","height","64",1,"spin"],[1,"converting-text"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"content-section"],[1,"document-info"],["src","images/icons/ico-pdf.svg","alt","PDF","width","40","height","40"],[1,"document-details"],[1,"document-name"],[1,"document-meta"],[1,"section"],[1,"section-title"],[1,"options-grid"],["class","option-card",3,"selected","click",4,"ngFor","ngForOf"],[1,"action-section"],[1,"convert-btn",3,"click","disabled"],["src","images/icons/btn-view-next.svg","alt","\uC2DC\uC791","width","20","height","20"],[1,"info-section"],[1,"info-text"],[1,"option-card",3,"click"],[1,"option-icon"],["src","images/icons/ico-img.svg","alt","PPT","width","48","height","48",4,"ngIf"],["src","images/icons/ico-img.svg","alt","Word","width","48","height","48",4,"ngIf"],["src","images/icons/ico-img.svg","alt","Excel","width","48","height","48",4,"ngIf"],["src","images/icons/ico-img.svg","alt","\uC774\uBBF8\uC9C0","width","48","height","48",4,"ngIf"],["src","images/icons/ico-img.svg","alt","JPG","width","48","height","48",4,"ngIf"],[1,"option-content"],[1,"option-title"],[1,"option-description"],[1,"option-extension"],["class","option-check",4,"ngIf"],["src","images/icons/ico-img.svg","alt","PPT","width","48","height","48"],["src","images/icons/ico-img.svg","alt","Word","width","48","height","48"],["src","images/icons/ico-img.svg","alt","Excel","width","48","height","48"],["src","images/icons/ico-img.svg","alt","\uC774\uBBF8\uC9C0","width","48","height","48"],["src","images/icons/ico-img.svg","alt","JPG","width","48","height","48"],[1,"option-check"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","24","height","24"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"button",1),u("click",function(){return n.onGoBack()}),h(2,"img",2),a(),o(3,"div",3),c(4,"PDF \uBCC0\uD658"),a()(),o(5,"div",4),b(6,wp,9,3,"div",5)(7,Ap,22,3,"div",6),a()),e&2&&(l(6),p("ngIf",n.isConverting),l(),p("ngIf",!n.isConverting))},dependencies:[oe,B],styles:[".header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fff;border-bottom:1px solid #e0e0e0;display:flex;align-items:center;padding-left:16px;padding-right:16px;gap:12px;z-index:100;box-sizing:border-box}.back-btn[_ngcontent-%COMP%]{width:40px;height:40px;padding:0;background:none;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;border-radius:50%;margin-left:-8px}.back-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.header-title[_ngcontent-%COMP%]{flex:1;font-size:18px;font-weight:600}.main-content[_ngcontent-%COMP%]{padding-top:calc(56px + var(--android-status-bar-height, 0px));padding-bottom:calc(24px + var(--android-navigation-bar-height, 0px));min-height:calc(100vh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));background:#f5f5f5}.converting-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 24px;background:#fff;margin:16px;border-radius:12px}.converting-icon[_ngcontent-%COMP%]{margin-bottom:24px}.converting-text[_ngcontent-%COMP%]{font-size:16px;color:#333;margin-bottom:24px;font-weight:500}.progress-bar[_ngcontent-%COMP%]{width:100%;max-width:300px;height:8px;background:#e0e0e0;border-radius:4px;overflow:hidden;margin-bottom:12px}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#2196f3,#64b5f6);transition:width .3s ease}.progress-text[_ngcontent-%COMP%]{font-size:14px;color:#666}.content-section[_ngcontent-%COMP%]{padding:16px}.document-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px;background:#fff;border-radius:12px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.document-details[_ngcontent-%COMP%]{flex:1}.document-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin-bottom:4px;word-break:break-word}.document-meta[_ngcontent-%COMP%]{font-size:13px;color:#666}.section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.section-title[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#333;margin-bottom:20px}.options-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.option-card[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;gap:16px;padding:16px;background:#f8f9fa;border:2px solid transparent;border-radius:12px;cursor:pointer;transition:all .2s;text-align:left}.option-card[_ngcontent-%COMP%]:active{transform:scale(.98)}.option-card.selected[_ngcontent-%COMP%]{background:#e3f2fd;border-color:#2196f3}.option-icon[_ngcontent-%COMP%]{flex-shrink:0}.option-content[_ngcontent-%COMP%]{flex:1}.option-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin-bottom:4px}.option-description[_ngcontent-%COMP%]{font-size:13px;color:#666;margin-bottom:6px}.option-extension[_ngcontent-%COMP%]{font-size:12px;color:#999;font-family:monospace}.option-check[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px}.action-section[_ngcontent-%COMP%]{padding:0 16px;margin-bottom:16px}.convert-btn[_ngcontent-%COMP%]{width:100%;padding:16px;background:linear-gradient(135deg,#2196f3,#1976d2);color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:transform .2s;box-shadow:0 4px 12px #2196f34d}.convert-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98)}.convert-btn[_ngcontent-%COMP%]:disabled{background:#bdbdbd;cursor:not-allowed;box-shadow:none}.info-section[_ngcontent-%COMP%]{padding:16px;background:#e3f2fd;border-radius:12px;margin:0 16px}.info-text[_ngcontent-%COMP%]{font-size:13px;line-height:1.6;color:#1976d2}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}"]})};function Fp(r,t){if(r&1&&(o(0,"div",21),h(1,"img",22),a()),r&2){let e=g(2);k("landscape",e.isLandscape),l(),p("src",e.thumbnailUrl,ce)}}function zp(r,t){if(r&1){let e=y();o(0,"div",8)(1,"div",9),h(2,"img",10),o(3,"span"),c(4,"\uD68C\uC804 \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC PDF \uD30C\uC77C\uC744 \uD68C\uC804\uD574 \uBCF4\uC138\uC694."),a()(),o(5,"div",11),b(6,Fp,2,3,"div",12),o(7,"div",13)(8,"h3",14),c(9),a(),o(10,"div",15)(11,"span",16),c(12),a(),o(13,"span",17),c(14,"\xB7"),a(),o(15,"span",16),c(16,"PDF"),a()(),o(17,"div",18),c(18),L(19,"date"),a()(),o(20,"button",19),u("click",function(){m(e);let i=g();return f(i.rotateThumbnail())}),h(21,"img",20),a()()()}if(r&2){let e=g();l(6),p("ngIf",e.thumbnailUrl),l(3),x(e.document.fileName||e.document.title),l(3),x(e.formatFileSize(e.document.fileSize||0)),l(6),S(" ",me(19,4,e.document.updatedAt,"yyyy.MM.dd HH:mm:ss")," ")}}function Rp(r,t){if(r&1){let e=y();o(0,"div",23)(1,"button",24),u("click",function(){m(e);let i=g();return f(i.applyRotation())}),c(2," \uC801\uC6A9 "),a()()}}var ai=class r{document=null;isProcessing=!1;isComplete=!1;isFailed=!1;processingTitle="\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.";processingSubtitle="";progress=0;selectedAngle=90;applyToAll=!0;selectedPages=new Set;thumbnailUrl="";totalPages=0;isLandscape=!1;savedDocId="";savedFolderId=null;rotationCount=0;pdfjsLibService=P(Me);rotationOptions=[{angle:90,label:"90\xB0 \uD68C\uC804",icon:"\u21BB",description:"\uC2DC\uACC4\uBC29\uD5A5 90\uB3C4"},{angle:180,label:"180\xB0 \uD68C\uC804",icon:"\u21BB\u21BB",description:"180\uB3C4 \uB4A4\uC9D1\uAE30"},{angle:270,label:"270\xB0 \uD68C\uC804",icon:"\u21BA",description:"\uBC18\uC2DC\uACC4\uBC29\uD5A5 90\uB3C4"}];router=P(N);snackbar=P(G);pdfPageManagement=P(Lo);pdfThumbnail=P(lt);indexedDb=P(ee);toolActionService=P(le);ngOnInit(){return C(this,null,function*(){console.log("[Rotate] ngOnInit \uC2DC\uC791");let t=this.toolActionService.getPendingAction();if(console.log("[Rotate] pendingAction:",t),t&&t.data?.documentId){console.log("[Rotate] documentId\uB85C \uBB38\uC11C \uB85C\uB4DC:",t.data.documentId),yield this.loadDocumentById(t.data.documentId),this.toolActionService.clearPendingAction();return}let e=this.router.getCurrentNavigation();console.log("[Rotate] navigation:",e),console.log("[Rotate] history.state:",history.state);let n=e?.extras?.state||history.state;console.log("[Rotate] \uCD5C\uC885 state:",n),n&&n.document?(console.log("[Rotate] document \uBC1C\uACAC:",n.document),this.document=n.document,this.loadThumbnail()):(console.log("[Rotate] document \uC5C6\uC74C, origin\uC73C\uB85C \uC774\uB3D9"),this.snackbar.showError("\uBB38\uC11C \uC815\uBCF4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())})}loadDocumentById(t){return C(this,null,function*(){try{let e=yield this.indexedDb.getDocumentById(t);e?(this.document=e,yield this.loadThumbnail()):(this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin()}})}formatFileSize(t){return t===0?"0 B":t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/(1024*1024)).toFixed(1)+" MB"}rotateThumbnail(){if(!this.thumbnailUrl)return;this.rotationCount=(this.rotationCount+1)%4;let t={1:90,2:180,3:270};this.rotationCount>0&&(this.selectedAngle=t[this.rotationCount]);let e=new Image;e.onload=()=>{let n=document.createElement("canvas");n.width=e.height,n.height=e.width;let i=n.getContext("2d");i&&(i.translate(n.width/2,n.height/2),i.rotate(90*Math.PI/180),i.drawImage(e,-e.width/2,-e.height/2),this.thumbnailUrl=n.toDataURL("image/jpeg",.7),this.isLandscape=!this.isLandscape)},e.src=this.thumbnailUrl}loadThumbnail(){return C(this,null,function*(){if(!this.document)return;let t=this.document.pdfBase64||this.document.originalPdfBase64;if(!t){this.snackbar.showWarning("\uBB38\uC11C \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}try{let e=this.createBlobUrl(t);this.totalPages=yield this.pdfPageManagement.getPageCount(e);let i=yield(yield this.pdfjsLibService.getDocument(e)).getPage(1),s=i.getViewport({scale:1});this.isLandscape=s.width>s.height;let d=200,_=Math.min(d/s.width,d/s.height),v=i.getViewport({scale:_}),w=document.createElement("canvas");w.width=v.width,w.height=v.height;let M=w.getContext("2d");M&&(yield i.render({canvas:w,canvasContext:M,viewport:v}).promise,this.thumbnailUrl=w.toDataURL("image/jpeg",.7)),this.pdfPageManagement.revokeBlobUrl(e)}catch{this.snackbar.showError("\uBB38\uC11C \uBBF8\uB9AC\uBCF4\uAE30\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}selectAngle(t){this.selectedAngle=t}toggleApplyToAll(){this.applyToAll=!this.applyToAll,this.applyToAll&&this.selectedPages.clear()}togglePageSelection(t){this.selectedPages.has(t)?this.selectedPages.delete(t):this.selectedPages.add(t)}isPageSelected(t){return this.selectedPages.has(t)}applyRotation(){return C(this,null,function*(){if(!(!this.document||!this.document.pdfBase64)){if(this.rotationCount===0){this.snackbar.showWarning("\uD68C\uC804 \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uD68C\uC804\uD574\uC8FC\uC138\uC694.");return}if(!this.applyToAll&&this.selectedPages.size===0){this.snackbar.showWarning("\uD68C\uC804\uD560 \uD398\uC774\uC9C0\uB97C \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");return}this.isProcessing=!0,this.progress=0;try{let t=this.createBlobUrl(this.document.pdfBase64);this.progress=30;let e;if(this.applyToAll)e=yield this.pdfPageManagement.rotateAllPages(t,this.selectedAngle),this.snackbar.showInfo(`\uBAA8\uB4E0 \uD398\uC774\uC9C0\uB97C ${this.selectedAngle}\uB3C4 \uD68C\uC804\uD588\uC2B5\uB2C8\uB2E4.`);else{let M=yield(yield fetch(t)).arrayBuffer(),O=window.PDFLib,E=yield O.PDFDocument.load(M),D=E.getPages(),T=Array.from(this.selectedPages).sort((A,Y)=>A-Y);for(let A of T)if(A>=1&&A<=D.length){let Y=D[A-1],Q=Y.getRotation().angle;Y.setRotation(O.degrees(Q+this.selectedAngle))}let I=yield E.save(),z=new Blob([I],{type:"application/pdf"});e=URL.createObjectURL(z),this.snackbar.showInfo(`${T.length}\uAC1C \uD398\uC774\uC9C0\uB97C ${this.selectedAngle}\uB3C4 \uD68C\uC804\uD588\uC2B5\uB2C8\uB2E4.`)}this.progress=70;let i=yield(yield fetch(e)).blob(),s=yield this.blobToBase64(i);this.progress=80;let d=null;try{let M=yield(yield this.pdfjsLibService.getDocument(e)).getPage(1);d=yield this.pdfThumbnail.renderHighQualityThumbnail(M,1)}catch(w){console.warn("\uC378\uB124\uC77C \uC0DD\uC131 \uC2E4\uD328:",w)}this.progress=90;let _=Z(K({},this.document),{pdfBase64:s,thumbnail:d||this.document.thumbnail,updatedAt:new Date().toISOString()});yield this.indexedDb.saveDocument(_),this.progress=100,this.pdfPageManagement.revokeBlobUrl(t),this.pdfPageManagement.revokeBlobUrl(e);let v=this.applyToAll?this.totalPages:this.selectedPages.size;this.savedDocId=_.id,this.savedFolderId=_.folderId||null,setTimeout(()=>{this.processingTitle="\uBB38\uC11C\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",this.processingSubtitle=`${v}\uAC1C \uD398\uC774\uC9C0\uB97C ${this.selectedAngle}\uB3C4 \uD68C\uC804\uD588\uC2B5\uB2C8\uB2E4.`,this.isComplete=!0},1e3)}catch{this.isFailed=!0,this.isProcessing=!0,this.progress=0}}})}cancel(){this.toolActionService.navigateToOrigin()}onNavigateToFile(){this.savedDocId?this.router.navigate(["/ezm/viewer"],{queryParams:{docId:this.savedDocId}}):this.savedFolderId?this.router.navigate(["/ezm/myfiles",this.savedFolderId]):this.router.navigate(["/ezm/myfiles","my-files"])}onRetry(){this.isFailed=!1,this.isProcessing=!1,this.isComplete=!1,this.progress=0}createBlobUrl(t){try{let e=t.includes(",")?t.split(",")[1]:t,n=atob(e),i=new Uint8Array(n.length);for(let d=0;d<n.length;d++)i[d]=n.charCodeAt(d);let s=new Blob([i],{type:"application/pdf"});return URL.createObjectURL(s)}catch(e){throw e}}blobToBase64(t){return new Promise((e,n)=>{let i=new FileReader;i.onloadend=()=>{let s=i.result.split(",")[1];e(s)},i.onerror=n,i.readAsDataURL(t)})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-rotate"]],standalone:!1,decls:10,vars:7,consts:[[1,"header"],[1,"back-button",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"header-center"],[1,"header-right"],["class","main-content",4,"ngIf"],[3,"navigate","retry","isVisible","isComplete","isFailed","title","subtitle"],["class","bottom-action",4,"ngIf"],[1,"main-content"],[1,"info-message"],["src","images/icons/ico-tooltip-info.svg","alt","\uC815\uBCF4","width","20","height","20"],[1,"document-card"],["class","thumbnail",3,"landscape",4,"ngIf"],[1,"document-details"],[1,"document-title"],[1,"document-meta"],[1,"meta-item"],[1,"meta-divider"],[1,"document-date"],["title","\uBBF8\uB9AC\uBCF4\uAE30 \uD68C\uC804",1,"rotate-button",3,"click"],["src","images/icons/ico-rotation.svg","alt","\uD68C\uC804","width","20","height","20"],[1,"thumbnail"],["alt","PDF \uBBF8\uB9AC\uBCF4\uAE30",3,"src"],[1,"bottom-action"],[1,"apply-button",3,"click"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"button",1),u("click",function(){return n.cancel()}),h(2,"img",2),a(),o(3,"div",3)(4,"h2"),c(5,"PDF \uD68C\uC804"),a()(),h(6,"div",4),a(),b(7,zp,22,7,"div",5),o(8,"app-processing-modal",6),u("navigate",function(){return n.onNavigateToFile()})("retry",function(){return n.onRetry()}),a(),b(9,Rp,3,0,"div",7)),e&2&&(l(7),p("ngIf",n.document&&!n.isProcessing),l(),p("isVisible",n.isProcessing)("isComplete",n.isComplete)("isFailed",n.isFailed)("title",n.processingTitle)("subtitle",n.processingSubtitle),l(),p("ngIf",!n.isProcessing))},dependencies:[B,Ee,Oe],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:content-box;background:#f5f5f5}.header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:#fff;border-bottom:1px solid #e0e0e0;position:sticky;top:0;z-index:10}.header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{padding:8px;background:none;border:none;color:#333;cursor:pointer;border-radius:50%;display:flex;align-items:center;justify-content:center}.header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:active{background:#f0f0f0}.header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]{flex:1;text-align:center}.header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#333}.header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{width:40px}.main-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px;background:#f5f5f5}.info-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;background:#e3f2fd;border-radius:8px;margin-bottom:16px}.info-message[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.info-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;font-size:14px;color:#1976d2;line-height:1.5}.document-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;display:flex;gap:16px;align-items:flex-start;box-shadow:0 2px 8px #00000014;position:relative}.document-card[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:60px;height:80px;border-radius:4px;overflow:hidden;background:#f0f0f0;flex-shrink:0;border:1px solid #e0e0e0;transition:width .3s ease,height .3s ease}.document-card[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.document-card[_ngcontent-%COMP%]   .thumbnail.landscape[_ngcontent-%COMP%]{width:80px;height:60px}.document-card[_ngcontent-%COMP%]   .document-details[_ngcontent-%COMP%]{flex:1;min-width:0}.document-card[_ngcontent-%COMP%]   .document-title[_ngcontent-%COMP%]{margin:0 0 8px;font-size:15px;font-weight:600;color:#333;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.document-card[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-bottom:6px}.document-card[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{font-size:13px;color:#666}.document-card[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]   .meta-divider[_ngcontent-%COMP%]{color:#ccc;font-size:12px}.document-card[_ngcontent-%COMP%]   .document-date[_ngcontent-%COMP%]{font-size:13px;color:#999}.document-card[_ngcontent-%COMP%]   .rotate-button[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;width:36px;height:36px;padding:0;background:#f5f5f5;border:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#666;transition:all .2s}.document-card[_ngcontent-%COMP%]   .rotate-button[_ngcontent-%COMP%]:active{background:#e0e0e0;transform:rotate(90deg)}.bottom-action[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;padding:16px;background:#fff;border-top:1px solid #e0e0e0;z-index:10}.bottom-action[_ngcontent-%COMP%]   .apply-button[_ngcontent-%COMP%]{width:100%;height:52px;background:#ef5350;color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s}.bottom-action[_ngcontent-%COMP%]   .apply-button[_ngcontent-%COMP%]:active{background:#e53935;transform:scale(.98)}.section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px 16px;margin-bottom:16px;box-shadow:0 2px 8px #00000014}.section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;font-weight:600;color:#333}.rotation-options[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}.rotation-options[_ngcontent-%COMP%]   .rotation-option[_ngcontent-%COMP%]{background:#f8f9fa;border:2px solid transparent;border-radius:12px;padding:20px 12px;cursor:pointer;transition:all .2s;display:flex;flex-direction:column;align-items:center;gap:8px}.rotation-options[_ngcontent-%COMP%]   .rotation-option.active[_ngcontent-%COMP%]{background:#e3f2fd;border-color:#2196f3}.rotation-options[_ngcontent-%COMP%]   .rotation-option.active[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{color:#2196f3}.rotation-options[_ngcontent-%COMP%]   .rotation-option.active[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#2196f3;font-weight:600}.rotation-options[_ngcontent-%COMP%]   .rotation-option[_ngcontent-%COMP%]:active{transform:scale(.95)}.rotation-options[_ngcontent-%COMP%]   .rotation-option[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:32px;color:#666;transition:color .2s}.rotation-options[_ngcontent-%COMP%]   .rotation-option[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333;transition:all .2s}.rotation-options[_ngcontent-%COMP%]   .rotation-option[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:12px;color:#999;text-align:center}.apply-scope[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.apply-scope[_ngcontent-%COMP%]   .scope-button[_ngcontent-%COMP%]{background:#f8f9fa;border:2px solid transparent;border-radius:12px;padding:16px;cursor:pointer;display:flex;align-items:center;gap:12px;transition:all .2s}.apply-scope[_ngcontent-%COMP%]   .scope-button.active[_ngcontent-%COMP%]{background:#e8f5e9;border-color:#4caf50}.apply-scope[_ngcontent-%COMP%]   .scope-button.active[_ngcontent-%COMP%]   .scope-icon[_ngcontent-%COMP%]{color:#4caf50}.apply-scope[_ngcontent-%COMP%]   .scope-button.active[_ngcontent-%COMP%]   .scope-label[_ngcontent-%COMP%]{color:#4caf50;font-weight:600}.apply-scope[_ngcontent-%COMP%]   .scope-button[_ngcontent-%COMP%]:active{transform:scale(.98)}.apply-scope[_ngcontent-%COMP%]   .scope-button[_ngcontent-%COMP%]   .scope-icon[_ngcontent-%COMP%]{flex-shrink:0;color:#666;transition:color .2s}.apply-scope[_ngcontent-%COMP%]   .scope-button[_ngcontent-%COMP%]   .scope-info[_ngcontent-%COMP%]{flex:1;text-align:left}.apply-scope[_ngcontent-%COMP%]   .scope-button[_ngcontent-%COMP%]   .scope-info[_ngcontent-%COMP%]   .scope-label[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333;margin-bottom:4px;transition:all .2s}.apply-scope[_ngcontent-%COMP%]   .scope-button[_ngcontent-%COMP%]   .scope-info[_ngcontent-%COMP%]   .scope-description[_ngcontent-%COMP%]{font-size:13px;color:#999}.apply-scope[_ngcontent-%COMP%]   .scope-button[_ngcontent-%COMP%]   .check-icon[_ngcontent-%COMP%]{font-size:20px;color:#4caf50;font-weight:700}.page-selector[_ngcontent-%COMP%]{margin-top:16px;padding-top:16px;border-top:1px solid #e0e0e0}.page-selector[_ngcontent-%COMP%]   .page-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(60px,1fr));gap:8px;margin-bottom:12px}.page-selector[_ngcontent-%COMP%]   .page-grid[_ngcontent-%COMP%]   .page-item[_ngcontent-%COMP%]{aspect-ratio:1;background:#f8f9fa;border:2px solid transparent;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;position:relative;transition:all .2s;font-size:14px;font-weight:500;color:#666}.page-selector[_ngcontent-%COMP%]   .page-grid[_ngcontent-%COMP%]   .page-item.selected[_ngcontent-%COMP%]{background:var(--selection-color-light, rgba(244, 67, 54, .1));border-color:var(--selection-color, #F44336);color:var(--selection-color, #F44336);font-weight:600}.page-selector[_ngcontent-%COMP%]   .page-grid[_ngcontent-%COMP%]   .page-item.selected[_ngcontent-%COMP%]   .check-badge[_ngcontent-%COMP%]{display:flex}.page-selector[_ngcontent-%COMP%]   .page-grid[_ngcontent-%COMP%]   .page-item[_ngcontent-%COMP%]:active{transform:scale(.95)}.page-selector[_ngcontent-%COMP%]   .page-grid[_ngcontent-%COMP%]   .page-item[_ngcontent-%COMP%]   .check-badge[_ngcontent-%COMP%]{position:absolute;top:4px;right:4px;width:18px;height:18px;background:#2196f3;color:#fff;border-radius:50%;font-size:12px;display:none;align-items:center;justify-content:center}.page-selector[_ngcontent-%COMP%]   .selection-info[_ngcontent-%COMP%]{margin:0;font-size:13px;color:#2196f3;text-align:center;font-weight:500}.processing-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:1000}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:32px;text-align:center;max-width:300px;width:90%}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #e0e0e0;border-top-color:#2196f3;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:18px;font-weight:600;color:#333}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#e0e0e0;border-radius:4px;overflow:hidden;margin-bottom:12px}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#2196f3,#21cbf3);border-radius:4px;transition:width .3s ease}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#666;font-weight:500}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.action-buttons[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:1px solid #e0e0e0;padding:12px 16px;display:flex;gap:12px;z-index:10}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:14px 24px;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{transform:scale(.98)}.action-buttons[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.action-buttons[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]:active{background:#e0e0e0}.action-buttons[_ngcontent-%COMP%]   .apply-button[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2196f3,#21cbf3);color:#fff;box-shadow:0 4px 12px #2196f34d}.action-buttons[_ngcontent-%COMP%]   .apply-button[_ngcontent-%COMP%]:active{box-shadow:0 2px 8px #2196f34d}"]})};function Bp(r,t){if(r&1&&(o(0,"div",28),h(1,"img",29),a()),r&2){let e=g(2);l(),p("src",e.thumbnailUrl,ce)}}function Vp(r,t){if(r&1){let e=y();o(0,"div",8)(1,"div",9),h(2,"img",10),o(3,"span"),c(4,"\uD398\uC774\uC9C0 \uBC94\uC704\uB97C \uC9C0\uC815\uD558\uC5EC PDF\uB97C \uC5EC\uB7EC \uD30C\uC77C\uB85C \uBD84\uD560\uD558\uC138\uC694."),a()(),o(5,"div",11),b(6,Bp,2,1,"div",12),o(7,"div",13)(8,"h3",14),c(9),a(),o(10,"div",15)(11,"span",16),c(12),a(),o(13,"span",17),c(14,"\xB7"),a(),o(15,"span",16),c(16),a(),o(17,"span",17),c(18,"\xB7"),a(),o(19,"span",16),c(20,"PDF"),a()(),o(21,"div",18),c(22),L(23,"date"),a()()(),o(24,"div",19)(25,"button",20),u("click",function(){m(e);let i=g();return f(i.extractAllPages())}),o(26,"div",21),h(27,"img",22),a(),o(28,"div",23)(29,"h3",24),c(30,"\uBAA8\uB4E0 \uD398\uC774\uC9C0 \uCD94\uCD9C\uD558\uAE30"),a(),o(31,"p",25),c(32),a()(),o(33,"div",26),h(34,"img",27),a()()()()}if(r&2){let e=g();l(6),p("ngIf",e.thumbnailUrl),l(3),x(e.document.fileName||e.document.title),l(3),x(e.formatFileSize(e.document.fileSize||0)),l(4),S("",e.totalPages,"\uD398\uC774\uC9C0"),l(6),S(" ",me(23,6,e.document.updatedAt,"yyyy.MM.dd HH:mm:ss")," "),l(10),S("\uBAA8\uB4E0 \uD398\uC774\uC9C0\uB97C \uCD94\uCD9C\uD558\uC5EC ",e.totalPages,"\uAC1C pdf\uB85C \uBCC0\uD658\uD569\uB2C8\uB2E4.")}}function Lp(r,t){if(r&1){let e=y();o(0,"div",30)(1,"button",31),u("click",function(){m(e);let i=g();return f(i.applySplit())}),c(2," \uBD84\uD560 \uC2E4\uD589 "),a()()}if(r&2){let e=g();l(),p("disabled",e.splitRanges.length===0)}}var si=class r{document=null;isProcessing=!1;isComplete=!1;isFailed=!1;processingTitle="\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.";processingSubtitle="";progress=0;thumbnailUrl="";totalPages=0;originalFolderId=null;splitFolderId=null;savedFolderId=null;splitRanges=[];nextRangeId=1;currentStartPage=1;currentEndPage=1;router=P(N);snackbar=P(G);indexedDb=P(ee);toolActionService=P(le);pdfjsLibService=P(Me);ngOnInit(){return C(this,null,function*(){let t=this.toolActionService.getPendingAction();if(t&&t.data?.documentId){yield this.loadDocumentById(t.data.documentId),this.toolActionService.clearPendingAction();return}let n=this.router.getCurrentNavigation()?.extras?.state||history.state;n&&n.document?(this.document=n.document,this.originalFolderId=this.document?.folderId||null,this.loadDocumentInfo()):(this.snackbar.showError("\uBB38\uC11C \uC815\uBCF4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())})}loadDocumentById(t){return C(this,null,function*(){try{let e=yield this.indexedDb.getDocumentById(t);e?(this.document=e,this.originalFolderId=e.folderId||null,yield this.loadDocumentInfo()):(this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin()}})}loadDocumentInfo(){return C(this,null,function*(){if(!this.document)return;let t=this.document.pdfBase64||this.document.originalPdfBase64;if(!t){this.snackbar.showWarning("\uBB38\uC11C \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}try{let e=this.createBlobUrl(t),n=yield this.pdfjsLibService.getDocument(e);this.totalPages=n.numPages,this.currentEndPage=this.totalPages;let i=yield n.getPage(1),s=i.getViewport({scale:1}),d=200,_=Math.min(d/s.width,d/s.height),v=i.getViewport({scale:_}),w=document.createElement("canvas");w.width=v.width,w.height=v.height;let M=w.getContext("2d");M&&(yield i.render({canvas:w,canvasContext:M,viewport:v}).promise,this.thumbnailUrl=w.toDataURL("image/jpeg",.7)),URL.revokeObjectURL(e)}catch{this.snackbar.showError("\uBB38\uC11C \uC815\uBCF4\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}formatFileSize(t){return t===0?"0 B":t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/(1024*1024)).toFixed(1)+" MB"}extractAllPages(){if(!this.document||this.totalPages===0){this.snackbar.showWarning("\uBB38\uC11C \uC815\uBCF4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.splitRanges=[];let e=(this.document.fileName||this.document.title||"\uBB38\uC11C").replace(/\.pdf$/i,"");for(let n=1;n<=this.totalPages;n++)this.splitRanges.push({id:this.nextRangeId++,startPage:n,endPage:n,fileName:`${e}_\uD398\uC774\uC9C0${n}.pdf`});this.snackbar.showSuccess(`${this.totalPages}\uAC1C \uD398\uC774\uC9C0\uAC00 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}addSplitRange(){if(this.currentStartPage<1||this.currentStartPage>this.totalPages){this.snackbar.showWarning(`\uC2DC\uC791 \uD398\uC774\uC9C0\uB294 1\uC5D0\uC11C ${this.totalPages} \uC0AC\uC774\uC5EC\uC57C \uD569\uB2C8\uB2E4.`);return}if(this.currentEndPage<1||this.currentEndPage>this.totalPages){this.snackbar.showWarning(`\uB05D \uD398\uC774\uC9C0\uB294 1\uC5D0\uC11C ${this.totalPages} \uC0AC\uC774\uC5EC\uC57C \uD569\uB2C8\uB2E4.`);return}if(this.currentStartPage>this.currentEndPage){this.snackbar.showWarning("\uC2DC\uC791 \uD398\uC774\uC9C0\uB294 \uB05D \uD398\uC774\uC9C0\uBCF4\uB2E4 \uC791\uAC70\uB098 \uAC19\uC544\uC57C \uD569\uB2C8\uB2E4.");return}let e=`${(this.document?.fileName||this.document?.title||"\uBB38\uC11C").replace(".pdf","")}_${this.currentStartPage}-${this.currentEndPage}.pdf`;this.splitRanges.push({id:this.nextRangeId++,startPage:this.currentStartPage,endPage:this.currentEndPage,fileName:e}),this.currentStartPage=1,this.currentEndPage=this.totalPages,this.snackbar.showSuccess("\uBD84\uD560 \uBC94\uC704\uAC00 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}removeSplitRange(t){this.splitRanges=this.splitRanges.filter(e=>e.id!==t),this.snackbar.showInfo("\uBD84\uD560 \uBC94\uC704\uAC00 \uC81C\uAC70\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}applySplit(){return C(this,null,function*(){if(!this.document||!this.document.pdfBase64){this.snackbar.showError("\uBB38\uC11C \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if(this.splitRanges.length===0){this.snackbar.showWarning("\uBD84\uD560 \uBC94\uC704\uB97C \uCD94\uAC00\uD574\uC8FC\uC138\uC694.");return}this.isProcessing=!0,this.progress=0;try{let t=window.PDFLib,e=this.document.pdfBase64||this.document.originalPdfBase64;if(!e){this.snackbar.showError("PDF \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.isProcessing=!1;return}let n=this.createBlobUrl(e);this.progress=10;let s=yield(yield fetch(n)).arrayBuffer(),d=yield t.PDFDocument.load(s);this.progress=20;let v=(this.document.fileName||this.document.title||"\uBB38\uC11C").replace(/\.pdf$/i,"")+"_\uBD84\uD560",w=yield this.indexedDb.createFolder(v,this.originalFolderId);this.splitFolderId=w.id,this.progress=25;let M=this.splitRanges.length,O=0,E=[];for(let D of this.splitRanges){let T=yield t.PDFDocument.create(),I=[];for(let ie=D.startPage-1;ie<=D.endPage-1;ie++)I.push(ie);(yield T.copyPages(d,I)).forEach(ie=>T.addPage(ie));let A=yield T.save(),Y=yield this.arrayBufferToBase64(A),Q=`split-${Date.now()}-${D.id}`,te={id:Q,title:D.fileName.replace(".pdf",""),fileName:D.fileName,pdfBase64:Y,pages:[],elementCount:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:"1.0",documentType:"viewer",pageCount:D.endPage-D.startPage+1,folderId:this.splitFolderId};yield this.indexedDb.saveDocument(te),E.push(Q),O++,this.progress=20+Math.floor(O/M*70)}this.progress=100,URL.revokeObjectURL(n),this.savedFolderId=this.splitFolderId,setTimeout(()=>{this.processingTitle="\uBB38\uC11C\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",this.processingSubtitle=`${this.totalPages}\uD398\uC774\uC9C0\uB97C ${this.splitRanges.length}\uAC1C \uD30C\uC77C\uB85C \uBD84\uD560\uD588\uC2B5\uB2C8\uB2E4.`,this.isComplete=!0},1e3)}catch{this.isFailed=!0,this.isProcessing=!0,this.progress=0}})}cancel(){this.toolActionService.navigateToOrigin()}onNavigateToFile(){this.savedFolderId?this.router.navigate(["/ezm/myfiles",this.savedFolderId]):this.router.navigate(["/ezm/myfiles","my-files"])}onRetry(){this.isFailed=!1,this.isProcessing=!1,this.isComplete=!1,this.progress=0}createBlobUrl(t){try{let e=t.includes(",")?t.split(",")[1]:t,n=atob(e),i=new Uint8Array(n.length);for(let d=0;d<n.length;d++)i[d]=n.charCodeAt(d);let s=new Blob([i],{type:"application/pdf"});return URL.createObjectURL(s)}catch(e){throw e}}arrayBufferToBase64(t){let e=new Uint8Array(t),n="";for(let i=0;i<e.byteLength;i++)n+=String.fromCharCode(e[i]);return btoa(n)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-split"]],standalone:!1,decls:10,vars:8,consts:[[1,"header"],[1,"back-button",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"header-center"],[1,"header-right"],["class","main-content",4,"ngIf"],[3,"navigate","retry","isVisible","isComplete","isFailed","title","subtitle","buttonText"],["class","bottom-action",4,"ngIf"],[1,"main-content"],[1,"info-message"],["src","images/icons/ico-tooltip-info.svg","alt","\uC815\uBCF4","width","20","height","20"],[1,"document-card"],["class","thumbnail",4,"ngIf"],[1,"document-details"],[1,"document-title"],[1,"document-meta"],[1,"meta-item"],[1,"meta-divider"],[1,"document-date"],[1,"extract-all-section"],[1,"extract-all-card",3,"click"],[1,"card-icon"],["src","images/icons/ico-file.svg","alt","\uD30C\uC77C","width","24","height","24"],[1,"card-content"],[1,"card-title"],[1,"card-description"],[1,"card-arrow"],["src","images/icons/btn-view-next.svg","alt","\uC774\uB3D9","width","20","height","20"],[1,"thumbnail"],["alt","PDF \uBBF8\uB9AC\uBCF4\uAE30",3,"src"],[1,"bottom-action"],[1,"apply-button",3,"click","disabled"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"button",1),u("click",function(){return n.cancel()}),h(2,"img",2),a(),o(3,"div",3)(4,"h2"),c(5,"PDF \uBD84\uD560"),a()(),h(6,"div",4),a(),b(7,Vp,35,9,"div",5),o(8,"app-processing-modal",6),u("navigate",function(){return n.onNavigateToFile()})("retry",function(){return n.onRetry()}),a(),b(9,Lp,3,1,"div",7)),e&2&&(l(7),p("ngIf",n.document&&!n.isProcessing),l(),p("isVisible",n.isProcessing)("isComplete",n.isComplete)("isFailed",n.isFailed)("title",n.processingTitle)("subtitle",n.processingSubtitle)("buttonText","\uD30C\uC77C\uC704\uCE58\uB85C \uC774\uB3D9"),l(),p("ngIf",!n.isProcessing))},dependencies:[B,Ee,Oe],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100vh;background:#f5f5f5;padding-top:var(--android-status-bar-height, 0px);padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:border-box}.header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:#fff;border-bottom:1px solid #e0e0e0;position:sticky;top:0;z-index:10}.header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{padding:8px;background:none;border:none;color:#333;cursor:pointer;border-radius:50%;display:flex;align-items:center;justify-content:center}.header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:active{background:#f0f0f0}.header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]{flex:1;text-align:center}.header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#333}.header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{width:40px}.main-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px;background:#f5f5f5}.info-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;background:#e3f2fd;border-radius:8px;margin-bottom:16px}.info-message[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.info-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;font-size:14px;color:#1976d2;line-height:1.5}.document-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;display:flex;gap:16px;align-items:flex-start;box-shadow:0 2px 8px #00000014;margin-bottom:16px}.document-card[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]{width:60px;height:80px;border-radius:4px;overflow:hidden;background:#f0f0f0;flex-shrink:0;border:1px solid #e0e0e0}.document-card[_ngcontent-%COMP%]   .thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.document-card[_ngcontent-%COMP%]   .document-details[_ngcontent-%COMP%]{flex:1;min-width:0}.document-card[_ngcontent-%COMP%]   .document-title[_ngcontent-%COMP%]{margin:0 0 8px;font-size:15px;font-weight:600;color:#333;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.document-card[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-bottom:6px}.document-card[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{font-size:13px;color:#666}.document-card[_ngcontent-%COMP%]   .document-meta[_ngcontent-%COMP%]   .meta-divider[_ngcontent-%COMP%]{color:#ccc;font-size:12px}.document-card[_ngcontent-%COMP%]   .document-date[_ngcontent-%COMP%]{font-size:13px;color:#999}.extract-all-section[_ngcontent-%COMP%]{margin-bottom:16px}.extract-all-section[_ngcontent-%COMP%]   .extract-all-card[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;background:#fff;border:none;border-radius:12px;padding:20px;box-shadow:0 2px 8px #00000014;cursor:pointer;transition:all .2s;text-align:left}.extract-all-section[_ngcontent-%COMP%]   .extract-all-card[_ngcontent-%COMP%]:active{transform:scale(.98);background:#f8f9fa}.extract-all-section[_ngcontent-%COMP%]   .extract-all-card[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:48px;height:48px;background:#ef5350;border-radius:12px;flex-shrink:0;margin-right:16px}.extract-all-section[_ngcontent-%COMP%]   .extract-all-card[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;stroke:#fff}.extract-all-section[_ngcontent-%COMP%]   .extract-all-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{flex:1}.extract-all-section[_ngcontent-%COMP%]   .extract-all-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{margin:0 0 6px;font-size:16px;font-weight:600;color:#333}.extract-all-section[_ngcontent-%COMP%]   .extract-all-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .card-description[_ngcontent-%COMP%]{margin:0;font-size:13px;line-height:1.5;color:#666}.extract-all-section[_ngcontent-%COMP%]   .extract-all-card[_ngcontent-%COMP%]   .card-arrow[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-shrink:0}.extract-all-section[_ngcontent-%COMP%]   .extract-all-card[_ngcontent-%COMP%]   .card-arrow[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;stroke:#999}.range-input-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;margin-bottom:16px;box-shadow:0 2px 8px #00000014}.range-input-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.range-input-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:600;color:#333}.range-input-section[_ngcontent-%COMP%]   .extract-all-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 14px;background:#2196f3;color:#fff;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.range-input-section[_ngcontent-%COMP%]   .extract-all-button[_ngcontent-%COMP%]:hover{background:#1976d2}.range-input-section[_ngcontent-%COMP%]   .extract-all-button[_ngcontent-%COMP%]:active{transform:scale(.98)}.range-input-section[_ngcontent-%COMP%]   .extract-all-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px}.range-input-section[_ngcontent-%COMP%]   .range-input-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:12px}.range-input-section[_ngcontent-%COMP%]   .range-input-row[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{flex:1}.range-input-section[_ngcontent-%COMP%]   .range-input-row[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:13px;color:#666;font-weight:500}.range-input-section[_ngcontent-%COMP%]   .range-input-row[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .page-input[_ngcontent-%COMP%]{width:100%;height:44px;padding:0 12px;border:2px solid #e0e0e0;border-radius:8px;font-size:15px;color:#333;transition:all .2s}.range-input-section[_ngcontent-%COMP%]   .range-input-row[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .page-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;background:#f8f9fa}.range-input-section[_ngcontent-%COMP%]   .range-input-row[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{font-size:18px;color:#999;font-weight:500;margin-bottom:12px}.range-input-section[_ngcontent-%COMP%]   .range-input-row[_ngcontent-%COMP%]   .add-range-button[_ngcontent-%COMP%]{width:44px;height:44px;background:#2196f3;color:#fff;border:none;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .2s}.range-input-section[_ngcontent-%COMP%]   .range-input-row[_ngcontent-%COMP%]   .add-range-button[_ngcontent-%COMP%]:active{background:#1976d2;transform:scale(.95)}.split-ranges-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;margin-bottom:16px;box-shadow:0 2px 8px #00000014}.split-ranges-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 16px;font-size:16px;font-weight:600;color:#333}.split-ranges-section[_ngcontent-%COMP%]   .split-range-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.split-ranges-section[_ngcontent-%COMP%]   .split-range-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;background:#f8f9fa;border-radius:10px;border:1px solid #e0e0e0;transition:all .2s}.split-ranges-section[_ngcontent-%COMP%]   .split-range-item[_ngcontent-%COMP%]:active{background:#f0f1f2}.split-ranges-section[_ngcontent-%COMP%]   .split-range-item[_ngcontent-%COMP%]   .range-info[_ngcontent-%COMP%]{flex:1;min-width:0}.split-ranges-section[_ngcontent-%COMP%]   .split-range-item[_ngcontent-%COMP%]   .range-pages[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:6px}.split-ranges-section[_ngcontent-%COMP%]   .split-range-item[_ngcontent-%COMP%]   .range-pages[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;color:#666}.split-ranges-section[_ngcontent-%COMP%]   .split-range-item[_ngcontent-%COMP%]   .range-pages[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333}.split-ranges-section[_ngcontent-%COMP%]   .split-range-item[_ngcontent-%COMP%]   .range-pages[_ngcontent-%COMP%]   .page-count[_ngcontent-%COMP%]{font-size:13px;color:#999;font-weight:400}.split-ranges-section[_ngcontent-%COMP%]   .split-range-item[_ngcontent-%COMP%]   .range-filename[_ngcontent-%COMP%]{font-size:13px;color:#666;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.split-ranges-section[_ngcontent-%COMP%]   .split-range-item[_ngcontent-%COMP%]   .remove-button[_ngcontent-%COMP%]{width:32px;height:32px;padding:0;background:#ffebee;color:#f44336;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .2s}.split-ranges-section[_ngcontent-%COMP%]   .split-range-item[_ngcontent-%COMP%]   .remove-button[_ngcontent-%COMP%]:active{background:#ffcdd2;transform:scale(.9)}.empty-state[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:48px 20px;text-align:center;box-shadow:0 2px 8px #00000014}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#999}.bottom-action[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;padding:16px;background:#fff;border-top:1px solid #e0e0e0;z-index:10}.bottom-action[_ngcontent-%COMP%]   .apply-button[_ngcontent-%COMP%]{width:100%;height:52px;background:#ef5350;color:#fff;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s}.bottom-action[_ngcontent-%COMP%]   .apply-button[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed;opacity:.6}.bottom-action[_ngcontent-%COMP%]   .apply-button[_ngcontent-%COMP%]:not(:disabled):active{background:#e53935;transform:scale(.98)}.processing-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:1000}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:32px;text-align:center;max-width:300px;width:90%}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #e0e0e0;border-top-color:#2196f3;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:18px;font-weight:600;color:#333}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#e0e0e0;border-radius:4px;overflow:hidden;margin-bottom:12px}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#ef5350,#e53935);border-radius:4px;transition:width .3s ease}.processing-overlay[_ngcontent-%COMP%]   .processing-content[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#666;font-weight:500}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};var li=class r{fontkitLoaded=!1;fontCache=new Map;static FONT_OPTIONS=[{value:"Helvetica",label:"Helvetica",type:"standard",supportsKorean:!1},{value:"Times",label:"Times New Roman",type:"standard",supportsKorean:!1},{value:"Courier",label:"Courier",type:"standard",supportsKorean:!1},{value:"NotoSansKR",label:"Noto Sans KR",type:"custom",supportsKorean:!0,file:"NotoSansKR-Regular.ttf"},{value:"NanumGothic",label:"\uB098\uB214\uACE0\uB515",type:"custom",supportsKorean:!0,file:"NanumGothic-Regular.ttf"},{value:"NanumMyeongjo",label:"\uB098\uB214\uBA85\uC870",type:"custom",supportsKorean:!0,file:"NanumMyeongjo-Regular.ttf"},{value:"IBMPlexSansKR",label:"IBM Plex Sans KR",type:"custom",supportsKorean:!0,file:"IBMPlexSansKR-Regular.ttf"},{value:"Roboto",label:"Roboto",type:"custom",supportsKorean:!1,file:"Roboto-Regular.ttf"},{value:"Lato",label:"Lato",type:"custom",supportsKorean:!1,file:"Lato-Regular.ttf"}];constructor(){}loadFontkit(){return C(this,null,function*(){if(!this.fontkitLoaded){if(window.fontkit){this.fontkitLoaded=!0;return}return new Promise((t,e)=>{let n=document.createElement("script");n.src="assets/libs/fontkit.umd.min.js",n.onload=()=>{this.fontkitLoaded=!0,console.log("\u2705 fontkit \uB85C\uB4DC \uC644\uB8CC"),t()},n.onerror=()=>{e(new Error("fontkit \uB85C\uB4DC \uC2E4\uD328"))},document.head.appendChild(n)})}})}registerFontkit(t){window.fontkit&&t.registerFontkit(window.fontkit)}loadFontFile(t){return C(this,null,function*(){if(this.fontCache.has(t))return this.fontCache.get(t);let e=r.FONT_OPTIONS.find(d=>d.value===t);if(!e||e.type==="standard"||!e.file)throw new Error(`\uD3F0\uD2B8 \uD30C\uC77C\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4: ${t}`);let n=yield fetch(`fonts/${e.file}`);if(!n.ok)throw new Error(`\uD3F0\uD2B8 \uD30C\uC77C \uB85C\uB4DC \uC2E4\uD328: ${e.file}`);let i=yield n.arrayBuffer(),s=new Uint8Array(i);return this.fontCache.set(t,s),console.log(`\u2705 \uD3F0\uD2B8 \uB85C\uB4DC: ${t}`),s})}embedFont(t,e){return C(this,null,function*(){let n=r.FONT_OPTIONS.find(i=>i.value===e);if(!n)return console.warn(`\uC54C \uC218 \uC5C6\uB294 \uD3F0\uD2B8: ${e}, Helvetica\uB85C \uB300\uCCB4`),t.embedFont(PDFLib.StandardFonts.Helvetica);if(n.type==="standard")switch(e){case"Helvetica":return t.embedFont(PDFLib.StandardFonts.Helvetica);case"Times":return t.embedFont(PDFLib.StandardFonts.TimesRoman);case"Courier":return t.embedFont(PDFLib.StandardFonts.Courier);default:return t.embedFont(PDFLib.StandardFonts.Helvetica)}yield this.loadFontkit(),this.registerFontkit(t);try{let i=yield this.loadFontFile(e),s=yield t.embedFont(i);return console.log(`\u2705 \uD3F0\uD2B8 \uC784\uBCA0\uB529 \uC644\uB8CC: ${e}`),s}catch(i){return console.error(`\uD3F0\uD2B8 \uC784\uBCA0\uB529 \uC2E4\uD328: ${e}`,i),t.embedFont(PDFLib.StandardFonts.Helvetica)}})}containsKorean(t){return/[---]/.test(t)}fontSupportsKorean(t){return r.FONT_OPTIONS.find(n=>n.value===t)?.supportsKorean??!1}getOptimalFont(t,e){return this.containsKorean(e)&&!this.fontSupportsKorean(t)?(console.log(`\u26A0\uFE0F \uD55C\uAE00 \uD14D\uC2A4\uD2B8 \uAC10\uC9C0: ${t} \u2192 NotoSansKR \uC804\uD658`),"NotoSansKR"):t}hexToRgb(t){let e=t.replace("#","");if(e.length===3&&(e=e.split("").map(d=>d+d).join("")),e.length!==6||!/^[0-9A-Fa-f]{6}$/.test(e))return console.warn(`\uC798\uBABB\uB41C HEX \uC0C9\uC0C1: ${t}, \uAC80\uC815\uC0C9\uC73C\uB85C \uB300\uCCB4`),{r:0,g:0,b:0};let n=parseInt(e.substring(0,2),16)/255,i=parseInt(e.substring(2,4),16)/255,s=parseInt(e.substring(4,6),16)/255;return isNaN(n)||isNaN(i)||isNaN(s)?(console.warn(`HEX \uD30C\uC2F1 \uC2E4\uD328: ${t}, \uAC80\uC815\uC0C9\uC73C\uB85C \uB300\uCCB4`),{r:0,g:0,b:0}):{r:n,g:i,b:s}}getFontOptions(){return r.FONT_OPTIONS.map(t=>({value:t.value,label:t.label,supportsKorean:t.supportsKorean}))}getKoreanFontOptions(){return r.FONT_OPTIONS.filter(t=>t.supportsKorean).map(t=>({value:t.value,label:t.label}))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};var Np=["previewCanvas"],jp=["mainContent"];function Up(r,t){r&1&&(o(0,"div",35),h(1,"div",36),o(2,"span"),c(3,"\uBBF8\uB9AC\uBCF4\uAE30 \uC0DD\uC131 \uC911..."),a()())}function $p(r,t){if(r&1&&(o(0,"div",37),h(1,"img",38),o(2,"div",39),c(3),a()()),r&2){let e=g(2);l(),p("src",e.previewImageUrl,ce),l(),p("ngStyle",e.previewNumberStyle),l(),S(" ",e.previewPageNumberText," ")}}function Hp(r,t){r&1&&(o(0,"div",40),c(1,"1"),a())}function Wp(r,t){if(r&1&&(o(0,"div",30)(1,"div",31),b(2,Up,4,0,"div",32)(3,$p,4,3,"div",33)(4,Hp,2,0,"div",34),a()()),r&2){let e=g();l(2),p("ngIf",e.isPreviewLoading),l(),p("ngIf",e.previewImageUrl&&!e.isPreviewLoading),l(),p("ngIf",e.previewImageUrl&&!e.isPreviewLoading)}}function Kp(r,t){if(r&1&&(o(0,"option",41),c(1),a()),r&2){let e=t.$implicit;p("value",e.value)("hidden",!e.supportsKorean),l(),S(" ",e.label," ")}}function Gp(r,t){if(r&1&&(o(0,"option",41),c(1),a()),r&2){let e=t.$implicit;p("value",e.value)("hidden",e.supportsKorean),l(),S(" ",e.label," ")}}function Yp(r,t){if(r&1){let e=y();o(0,"button",42),u("click",function(){let i=m(e).$implicit,s=g();return f(s.onPositionChange(i.value))}),o(1,"span",43),c(2,"1"),a()()}if(r&2){let e=t.$implicit,n=g();k("active",n.settings.position===e.value),Be("aria-label",e.value)}}function qp(r,t){if(r&1){let e=y();o(0,"button",44),u("click",function(){let i=m(e).$implicit,s=g();return f(s.onTemplateChange(i.value))}),c(1),a()}if(r&2){let e=t.$implicit,n=g();k("active",n.settings.template===e.value),l(),S(" ",e.label," ")}}function Xp(r,t){r&1&&(o(0,"span"),c(1,"\uD398\uC774\uC9C0 \uBC88\uD638 \uC801\uC6A9"),a())}function Jp(r,t){r&1&&(o(0,"span"),c(1,"\uCC98\uB9AC \uC911..."),a())}var ci=class r{previewCanvasRef;mainContentRef;docData=null;pdfDoc=null;pdfJsDoc=null;totalPages=0;previewImageUrl="";isScrolled=!1;scrollThreshold=200;previewBlobUrl="";pdfWidth=0;pdfHeight=0;isProcessing=!1;isPreviewLoading=!1;isComplete=!1;isFailed=!1;processingTitle="\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.";processingSubtitle="";savedDocId="";savedFolderId=null;settings={font:"NotoSansKR",fontSize:12,color:"#000000",position:"bottom-center",template:"1",startNumber:1};positionOptions=[{value:"top-left",row:0,col:0},{value:"top-center",row:0,col:1},{value:"top-right",row:0,col:2},{value:"middle-left",row:1,col:0},{value:"middle-center",row:1,col:1},{value:"middle-right",row:1,col:2},{value:"bottom-left",row:2,col:0},{value:"bottom-center",row:2,col:1},{value:"bottom-right",row:2,col:2}];fontOptions=[];templateOptions=[{value:"1",label:"1, 2, 3..."},{value:"Page 1",label:"Page 1, Page 2..."},{value:"\uD398\uC774\uC9C0 1",label:"\uD398\uC774\uC9C0 1, \uD398\uC774\uC9C0 2..."},{value:"1/N",label:"1/N, 2/N..."}];router=P(N);indexedDbService=P(ee);snackbar=P(G);cdr=P(fe);toolActionService=P(le);pdfjsLibService=P(Me);pdfThumbnailService=P(lt);pdfFontService=P(li);constructor(){let t=this.router.getCurrentNavigation();t?.extras.state&&(this.docData=t.extras.state.docData),this.fontOptions=this.pdfFontService.getFontOptions(),this.settings.font="NanumGothic"}ngOnInit(){return C(this,null,function*(){let t=this.toolActionService.getPendingAction();if(t&&t.data?.documentId){yield this.loadDocumentById(t.data.documentId),this.toolActionService.clearPendingAction();return}if(!this.docData){this.snackbar.showError("\uBB38\uC11C \uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin();return}try{yield this.loadPdf()}catch{this.snackbar.showError("PDF\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin()}})}ngAfterViewInit(){}ngOnDestroy(){this.previewBlobUrl&&URL.revokeObjectURL(this.previewBlobUrl)}onWindowScroll(){this.checkScrollPosition()}onContentScroll(t){let n=t.target.scrollTop;this.isScrolled=n>this.scrollThreshold,this.cdr.detectChanges()}checkScrollPosition(){if(this.mainContentRef?.nativeElement){let t=this.mainContentRef.nativeElement.scrollTop;this.isScrolled=t>this.scrollThreshold,this.cdr.detectChanges()}}loadDocumentById(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t);e?(this.docData=e,yield this.loadPdf()):(this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin()}})}loadPdf(){return C(this,null,function*(){if(!this.docData?.pdfBase64)throw new Error("PDF \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");let t=this.docData.pdfBase64.includes(",")?this.docData.pdfBase64.split(",")[1]:this.docData.pdfBase64,e=atob(t),n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);this.pdfDoc=yield PDFLib.PDFDocument.load(n),this.totalPages=this.pdfDoc.getPageCount(),yield this.loadPdfJsDocument(n),yield this.generatePreview()})}loadPdfJsDocument(t){return C(this,null,function*(){try{this.pdfJsDoc=yield this.pdfjsLibService.getDocument({data:t})}catch(e){console.error("pdf.js \uBB38\uC11C \uB85C\uB4DC \uC2E4\uD328:",e)}})}generatePreview(){return C(this,null,function*(){if(this.pdfJsDoc)try{this.isPreviewLoading=!0,this.cdr.detectChanges();let t=yield this.pdfJsDoc.getPage(1),e=t.getViewport({scale:1});this.pdfWidth=e.width,this.pdfHeight=e.height;let i=150/e.width,s=t.getViewport({scale:i}),d=document.createElement("canvas");d.width=s.width,d.height=s.height;let _=d.getContext("2d");yield t.render({canvasContext:_,viewport:s}).promise;let v=yield new Promise(w=>{d.toBlob(M=>w(M),"image/png")});this.previewBlobUrl&&URL.revokeObjectURL(this.previewBlobUrl),this.previewBlobUrl=URL.createObjectURL(v),this.previewImageUrl=this.previewBlobUrl,this.isPreviewLoading=!1,this.cdr.detectChanges()}catch(t){console.error("\uBBF8\uB9AC\uBCF4\uAE30 \uC0DD\uC131 \uC2E4\uD328:",t),this.isPreviewLoading=!1,this.cdr.detectChanges()}})}get previewPageNumberText(){return this.generatePageNumberText(0)}get previewNumberStyle(){let[t,e]=this.settings.position.split("-"),n=this.pdfWidth>0?40/this.pdfWidth*100:5,s=this.pdfWidth>0?150/this.pdfWidth:.25,_={"font-size":`${Math.max(this.settings.fontSize*s,6)}px`,color:this.settings.color,"font-family":this.getFontFamily(this.settings.font),position:"absolute","white-space":"nowrap"};switch(e){case"left":_.left=`${n}%`;break;case"center":_.left="50%",_.transform="translateX(-50%)";break;case"right":_.right=`${n}%`;break}switch(t){case"top":_.top=`${n}%`;break;case"middle":_.top="50%",e==="center"?_.transform="translate(-50%, -50%)":_.transform="translateY(-50%)";break;case"bottom":_.bottom=`${n}%`;break}return _}get floatingNumberStyle(){let[t,e]=this.settings.position.split("-"),n=8,s=this.pdfWidth>0?80/this.pdfWidth:.13,_={"font-size":`${Math.max(this.settings.fontSize*s,4)}px`,color:this.settings.color,"font-family":this.getFontFamily(this.settings.font),position:"absolute","white-space":"nowrap"};switch(e){case"left":_.left=`${n}%`;break;case"center":_.left="50%",_.transform="translateX(-50%)";break;case"right":_.right=`${n}%`;break}switch(t){case"top":_.top=`${n}%`;break;case"middle":_.top="50%",e==="center"?_.transform="translate(-50%, -50%)":_.transform="translateY(-50%)";break;case"bottom":_.bottom=`${n}%`;break}return _}getFontFamily(t){switch(t){case"Times":return"Times New Roman, serif";case"Courier":return"Courier New, monospace";case"NanumGothic":return'"Nanum Gothic", "\uB098\uB214\uACE0\uB515", sans-serif';case"NanumMyeongjo":return'"Nanum Myeongjo", "\uB098\uB214\uBA85\uC870", serif';case"NotoSansKR":return'"Noto Sans KR", sans-serif';case"IBMPlexSansKR":return'"IBM Plex Sans KR", sans-serif';case"Roboto":return"Roboto, sans-serif";case"Lato":return"Lato, sans-serif";case"Helvetica":default:return"Helvetica, Arial, sans-serif"}}onFontChange(t){this.settings.font=t.target.value}onFontSizeChange(t){this.settings.fontSize=parseInt(t.target.value,10)}onColorChange(t){this.settings.color=t.target.value}onPositionChange(t){this.settings.position=t}onTemplateChange(t){this.settings.template=t}onStartNumberChange(t){let e=parseInt(t.target.value,10);!isNaN(e)&&e>=1&&(this.settings.startNumber=e)}generatePageNumberText(t){let e=this.settings.startNumber+t;switch(this.settings.template){case"1":return`${e}`;case"Page 1":return`Page ${e}`;case"\uD398\uC774\uC9C0 1":return`\uD398\uC774\uC9C0 ${e}`;case"1/N":return`${e}/${this.totalPages}`;default:return`${e}`}}applyPageNumbers(){return C(this,null,function*(){if(!(!this.pdfDoc||this.isProcessing))try{this.isProcessing=!0,this.processingTitle="\uD398\uC774\uC9C0 \uBC88\uD638\uB97C \uCD94\uAC00\uD558\uACE0 \uC788\uC2B5\uB2C8\uB2E4...",this.cdr.detectChanges();let t=this.generatePageNumberText(0),e=this.pdfFontService.containsKorean(t),n=this.pdfFontService.getOptimalFont(this.settings.font,t),i=yield this.pdfFontService.embedFont(this.pdfDoc,n),s=this.pdfFontService.hexToRgb(this.settings.color),d=this.pdfDoc.getPages();for(let D=0;D<d.length;D++){let T=d[D],{width:I,height:z}=T.getSize(),A=this.generatePageNumberText(D),Y=i.widthOfTextAtSize(A,this.settings.fontSize),Q=this.settings.fontSize,te=T.getRotation().angle,ie=I,Ie=z;(te===90||te===270)&&(ie=z,Ie=I);let[qe,Rt]=this.settings.position.split("-"),Xe=0,ze=40;switch(Rt){case"left":Xe=ze;break;case"center":Xe=(ie-Y)/2;break;case"right":Xe=ie-Y-ze;break}let Tt=0;switch(qe){case"top":Tt=Ie-ze;break;case"middle":Tt=Ie/2+Q/2;break;case"bottom":Tt=ze;break}let pn=Xe,gn=Tt;te===90?(pn=Tt,gn=ie-Xe):te===180?(pn=ie-Xe,gn=Ie-Tt):te===270&&(pn=Ie-Tt,gn=Xe),T.drawText(A,{x:pn,y:gn,size:this.settings.fontSize,font:i,color:PDFLib.rgb(s.r,s.g,s.b),rotate:PDFLib.degrees(-te)})}let _=yield this.pdfDoc.save(),v=this.docData.fileName||this.docData.title,w=this.generateNewFileName(v),M=this.uint8ArrayToBase64(_),O=null;try{let D=new Blob([_],{type:"application/pdf"}),T=URL.createObjectURL(D),z=yield(yield this.pdfjsLibService.getDocument(T)).getPage(1);O=yield this.pdfThumbnailService.renderHighQualityThumbnail(z,1),URL.revokeObjectURL(T)}catch(D){console.warn("\uC378\uB124\uC77C \uC0DD\uC131 \uC2E4\uD328:",D)}let E=`doc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;yield this.indexedDbService.saveDocument({id:E,title:w,fileName:w,pdfBase64:`data:application/pdf;base64,${M}`,thumbnail:O||"",pages:[],elementCount:0,version:"1.0",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:"page-numbered",folderId:this.docData.folderId}),this.savedDocId=E,this.savedFolderId=this.docData.folderId||null,setTimeout(()=>{this.processingTitle="\uBB38\uC11C\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",this.processingSubtitle=`${w} \uD30C\uC77C\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,this.isComplete=!0},1e3)}catch{this.isFailed=!0,this.isProcessing=!0}})}generateNewFileName(t){return`${t.replace(/\.pdf$/i,"")}_\uD398\uC774\uC9C0\uBC88\uD638.pdf`}uint8ArrayToBase64(t){let n="";for(let i=0;i<t.length;i+=32768){let s=t.subarray(i,Math.min(i+32768,t.length));n+=String.fromCharCode(...Array.from(s))}return btoa(n)}goBack(){this.toolActionService.navigateToOrigin()}onNavigateToFile(){this.savedDocId?this.router.navigate(["/ezm/viewer"],{queryParams:{docId:this.savedDocId}}):this.savedFolderId?this.router.navigate(["/ezm/myfiles",this.savedFolderId]):this.router.navigate(["/ezm/myfiles","my-files"])}onRetry(){this.isFailed=!1,this.isProcessing=!1,this.isComplete=!1}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-page-number"]],viewQuery:function(e,n){if(e&1&&($e(Np,5),$e(jp,5)),e&2){let i;He(i=We())&&(n.previewCanvasRef=i.first),He(i=We())&&(n.mainContentRef=i.first)}},hostBindings:function(e,n){e&1&&u("scroll",function(){return n.onWindowScroll()},Lt)},standalone:!1,decls:55,vars:19,consts:[["mainContent",""],[3,"navigate","retry","isVisible","isComplete","isFailed","title","subtitle"],[1,"header"],[1,"header-left",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C\uAC00\uAE30","width","24","height","24"],[1,"header-center"],[1,"header-right"],["class","preview-section-fixed",4,"ngIf"],[1,"main-content",3,"scroll"],[1,"settings-section"],[1,"setting-group"],[1,"setting-label"],[1,"setting-select",3,"change","value"],["label","\uD55C\uAE00 \uC9C0\uC6D0"],[3,"value","hidden",4,"ngFor","ngForOf"],["label","\uC601\uBB38 \uC804\uC6A9"],["type","range","min","8","max","72",1,"setting-range",3,"input","value"],[1,"range-labels"],[1,"color-picker-wrapper"],["type","color",1,"color-picker",3,"input","value"],[1,"color-value"],[1,"position-grid"],["class","position-block",3,"active","click",4,"ngFor","ngForOf"],[1,"template-grid"],["class","template-btn",3,"active","click",4,"ngFor","ngForOf"],["type","number","min","1",1,"setting-input",3,"input","value"],[1,"bottom-spacer"],[1,"action-section"],[1,"apply-btn",3,"click","disabled"],[4,"ngIf"],[1,"preview-section-fixed"],[1,"preview-container"],["class","preview-loading",4,"ngIf"],["class","preview-wrapper",4,"ngIf"],["class","preview-page-indicator",4,"ngIf"],[1,"preview-loading"],[1,"loading-spinner"],[1,"preview-wrapper"],["alt","PDF \uBBF8\uB9AC\uBCF4\uAE30",1,"preview-image",3,"src"],[1,"page-number-overlay",3,"ngStyle"],[1,"preview-page-indicator"],[3,"value","hidden"],[1,"position-block",3,"click"],[1,"position-number"],[1,"template-btn",3,"click"]],template:function(e,n){if(e&1){let i=y();o(0,"app-processing-modal",1),u("navigate",function(){return m(i),f(n.onNavigateToFile())})("retry",function(){return m(i),f(n.onRetry())}),a(),o(1,"div",2)(2,"button",3),u("click",function(){return m(i),f(n.goBack())}),h(3,"img",4),a(),o(4,"div",5)(5,"h2"),c(6,"\uD398\uC774\uC9C0 \uBC88\uD638 \uCD94\uAC00"),a()(),h(7,"div",6),a(),b(8,Wp,5,3,"div",7),o(9,"div",8,0),u("scroll",function(d){return m(i),f(n.onContentScroll(d))}),o(11,"div",9)(12,"div",10)(13,"label",11),c(14,"\uD3F0\uD2B8"),a(),o(15,"select",12),u("change",function(d){return m(i),f(n.onFontChange(d))}),o(16,"optgroup",13),b(17,Kp,2,3,"option",14),a(),o(18,"optgroup",15),b(19,Gp,2,3,"option",14),a()()(),o(20,"div",10)(21,"label",11),c(22),a(),o(23,"input",16),u("input",function(d){return m(i),f(n.onFontSizeChange(d))}),a(),o(24,"div",17)(25,"span"),c(26,"8pt"),a(),o(27,"span"),c(28,"72pt"),a()()(),o(29,"div",10)(30,"label",11),c(31,"\uD14D\uC2A4\uD2B8 \uC0C9\uC0C1"),a(),o(32,"div",18)(33,"input",19),u("input",function(d){return m(i),f(n.onColorChange(d))}),a(),o(34,"span",20),c(35),a()()(),o(36,"div",10)(37,"label",11),c(38,"\uD398\uC774\uC9C0 \uBC88\uD638 \uC704\uCE58"),a(),o(39,"div",21),b(40,Yp,3,3,"button",22),a()(),o(41,"div",10)(42,"label",11),c(43,"\uD15C\uD50C\uB9BF"),a(),o(44,"div",23),b(45,qp,2,3,"button",24),a()(),o(46,"div",10)(47,"label",11),c(48,"\uC2DC\uC791 \uBC88\uD638"),a(),o(49,"input",25),u("input",function(d){return m(i),f(n.onStartNumberChange(d))}),a()()(),h(50,"div",26),a(),o(51,"div",27)(52,"button",28),u("click",function(){return m(i),f(n.applyPageNumbers())}),b(53,Xp,2,0,"span",29)(54,Jp,2,0,"span",29),a()()}e&2&&(p("isVisible",n.isProcessing)("isComplete",n.isComplete)("isFailed",n.isFailed)("title",n.processingTitle)("subtitle",n.processingSubtitle),l(8),p("ngIf",n.previewImageUrl||n.isPreviewLoading),l(7),p("value",n.settings.font),l(2),p("ngForOf",n.fontOptions),l(2),p("ngForOf",n.fontOptions),l(3),S("\uD06C\uAE30: ",n.settings.fontSize,"pt"),l(),p("value",n.settings.fontSize),l(10),p("value",n.settings.color),l(2),x(n.settings.color),l(5),p("ngForOf",n.positionOptions),l(5),p("ngForOf",n.templateOptions),l(4),p("value",n.settings.startNumber),l(3),p("disabled",n.isProcessing),l(),p("ngIf",!n.isProcessing),l(),p("ngIf",n.isProcessing))},dependencies:[oe,B,Cn,Ve,Le,Ee],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100vh;background-color:#f5f5f5;padding-top:var(--android-status-bar-height, 0px);padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:border-box;position:relative}.floating-preview[_ngcontent-%COMP%]{position:fixed;top:calc(56px + var(--android-status-bar-height, 0px) + 16px);right:16px;z-index:200;animation:_ngcontent-%COMP%_fadeInSlide .3s ease}@keyframes _ngcontent-%COMP%_fadeInSlide{0%{opacity:0;transform:translate(20px)}to{opacity:1;transform:translate(0)}}.floating-preview-container[_ngcontent-%COMP%]{position:relative;width:80px;background:#fff;border-radius:8px;box-shadow:0 4px 16px #00000026;overflow:hidden}.floating-preview-image[_ngcontent-%COMP%]{width:100%;height:auto;display:block}.floating-page-number[_ngcontent-%COMP%]{font-weight:600;text-shadow:0 1px 2px rgba(255,255,255,.8)}.floating-preview-page[_ngcontent-%COMP%]{text-align:center;font-size:11px;color:#666;margin-top:4px;background:#ffffffe6;padding:2px 6px;border-radius:4px}.header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:56px;padding:0 8px;background-color:#fff;border-bottom:1px solid #e0e0e0;position:sticky;top:0;z-index:100;flex-shrink:0}.header-left[_ngcontent-%COMP%], .header-right[_ngcontent-%COMP%]{width:48px;height:48px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:#333}.header-left[_ngcontent-%COMP%]:active, .header-right[_ngcontent-%COMP%]:active{opacity:.6}.header-center[_ngcontent-%COMP%]{flex:1;text-align:center}.header-center[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#333}.main-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px 16px 100px}.preview-section-fixed[_ngcontent-%COMP%]{position:sticky;top:0;z-index:50;background:#f5f5f5;padding:8px 16px;border-bottom:1px solid #e0e0e0;flex-shrink:0}.preview-section[_ngcontent-%COMP%]{margin-bottom:20px}.preview-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:#fff;border-radius:8px;padding:8px;box-shadow:0 2px 8px #0000000d}.preview-loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;padding:20px 0;color:#666;font-size:12px}.loading-spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:2px solid #e0e0e0;border-top-color:#673ab7;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.preview-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;max-width:150px;border:1px solid #e0e0e0;border-radius:4px;overflow:hidden;background:#fff;box-shadow:0 1px 4px #0000001a}.preview-image[_ngcontent-%COMP%]{display:block;max-width:150px;max-height:200px;height:auto;object-fit:contain}.page-number-overlay[_ngcontent-%COMP%]{position:absolute;font-weight:600;text-shadow:1px 1px 0 rgba(255,255,255,.8),-1px -1px 0 rgba(255,255,255,.8),1px -1px 0 rgba(255,255,255,.8),-1px 1px 0 rgba(255,255,255,.8);pointer-events:none}.preview-page-indicator[_ngcontent-%COMP%]{margin-top:4px;font-size:11px;color:#666}.bottom-spacer[_ngcontent-%COMP%]{height:20px}.info-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px;background-color:#fff;border-radius:12px;box-shadow:0 2px 8px #0000000d;margin-bottom:24px}.info-icon[_ngcontent-%COMP%]{flex-shrink:0;width:48px;height:48px;display:flex;align-items:center;justify-content:center;background-color:#f3e5f5;border-radius:12px}.info-content[_ngcontent-%COMP%]{flex:1;min-width:0}.info-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:4px}.info-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#666}.settings-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.setting-group[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;padding:16px;box-shadow:0 2px 8px #0000000d}.setting-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:600;color:#333;margin-bottom:12px}.setting-select[_ngcontent-%COMP%]{width:100%;padding:12px;font-size:15px;border:1px solid #e0e0e0;border-radius:8px;background-color:#fff;color:#333;cursor:pointer}.setting-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#673ab7}.setting-range[_ngcontent-%COMP%]{width:100%;height:6px;border-radius:3px;background:#e0e0e0;outline:none;-webkit-appearance:none;appearance:none}.setting-range[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;border-radius:50%;background:#673ab7;cursor:pointer}.setting-range[_ngcontent-%COMP%]::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:#673ab7;cursor:pointer;border:none}.range-labels[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:8px;font-size:12px;color:#999}.color-picker-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.color-picker[_ngcontent-%COMP%]{width:60px;height:40px;border:1px solid #e0e0e0;border-radius:8px;cursor:pointer}.color-picker[_ngcontent-%COMP%]::-webkit-color-swatch-wrapper{padding:0}.color-picker[_ngcontent-%COMP%]::-webkit-color-swatch{border:none;border-radius:8px}.color-value[_ngcontent-%COMP%]{font-size:14px;font-family:monospace;color:#666}.position-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;padding:8px;background-color:#f8f9fa;border-radius:12px;max-width:280px;margin:0 auto}.position-block[_ngcontent-%COMP%]{aspect-ratio:1;display:flex;align-items:center;justify-content:center;background-color:#fff;border:2px solid #e0e0e0;border-radius:8px;cursor:pointer;transition:all .2s;position:relative;min-height:70px}.position-block[_ngcontent-%COMP%]:active{transform:scale(.95)}.position-block.active[_ngcontent-%COMP%]{background-color:#673ab7;border-color:#673ab7;box-shadow:0 4px 12px #673ab74d}.position-block.active[_ngcontent-%COMP%]   .position-number[_ngcontent-%COMP%]{color:#fff;font-weight:700}.position-block[_ngcontent-%COMP%]:not(.active):hover{border-color:#673ab7;background-color:#f3e5f5}.position-number[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#666;transition:all .2s}.position-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.position-btn[_ngcontent-%COMP%]{flex:1;padding:12px;font-size:14px;font-weight:500;color:#666;background-color:#f5f5f5;border:1px solid #e0e0e0;border-radius:8px;cursor:pointer;transition:all .2s}.position-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}.position-btn.active[_ngcontent-%COMP%]{color:#fff;background-color:#673ab7;border-color:#673ab7}.template-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:8px}.template-btn[_ngcontent-%COMP%]{padding:12px;font-size:14px;font-weight:500;color:#666;background-color:#f5f5f5;border:1px solid #e0e0e0;border-radius:8px;cursor:pointer;transition:all .2s;text-align:center}.template-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}.template-btn.active[_ngcontent-%COMP%]{color:#fff;background-color:#673ab7;border-color:#673ab7}.setting-input[_ngcontent-%COMP%]{width:100%;padding:12px;font-size:15px;border:1px solid #e0e0e0;border-radius:8px;background-color:#fff;color:#333}.setting-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#673ab7}.setting-input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield;appearance:textfield}.setting-input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, .setting-input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.action-section[_ngcontent-%COMP%]{position:fixed;bottom:var(--android-navigation-bar-height, 0px);left:0;right:0;padding:16px;background-color:#fff;border-top:1px solid #e0e0e0;z-index:90}.apply-btn[_ngcontent-%COMP%]{width:100%;padding:16px;font-size:16px;font-weight:600;color:#fff;background-color:#673ab7;border:none;border-radius:12px;cursor:pointer;transition:all .2s}.apply-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98);background-color:#5e35b1}.apply-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}"]})};var Zp=["mainContent"];function Qp(r,t){if(r&1&&(o(0,"div",40),c(1),a()),r&2){let e=g(2);p("ngStyle",e.previewWatermarkStyle),l(),S(" ",e.settings.text," ")}}function eg(r,t){if(r&1&&(o(0,"span",43),c(1),a()),r&2){let e=t.$implicit,n=g(3);q("color",n.settings.color)("opacity",n.settings.opacity/100)("font-size",n.Math.max(n.settings.fontSize*.25,4),"px"),l(),x(e)}}function tg(r,t){if(r&1&&(o(0,"div",41),b(1,eg,2,7,"span",42),a()),r&2){let e=g(2);q("transform","rotate("+e.settings.rotation+"deg)")("row-gap",e.settings.patternSpacingY*.15,"px")("column-gap",e.settings.patternSpacingX*.15,"px"),l(),p("ngForOf",e.patternTexts.slice(0,30))}}function ng(r,t){if(r&1&&(o(0,"div",34)(1,"div",35),h(2,"img",36),b(3,Qp,2,2,"div",37)(4,tg,2,7,"div",38),a(),o(5,"div",39),c(6,"1"),a()()),r&2){let e=g();l(2),p("src",e.previewImageUrl,ce),l(),p("ngIf",e.settings.text&&!e.settings.isPattern),l(),p("ngIf",e.settings.text&&e.settings.isPattern)}}function ig(r,t){r&1&&(o(0,"div",49),h(1,"div",50),o(2,"span"),c(3,"\uBBF8\uB9AC\uBCF4\uAE30 \uC0DD\uC131 \uC911..."),a()())}function og(r,t){if(r&1&&(o(0,"div",55),c(1),a()),r&2){let e=g(3);p("ngStyle",e.previewWatermarkStyle),l(),S(" ",e.settings.text," ")}}function rg(r,t){if(r&1&&(o(0,"span",43),c(1),a()),r&2){let e=t.$implicit,n=g(4);q("color",n.settings.color)("opacity",n.settings.opacity/100)("font-size",n.Math.max(n.settings.fontSize*.4,6),"px")("font-family",n.settings.font==="Times"?"Times New Roman":n.settings.font),l(),x(e)}}function ag(r,t){if(r&1&&(o(0,"div",56),b(1,rg,2,9,"span",57),a()),r&2){let e=g(3);q("transform","rotate("+e.settings.rotation+"deg)")("gap",e.settings.patternSpacingY+" "+e.settings.patternSpacingX,"px")("row-gap",e.settings.patternSpacingY*.4,"px")("column-gap",e.settings.patternSpacingX*.4,"px"),l(),p("ngForOf",e.patternTexts)}}function sg(r,t){if(r&1&&(o(0,"div",51),h(1,"img",52),b(2,og,2,2,"div",53)(3,ag,2,9,"div",54),a()),r&2){let e=g(2);l(),p("src",e.previewImageUrl,ce),l(),p("ngIf",e.settings.text&&!e.settings.isPattern),l(),p("ngIf",e.settings.text&&e.settings.isPattern)}}function lg(r,t){r&1&&(o(0,"div",58),c(1,"1"),a())}function cg(r,t){if(r&1&&(o(0,"div",44)(1,"div",45),b(2,ig,4,0,"div",46)(3,sg,4,3,"div",47)(4,lg,2,0,"div",48),a()()),r&2){let e=g();l(2),p("ngIf",e.isPreviewLoading),l(),p("ngIf",e.previewImageUrl&&!e.isPreviewLoading),l(),p("ngIf",e.previewImageUrl&&!e.isPreviewLoading)}}function dg(r,t){if(r&1){let e=y();o(0,"div",10)(1,"h3",11),c(2,"\uD328\uD134 \uAC04\uACA9"),a(),o(3,"div",25)(4,"label",13),c(5),a(),o(6,"input",59),$("ngModelChange",function(i){m(e);let s=g();return U(s.settings.patternSpacingX,i)||(s.settings.patternSpacingX=i),f(i)}),a(),o(7,"div",27)(8,"span"),c(9,"\uC881\uAC8C"),a(),o(10,"span"),c(11,"\uB113\uAC8C"),a()()(),o(12,"div",25)(13,"label",13),c(14),a(),o(15,"input",59),$("ngModelChange",function(i){m(e);let s=g();return U(s.settings.patternSpacingY,i)||(s.settings.patternSpacingY=i),f(i)}),a(),o(16,"div",27)(17,"span"),c(18,"\uC881\uAC8C"),a(),o(19,"span"),c(20,"\uB113\uAC8C"),a()()()()}if(r&2){let e=g();l(5),S("\uAC00\uB85C \uAC04\uACA9: ",e.settings.patternSpacingX,"px"),l(),j("ngModel",e.settings.patternSpacingX),l(8),S("\uC138\uB85C \uAC04\uACA9: ",e.settings.patternSpacingY,"px"),l(),j("ngModel",e.settings.patternSpacingY)}}function pg(r,t){r&1&&(o(0,"span"),c(1,"\uC801\uC6A9\uD558\uAE30"),a())}function gg(r,t){r&1&&(o(0,"span"),c(1,"\uCC98\uB9AC \uC911..."),a())}function ug(r,t){if(r&1){let e=y();o(0,"div",60)(1,"h3",61),c(2,"\uD14D\uC2A4\uD2B8"),a(),o(3,"div",62)(4,"input",63),$("ngModelChange",function(i){m(e);let s=g();return U(s.tempValue,i)||(s.tempValue=i),f(i)}),a()(),o(5,"button",64),u("click",function(){m(e);let i=g();return f(i.applySheetValue())}),c(6,"\uC801\uC6A9"),a()()}if(r&2){let e=g();l(4),j("ngModel",e.tempValue)}}function mg(r,t){if(r&1){let e=y();o(0,"label",67)(1,"input",68),$("ngModelChange",function(i){m(e);let s=g(2);return U(s.tempValue,i)||(s.tempValue=i),f(i)}),a(),o(2,"span",69),c(3),a(),h(4,"span",70),a()}if(r&2){let e=t.$implicit,n=g(2);l(),p("value",e.value),j("ngModel",n.tempValue),l(2),x(e.label),l(),k("checked",n.tempValue===e.value)}}function fg(r,t){if(r&1){let e=y();o(0,"div",60)(1,"h3",61),c(2,"\uAE00\uAF34 \uC720\uD615"),a(),o(3,"div",62)(4,"div",65),b(5,mg,5,5,"label",66),a()(),o(6,"button",64),u("click",function(){m(e);let i=g();return f(i.applySheetValue())}),c(7,"\uC801\uC6A9"),a()()}if(r&2){let e=g();l(5),p("ngForOf",e.fontOptions)}}function hg(r,t){if(r&1){let e=y();o(0,"div",60)(1,"h3",61),c(2,"\uAE00\uAF34 \uD06C\uAE30"),a(),o(3,"div",62)(4,"div",71)(5,"button",72),u("click",function(){m(e);let i=g();return f(i.adjustFontSize(-1))}),c(6,"\u2212"),a(),o(7,"input",73),$("ngModelChange",function(i){m(e);let s=g();return U(s.tempValue,i)||(s.tempValue=i),f(i)}),a(),o(8,"button",72),u("click",function(){m(e);let i=g();return f(i.adjustFontSize(1))}),c(9,"+"),a()()(),o(10,"button",64),u("click",function(){m(e);let i=g();return f(i.applySheetValue())}),c(11,"\uC801\uC6A9"),a()()}if(r&2){let e=g();l(7),j("ngModel",e.tempValue)}}function _g(r,t){if(r&1){let e=y();o(0,"button",79),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.selectPresetColor(i.color))}),a()}if(r&2){let e=t.$implicit,n=g(2);q("background-color",e.color),k("active",n.tempValue===e.color)}}function Cg(r,t){if(r&1){let e=y();o(0,"div",60)(1,"h3",61),c(2,"\uC0C9\uC0C1"),a(),o(3,"div",62)(4,"div",74)(5,"input",75),$("ngModelChange",function(i){m(e);let s=g();return U(s.tempValue,i)||(s.tempValue=i),f(i)}),a()(),o(6,"div",76),b(7,_g,1,4,"button",77),a(),o(8,"div",78),c(9),a()(),o(10,"button",64),u("click",function(){m(e);let i=g();return f(i.applySheetValue())}),c(11,"\uC801\uC6A9"),a()()}if(r&2){let e=g();l(5),j("ngModel",e.tempValue),l(2),p("ngForOf",e.colorPresets),l(2),x(e.tempValue)}}function bg(r,t){if(r&1){let e=y();o(0,"label",67)(1,"input",80),$("ngModelChange",function(i){m(e);let s=g(2);return U(s.tempValue,i)||(s.tempValue=i),f(i)}),a(),o(2,"span",69),c(3),a(),h(4,"span",70),a()}if(r&2){let e=t.$implicit,n=g(2);l(),p("value",e.value),j("ngModel",n.tempValue),l(2),x(e.label),l(),k("checked",n.tempValue===e.value)}}function vg(r,t){if(r&1){let e=y();o(0,"div",60)(1,"h3",61),c(2,"\uC138\uB85C\uC704\uCE58"),a(),o(3,"div",62)(4,"div",65),b(5,bg,5,5,"label",66),a()(),o(6,"button",64),u("click",function(){m(e);let i=g();return f(i.applySheetValue())}),c(7,"\uC801\uC6A9"),a()()}if(r&2){let e=g();l(5),p("ngForOf",e.verticalPositionOptions)}}function xg(r,t){if(r&1){let e=y();o(0,"label",67)(1,"input",81),$("ngModelChange",function(i){m(e);let s=g(2);return U(s.tempValue,i)||(s.tempValue=i),f(i)}),a(),o(2,"span",69),c(3),a(),h(4,"span",70),a()}if(r&2){let e=t.$implicit,n=g(2);l(),p("value",e.value),j("ngModel",n.tempValue),l(2),x(e.label),l(),k("checked",n.tempValue===e.value)}}function Pg(r,t){if(r&1){let e=y();o(0,"div",60)(1,"h3",61),c(2,"\uAC00\uB85C\uC704\uCE58"),a(),o(3,"div",62)(4,"div",65),b(5,xg,5,5,"label",66),a()(),o(6,"button",64),u("click",function(){m(e);let i=g();return f(i.applySheetValue())}),c(7,"\uC801\uC6A9"),a()()}if(r&2){let e=g();l(5),p("ngForOf",e.horizontalPositionOptions)}}var di=class r{Math=Math;mainContentRef;docData=null;pdfDoc=null;pdfJsDoc=null;totalPages=0;previewImageUrl="";isScrolled=!1;scrollThreshold=200;previewBlobUrl="";isPreviewLoading=!1;fontManager=P(In);cdr=P(fe);pdfjsLibService=P(Me);pdfThumbnailService=P(lt);isProcessing=!1;isComplete=!1;isFailed=!1;processingTitle="\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.";processingSubtitle="";savedDocId="";savedFolderId=null;sheetState="collapsed";currentSheet=null;tempValue=null;settings={text:"",font:"Arial",fontSize:14,color:"#000000",verticalPosition:"bottom",horizontalPosition:"center",opacity:50,rotation:0,isPattern:!1,patternSpacingX:100,patternSpacingY:80};fontOptions=[{value:"Arial",label:"Arial"},{value:"Helvetica",label:"Helvetica"},{value:"Times",label:"Times New Roman"},{value:"Courier",label:"Courier"}];router=P(N);indexedDbService=P(ee);snackbar=P(G);toolActionService=P(le);constructor(){let t=this.router.getCurrentNavigation();t?.extras.state&&(this.docData=t.extras.state.docData)}ngOnInit(){return C(this,null,function*(){let t=this.toolActionService.getPendingAction();if(t&&t.data?.documentId){yield this.loadDocumentById(t.data.documentId),this.toolActionService.clearPendingAction();return}if(!this.docData){this.snackbar.showError("\uBB38\uC11C \uB370\uC774\uD130\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin();return}try{yield this.loadPdf()}catch(e){console.error("\u274C [Watermark] PDF \uB85C\uB4DC \uC2E4\uD328:",e),this.snackbar.showError("PDF\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin()}})}loadDocumentById(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t);e?(this.docData=e,yield this.loadPdf()):(this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin()}})}loadPdfLib(){return C(this,null,function*(){if(!window.PDFLib)return new Promise((t,e)=>{let n=document.createElement("script");n.src="assets/libs/pdf-lib.min.js",n.onload=()=>{window.PDFLib?t():e(new Error("pdf-lib \uB85C\uB4DC \uC2E4\uD328"))},n.onerror=()=>e(new Error("pdf-lib \uC2A4\uD06C\uB9BD\uD2B8 \uB85C\uB4DC \uC2E4\uD328")),document.head.appendChild(n)})})}loadPdf(){return C(this,null,function*(){if(!this.docData?.pdfBase64)throw new Error("PDF \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");yield this.loadPdfLib();let t=this.docData.pdfBase64.includes(",")?this.docData.pdfBase64.split(",")[1]:this.docData.pdfBase64,e=atob(t),n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i);this.pdfDoc=yield PDFLib.PDFDocument.load(n),this.totalPages=this.pdfDoc.getPageCount(),yield this.loadFontkit(),this.pdfDoc.registerFontkit(window.fontkit),yield this.loadPdfJsDocument(n),yield this.generatePreview()})}loadPdfJsDocument(t){return C(this,null,function*(){try{this.pdfJsDoc=yield this.pdfjsLibService.getDocument({data:t.slice().buffer})}catch(e){console.error("pdf.js \uBB38\uC11C \uB85C\uB4DC \uC2E4\uD328:",e)}})}generatePreview(){return C(this,null,function*(){if(this.pdfJsDoc)try{this.isPreviewLoading=!0,this.cdr.detectChanges();let t=yield this.pdfJsDoc.getPage(1),i=300/t.getViewport({scale:1}).width,s=t.getViewport({scale:i}),d=document.createElement("canvas");d.width=s.width,d.height=s.height;let _=d.getContext("2d");yield t.render({canvasContext:_,viewport:s}).promise;let v=yield new Promise(w=>{d.toBlob(M=>w(M),"image/png")});this.previewBlobUrl&&URL.revokeObjectURL(this.previewBlobUrl),this.previewBlobUrl=URL.createObjectURL(v),this.previewImageUrl=this.previewBlobUrl,this.isPreviewLoading=!1,this.cdr.detectChanges()}catch(t){console.error("\uBBF8\uB9AC\uBCF4\uAE30 \uC0DD\uC131 \uC2E4\uD328:",t),this.isPreviewLoading=!1,this.cdr.detectChanges()}})}ngAfterViewInit(){}ngOnDestroy(){this.previewBlobUrl&&URL.revokeObjectURL(this.previewBlobUrl)}onWindowScroll(){this.checkScrollPosition()}onContentScroll(t){let n=t.target.scrollTop;this.isScrolled=n>this.scrollThreshold,this.cdr.detectChanges()}checkScrollPosition(){if(this.mainContentRef?.nativeElement){let t=this.mainContentRef.nativeElement.scrollTop;this.isScrolled=t>this.scrollThreshold,this.cdr.detectChanges()}}get previewWatermarkStyle(){if(this.settings.isPattern)return this.previewPatternStyle;let t={"font-size":`${Math.max(this.settings.fontSize*.5,8)}px`,color:this.settings.color,"font-family":this.settings.font==="Times"?"Times New Roman":this.settings.font,position:"absolute",opacity:`${this.settings.opacity/100}`,transform:`rotate(${-this.settings.rotation}deg)`,"white-space":"nowrap"};switch(this.settings.verticalPosition){case"top":t.top="12px";break;case"center":t.top="50%";break;case"bottom":t.bottom="12px";break}switch(this.settings.horizontalPosition){case"left":t.left="12px";break;case"center":t.left="50%";break;case"right":t.right="12px";break}let e=[];return this.settings.verticalPosition==="center"&&e.push("translateY(-50%)"),this.settings.horizontalPosition==="center"&&e.push("translateX(-50%)"),this.settings.rotation!==0&&e.push(`rotate(${-this.settings.rotation}deg)`),e.length>0&&(t.transform=e.join(" ")),t}get previewPatternStyle(){let t=Math.max(this.settings.fontSize*.4,6),e=Math.max(this.settings.patternSpacingX*.3,20),n=Math.max(this.settings.patternSpacingY*.3,15);return{position:"absolute",top:"0",left:"0",width:"100%",height:"100%","font-size":`${t}px`,color:this.settings.color,"font-family":this.settings.font==="Times"?"Times New Roman":this.settings.font,opacity:`${this.settings.opacity/100}`,background:`repeating-linear-gradient(
        ${this.settings.rotation}deg,
        transparent,
        transparent ${n}px
      )`,display:"flex","flex-wrap":"wrap","align-content":"flex-start",gap:`${n}px ${e}px`,padding:"8px",overflow:"hidden","pointer-events":"none"}}get patternTexts(){return this.settings.isPattern?new Array(100).fill(this.settings.text):[]}loadFontkit(){return C(this,null,function*(){if(!window.fontkit)return new Promise((t,e)=>{let n=document.createElement("script");n.src="assets/libs/fontkit.umd.min.js",n.onload=()=>{window.fontkit?t():e(new Error("fontkit \uB85C\uB4DC \uC2E4\uD328"))},n.onerror=()=>e(new Error("fontkit \uC2A4\uD06C\uB9BD\uD2B8 \uB85C\uB4DC \uC2E4\uD328")),document.head.appendChild(n)})})}applyWatermark(){return C(this,null,function*(){if(!this.settings.text.trim()){this.snackbar.showError("\uC6CC\uD130\uB9C8\uD06C \uD14D\uC2A4\uD2B8\uB97C \uC785\uB825\uD574\uC8FC\uC138\uC694.");return}console.log("\u{1F3A8} [Watermark] \uC6CC\uD130\uB9C8\uD06C \uC801\uC6A9 \uC2DC\uC791",{text:this.settings.text,font:this.settings.font,fontSize:this.settings.fontSize,color:this.settings.color,opacity:this.settings.opacity,rotation:this.settings.rotation,verticalPosition:this.settings.verticalPosition,horizontalPosition:this.settings.horizontalPosition});try{this.isProcessing=!0;let t=this.fontManager.detectLanguage(this.settings.text);console.log(`\u{1F30D} [Watermark] \uAC10\uC9C0\uB41C \uC5B8\uC5B4: ${t}`);let e=yield this.fontManager.selectFontForText(this.pdfDoc,this.settings.text);console.log("\u2705 [Watermark] \uD3F0\uD2B8 \uB85C\uB4DC \uC644\uB8CC");let n=this.hexToRgb(this.settings.color),i=this.settings.opacity/100;console.log("\u{1F3A8} [Watermark] \uC0C9\uC0C1 \uBC0F \uD22C\uBA85\uB3C4:",{color:n,opacity:i});let s=this.pdfDoc.getPages();console.log(`\u{1F4C4} [Watermark] \uCD1D ${s.length}\uAC1C \uD398\uC774\uC9C0\uC5D0 \uC6CC\uD130\uB9C8\uD06C \uC801\uC6A9 \uC2DC\uC791 (\uD328\uD134 \uBAA8\uB4DC: ${this.settings.isPattern})`);for(let E=0;E<s.length;E++){let D=s[E],{width:T,height:I}=D.getSize(),z=this.settings.text,A=e.widthOfTextAtSize(z,this.settings.fontSize),Y=this.settings.fontSize;if(this.settings.isPattern){let Q=this.settings.patternSpacingX+A,te=this.settings.patternSpacingY+Y,ie=-A,Ie=-Y,qe=0;for(let Rt=Ie;Rt<I+Y;Rt+=te){let Xe=qe%2===1?Q/2:0;for(let ze=ie+Xe;ze<T+A;ze+=Q)D.drawText(z,{x:ze,y:Rt,size:this.settings.fontSize,font:e,color:PDFLib.rgb(n.r,n.g,n.b),opacity:i,rotate:PDFLib.degrees(this.settings.rotation)});qe++}console.log(`\u2705 [Watermark] \uD398\uC774\uC9C0 ${E+1} \uD328\uD134 \uC6CC\uD130\uB9C8\uD06C \uC801\uC6A9 \uC644\uB8CC`)}else{let Q=0,te=0,ie=40;switch(this.settings.horizontalPosition){case"left":Q=ie;break;case"center":Q=(T-A)/2;break;case"right":Q=T-A-ie;break}switch(this.settings.verticalPosition){case"top":te=I-ie-Y;break;case"center":te=I/2-Y/2;break;case"bottom":te=ie;break}Q<0&&(Q=ie),te<0&&(te=ie),Q+A>T&&(Q=T-A-ie),te+Y>I&&(te=I-Y-ie),console.log(`\u{1F4CD} [Watermark] \uD398\uC774\uC9C0 ${E+1}: \uC704\uCE58 (x: ${Q.toFixed(2)}, y: ${te.toFixed(2)}), \uD398\uC774\uC9C0 \uD06C\uAE30 (${T} x ${I})`),D.drawText(z,{x:Q,y:te,size:this.settings.fontSize,font:e,color:PDFLib.rgb(n.r,n.g,n.b),opacity:i,rotate:PDFLib.degrees(this.settings.rotation)}),console.log(`\u2705 [Watermark] \uD398\uC774\uC9C0 ${E+1} \uC6CC\uD130\uB9C8\uD06C \uC801\uC6A9 \uC644\uB8CC`)}}console.log("\u{1F4BE} [Watermark] PDF \uC800\uC7A5 \uC2DC\uC791");let d=yield this.pdfDoc.save();console.log("\u2705 [Watermark] PDF \uC800\uC7A5 \uC644\uB8CC, \uD06C\uAE30:",d.length,"bytes");let _=this.docData.fileName||this.docData.title,v=this.generateNewFileName(_),w=this.uint8ArrayToBase64(d);console.log("\u{1F4BE} [Watermark] Base64 \uBCC0\uD658 \uC644\uB8CC, \uAE38\uC774:",w.length);let M=null;try{let E=new Blob([d],{type:"application/pdf"}),D=URL.createObjectURL(E),I=yield(yield this.pdfjsLibService.getDocument(D)).getPage(1);M=yield this.pdfThumbnailService.renderHighQualityThumbnail(I,1),URL.revokeObjectURL(D)}catch(E){console.warn("\uC378\uB124\uC77C \uC0DD\uC131 \uC2E4\uD328:",E)}let O=`doc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;console.log("\u{1F4BE} [Watermark] IndexedDB \uC800\uC7A5 \uC2DC\uC791:",{docId:O,fileName:v}),yield this.indexedDbService.saveDocument({id:O,title:v,fileName:v,pdfBase64:`data:application/pdf;base64,${w}`,thumbnail:M||"",pages:[],elementCount:0,version:"1.0",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:"page-numbered",folderId:this.docData.folderId}),console.log("\u2705 [Watermark] IndexedDB \uC800\uC7A5 \uC644\uB8CC"),this.savedDocId=O,this.savedFolderId=this.docData.folderId||null,setTimeout(()=>{this.processingTitle="\uBB38\uC11C\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",this.processingSubtitle=`${v} \uD30C\uC77C\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,this.isComplete=!0},1e3)}catch(t){console.error("\u274C [Watermark] \uC6CC\uD130\uB9C8\uD06C \uC801\uC6A9 \uC2E4\uD328:",t),this.isFailed=!0,this.isProcessing=!0}})}generateNewFileName(t){return`${t.replace(/\.pdf$/i,"")}_\uC6CC\uD130\uB9C8\uD06C.pdf`}hexToRgb(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16)/255,g:parseInt(e[2],16)/255,b:parseInt(e[3],16)/255}:{r:0,g:0,b:0}}uint8ArrayToBase64(t){let n="";for(let i=0;i<t.length;i+=32768){let s=t.subarray(i,Math.min(i+32768,t.length));n+=String.fromCharCode(...Array.from(s))}return btoa(n)}goBack(){this.toolActionService.navigateToOrigin()}onNavigateToFile(){this.savedDocId?this.router.navigate(["/ezm/viewer"],{queryParams:{docId:this.savedDocId}}):this.savedFolderId?this.router.navigate(["/ezm/myfiles",this.savedFolderId]):this.router.navigate(["/ezm/myfiles","my-files"])}onRetry(){this.isFailed=!1,this.isProcessing=!1,this.isComplete=!1}openSheet(t){switch(this.currentSheet=t,t){case"text":this.tempValue=this.settings.text;break;case"font":this.tempValue=this.settings.font;break;case"fontSize":this.tempValue=this.settings.fontSize;break;case"color":this.tempValue=this.settings.color;break;case"verticalPosition":this.tempValue=this.settings.verticalPosition;break;case"horizontalPosition":this.tempValue=this.settings.horizontalPosition;break}this.sheetState="full"}closeSheet(){this.sheetState="collapsed",this.currentSheet=null,this.tempValue=null}applySheetValue(){if(this.currentSheet&&this.tempValue!==null)switch(this.currentSheet){case"text":this.settings.text=this.tempValue;break;case"font":this.settings.font=this.tempValue;break;case"fontSize":this.settings.fontSize=this.tempValue;break;case"color":this.settings.color=this.tempValue;break;case"verticalPosition":this.settings.verticalPosition=this.tempValue;break;case"horizontalPosition":this.settings.horizontalPosition=this.tempValue;break}this.closeSheet()}adjustFontSize(t){let e=this.tempValue+t;e>=8&&e<=120&&(this.tempValue=e)}colorPresets=[{color:"#FA3D22",label:"\uBE68\uAC15"},{color:"#000000",label:"\uAC80\uC815"},{color:"#2196F3",label:"\uD30C\uB791"},{color:"#4CAF50",label:"\uCD08\uB85D"},{color:"#FFEB3B",label:"\uB178\uB791"},{color:"#FF9800",label:"\uC8FC\uD669"}];selectPresetColor(t){this.tempValue=t}verticalPositionOptions=[{value:"top",label:"\uC0C1\uB2E8"},{value:"center",label:"\uC911\uC559"},{value:"bottom",label:"\uD558\uB2E8"}];horizontalPositionOptions=[{value:"left",label:"\uC67C\uCABD"},{value:"center",label:"\uC911\uC559"},{value:"right",label:"\uC624\uB978\uCABD"}];static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-watermark"]],viewQuery:function(e,n){if(e&1&&$e(Zp,5),e&2){let i;He(i=We())&&(n.mainContentRef=i.first)}},hostBindings:function(e,n){e&1&&u("scroll",function(){return n.onWindowScroll()},Lt)},standalone:!1,decls:110,vars:33,consts:[["mainContent",""],[3,"navigate","retry","isVisible","isComplete","isFailed","title","subtitle"],[1,"header"],[1,"header-left",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"header-center"],[1,"header-right"],["class","floating-preview",4,"ngIf"],[1,"main-content",3,"scroll"],["class","preview-section",4,"ngIf"],[1,"settings-section"],[1,"section-title"],[1,"setting-row",3,"click"],[1,"setting-label"],[1,"required"],[1,"setting-value"],[1,"value-text"],[1,"arrow"],[1,"color-preview"],[1,"color-circle"],[1,"setting-row","toggle-row"],[1,"toggle-switch"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"toggle-slider"],["class","settings-section",4,"ngIf"],[1,"setting-group"],["type","range","min","0","max","100",1,"setting-range",3,"ngModelChange","ngModel"],[1,"range-labels"],["type","range","min","-45","max","45",1,"setting-range",3,"ngModelChange","ngModel"],[1,"action-section"],[1,"apply-btn",3,"click","disabled"],[4,"ngIf"],[3,"sheetStateChange","close","sheetState"],["class","sheet-modal",4,"ngIf"],[1,"floating-preview"],[1,"floating-preview-container"],["alt","\uBBF8\uB9AC\uBCF4\uAE30",1,"floating-preview-image",3,"src"],["class","floating-watermark",3,"ngStyle",4,"ngIf"],["class","floating-pattern-overlay",3,"transform","row-gap","column-gap",4,"ngIf"],[1,"floating-preview-page"],[1,"floating-watermark",3,"ngStyle"],[1,"floating-pattern-overlay"],["class","pattern-text",3,"color","opacity","font-size",4,"ngFor","ngForOf"],[1,"pattern-text"],[1,"preview-section"],[1,"preview-container"],["class","preview-loading",4,"ngIf"],["class","preview-wrapper",4,"ngIf"],["class","preview-page-indicator",4,"ngIf"],[1,"preview-loading"],[1,"loading-spinner"],[1,"preview-wrapper"],["alt","PDF \uBBF8\uB9AC\uBCF4\uAE30",1,"preview-image",3,"src"],["class","watermark-overlay",3,"ngStyle",4,"ngIf"],["class","pattern-overlay",3,"transform","gap","row-gap","column-gap",4,"ngIf"],[1,"watermark-overlay",3,"ngStyle"],[1,"pattern-overlay"],["class","pattern-text",3,"color","opacity","font-size","font-family",4,"ngFor","ngForOf"],[1,"preview-page-indicator"],["type","range","min","20","max","300",1,"setting-range",3,"ngModelChange","ngModel"],[1,"sheet-modal"],[1,"modal-title"],[1,"modal-content"],["type","text","placeholder","\uC6CC\uD130\uB9C8\uD06C \uD14D\uC2A4\uD2B8\uB97C \uC785\uB825\uD574 \uC8FC\uC138\uC694.",1,"modal-input",3,"ngModelChange","ngModel"],[1,"modal-apply-btn",3,"click"],[1,"radio-list"],["class","radio-item",4,"ngFor","ngForOf"],[1,"radio-item"],["type","radio","name","font",3,"ngModelChange","value","ngModel"],[1,"radio-label"],[1,"radio-circle"],[1,"number-control"],[1,"control-btn",3,"click"],["type","number","min","8","max","120",1,"control-input",3,"ngModelChange","ngModel"],[1,"color-picker-section"],["type","color",1,"full-color-picker",3,"ngModelChange","ngModel"],[1,"color-presets"],["class","preset-color-btn",3,"background-color","active","click",4,"ngFor","ngForOf"],[1,"selected-color-code"],[1,"preset-color-btn",3,"click"],["type","radio","name","verticalPosition",3,"ngModelChange","value","ngModel"],["type","radio","name","horizontalPosition",3,"ngModelChange","value","ngModel"]],template:function(e,n){if(e&1){let i=y();o(0,"app-processing-modal",1),u("navigate",function(){return m(i),f(n.onNavigateToFile())})("retry",function(){return m(i),f(n.onRetry())}),a(),o(1,"div",2)(2,"button",3),u("click",function(){return m(i),f(n.goBack())}),h(3,"img",4),a(),o(4,"div",5)(5,"h2"),c(6,"\uC6CC\uD130\uB9C8\uD06C"),a()(),h(7,"div",6),a(),b(8,ng,7,3,"div",7),o(9,"div",8,0),u("scroll",function(d){return m(i),f(n.onContentScroll(d))}),b(11,cg,5,3,"div",9),o(12,"div",10)(13,"h3",11),c(14,"\uD14D\uC2A4\uD2B8 \uD615\uC2DD"),a(),o(15,"div",12),u("click",function(){return m(i),f(n.openSheet("text"))}),o(16,"label",13),c(17," \uD14D\uC2A4\uD2B8 "),o(18,"span",14),c(19,"(\uD544\uC218)"),a()(),o(20,"div",15)(21,"span",16),c(22),a(),o(23,"span",17),c(24,"\u203A"),a()()(),o(25,"div",12),u("click",function(){return m(i),f(n.openSheet("font"))}),o(26,"label",13),c(27,"\uAE00\uAF34 \uC720\uD615"),a(),o(28,"div",15)(29,"span",16),c(30),a(),o(31,"span",17),c(32,"\u203A"),a()()(),o(33,"div",12),u("click",function(){return m(i),f(n.openSheet("fontSize"))}),o(34,"label",13),c(35,"\uAE00\uAF34 \uD06C\uAE30"),a(),o(36,"div",15)(37,"span",16),c(38),a(),o(39,"span",17),c(40,"\u203A"),a()()(),o(41,"div",12),u("click",function(){return m(i),f(n.openSheet("color"))}),o(42,"label",13),c(43,"\uC0C9\uC0C1"),a(),o(44,"div",15)(45,"div",18),h(46,"span",19),o(47,"span",16),c(48),a()(),o(49,"span",17),c(50,"\u203A"),a()()()(),o(51,"div",10)(52,"h3",11),c(53,"\uC6CC\uD130\uB9C8\uD06C \uC704\uCE58"),a(),o(54,"div",12),u("click",function(){return m(i),f(n.openSheet("verticalPosition"))}),o(55,"label",13),c(56,"\uC138\uB85C \uC704\uCE58"),a(),o(57,"div",15)(58,"span",16),c(59),a(),o(60,"span",17),c(61,"\u203A"),a()()(),o(62,"div",12),u("click",function(){return m(i),f(n.openSheet("horizontalPosition"))}),o(63,"label",13),c(64,"\uAC00\uB85C \uC704\uCE58"),a(),o(65,"div",15)(66,"span",16),c(67),a(),o(68,"span",17),c(69,"\u203A"),a()()(),o(70,"div",20)(71,"label",13),c(72,"\uD328\uD134 (\uD0C0\uC77C \uBC18\uBCF5)"),a(),o(73,"div",15)(74,"label",21)(75,"input",22),$("ngModelChange",function(d){return m(i),U(n.settings.isPattern,d)||(n.settings.isPattern=d),f(d)}),a(),h(76,"span",23),a()()()(),b(77,dg,21,4,"div",24),o(78,"div",10)(79,"h3",11),c(80,"\uC124\uC815"),a(),o(81,"div",25)(82,"label",13),c(83),a(),o(84,"input",26),$("ngModelChange",function(d){return m(i),U(n.settings.opacity,d)||(n.settings.opacity=d),f(d)}),a(),o(85,"div",27)(86,"span"),c(87,"0%"),a(),o(88,"span"),c(89,"100%"),a()()(),o(90,"div",25)(91,"label",13),c(92),a(),o(93,"input",28),$("ngModelChange",function(d){return m(i),U(n.settings.rotation,d)||(n.settings.rotation=d),f(d)}),a(),o(94,"div",27)(95,"span"),c(96,"-45\xB0"),a(),o(97,"span"),c(98,"45\xB0"),a()()()(),o(99,"div",29)(100,"button",30),u("click",function(){return m(i),f(n.applyWatermark())}),b(101,pg,2,0,"span",31)(102,gg,2,0,"span",31),a()()(),o(103,"app-bottom-sheet",32),$("sheetStateChange",function(d){return m(i),U(n.sheetState,d)||(n.sheetState=d),f(d)}),u("close",function(){return m(i),f(n.closeSheet())}),b(104,ug,7,1,"div",33)(105,fg,8,1,"div",33)(106,hg,12,1,"div",33)(107,Cg,12,3,"div",33)(108,vg,8,1,"div",33)(109,Pg,8,1,"div",33),a()}e&2&&(p("isVisible",n.isProcessing)("isComplete",n.isComplete)("isFailed",n.isFailed)("title",n.processingTitle)("subtitle",n.processingSubtitle),l(8),p("ngIf",n.isScrolled&&n.previewImageUrl),l(3),p("ngIf",n.previewImageUrl||n.isPreviewLoading),l(10),k("placeholder",!n.settings.text),l(),S(" ",n.settings.text||"\uC6CC\uD130\uB9C8\uD06C \uD14D\uC2A4\uD2B8\uB97C \uC785\uB825\uD574\uC8FC\uC138\uC694"," "),l(8),x(n.settings.font),l(8),x(n.settings.fontSize),l(8),q("background-color",n.settings.color),l(2),x(n.settings.color),l(11),S(" ",n.settings.verticalPosition==="top"?"\uC0C1\uB2E8":n.settings.verticalPosition==="center"?"\uC911\uC559":"\uD558\uB2E8"," "),l(8),S(" ",n.settings.horizontalPosition==="left"?"\uC67C\uCABD":n.settings.horizontalPosition==="center"?"\uC911\uC559":"\uC624\uB978\uCABD"," "),l(8),j("ngModel",n.settings.isPattern),l(2),p("ngIf",n.settings.isPattern),l(6),S("\uBD88\uD22C\uBA85\uB3C4: ",n.settings.opacity,"%"),l(),j("ngModel",n.settings.opacity),l(8),S("\uD68C\uC804: ",n.settings.rotation,"\xB0"),l(),j("ngModel",n.settings.rotation),l(7),p("disabled",!n.settings.text||n.isProcessing),l(),p("ngIf",!n.isProcessing),l(),p("ngIf",n.isProcessing),l(),j("sheetState",n.sheetState),l(),p("ngIf",n.currentSheet==="text"),l(),p("ngIf",n.currentSheet==="font"),l(),p("ngIf",n.currentSheet==="fontSize"),l(),p("ngIf",n.currentSheet==="color"),l(),p("ngIf",n.currentSheet==="verticalPosition"),l(),p("ngIf",n.currentSheet==="horizontalPosition"))},dependencies:[oe,B,Cn,he,Pn,fo,xn,Mn,pe,wn,yn,ge,Pe,Ee],styles:['.header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background-color:#fff;border-bottom:1px solid #e0e0e0;display:flex;align-items:center;justify-content:space-between;padding-left:16px;padding-right:16px;z-index:100;box-sizing:border-box}.header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%], .header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;border:none;background:none;cursor:pointer;padding:0;color:#333}.header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]:hover, .header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;border-radius:50%}.header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]{flex:1;text-align:center}.header[_ngcontent-%COMP%]   .header-center[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#333}.floating-preview[_ngcontent-%COMP%]{position:fixed;top:calc(56px + var(--android-status-bar-height, 0px) + 16px);right:16px;z-index:200;animation:_ngcontent-%COMP%_fadeInSlide .3s ease}@keyframes _ngcontent-%COMP%_fadeInSlide{0%{opacity:0;transform:translate(20px)}to{opacity:1;transform:translate(0)}}.floating-preview-container[_ngcontent-%COMP%]{position:relative;width:80px;background:#fff;border-radius:8px;box-shadow:0 4px 16px #00000026;overflow:hidden}.floating-preview-image[_ngcontent-%COMP%]{width:100%;height:auto;display:block}.floating-watermark[_ngcontent-%COMP%]{font-weight:600;text-shadow:0 1px 2px rgba(255,255,255,.8);pointer-events:none}.floating-preview-page[_ngcontent-%COMP%]{text-align:center;font-size:11px;color:#666;margin-top:4px;background:#ffffffe6;padding:2px 6px;border-radius:4px}.preview-section[_ngcontent-%COMP%]{margin-bottom:20px}.preview-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:#fff;border-radius:12px;padding:16px;box-shadow:0 2px 8px #0000000d}.preview-loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;padding:40px 0;color:#666;font-size:14px}.loading-spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid #e0e0e0;border-top-color:#00bcd4;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.preview-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;max-width:100%;border:1px solid #e0e0e0;border-radius:4px;overflow:hidden;background:#fff}.preview-image[_ngcontent-%COMP%]{display:block;max-width:100%;max-height:300px;height:auto;object-fit:contain}.watermark-overlay[_ngcontent-%COMP%]{position:absolute;font-weight:600;text-shadow:0 1px 2px rgba(255,255,255,.8);pointer-events:none}.pattern-overlay[_ngcontent-%COMP%]{position:absolute;top:-50%;left:-50%;width:200%;height:200%;display:flex;flex-wrap:wrap;align-content:space-evenly;justify-content:space-evenly;gap:20px 40px;padding:20px;overflow:hidden;pointer-events:none;transform-origin:center}.pattern-overlay[_ngcontent-%COMP%]   .pattern-text[_ngcontent-%COMP%]{white-space:nowrap;font-weight:500;text-shadow:0 1px 2px rgba(255,255,255,.5)}.floating-pattern-overlay[_ngcontent-%COMP%]{position:absolute;top:-50%;left:-50%;width:200%;height:200%;display:flex;flex-wrap:wrap;align-content:space-evenly;justify-content:space-evenly;gap:8px 16px;padding:8px;overflow:hidden;pointer-events:none;transform-origin:center}.floating-pattern-overlay[_ngcontent-%COMP%]   .pattern-text[_ngcontent-%COMP%]{white-space:nowrap;font-weight:500;text-shadow:0 1px 1px rgba(255,255,255,.5)}.preview-page-indicator[_ngcontent-%COMP%]{margin-top:8px;font-size:13px;color:#666}.main-content[_ngcontent-%COMP%]{margin-top:calc(56px + var(--android-status-bar-height, 0px));padding:20px 16px;padding-bottom:calc(80px + var(--android-navigation-bar-height, 0px));max-width:600px;margin-left:auto;margin-right:auto;overflow-y:auto;height:calc(100vh - 56px - var(--android-status-bar-height, 0px))}.info-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;margin-bottom:24px;box-shadow:0 2px 8px #0000001a;display:flex;align-items:center;gap:16px}.info-card[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{width:48px;height:48px;display:flex;align-items:center;justify-content:center;background:#e0f7fa;border-radius:12px}.info-card[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]{flex:1}.info-card[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   .info-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin-bottom:4px;word-break:break-all}.info-card[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   .info-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#757575}.settings-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;margin-bottom:16px;box-shadow:0 2px 8px #0000000d}.settings-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#757575;margin:0 0 16px;text-transform:uppercase;letter-spacing:.5px}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 0;border-bottom:1px solid #f0f0f0;cursor:pointer;transition:background .2s ease}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]:active{background:#f5f5f5}.settings-section[_ngcontent-%COMP%]   .setting-row.toggle-row[_ngcontent-%COMP%]{cursor:default}.settings-section[_ngcontent-%COMP%]   .setting-row.toggle-row[_ngcontent-%COMP%]:active{background:transparent}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#f44336;font-weight:600;margin-left:4px}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .value-text[_ngcontent-%COMP%]{font-size:14px;color:#333;max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .value-text.placeholder[_ngcontent-%COMP%]{color:#bdbdbd}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .color-preview[_ngcontent-%COMP%]   .color-circle[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:50%;border:2px solid #e0e0e0}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{font-size:20px;color:#bdbdbd;font-weight:300}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:28px}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   .toggle-slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;border-radius:28px;transition:.3s}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   .toggle-slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:22px;width:22px;left:3px;bottom:3px;background-color:#fff;border-radius:50%;transition:.3s;box-shadow:0 2px 4px #0003}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-slider[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.settings-section[_ngcontent-%COMP%]   .setting-row[_ngcontent-%COMP%]   .setting-value[_ngcontent-%COMP%]   .toggle-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .toggle-slider[_ngcontent-%COMP%]:before{transform:translate(22px)}.settings-section[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]{margin-bottom:20px}.settings-section[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.settings-section[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]   .setting-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#333;margin-bottom:8px}.settings-section[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]   .setting-input[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #e0e0e0;border-radius:8px;font-size:14px;box-sizing:border-box}.settings-section[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]   .setting-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#00bcd4}.settings-section[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]   .setting-range[_ngcontent-%COMP%]{width:100%;height:6px;border-radius:3px;background:#e0e0e0;outline:none;-webkit-appearance:none;appearance:none}.settings-section[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]   .setting-range[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:20px;height:20px;border-radius:50%;background:#00bcd4;cursor:pointer}.settings-section[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]   .setting-range[_ngcontent-%COMP%]::-moz-range-thumb{width:20px;height:20px;border-radius:50%;background:#00bcd4;cursor:pointer;border:none}.settings-section[_ngcontent-%COMP%]   .setting-group[_ngcontent-%COMP%]   .range-labels[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:8px;font-size:12px;color:#757575}.action-section[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;padding:16px;background:#fff;border-top:1px solid #e0e0e0;z-index:10}.action-section[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]{width:100%;max-width:600px;margin:0 auto;display:block;padding:16px;background:#00bcd4;color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s ease}.action-section[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]:hover{background:#00acc1}.action-section[_ngcontent-%COMP%]   .apply-btn[_ngcontent-%COMP%]:disabled{background:#bdbdbd;cursor:not-allowed}.sheet-modal[_ngcontent-%COMP%]{padding:24px 20px}.sheet-modal[_ngcontent-%COMP%]   .modal-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0 0 24px;text-align:center}.sheet-modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{margin-bottom:24px}.sheet-modal[_ngcontent-%COMP%]   .modal-input[_ngcontent-%COMP%]{width:100%;padding:16px;border:1px solid #e0e0e0;border-radius:8px;font-size:15px;box-sizing:border-box}.sheet-modal[_ngcontent-%COMP%]   .modal-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#00bcd4}.sheet-modal[_ngcontent-%COMP%]   .modal-input[_ngcontent-%COMP%]::placeholder{color:#bdbdbd}.sheet-modal[_ngcontent-%COMP%]   .radio-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.sheet-modal[_ngcontent-%COMP%]   .radio-list[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;border-radius:8px;cursor:pointer;transition:background .2s ease}.sheet-modal[_ngcontent-%COMP%]   .radio-list[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]:hover{background:#f5f5f5}.sheet-modal[_ngcontent-%COMP%]   .radio-list[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.sheet-modal[_ngcontent-%COMP%]   .radio-list[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]   .radio-label[_ngcontent-%COMP%]{flex:1;font-size:15px;color:#333}.sheet-modal[_ngcontent-%COMP%]   .radio-list[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]   .radio-circle[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid #bdbdbd;border-radius:50%;position:relative;transition:all .2s ease}.sheet-modal[_ngcontent-%COMP%]   .radio-list[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]   .radio-circle.checked[_ngcontent-%COMP%]{border-color:#00bcd4}.sheet-modal[_ngcontent-%COMP%]   .radio-list[_ngcontent-%COMP%]   .radio-item[_ngcontent-%COMP%]   .radio-circle.checked[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:10px;height:10px;background:#00bcd4;border-radius:50%}.sheet-modal[_ngcontent-%COMP%]   .number-control[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:16px}.sheet-modal[_ngcontent-%COMP%]   .number-control[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]{width:48px;height:48px;border:2px solid #e0e0e0;border-radius:8px;background:#fff;font-size:24px;color:#333;cursor:pointer;transition:all .2s ease}.sheet-modal[_ngcontent-%COMP%]   .number-control[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5}.sheet-modal[_ngcontent-%COMP%]   .number-control[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]:active{background:#e0e0e0}.sheet-modal[_ngcontent-%COMP%]   .number-control[_ngcontent-%COMP%]   .control-input[_ngcontent-%COMP%]{width:120px;padding:12px;border:2px solid #e0e0e0;border-radius:8px;font-size:18px;text-align:center}.sheet-modal[_ngcontent-%COMP%]   .number-control[_ngcontent-%COMP%]   .control-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#00bcd4}.sheet-modal[_ngcontent-%COMP%]   .color-picker-section[_ngcontent-%COMP%]{margin-bottom:20px}.sheet-modal[_ngcontent-%COMP%]   .color-picker-section[_ngcontent-%COMP%]   .full-color-picker[_ngcontent-%COMP%]{width:100%;height:200px;border:none;border-radius:8px;cursor:pointer}.sheet-modal[_ngcontent-%COMP%]   .color-picker-section[_ngcontent-%COMP%]   .full-color-picker[_ngcontent-%COMP%]::-webkit-color-swatch-wrapper{padding:0}.sheet-modal[_ngcontent-%COMP%]   .color-picker-section[_ngcontent-%COMP%]   .full-color-picker[_ngcontent-%COMP%]::-webkit-color-swatch{border:none;border-radius:8px}.sheet-modal[_ngcontent-%COMP%]   .color-presets[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:16px;justify-content:center}.sheet-modal[_ngcontent-%COMP%]   .color-presets[_ngcontent-%COMP%]   .preset-color-btn[_ngcontent-%COMP%]{width:44px;height:44px;border:3px solid transparent;border-radius:50%;cursor:pointer;transition:all .2s ease}.sheet-modal[_ngcontent-%COMP%]   .color-presets[_ngcontent-%COMP%]   .preset-color-btn.active[_ngcontent-%COMP%]{border-color:#00bcd4;box-shadow:0 0 0 2px #fff,0 0 0 4px #00bcd4}.sheet-modal[_ngcontent-%COMP%]   .color-presets[_ngcontent-%COMP%]   .preset-color-btn[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.sheet-modal[_ngcontent-%COMP%]   .selected-color-code[_ngcontent-%COMP%]{text-align:center;font-size:16px;font-family:monospace;color:#333;font-weight:600}.sheet-modal[_ngcontent-%COMP%]   .modal-apply-btn[_ngcontent-%COMP%]{width:100%;padding:16px;background:#fa3d22;color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s ease}.sheet-modal[_ngcontent-%COMP%]   .modal-apply-btn[_ngcontent-%COMP%]:hover{background:#e63519}.sheet-modal[_ngcontent-%COMP%]   .modal-apply-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}']})};function Mg(r,t){r&1&&h(0,"img",19)}function yg(r,t){r&1&&h(0,"img",20)}function wg(r,t){if(r&1&&(o(0,"p",21),c(1),a()),r&2){let e=g();l(),x(e.passwordError)}}function Sg(r,t){r&1&&h(0,"img",19)}function Og(r,t){r&1&&h(0,"img",20)}function Eg(r,t){if(r&1&&(o(0,"p",21),c(1),a()),r&2){let e=g();l(),x(e.passwordConfirmError)}}function kg(r,t){r&1&&(o(0,"span"),c(1,"\uC801\uC6A9\uD558\uAE30"),a())}function Dg(r,t){r&1&&(o(0,"span"),c(1,"\uC554\uD638\uD654 \uC911..."),a())}var pi=class r{document=null;password="";passwordConfirm="";showPassword=!1;showPasswordConfirm=!1;passwordError="";passwordConfirmError="";permissions={allowPrinting:!0,allowCopy:!1,allowEdit:!1,allowAnnotations:!1};encryptionLevel="256-bit";isLoading=!1;isComplete=!1;isFailed=!1;processingTitle="\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.";processingSubtitle="";savedDocId="";savedFolderId=null;passwordStrength={score:0,label:"",color:""};router=P(N);indexedDbService=P(ee);snackbar=P(G);pdfEncryptionService=P(ht);toolActionService=P(le);ngOnInit(){return C(this,null,function*(){let t=this.toolActionService.getPendingAction();if(t&&t.data?.documentId){yield this.loadDocumentById(t.data.documentId),this.toolActionService.clearPendingAction();return}let n=this.router.getCurrentNavigation()?.extras?.state||history.state;n&&n.document?this.document=n.document:(this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())})}loadDocumentById(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t);e?this.document=e:(this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin()}})}onPasswordChange(){this.passwordStrength=this.calculatePasswordStrength(this.password),this.password.length>0&&(this.password.length<4||this.password.length>20)?this.passwordError="4-20\uC790 \uC774\uB0B4\uB85C \uC785\uB825\uD558\uC138\uC694.":this.passwordError="",this.passwordConfirm.length>0&&this.onPasswordConfirmChange()}onPasswordConfirmChange(){this.passwordConfirm.length>0&&this.password!==this.passwordConfirm?this.passwordConfirmError="\uBE44\uBC00\uBC88\uD638\uAC00 \uC77C\uCE58\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.":this.passwordConfirmError=""}calculatePasswordStrength(t){if(!t)return{score:0,label:"",color:""};let e=0;t.length>=8&&(e+=25),t.length>=12&&(e+=25),/[a-z]/.test(t)&&(e+=10),/[A-Z]/.test(t)&&(e+=15),/[0-9]/.test(t)&&(e+=15),/[^a-zA-Z0-9]/.test(t)&&(e+=10);let n="",i="";return e<30?(n="\uC57D\uD568",i="#f44336"):e<60?(n="\uBCF4\uD1B5",i="#FF9800"):(n="\uAC15\uD568",i="#4CAF50"),{score:e,label:n,color:i}}togglePasswordVisibility(){this.showPassword=!this.showPassword}togglePasswordConfirmVisibility(){this.showPasswordConfirm=!this.showPasswordConfirm}validateForm(){return this.password?this.password.length<4||this.password.length>20?{isValid:!1,error:"\uBE44\uBC00\uBC88\uD638\uB294 4-20\uC790 \uC774\uB0B4\uC5EC\uC57C \uD569\uB2C8\uB2E4."}:this.password!==this.passwordConfirm?{isValid:!1,error:"\uBE44\uBC00\uBC88\uD638\uAC00 \uC77C\uCE58\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4."}:{isValid:!0}:{isValid:!1,error:"\uBE44\uBC00\uBC88\uD638\uB97C \uC785\uB825\uD558\uC138\uC694."}}onApplyEncryption(){return C(this,null,function*(){if(console.log("\u{1F512} onApplyEncryption \uD638\uCD9C\uB428"),console.log("document:",this.document),console.log("password:",this.password),console.log("passwordConfirm:",this.passwordConfirm),!this.document){console.error("\u274C \uBB38\uC11C\uAC00 \uC5C6\uC74C"),this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let t=this.validateForm();if(console.log("\u2705 \uC720\uD6A8\uC131 \uAC80\uC0AC \uACB0\uACFC:",t),!t.isValid){console.warn("\u26A0\uFE0F \uC720\uD6A8\uC131 \uAC80\uC0AC \uC2E4\uD328:",t.error),this.snackbar.showWarning(t.error);return}try{this.isLoading=!0,console.log("\u23F3 \uB85C\uB529 \uC2DC\uC791");let e=yield this.indexedDbService.getDocumentById(this.document.id);if(console.log("\u{1F4C4} \uAE30\uC874 \uBB38\uC11C:",e),e){if(this.pdfEncryptionService.isNativeEncryptionAvailable()){let n=e.pdfBase64||e.originalPdfBase64;if(!n)throw new Error("PDF \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");let i=yield this.pdfEncryptionService.encryptPdf(n,this.password,{allowPrinting:!0,allowCopy:!1,allowEdit:!1,allowAnnotations:!1});e.originalPdfBase64=n,e.pdfBase64=i,e.isEncrypted=!0,e.encryptionMetadata={password:this.password,encryptedAt:Date.now()},e.updatedAt=Date.now().toString(),yield this.indexedDbService.saveDocument(e),console.log("\u{1F4BE} \uC554\uD638\uD654\uB41C \uBB38\uC11C \uC800\uC7A5 \uC644\uB8CC")}else e.isEncrypted=!0,e.encryptionMetadata={password:this.password,encryptedAt:Date.now()},e.updatedAt=Date.now().toString(),yield this.indexedDbService.saveDocument(e),console.log("\u{1F4BE} \uC554\uD638\uD654 \uBA54\uD0C0\uB370\uC774\uD130 \uC800\uC7A5 \uC644\uB8CC");this.savedDocId=e.id,this.savedFolderId=e.folderId||null,setTimeout(()=>{this.processingTitle="\uBB38\uC11C\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",this.processingSubtitle="\uC554\uD638\uD654 \uC124\uC815\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",this.isComplete=!0},1e3)}else console.error("\u274C \uAE30\uC874 \uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC74C"),this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}catch(e){console.error("\u274C \uC554\uD638\uD654 \uC124\uC815 \uC800\uC7A5 \uC2E4\uD328:",e),this.isFailed=!0,this.isLoading=!0}})}onCancel(){this.toolActionService.navigateToOrigin()}onNavigateToFile(){this.savedDocId?this.router.navigate(["/ezm/viewer"],{queryParams:{docId:this.savedDocId}}):this.savedFolderId?this.router.navigate(["/ezm/myfiles",this.savedFolderId]):this.router.navigate(["/ezm/myfiles","my-files"])}onRetry(){this.isFailed=!1,this.isLoading=!1,this.isComplete=!1}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-encrypt"]],standalone:!1,decls:32,vars:22,consts:[[1,"encrypt-container"],[1,"encrypt-header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"title"],[1,"spacer"],[1,"encrypt-content"],[1,"section"],[1,"input-group"],[1,"password-input-wrapper"],["placeholder","",1,"input-field",3,"ngModelChange","type","ngModel"],["type","button",1,"toggle-visibility-btn",3,"click"],["src","images/icons/ico-tooltip-info.svg","alt","\uD45C\uC2DC","width","20","height","20",4,"ngIf"],["src","images/icons/ico-close.svg","alt","\uC228\uAE30\uAE30","width","20","height","20",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"encrypt-footer"],[1,"btn-apply",3,"click","disabled"],[4,"ngIf"],[3,"navigate","retry","isVisible","isComplete","isFailed","title","subtitle"],["src","images/icons/ico-tooltip-info.svg","alt","\uD45C\uC2DC","width","20","height","20"],["src","images/icons/ico-close.svg","alt","\uC228\uAE30\uAE30","width","20","height","20"],[1,"error-message"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),u("click",function(){return n.onCancel()}),h(3,"img",3),a(),o(4,"h1",4),c(5,"PDF \uC554\uD638\uD654"),a(),h(6,"div",5),a(),o(7,"div",6)(8,"div",7)(9,"div",8)(10,"label"),c(11,"4-20\uC790\uC758 \uC601\uBB38, \uC22B\uC790, \uD2B9\uC218\uBB38\uC790"),a(),o(12,"div",9)(13,"input",10),$("ngModelChange",function(s){return U(n.password,s)||(n.password=s),s}),u("ngModelChange",function(){return n.onPasswordChange()}),a(),o(14,"button",11),u("click",function(){return n.togglePasswordVisibility()}),b(15,Mg,1,0,"img",12)(16,yg,1,0,"img",13),a()(),b(17,wg,2,1,"p",14),a(),o(18,"div",8)(19,"label"),c(20,"\uBE44\uBC00\uBC88\uD638 \uD655\uC778"),a(),o(21,"div",9)(22,"input",10),$("ngModelChange",function(s){return U(n.passwordConfirm,s)||(n.passwordConfirm=s),s}),u("ngModelChange",function(){return n.onPasswordConfirmChange()}),a(),o(23,"button",11),u("click",function(){return n.togglePasswordConfirmVisibility()}),b(24,Sg,1,0,"img",12)(25,Og,1,0,"img",13),a()(),b(26,Eg,2,1,"p",14),a()()(),o(27,"div",15)(28,"button",16),u("click",function(){return n.onApplyEncryption()}),b(29,kg,2,0,"span",17)(30,Dg,2,0,"span",17),a()(),o(31,"app-processing-modal",18),u("navigate",function(){return n.onNavigateToFile()})("retry",function(){return n.onRetry()}),a()()),e&2&&(l(13),k("error",n.passwordError),p("type",n.showPassword?"text":"password"),j("ngModel",n.password),l(2),p("ngIf",!n.showPassword),l(),p("ngIf",n.showPassword),l(),p("ngIf",n.passwordError),l(5),k("error",n.passwordConfirmError),p("type",n.showPasswordConfirm?"text":"password"),j("ngModel",n.passwordConfirm),l(2),p("ngIf",!n.showPasswordConfirm),l(),p("ngIf",n.showPasswordConfirm),l(),p("ngIf",n.passwordConfirmError),l(2),p("disabled",n.isLoading),l(),p("ngIf",!n.isLoading),l(),p("ngIf",n.isLoading),l(),p("isVisible",n.isLoading)("isComplete",n.isComplete)("isFailed",n.isFailed)("title",n.processingTitle)("subtitle",n.processingSubtitle))},dependencies:[B,he,pe,ge,Ee],styles:[".encrypt-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:content-box;background:#f5f5f5}.encrypt-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;background:#fff;border-bottom:1px solid #e0e0e0;position:sticky;top:0;z-index:10}.encrypt-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#333}.encrypt-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5;border-radius:4px}.encrypt-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:1;text-align:center;font-size:18px;font-weight:600;margin:0}.encrypt-header[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{width:40px}.encrypt-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px}.document-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;background:#fff;border-radius:8px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.document-info[_ngcontent-%COMP%]   .doc-icon[_ngcontent-%COMP%]{font-size:32px}.document-info[_ngcontent-%COMP%]   .doc-details[_ngcontent-%COMP%]{flex:1}.document-info[_ngcontent-%COMP%]   .doc-details[_ngcontent-%COMP%]   .doc-name[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#333;margin-bottom:4px}.document-info[_ngcontent-%COMP%]   .doc-details[_ngcontent-%COMP%]   .doc-size[_ngcontent-%COMP%]{font-size:14px;color:#666}.section[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:16px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin:0 0 16px;color:#333}.input-group[_ngcontent-%COMP%]{margin-bottom:16px}.input-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#333;margin-bottom:8px}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]{position:relative}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]{width:100%;padding:12px 40px 12px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px;box-sizing:border-box}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .input-field.error[_ngcontent-%COMP%]{border-color:#ef5350}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .toggle-visibility-btn[_ngcontent-%COMP%]{position:absolute;right:8px;top:50%;transform:translateY(-50%);background:none;border:none;padding:4px;cursor:pointer;color:#666}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .toggle-visibility-btn[_ngcontent-%COMP%]:hover{color:#333}.input-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{margin:4px 0 0;font-size:12px;color:#ef5350}.input-group[_ngcontent-%COMP%]   .password-strength[_ngcontent-%COMP%]{margin-top:8px;display:flex;align-items:center;gap:8px}.input-group[_ngcontent-%COMP%]   .password-strength[_ngcontent-%COMP%]   .strength-bar[_ngcontent-%COMP%]{flex:1;height:4px;background:#e0e0e0;border-radius:2px;overflow:hidden}.input-group[_ngcontent-%COMP%]   .password-strength[_ngcontent-%COMP%]   .strength-bar[_ngcontent-%COMP%]   .strength-bar-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s,background-color .3s}.input-group[_ngcontent-%COMP%]   .password-strength[_ngcontent-%COMP%]   .strength-label[_ngcontent-%COMP%]{font-size:12px;font-weight:500;white-space:nowrap}.permissions-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.permissions-list[_ngcontent-%COMP%]   .permission-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;padding:12px;border:1px solid #e0e0e0;border-radius:8px;cursor:pointer;transition:background .2s}.permissions-list[_ngcontent-%COMP%]   .permission-item[_ngcontent-%COMP%]:hover{background:#f9f9f9}.permissions-list[_ngcontent-%COMP%]   .permission-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-top:2px;width:18px;height:18px;cursor:pointer}.permissions-list[_ngcontent-%COMP%]   .permission-item[_ngcontent-%COMP%]   .permission-info[_ngcontent-%COMP%]{flex:1;display:flex;gap:12px}.permissions-list[_ngcontent-%COMP%]   .permission-item[_ngcontent-%COMP%]   .permission-info[_ngcontent-%COMP%]   .permission-icon[_ngcontent-%COMP%]{font-size:24px}.permissions-list[_ngcontent-%COMP%]   .permission-item[_ngcontent-%COMP%]   .permission-info[_ngcontent-%COMP%]   .permission-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333;margin-bottom:2px}.permissions-list[_ngcontent-%COMP%]   .permission-item[_ngcontent-%COMP%]   .permission-info[_ngcontent-%COMP%]   .permission-desc[_ngcontent-%COMP%]{font-size:12px;color:#666}.encryption-levels[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.encryption-levels[_ngcontent-%COMP%]   .encryption-level-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;border:2px solid #e0e0e0;border-radius:8px;cursor:pointer;transition:border-color .2s,background .2s}.encryption-levels[_ngcontent-%COMP%]   .encryption-level-item[_ngcontent-%COMP%]:hover{background:#f9f9f9}.encryption-levels[_ngcontent-%COMP%]   .encryption-level-item[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer}.encryption-levels[_ngcontent-%COMP%]   .encryption-level-item[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked ~ .level-info[_ngcontent-%COMP%]   .level-label[_ngcontent-%COMP%]{color:#2196f3}.encryption-levels[_ngcontent-%COMP%]   .encryption-level-item[_ngcontent-%COMP%]:has(input[type=radio]:checked){border-color:#2196f3;background:#e3f2fd}.encryption-levels[_ngcontent-%COMP%]   .encryption-level-item[_ngcontent-%COMP%]   .level-info[_ngcontent-%COMP%]{flex:1}.encryption-levels[_ngcontent-%COMP%]   .encryption-level-item[_ngcontent-%COMP%]   .level-info[_ngcontent-%COMP%]   .level-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333;margin-bottom:2px}.encryption-levels[_ngcontent-%COMP%]   .encryption-level-item[_ngcontent-%COMP%]   .level-info[_ngcontent-%COMP%]   .level-desc[_ngcontent-%COMP%]{font-size:12px;color:#666}.encrypt-footer[_ngcontent-%COMP%]{display:flex;gap:12px;padding:16px;background:#fff;border-top:1px solid #e0e0e0}.encrypt-footer[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%], .encrypt-footer[_ngcontent-%COMP%]   .btn-apply[_ngcontent-%COMP%]{flex:1;padding:14px;border:none;border-radius:8px;font-size:16px;font-weight:500;cursor:pointer;transition:background .2s}.encrypt-footer[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:disabled, .encrypt-footer[_ngcontent-%COMP%]   .btn-apply[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.encrypt-footer[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{background:#f5f5f5;color:#333}.encrypt-footer[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover:not(:disabled){background:#e0e0e0}.encrypt-footer[_ngcontent-%COMP%]   .btn-apply[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.encrypt-footer[_ngcontent-%COMP%]   .btn-apply[_ngcontent-%COMP%]:hover:not(:disabled){background:#1976d2}.loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000b3;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000}.loading-overlay[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:4px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:20px;color:#fff;font-size:16px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})};function Ig(r,t){r&1&&h(0,"img",19)}function Tg(r,t){r&1&&h(0,"img",20)}function Ag(r,t){if(r&1&&(o(0,"span"),c(1),a()),r&2){let e=g(3);l(),S(" - ",e.maxAttempts-e.attemptCount,"\uD68C \uB0A8\uC74C!")}}function Fg(r,t){if(r&1&&(o(0,"p",21),c(1),b(2,Ag,2,1,"span",10),a()),r&2){let e=g(2);l(),ue(" ",e.attemptCount," / ",e.maxAttempts,"\uD68C \uC2DC\uB3C4 "),l(),p("ngIf",e.attemptCount>=e.maxAttempts-1)}}function zg(r,t){if(r&1){let e=y();o(0,"div",11)(1,"div",12)(2,"label"),c(3,"\uBB38\uC11C \uBE44\uBC00\uBC88\uD638"),a(),o(4,"div",13)(5,"input",14),$("ngModelChange",function(i){m(e);let s=g();return U(s.password,i)||(s.password=i),f(i)}),u("keyup.enter",function(){m(e);let i=g();return f(i.onDecrypt())}),a(),o(6,"button",15),u("click",function(){m(e);let i=g();return f(i.togglePasswordVisibility())}),b(7,Ig,1,0,"img",16)(8,Tg,1,0,"img",17),a()(),b(9,Fg,3,3,"p",18),a()()}if(r&2){let e=g();l(5),p("type",e.showPassword?"text":"password"),j("ngModel",e.password),p("disabled",e.attemptCount>=e.maxAttempts),l(),p("disabled",e.attemptCount>=e.maxAttempts),l(),p("ngIf",!e.showPassword),l(),p("ngIf",e.showPassword),l(),p("ngIf",e.attemptCount>0)}}function Rg(r,t){r&1&&(o(0,"div",11)(1,"p",22),c(2,"\uC774 \uBB38\uC11C\uB294 \uC554\uD638\uD654\uB418\uC5B4 \uC788\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4."),a()())}function Bg(r,t){if(r&1&&(o(0,"span"),c(1),a()),r&2){let e=g();l(),x(e.isNonEncrypted?"\uBB38\uC11C \uC5F4\uAE30":"\uC554\uD638 \uD574\uC81C")}}function Vg(r,t){r&1&&(o(0,"span"),c(1,"\uCC98\uB9AC \uC911..."),a())}var gi=class r{document=null;password="";showPassword=!1;isLoading=!1;attemptCount=0;maxAttempts=5;isNonEncrypted=!1;router=P(N);indexedDbService=P(ee);snackbar=P(G);pdfEncryptionService=P(ht);toolActionService=P(le);ngOnInit(){return C(this,null,function*(){let t=this.toolActionService.getPendingAction();if(t&&t.data?.documentId){yield this.loadDocumentById(t.data.documentId),this.toolActionService.clearPendingAction();return}let n=this.router.getCurrentNavigation()?.extras?.state||history.state;n&&n.document?(this.document=n.document,this.document&&!this.document.isEncrypted&&(this.isNonEncrypted=!0)):(this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())})}loadDocumentById(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t);e?(this.document=e,this.document&&!this.document.isEncrypted&&(this.isNonEncrypted=!0)):(this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin()}})}togglePasswordVisibility(){this.showPassword=!this.showPassword}onDecrypt(){return C(this,null,function*(){if(!this.document){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}if(this.isNonEncrypted){this.isLoading=!0;try{this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uC5FD\uB2C8\uB2E4."),this.router.navigate(["/ezm/viewer"],{state:{document:this.document}})}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}finally{this.isLoading=!1}return}if(!this.password){this.snackbar.showWarning("\uBE44\uBC00\uBC88\uD638\uB97C \uC785\uB825\uD558\uC138\uC694.");return}if(this.attemptCount>=this.maxAttempts){this.snackbar.showError(`\uCD5C\uB300 \uC2DC\uB3C4 \uD69F\uC218(${this.maxAttempts}\uD68C)\uB97C \uCD08\uACFC\uD588\uC2B5\uB2C8\uB2E4.`);return}try{this.isLoading=!0,this.attemptCount++;let t;if(this.pdfEncryptionService.isNativeEncryptionAvailable()){let n=this.document.originalPdfBase64||this.document.pdfBase64;if(!n)throw new Error("\uC554\uD638\uD654\uB41C PDF \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");t=yield this.pdfEncryptionService.decryptPdf(n,this.password)}else{if(this.document.encryptionMetadata?.password!==this.password)throw new Error("\uBE44\uBC00\uBC88\uD638\uAC00 \uD2C0\uB838\uC2B5\uB2C8\uB2E4.");t=this.document.originalPdfBase64||this.document.pdfBase64||""}let e=yield this.indexedDbService.getDocumentById(this.document.id);e&&(e.pdfBase64=t,e.isEncrypted=!1,delete e.encryptionMetadata,e.updatedAt=Date.now().toString(),yield this.indexedDbService.saveDocument(e)),this.snackbar.showSuccess("PDF \uC554\uD638\uAC00 \uD574\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.router.navigate(["/ezm/viewer"],{state:{document:e}})}catch(t){if(t.message.includes("\uBE44\uBC00\uBC88\uD638")||t.message.includes("password")){let e=this.maxAttempts-this.attemptCount;e>0?(this.snackbar.showError(`\uC798\uBABB\uB41C \uBE44\uBC00\uBC88\uD638\uC785\uB2C8\uB2E4. (\uB0A8\uC740 \uC2DC\uB3C4: ${e}\uD68C)`),this.password=""):this.snackbar.showError("\uCD5C\uB300 \uC2DC\uB3C4 \uD69F\uC218\uB97C \uCD08\uACFC\uD588\uC2B5\uB2C8\uB2E4.")}else this.snackbar.showError(t.message||"\uC554\uD638 \uD574\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}finally{this.isLoading=!1}})}onCancel(){this.toolActionService.navigateToOrigin()}onForgotPassword(){this.snackbar.showWarning("\uBE44\uBC00\uBC88\uD638\uB97C \uC78A\uC73C\uC168\uB2E4\uBA74 \uBB38\uC11C\uB97C \uBCF5\uAD6C\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4. \uC554\uD638\uD654\uB41C \uC6D0\uBCF8\uC774 \uD544\uC694\uD569\uB2C8\uB2E4.")}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-decrypt"]],standalone:!1,decls:14,vars:5,consts:[[1,"decrypt-container"],[1,"decrypt-header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"title"],[1,"spacer"],[1,"decrypt-content"],["class","section",4,"ngIf"],[1,"decrypt-footer"],[1,"btn-apply",3,"click","disabled"],[4,"ngIf"],[1,"section"],[1,"input-group"],[1,"password-input-wrapper"],["placeholder","",1,"input-field",3,"ngModelChange","keyup.enter","type","ngModel","disabled"],["type","button",1,"toggle-visibility-btn",3,"click","disabled"],["src","images/icons/btn-top-find.svg","alt","\uBCF4\uAE30","width","20","height","20",4,"ngIf"],["src","images/icons/btn-top-find.svg","alt","\uC228\uAE30\uAE30","width","20","height","20",4,"ngIf"],["class","error-message",4,"ngIf"],["src","images/icons/btn-top-find.svg","alt","\uBCF4\uAE30","width","20","height","20"],["src","images/icons/btn-top-find.svg","alt","\uC228\uAE30\uAE30","width","20","height","20"],[1,"error-message"],[1,"info-text"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),u("click",function(){return n.onCancel()}),h(3,"img",3),a(),o(4,"h1",4),c(5,"PDF \uC554\uD638 \uD574\uC81C"),a(),h(6,"div",5),a(),o(7,"div",6),b(8,zg,10,7,"div",7)(9,Rg,3,0,"div",7),a(),o(10,"div",8)(11,"button",9),u("click",function(){return n.onDecrypt()}),b(12,Bg,2,1,"span",10)(13,Vg,2,0,"span",10),a()()()),e&2&&(l(8),p("ngIf",!n.isNonEncrypted),l(),p("ngIf",n.isNonEncrypted),l(2),p("disabled",n.isLoading||!n.isNonEncrypted&&(!n.password||n.attemptCount>=n.maxAttempts)),l(),p("ngIf",!n.isLoading),l(),p("ngIf",n.isLoading))},dependencies:[B,he,pe,ge],styles:[".decrypt-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:content-box;background:#f5f5f5}.decrypt-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;background:#fff;border-bottom:1px solid #e0e0e0;position:sticky;top:0;z-index:10}.decrypt-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;color:#333}.decrypt-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5;border-radius:4px}.decrypt-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:1;text-align:center;font-size:18px;font-weight:600;margin:0}.decrypt-header[_ngcontent-%COMP%]   .spacer[_ngcontent-%COMP%]{width:40px}.decrypt-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px}.section[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:16px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.section[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#666;text-align:center}.input-group[_ngcontent-%COMP%]{margin-bottom:16px}.input-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#333;margin-bottom:8px}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]{position:relative}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]{width:100%;padding:12px 40px 12px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px;box-sizing:border-box}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .input-field[_ngcontent-%COMP%]:disabled{background:#f5f5f5;color:#999}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .toggle-visibility-btn[_ngcontent-%COMP%]{position:absolute;right:8px;top:50%;transform:translateY(-50%);background:none;border:none;padding:4px;cursor:pointer;color:#666}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .toggle-visibility-btn[_ngcontent-%COMP%]:hover{color:#333}.input-group[_ngcontent-%COMP%]   .password-input-wrapper[_ngcontent-%COMP%]   .toggle-visibility-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.input-group[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{margin:4px 0 0;font-size:12px;color:#ef5350}.decrypt-footer[_ngcontent-%COMP%]{padding:16px;background:#fff;border-top:1px solid #e0e0e0}.decrypt-footer[_ngcontent-%COMP%]   .btn-apply[_ngcontent-%COMP%]{width:100%;padding:14px;font-size:16px;font-weight:600;border:none;border-radius:8px;background:#2196f3;color:#fff;cursor:pointer;transition:background .2s}.decrypt-footer[_ngcontent-%COMP%]   .btn-apply[_ngcontent-%COMP%]:hover:not(:disabled){background:#1976d2}.decrypt-footer[_ngcontent-%COMP%]   .btn-apply[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}"]})};var Lg=["modalContent"];function Ng(r,t){if(r&1){let e=y();o(0,"div",1),u("click",function(){m(e);let i=g();return f(i.onCancel())}),o(1,"div",2),u("click",function(i){return m(e),f(i.stopPropagation())}),o(2,"div",3)(3,"div",4)(4,"button",5),u("click",function(){m(e);let i=g();return f(i.onSave())}),h(5,"img",6),c(6," \uC801\uC6A9 "),a(),o(7,"button",7),u("click",function(){m(e);let i=g();return f(i.onCancel())}),c(8," \xD7 "),a()(),o(9,"input",8),$("ngModelChange",function(i){m(e);let s=g();return U(s.editedContent,i)||(s.editedContent=i),f(i)}),u("keydown.enter",function(){m(e);let i=g();return f(i.onSave())})("keydown.escape",function(){m(e);let i=g();return f(i.onCancel())}),a()(),o(10,"div",9)(11,"div",10)(12,"label",11),c(13,"\uB113\uC774"),a(),o(14,"span",12),c(15),a()(),o(16,"div",13)(17,"label",11),c(18,"\uD06C\uAE30"),a(),o(19,"div",14)(20,"button",15),u("click",function(){m(e);let i=g();return f(i.decreaseFontSize())}),o(21,"span",16),c(22,"A-"),a()(),o(23,"span",17),c(24),a(),o(25,"button",18),u("click",function(){m(e);let i=g();return f(i.increaseFontSize())}),o(26,"span",16),c(27,"A+"),a()()()(),o(28,"div",13)(29,"label",11),c(30,"\uD3F0\uD2B8"),a(),o(31,"select",19),$("ngModelChange",function(i){m(e);let s=g();return U(s.currentFontFamily,i)||(s.currentFontFamily=i),f(i)}),u("change",function(){m(e);let i=g();return f(i.onFontChange())}),o(32,"optgroup",20)(33,"option",21),c(34,"Noto Sans KR"),a(),o(35,"option",22),c(36,"\uB098\uB214\uACE0\uB515"),a(),o(37,"option",23),c(38,"\uB098\uB214\uBC14\uB978\uACE0\uB515"),a(),o(39,"option",24),c(40,"IBM Plex Sans KR"),a(),o(41,"option",25),c(42,"\uB098\uB214\uC2A4\uD018\uC5B4"),a(),o(43,"option",26),c(44,"Black Han Sans"),a()(),o(45,"optgroup",27)(46,"option",28),c(47,"Noto Serif KR"),a(),o(48,"option",29),c(49,"\uB098\uB214\uBA85\uC870"),a()(),o(50,"optgroup",30)(51,"option",31),c(52,"\uB098\uB214\uC190\uAE00\uC528\uD39C"),a(),o(53,"option",32),c(54,"\uB098\uB214\uC190\uAE00\uC528\uBD93"),a(),o(55,"option",33),c(56,"\uB3C4\uD604\uCCB4"),a(),o(57,"option",34),c(58,"\uC8FC\uC544\uCCB4"),a(),o(59,"option",35),c(60,"\uAC1C\uAD6C\uC7C1\uC774\uCCB4"),a(),o(61,"option",36),c(62,"\uAC10\uC790\uAF43\uCCB4"),a(),o(63,"option",37),c(64,"\uD574\uBC14\uB77C\uAE30\uCCB4"),a(),o(65,"option",38),c(66,"\uB3D9\uD574\uB3C5\uB3C4\uCCB4"),a(),o(67,"option",39),c(68,"\uD558\uC774\uBA5C\uB85C\uB514\uCCB4"),a()(),o(69,"optgroup",40)(70,"option",41),c(71,"Arial"),a(),o(72,"option",42),c(73,"Helvetica"),a(),o(74,"option",43),c(75,"Times New Roman"),a(),o(76,"option",44),c(77,"Courier New"),a(),o(78,"option",45),c(79,"Georgia"),a(),o(80,"option",46),c(81,"Verdana"),a(),o(82,"option",47),c(83,"Roboto"),a(),o(84,"option",48),c(85,"Open Sans"),a(),o(86,"option",49),c(87,"Lato"),a(),o(88,"option",50),c(89,"Montserrat"),a(),o(90,"option",51),c(91,"Poppins"),a(),o(92,"option",52),c(93,"Inter"),a(),o(94,"option",53),c(95,"Ubuntu"),a()()()(),o(96,"div",13)(97,"label",11),c(98,"\uC0C9\uC0C1"),a(),o(99,"input",54),$("ngModelChange",function(i){m(e);let s=g();return U(s.currentColor,i)||(s.currentColor=i),f(i)}),u("change",function(){m(e);let i=g();return f(i.onColorChange())}),a()(),o(100,"div",55)(101,"button",56),u("click",function(){m(e);let i=g();return f(i.onCancel())}),c(102," \uCDE8\uC18C "),a(),o(103,"button",57),u("click",function(){m(e);let i=g();return f(i.onSave())}),c(104," \uC800\uC7A5 "),a()()()()()}if(r&2){let e=g();q("background",e.complementaryColor)("height",e.keyboardHeight>0?"calc(100vh - "+e.keyboardHeight+"px)":"100vh"),l(),q("max-height",e.keyboardHeight>0?"calc(100vh - "+e.keyboardHeight+"px)":"100vh"),l(3),q("color",e.currentColor),l(3),q("color",e.currentColor),l(2),q("color",e.currentColor)("font-size",e.currentFontSize*2,"px")("font-family",e.currentFontFamily),j("ngModel",e.editedContent),l(),q("bottom",e.keyboardHeight,"px"),l(5),S("",e.previewWidth,"px"),l(9),S("",e.currentFontSize,"px"),l(7),j("ngModel",e.currentFontFamily),l(68),j("ngModel",e.currentColor)}}var ui=class r{constructor(t,e,n){this.cdr=t;this.overlay=e;this.viewContainerRef=n}isVisible=!1;textData=null;save=new W;cancel=new W;delete=new W;modalContentTemplate;overlayRef=null;portal=null;editedContent="";currentFontSize=48;currentFontFamily="Arial";currentColor="#1e293b";availableFonts=[{value:"Noto Sans KR",label:"Noto Sans KR",group:"\uD55C\uAE00 \uACE0\uB515"},{value:"NanumGothic",label:"\uB098\uB214\uACE0\uB515",group:"\uD55C\uAE00 \uACE0\uB515"},{value:"NanumBarunGothic",label:"\uB098\uB214\uBC14\uB978\uACE0\uB515",group:"\uD55C\uAE00 \uACE0\uB515"},{value:"IBM Plex Sans KR",label:"IBM Plex Sans KR",group:"\uD55C\uAE00 \uACE0\uB515"},{value:"NanumSquare",label:"\uB098\uB214\uC2A4\uD018\uC5B4",group:"\uD55C\uAE00 \uACE0\uB515"},{value:"Black Han Sans",label:"Black Han Sans",group:"\uD55C\uAE00 \uACE0\uB515"},{value:"Noto Serif KR",label:"Noto Serif KR",group:"\uD55C\uAE00 \uBA85\uC870"},{value:"NanumMyeongjo",label:"\uB098\uB214\uBA85\uC870",group:"\uD55C\uAE00 \uBA85\uC870"},{value:"NanumPen",label:"\uB098\uB214\uC190\uAE00\uC528\uD39C",group:"\uC190\uAE00\uC528"},{value:"NanumBrush",label:"\uB098\uB214\uC190\uAE00\uC528\uBD93",group:"\uC190\uAE00\uC528"},{value:"DoHyeon",label:"\uB3C4\uD604\uCCB4",group:"\uC190\uAE00\uC528"},{value:"Jua",label:"\uC8FC\uC544\uCCB4",group:"\uC190\uAE00\uC528"},{value:"Gaegu",label:"\uAC1C\uAD6C\uC7C1\uC774\uCCB4",group:"\uC190\uAE00\uC528"},{value:"GamjaFlower",label:"\uAC10\uC790\uAF43\uCCB4",group:"\uC190\uAE00\uC528"},{value:"Sunflower",label:"\uD574\uBC14\uB77C\uAE30\uCCB4",group:"\uC190\uAE00\uC528"},{value:"EastSeaDokdo",label:"\uB3D9\uD574\uB3C5\uB3C4\uCCB4",group:"\uC190\uAE00\uC528"},{value:"HiMelody",label:"\uD558\uC774\uBA5C\uB85C\uB514\uCCB4",group:"\uC190\uAE00\uC528"},{value:"Arial",label:"Arial",group:"\uC601\uBB38"},{value:"Helvetica",label:"Helvetica",group:"\uC601\uBB38"},{value:"Times New Roman",label:"Times New Roman",group:"\uC601\uBB38"},{value:"Courier New",label:"Courier New",group:"\uC601\uBB38"},{value:"Georgia",label:"Georgia",group:"\uC601\uBB38"},{value:"Verdana",label:"Verdana",group:"\uC601\uBB38"},{value:"Roboto",label:"Roboto",group:"\uC601\uBB38"},{value:"Open Sans",label:"Open Sans",group:"\uC601\uBB38"},{value:"Lato",label:"Lato",group:"\uC601\uBB38"},{value:"Montserrat",label:"Montserrat",group:"\uC601\uBB38"},{value:"Poppins",label:"Poppins",group:"\uC601\uBB38"},{value:"Inter",label:"Inter",group:"\uC601\uBB38"},{value:"Ubuntu",label:"Ubuntu",group:"\uC601\uBB38"}];keyboardHeight=0;ngOnInit(){window.visualViewport&&(window.visualViewport.addEventListener("resize",this.handleViewportResize),window.visualViewport.addEventListener("scroll",this.handleViewportResize))}ngOnDestroy(){document.documentElement.classList.remove("modal-open"),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.position="",document.body.style.width="",document.body.style.height="",document.body.style.top="",document.body.style.touchAction="",this.overlayRef&&(this.overlayRef.detach(),this.overlayRef.dispose(),this.overlayRef=null),window.visualViewport&&(window.visualViewport.removeEventListener("resize",this.handleViewportResize),window.visualViewport.removeEventListener("scroll",this.handleViewportResize))}handleViewportResize=()=>{if(window.visualViewport){let t=window.visualViewport.height,e=window.innerHeight,n=Math.max(0,e-t);Math.abs(this.keyboardHeight-n)>5&&(this.keyboardHeight=n,this.cdr.detectChanges(),requestAnimationFrame(()=>{document.body.style.position="fixed",document.body.style.top="0",document.body.style.left="0",document.body.style.right="0",this.overlayRef&&this.overlayRef.updatePosition(),this.cdr.detectChanges()}))}else console.warn("\u26A0\uFE0F visualViewport API \uC0AC\uC6A9 \uBD88\uAC00")};ngOnChanges(){if(this.isVisible&&!this.overlayRef){if(document.documentElement.classList.add("modal-open"),document.body.classList.add("modal-open"),document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.height="100vh",document.body.style.top="0",document.body.style.left="0",document.body.style.right="0",document.body.style.touchAction="none",window.visualViewport){let t=window.visualViewport.height,e=window.innerHeight;this.keyboardHeight=Math.max(0,e-t)}else this.keyboardHeight=0;this.overlayRef=this.createOverlay(),this.portal=new vo(this.modalContentTemplate,this.viewContainerRef),this.overlayRef.attach(this.portal),this.cdr.detectChanges(),setTimeout(()=>this.handleViewportResize(),50),setTimeout(()=>this.handleViewportResize(),150),setTimeout(()=>this.handleViewportResize(),300),setTimeout(()=>this.handleViewportResize(),600),setTimeout(()=>this.handleViewportResize(),1e3)}else!this.isVisible&&this.overlayRef&&(document.documentElement.classList.remove("modal-open"),document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.position="",document.body.style.width="",document.body.style.height="",document.body.style.top="",document.body.style.left="",document.body.style.right="",document.body.style.touchAction="",this.keyboardHeight=0,this.overlayRef.detach(),this.overlayRef=null,this.portal=null);this.textData&&(this.editedContent=this.textData.content,this.currentFontSize=this.textData.fontSize||48,this.currentFontFamily=this.textData.fontFamily||"Arial",this.currentColor=this.textData.color||"#1e293b")}createOverlay(){return this.overlay.create({positionStrategy:this.overlay.position().global(),hasBackdrop:!1,scrollStrategy:this.overlay.scrollStrategies.block(),panelClass:"mobile-text-edit-overlay"})}forceLayoutAdjustment(){if(!window.visualViewport)return;let t=window.visualViewport.height,e=window.innerHeight,n=Math.max(0,e-t);Math.abs(this.keyboardHeight-n)>5&&(this.keyboardHeight=n,this.cdr.detectChanges(),requestAnimationFrame(()=>{document.body.style.position="fixed",document.body.style.top="0",document.body.style.left="0",document.body.style.right="0",this.overlayRef&&this.overlayRef.updatePosition(),this.cdr.detectChanges()}))}get previewWidth(){return this.editedContent?this.calculateTextWidth(this.editedContent,this.currentFontSize,this.currentFontFamily):0}calculateTextWidth(t,e,n){let s=document.createElement("canvas").getContext("2d");if(!s)return t.length*e*.6;s.font=`500 ${e}px ${n}`;let _=s.measureText(t).width;return Math.ceil(_+20)}increaseFontSize(){this.currentFontSize<72&&(this.currentFontSize+=2)}decreaseFontSize(){this.currentFontSize>12&&(this.currentFontSize-=2)}onFontChange(){}onColorChange(){}get complementaryColor(){let t=this.currentColor.replace("#",""),e=parseInt(t.substring(0,2),16),n=parseInt(t.substring(2,4),16),i=parseInt(t.substring(4,6),16),s=255-e,d=255-n,_=255-i;return`rgba(${s}, ${d}, ${_}, 0.95)`}onSave(){this.textData&&this.save.emit(Z(K({},this.textData),{content:this.editedContent,fontSize:this.currentFontSize,fontFamily:this.currentFontFamily,color:this.currentColor}))}onCancel(){this.cancel.emit()}onDelete(){this.textData&&this.delete.emit(this.textData.textId)}static \u0275fac=function(e){return new(e||r)(V(fe),V(So),V(no))};static \u0275cmp=F({type:r,selectors:[["app-mobile-text-edit-modal"]],viewQuery:function(e,n){if(e&1&&$e(Lg,5),e&2){let i;He(i=We())&&(n.modalContentTemplate=i.first)}},inputs:{isVisible:"isVisible",textData:"textData"},outputs:{save:"save",cancel:"cancel",delete:"delete"},features:[Je],decls:2,vars:0,consts:[["modalContent",""],[1,"modal-backdrop",3,"click"],[1,"modal-container",3,"click"],[1,"text-input-area"],[1,"input-header-buttons"],["type","button","aria-label","\uC801\uC6A9",1,"modal-apply-btn",3,"click"],["src","images/icons/ico-check.svg","alt","\uC801\uC6A9","width","20","height","20"],["type","button","aria-label","\uB2EB\uAE30",1,"modal-close-btn",3,"click"],["type","text","placeholder","\uD14D\uC2A4\uD2B8\uB97C \uC785\uB825\uD558\uC138\uC694","autofocus","",1,"large-text-input",3,"ngModelChange","keydown.enter","keydown.escape","ngModel"],[1,"keyboard-toolbar"],[1,"toolbar-group","width-preview"],[1,"toolbar-label"],[1,"width-display"],[1,"toolbar-group"],[1,"size-controls"],["type","button","title","\uC791\uAC8C",1,"control-btn",3,"click"],[1,"icon"],[1,"size-display"],["type","button","title","\uD06C\uAC8C",1,"control-btn",3,"click"],[1,"font-select",3,"ngModelChange","change","ngModel"],["label","\uD55C\uAE00 \uACE0\uB515\uCCB4"],["value","Noto Sans KR"],["value","NanumGothic"],["value","NanumBarunGothic"],["value","IBM Plex Sans KR"],["value","NanumSquare"],["value","Black Han Sans"],["label","\uD55C\uAE00 \uBA85\uC870\uCCB4"],["value","Noto Serif KR"],["value","NanumMyeongjo"],["label","\uC190\uAE00\uC528/\uCE90\uC8FC\uC5BC"],["value","NanumPen"],["value","NanumBrush"],["value","DoHyeon"],["value","Jua"],["value","Gaegu"],["value","GamjaFlower"],["value","Sunflower"],["value","EastSeaDokdo"],["value","HiMelody"],["label","\uC601\uBB38 \uD3F0\uD2B8"],["value","Arial"],["value","Helvetica"],["value","Times New Roman"],["value","Courier New"],["value","Georgia"],["value","Verdana"],["value","Roboto"],["value","Open Sans"],["value","Lato"],["value","Montserrat"],["value","Poppins"],["value","Inter"],["value","Ubuntu"],["type","color",1,"color-picker",3,"ngModelChange","change","ngModel"],[1,"toolbar-actions"],["type","button",1,"action-btn","cancel-btn",3,"click"],["type","button",1,"action-btn","save-btn",3,"click"]],template:function(e,n){e&1&&b(0,Ng,105,23,"ng-template",null,0,$t)},dependencies:[_e,Qe,Ve,Le,he,Gt,pe,ge,xo,Oo],styles:['@charset "UTF-8";@font-face{font-family:Noto Sans KR;src:url(/ezReader_Page/fonts/NotoSansKR-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:NanumGothic;src:url(/ezReader_Page/fonts/NanumGothic-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:NanumBarunGothic;src:url(/ezReader_Page/fonts/NanumBarunGothic-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:IBM Plex Sans KR;src:url(/ezReader_Page/fonts/IBMPlexSansKR-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:NanumSquare;src:url(/ezReader_Page/fonts/NanumSquare-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Black Han Sans;src:url(/ezReader_Page/fonts/BlackHanSans-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:"Noto Serif KR";src:url(/ezReader_Page/fonts/NotoSerifKR-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:NanumMyeongjo;src:url(/ezReader_Page/fonts/NanumMyeongjo-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:NanumPen;src:url(/ezReader_Page/fonts/NanumPen-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:NanumBrush;src:url(/ezReader_Page/fonts/NanumBrush-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:DoHyeon;src:url(/ezReader_Page/fonts/DoHyeon-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Jua;src:url(/ezReader_Page/fonts/Jua-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Gaegu;src:url(/ezReader_Page/fonts/Gaegu-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:GamjaFlower;src:url(/ezReader_Page/fonts/GamjaFlower-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Sunflower;src:url(/ezReader_Page/fonts/Sunflower-Medium.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:EastSeaDokdo;src:url(/ezReader_Page/fonts/EastSeaDokdo-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:HiMelody;src:url(/ezReader_Page/fonts/HiMelody-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Roboto;src:url(/ezReader_Page/fonts/Roboto-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Open Sans;src:url(/ezReader_Page/fonts/OpenSans-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Lato;src:url(/ezReader_Page/fonts/Lato-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Montserrat;src:url(/ezReader_Page/fonts/Montserrat-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Poppins;src:url(/ezReader_Page/fonts/Poppins-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Inter;src:url(/ezReader_Page/fonts/Inter-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:Ubuntu;src:url(/ezReader_Page/fonts/Ubuntu-Regular.ttf) format("truetype");font-weight:400;font-style:normal;font-display:swap}  .cdk-overlay-container{position:fixed;width:100vw;height:100vh;top:0;left:0;overflow:hidden!important;pointer-events:none;z-index:9999}  .cdk-overlay-container .mobile-text-edit-overlay{pointer-events:auto;overflow:hidden!important}  body.modal-open{overflow:hidden!important;position:fixed!important;width:100%!important;height:100vh!important;touch-action:none!important}  html.modal-open{overflow:hidden!important}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;background:#000000d9;display:flex;align-items:center;justify-content:center;z-index:10000;padding:16px;overflow:hidden!important;touch-action:none!important}.input-header-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-bottom:12px;padding:0 8px}.modal-apply-btn[_ngcontent-%COMP%]{padding:10px 16px;border:none;background:transparent;color:#fff;font-size:14px;font-weight:600;cursor:pointer;border-radius:22px;display:flex;align-items:center;gap:6px;transition:all .2s ease}.modal-apply-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.modal-apply-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a;transform:translateY(-1px)}.modal-apply-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#fff3}.modal-close-btn[_ngcontent-%COMP%]{width:44px;height:44px;border:none;background:transparent;color:#fff;font-size:36px;line-height:1;cursor:pointer;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .2s ease}.modal-close-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a;transform:scale(1.1)}.modal-close-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#fff3}.modal-container[_ngcontent-%COMP%]{width:100%;max-width:600px;max-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 24px;position:relative;transition:max-height .3s ease}.text-input-area[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;background:none!important;background-color:transparent!important;border:none!important;padding:0!important;margin:0!important;box-shadow:none!important}.text-input-area[_ngcontent-%COMP%]   .large-text-input[_ngcontent-%COMP%]{width:100%;padding:0;margin:0;border:none!important;border-radius:0!important;font-size:48px;font-weight:500;font-family:inherit;text-align:center;background:none!important;background-color:transparent!important;backdrop-filter:none!important;-webkit-backdrop-filter:none!important;transition:none;box-shadow:none!important;-webkit-appearance:none;appearance:none;white-space:nowrap;overflow-x:auto;overflow-y:hidden}.text-input-area[_ngcontent-%COMP%]   .large-text-input[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.text-input-area[_ngcontent-%COMP%]   .large-text-input[_ngcontent-%COMP%]:focus{outline:none!important;border:none!important;background:transparent!important;background-color:transparent!important;box-shadow:none!important}.text-input-area[_ngcontent-%COMP%]   .large-text-input[_ngcontent-%COMP%]::placeholder{color:#ffffff80;font-size:40px}@media (max-width: 768px){.modal-backdrop[_ngcontent-%COMP%]{padding:0 0 260px;align-items:center}.modal-container[_ngcontent-%COMP%]{max-width:100%;border-radius:0;padding:24px 20px;justify-content:center}.text-input-area[_ngcontent-%COMP%]{border-radius:16px 16px 0 0;padding:20px;background:#ffffffe6}.text-input-area[_ngcontent-%COMP%]   .large-text-input[_ngcontent-%COMP%]{font-size:24px;padding:16px 20px;white-space:nowrap;overflow-x:auto;overflow-y:hidden}.text-input-area[_ngcontent-%COMP%]   .large-text-input[_ngcontent-%COMP%]::placeholder{font-size:20px}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideUpMobile{0%{transform:translateY(100%)}to{transform:translateY(0)}}.keyboard-toolbar[_ngcontent-%COMP%]{position:fixed;left:0;right:0;background:#fffffffa;backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-top:1px solid rgba(0,0,0,.1);padding:12px 16px;padding-bottom:calc(12px + env(safe-area-inset-bottom,0));display:flex;gap:12px;align-items:center;box-shadow:0 -4px 12px #00000014;z-index:10002;overflow-x:auto;overflow-y:hidden;touch-action:pan-x;-webkit-overflow-scrolling:touch;scrollbar-width:none;-ms-overflow-style:none}.keyboard-toolbar[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.keyboard-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;flex-shrink:0}.keyboard-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   .toolbar-label[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#64748b;white-space:nowrap}.keyboard-toolbar[_ngcontent-%COMP%]   .size-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;background:#f1f5f9cc;border-radius:8px;padding:4px}.keyboard-toolbar[_ngcontent-%COMP%]   .size-controls[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:6px;padding:6px 10px;font-size:14px;font-weight:600;color:#3b82f6;cursor:pointer;transition:all .2s ease}.keyboard-toolbar[_ngcontent-%COMP%]   .size-controls[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]:active{background:#f1f5f9;transform:scale(.95)}.keyboard-toolbar[_ngcontent-%COMP%]   .size-controls[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:block;line-height:1}.keyboard-toolbar[_ngcontent-%COMP%]   .size-controls[_ngcontent-%COMP%]   .size-display[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#1e293b;min-width:44px;text-align:center}.keyboard-toolbar[_ngcontent-%COMP%]   .width-preview[_ngcontent-%COMP%]   .width-display[_ngcontent-%COMP%]{font-size:13px;font-weight:700;color:#10b981;min-width:60px;text-align:center;background:#10b9811a;padding:6px 12px;border-radius:8px;border:1px solid rgba(16,185,129,.2)}.keyboard-toolbar[_ngcontent-%COMP%]   .font-select[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:8px;padding:8px 12px;font-size:13px;font-weight:500;color:#1e293b;cursor:pointer;min-width:120px}.keyboard-toolbar[_ngcontent-%COMP%]   .font-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.keyboard-toolbar[_ngcontent-%COMP%]   .color-picker[_ngcontent-%COMP%]{width:40px;height:40px;border:2px solid #e2e8f0;border-radius:8px;cursor:pointer;background:#fff}.keyboard-toolbar[_ngcontent-%COMP%]   .color-picker[_ngcontent-%COMP%]::-webkit-color-swatch-wrapper{padding:4px}.keyboard-toolbar[_ngcontent-%COMP%]   .color-picker[_ngcontent-%COMP%]::-webkit-color-swatch{border:none;border-radius:4px}.keyboard-toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-left:auto;flex-shrink:0}.keyboard-toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s ease;border:none}.keyboard-toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn.cancel-btn[_ngcontent-%COMP%]{background:#f1f5f9;color:#64748b}.keyboard-toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn.cancel-btn[_ngcontent-%COMP%]:active{background:#e2e8f0}.keyboard-toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn.save-btn[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.keyboard-toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn.save-btn[_ngcontent-%COMP%]:active{background:#2563eb}@media (min-width: 769px){.keyboard-toolbar[_ngcontent-%COMP%]{position:relative;bottom:auto;border-top:none;border-radius:12px;margin-top:16px;overflow-x:visible}}@media (max-width: 768px){.modal-backdrop[_ngcontent-%COMP%]{padding-bottom:80px}.keyboard-toolbar[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;padding:10px 12px;gap:8px}.keyboard-toolbar[_ngcontent-%COMP%]   .toolbar-group[_ngcontent-%COMP%]   .toolbar-label[_ngcontent-%COMP%]{font-size:11px}.keyboard-toolbar[_ngcontent-%COMP%]   .font-select[_ngcontent-%COMP%]{min-width:100px;font-size:12px;padding:6px 10px}.keyboard-toolbar[_ngcontent-%COMP%]   .size-controls[_ngcontent-%COMP%]   .control-btn[_ngcontent-%COMP%]{padding:5px 8px;font-size:12px}.keyboard-toolbar[_ngcontent-%COMP%]   .size-controls[_ngcontent-%COMP%]   .size-display[_ngcontent-%COMP%]{font-size:12px;min-width:40px}.keyboard-toolbar[_ngcontent-%COMP%]   .color-picker[_ngcontent-%COMP%]{width:36px;height:36px}.keyboard-toolbar[_ngcontent-%COMP%]   .toolbar-actions[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}}.virtual-keyboard[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;background:#d1d5db;border-top:1px solid #9ca3af;z-index:10001;box-shadow:0 -4px 20px #0003}.virtual-keyboard[_ngcontent-%COMP%]   .keyboard-header[_ngcontent-%COMP%]{background:#e5e7eb;padding:8px 16px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #9ca3af}.virtual-keyboard[_ngcontent-%COMP%]   .keyboard-header[_ngcontent-%COMP%]   .keyboard-title[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#374151}.virtual-keyboard[_ngcontent-%COMP%]   .keyboard-header[_ngcontent-%COMP%]   .keyboard-close[_ngcontent-%COMP%]{background:#f3f4f6;border:1px solid #9ca3af;border-radius:4px;width:28px;height:28px;font-size:20px;font-weight:700;color:#6b7280;cursor:pointer;display:flex;align-items:center;justify-content:center}.virtual-keyboard[_ngcontent-%COMP%]   .keyboard-header[_ngcontent-%COMP%]   .keyboard-close[_ngcontent-%COMP%]:active{background:#e5e7eb}.virtual-keyboard[_ngcontent-%COMP%]   .keyboard-body[_ngcontent-%COMP%]{padding:8px}.virtual-keyboard[_ngcontent-%COMP%]   .keyboard-body[_ngcontent-%COMP%]   .keyboard-row[_ngcontent-%COMP%]{display:flex;gap:4px;margin-bottom:6px;justify-content:center}.virtual-keyboard[_ngcontent-%COMP%]   .keyboard-body[_ngcontent-%COMP%]   .keyboard-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.virtual-keyboard[_ngcontent-%COMP%]   .keyboard-body[_ngcontent-%COMP%]   .keyboard-row[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{flex:1;min-width:30px;max-width:50px;height:44px;background:#fff;border:1px solid #9ca3af;border-radius:6px;font-size:16px;font-weight:500;color:#1f2937;cursor:pointer;box-shadow:0 2px 4px #0000001a;transition:all .1s ease}.virtual-keyboard[_ngcontent-%COMP%]   .keyboard-body[_ngcontent-%COMP%]   .keyboard-row[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]:active{background:#f3f4f6;transform:scale(.95);box-shadow:0 1px 2px #0000001a}.virtual-keyboard[_ngcontent-%COMP%]   .keyboard-body[_ngcontent-%COMP%]   .keyboard-row[_ngcontent-%COMP%]   .key.wide-key[_ngcontent-%COMP%]{flex:3;max-width:200px}@media (max-width: 768px){.virtual-keyboard[_ngcontent-%COMP%] ~ .keyboard-toolbar[_ngcontent-%COMP%], .keyboard-toolbar[_ngcontent-%COMP%]{transform:translateY(0);transition:transform .3s ease}.modal-container[_ngcontent-%COMP%]:has(~.virtual-keyboard){padding-bottom:280px}}'],changeDetection:0})};var jg=(r,t)=>t.id||r;function Ug(r,t){if(r&1&&(o(0,"div",2)(1,"div",5),h(2,"div",6),o(3,"div",7)(4,"h3"),c(5),a(),o(6,"div",8),h(7,"div",9),a(),o(8,"p",10),c(9),a()()()()),r&2){let e=g();l(5),x(e.creationStep),l(2),q("width",e.creationProgress,"%"),l(2),S("",e.creationProgress,"%")}}function $g(r,t){if(r&1){let e=y();o(0,"div",17),u("touchstart",function(i){m(e);let s=g().$implicit,d=g(3);return f(d.startElementDrag(i,s))})("click",function(i){m(e);let s=g().$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))}),o(1,"span",18),c(2),a()()}if(r&2){let e=g().$implicit,n=g(3);q("left",e.x,"px")("top",e.y,"px")("width",e.width,"px")("height",e.height,"px")("transform","rotate("+(e.rotation||0)+"deg)")("opacity",e.opacity||1),k("selected",(n.selectedElement==null?null:n.selectedElement.id)===e.id),l(),q("color",e.color)("font-size",e.fontSize,"px"),l(),S(" ",e.text||"WATERMARK"," ")}}function Hg(r,t){if(r&1){let e=y();o(0,"div",19),u("touchstart",function(i){m(e);let s=g().$implicit,d=g(3);return f(d.startElementDrag(i,s))})("click",function(i){m(e);let s=g().$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))}),ve(),o(1,"svg",20),h(2,"path",21),a()()}if(r&2){let e=g().$implicit,n=g(3);q("left",e.x,"px")("top",e.y,"px")("width",e.width,"px")("height",e.height,"px"),k("selected",(n.selectedElement==null?null:n.selectedElement.id)===e.id),l(),Be("width",e.width)("height",e.height)("viewBox",(e.properties==null?null:e.properties.viewBox)||"0 0 "+e.width+" "+e.height),l(),Be("d",e.pathData)("stroke",e.strokeColor||"#2c3e50")("stroke-width",e.strokeWidth||2)("fill",e.fill||"none")("fill-opacity",e.fillOpacity||1)("stroke-opacity",e.strokeOpacity||1)}}function Wg(r,t){if(r&1){let e=y();o(0,"div",32),u("click",function(i){m(e);let s=g(2).$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))})("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.onTextTouchStart(i,s))})("touchend",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.onTextTouchEnd(i,s))})("touchmove",function(i){m(e);let s=g(5);return f(s.onTextTouchMove(i))}),c(1),a()}if(r&2){let e=g(2).$implicit;q("font-size",e.fontSize||16,"px")("font-family",e.fontFamily||"Arial")("font-weight",e.fontWeight||"normal")("font-style",e.fontStyle||"normal")("color",e.color||"#000"),l(),S(" ",e.text," ")}}function Kg(r,t){if(r&1){let e=y();o(0,"div",33),u("click",function(i){m(e);let s=g(2).$implicit,d=g(3);return i.stopPropagation(),f(d.openMobileTextEdit(s))})("touchstart",function(i){return m(e),f(i.stopPropagation())}),ve(),o(1,"svg",34),h(2,"path",35)(3,"path",36),a()(),Vt(),o(4,"div",37),u("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startTextResize(i,s,"left"))})("mousedown",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startTextResize(i,s,"left"))}),a(),o(5,"div",38),u("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startTextResize(i,s,"right"))})("mousedown",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startTextResize(i,s,"right"))}),a()}}function Gg(r,t){if(r&1){let e=y();o(0,"img",39),u("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startElementDrag(i,s))})("click",function(i){m(e);let s=g(2).$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))}),a()}if(r&2){let e=g(2).$implicit;q("width",e.width,"px")("height",e.height,"px"),p("src",e.src,ce)}}function Yg(r,t){if(r&1){let e=y();o(0,"div",40),u("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startElementDrag(i,s))})("click",function(i){m(e);let s=g(2).$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))}),a()}if(r&2){let e=g(2).$implicit;q("width",e.width,"px")("height",e.height,"px")("background-color",e.fillColor)("border",e.strokeWidth+"px solid "+e.strokeColor)("border-radius",e.shapeType==="circle"?"50%":"0"),k("shape-circle",e.shapeType==="circle")("shape-rectangle",e.shapeType==="rectangle")("shape-line",e.shapeType==="line")}}function qg(r,t){if(r&1){let e=y();o(0,"div",41),u("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startElementDrag(i,s))})("click",function(i){m(e);let s=g(2).$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))}),o(1,"div",42)(2,"span"),c(3,"\u2714"),a()(),o(4,"div",43),c(5),a()()}if(r&2){let e=g(2).$implicit;l(),q("width",(e.properties==null?null:e.properties.boxSize)||18,"px")("height",(e.properties==null?null:e.properties.boxSize)||18,"px"),k("checked",e.properties==null?null:e.properties.checked),l(4),S(" ",(e.properties==null?null:e.properties.label)||"\uCCB4\uD06C\uBC15\uC2A4"," ")}}function Xg(r,t){r&1&&h(0,"div",48)}function Jg(r,t){if(r&1){let e=y();o(0,"div",44),u("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startElementDrag(i,s))})("click",function(i){m(e);let s=g(2).$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))}),o(1,"div",45),b(2,Xg,1,0,"div",46),a(),o(3,"div",47),c(4),a()()}if(r&2){let e=g(2).$implicit;l(),q("width",(e.properties==null?null:e.properties.circleSize)||18,"px")("height",(e.properties==null?null:e.properties.circleSize)||18,"px"),k("selected",e.properties==null?null:e.properties.selected),l(),p("ngIf",e.properties==null?null:e.properties.selected),l(2),S(" ",(e.properties==null?null:e.properties.label)||"\uB77C\uB514\uC624 \uC635\uC158"," ")}}function Zg(r,t){if(r&1){let e=y();o(0,"div",49),u("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startElementDrag(i,s))})("click",function(i){m(e);let s=g(2).$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))}),o(1,"label",50),c(2),a(),o(3,"div",51)(4,"span",52),c(5),a(),o(6,"span",53),c(7,"v"),a()()()}if(r&2){let e=g(2).$implicit;l(2),x((e.properties==null?null:e.properties.label)||"\uB4DC\uB86D\uB2E4\uC6B4"),l(3),x((e.properties==null?null:e.properties.selectedOption)||(e.properties==null||e.properties.options==null?null:e.properties.options[0])||"\uC635\uC158 \uC120\uD0DD")}}function Qg(r,t){if(r&1){let e=y();o(0,"div",54),u("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startElementDrag(i,s))})("click",function(i){m(e);let s=g(2).$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))}),o(1,"label",55),c(2),a(),o(3,"div",56)(4,"span",57),c(5),a()(),o(6,"div",58),c(7),a()()}if(r&2){let e=g(2).$implicit;l(2),x((e.properties==null?null:e.properties.label)||"\uB0A0\uC9DC \uD544\uB4DC"),l(3),x((e.properties==null?null:e.properties.defaultValue)||(e.properties==null?null:e.properties.placeholder)||"YYYY-MM-DD"),l(2),S("\uD615\uC2DD: ",(e.properties==null?null:e.properties.dateFormat)||"YYYY-MM-DD")}}function eu(r,t){if(r&1){let e=y();o(0,"img",59),u("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startElementDrag(i,s))})("click",function(i){m(e);let s=g(2).$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))}),a()}if(r&2){let e=g(2).$implicit;q("width",e.width,"px")("height",e.height,"px"),p("src",e.src,ce)}}function tu(r,t){if(r&1){let e=y();o(0,"div",60),L(1,"sanitizeHtml"),u("touchstart",function(i){m(e);let s=g(2).$implicit,d=g(3);return f(d.startElementDrag(i,s))})("click",function(i){m(e);let s=g(2).$implicit,d=g(3);return i.stopPropagation(),f(d.onElementClick(s))}),a()}if(r&2){let e=g(2).$implicit;q("width",e.width,"px")("height",e.height,"px"),p("innerHTML",J(1,5,e.svgContent),eo)}}function nu(r,t){if(r&1){let e=y();o(0,"div",22),u("click",function(){m(e);let i=g().$implicit,s=g(3);return f(s.onElementClick(i))})("touchstart",function(i){m(e);let s=g().$implicit,d=g(3);return f(d.startElementDrag(i,s))}),we(1,Wg,2,11,"div",23),we(2,Kg,6,0),we(3,Gg,1,5,"img",24),we(4,Yg,1,16,"div",25),we(5,qg,6,7,"div",26),we(6,Jg,5,8,"div",27),we(7,Zg,8,2,"div",28),we(8,Qg,8,3,"div",29),we(9,eu,1,5,"img",30),we(10,tu,2,7,"div",31),a()}if(r&2){let e=g().$implicit,n=g(3);q("left",e.x,"px")("top",e.y,"px")("width",e.width,"px")("height",e.height,"px"),k("selected",(n.selectedElement==null?null:n.selectedElement.id)===e.id),p("ngClass","element-"+e.type),l(),Se(e.type==="text"?1:-1),l(),Se(e.type==="text"&&(n.selectedElement==null?null:n.selectedElement.id)===e.id?2:-1),l(),Se(e.type==="image"?3:-1),l(),Se(e.type==="shape"?4:-1),l(),Se(e.type==="form-checkbox"?5:-1),l(),Se(e.type==="form-radio"?6:-1),l(),Se(e.type==="form-dropdown"?7:-1),l(),Se(e.type==="form-date"?8:-1),l(),Se(e.type==="signature"?9:-1),l(),Se(e.type==="svg"?10:-1)}}function iu(r,t){if(r&1&&(we(0,$g,3,19,"div",14),we(1,Hg,3,19,"div",15),we(2,nu,11,21,"div",16)),r&2){let e=t.$implicit;Se(e.type==="watermark"?0:-1),l(),Se(e.type==="vector-path"?1:-1),l(),Se(e.type!=="watermark"&&e.type!=="vector-path"?2:-1)}}function ou(r,t){if(r&1&&(o(0,"div",12)(1,"div",13),ro(2,iu,3,3,null,null,jg),a()()),r&2){let e=g(2);Be("data-page-number",e.currentPage),l(),q("width",e.currentPageData.width,"px")("height",e.currentPageData.height,"px")("transform","scale("+e.zoomLevel/100+")")("transform-origin","center top"),l(),ao(e.currentPageData.elements)}}function ru(r,t){if(r&1){let e=y();o(0,"div",3)(1,"div",11),u("touchstart",function(i){m(e);let s=g();return f(s.onCanvasContainerTouchStart(i))}),we(2,ou,4,9,"div",12),a()()}if(r&2){let e=g();l(),k("pan-mode",e.isPanMode)("panning",e.isPanning),l(),Se(e.currentPageData?2:-1)}}function au(r,t){r&1&&(o(0,"div",4)(1,"div",61),c(2,"\u{1F4C4}"),a(),o(3,"h3"),c(4,"\uBB38\uC11C\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4"),a(),o(5,"p"),c(6,"\uBB38\uC11C \uB370\uC774\uD130\uB97C \uC81C\uACF5\uD558\uAC70\uB098 \uC0C8 \uBB38\uC11C\uB97C \uC0DD\uC131\uD558\uC138\uC694."),a()())}var en=class r{constructor(t){this.cdr=t}config={mode:"create",showToolbar:!0,allowExport:!0};documentData;pdfPages=[];zoomLevel=100;isPanMode=!1;currentPage=1;documentCreated=new W;exportPdf=new W;close=new W;pdfPagesChange=new W;currentPageChange=new W;elementSelected=new W;elementUpdated=new W;textEditModalStateChange=new W;selectedElement=null;editingElement=null;totalPages=0;isCreating=!1;creationProgress=0;creationStep="";isDraggingElement=!1;isResizingElement=!1;currentDragElement=null;resizeDirection="";dragStartPosition={x:0,y:0};elementStartPosition={x:0,y:0,width:0,height:0};showMobileTextEditModal=!1;mobileTextEditData=null;longPressTimer=null;longPressStartPos={x:0,y:0};isLongPressing=!1;isPanning=!1;panStartPos={x:0,y:0};scrollStartPos={x:0,y:0};canvasContainerElement=null;ngOnInit(){this.pdfPages.length>0?(this.totalPages=this.pdfPages.length,this.currentPage=1,this.adjustPagesToDeviceWidth()):this.config.mode==="create"&&this.documentData?this.createDocument():this.totalPages=0,this.setupGlobalEventListeners(),setTimeout(()=>{this.canvasContainerElement=document.querySelector(".canvas-container")},100)}ngOnChanges(t){t.pdfPages&&this.pdfPages.length>0&&(this.totalPages=this.pdfPages.length,this.currentPage>this.totalPages&&(this.currentPage=1),this.adjustPagesToDeviceWidth(),this.cdr.detectChanges())}ngDoCheck(){this.cdr.markForCheck()}ngOnDestroy(){this.longPressTimer&&clearTimeout(this.longPressTimer),this.removeGlobalEventListeners()}setupGlobalEventListeners(){document.addEventListener("touchmove",this.handleTouchMove),document.addEventListener("touchend",this.handleTouchEnd)}removeGlobalEventListeners(){document.removeEventListener("touchmove",this.handleTouchMove),document.removeEventListener("touchend",this.handleTouchEnd)}handleTouchMove=t=>{if(this.isResizingElement&&this.currentDragElement){t.preventDefault();let e=t.touches[0];this.updateTextResize(e.clientX)}else if(this.isPanning&&this.isPanMode){t.preventDefault();let e=t.touches[0];this.updatePanPosition(e.clientX,e.clientY)}else if(this.isDraggingElement&&this.currentDragElement){let e=t.touches[0];this.updateElementPosition(e.clientX,e.clientY)}};handleTouchEnd=t=>{this.isResizingElement?this.stopTextResize():this.isPanning?this.stopPan():this.isDraggingElement&&this.stopElementDrag()};get currentPageData(){return this.pdfPages[this.currentPage-1]}createDocument(){}adjustPagesToDeviceWidth(){let n=window.innerWidth-32;this.pdfPages.forEach((i,s)=>{let d=i.width||595,_=i.height||842,v=n/d,w=n,M=_*v;i.width=w,i.height=M,i.elements.forEach(O=>{O.x=O.x*v,O.y=O.y*v,O.width=O.width*v,O.height=O.height*v,O.type==="text"&&O.fontSize&&(O.fontSize=O.fontSize*v)})}),this.cdr.detectChanges()}onTextTouchStart(t,e){let n=t.touches[0];this.longPressStartPos={x:n.clientX,y:n.clientY},this.isLongPressing=!1,this.longPressTimer=setTimeout(()=>{this.isLongPressing=!0,this.openMobileTextEdit(e)},500)}onTextTouchMove(t){if(this.longPressTimer){let e=t.touches[0],n=Math.abs(e.clientX-this.longPressStartPos.x),i=Math.abs(e.clientY-this.longPressStartPos.y);(n>10||i>10)&&(clearTimeout(this.longPressTimer),this.longPressTimer=null)}}onTextTouchEnd(t,e){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null),this.isLongPressing||this.onElementClick(e),this.isLongPressing=!1}onElementClick(t){this.selectedElement=t,this.elementSelected.emit(t),this.cdr.detectChanges()}openMobileTextEdit(t){t.type==="text"&&(this.mobileTextEditData={textId:t.id,content:t.text||"",pageNumber:this.currentPage,x:t.x,y:t.y,fontSize:t.fontSize||16,fontFamily:t.fontFamily||"Arial",color:t.color||"#000000"},this.showMobileTextEditModal=!0,this.textEditModalStateChange.emit(!0),this.cdr.detectChanges())}onMobileTextSave(t){let e=this.pdfPages[this.currentPage-1];if(!e){console.error("\u274C \uD604\uC7AC \uD398\uC774\uC9C0\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=e.elements.find(s=>s.id===t.textId);if(!n){console.error("\u274C \uD14D\uC2A4\uD2B8 \uC694\uC18C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}n.text=t.content||"",n.fontSize=t.fontSize,n.fontFamily=t.fontFamily,n.color=t.color;let i=this.calculateTextWidth(t.content||"",t.fontSize,t.fontFamily,n.fontWeight||"normal");n.width=i,this.showMobileTextEditModal=!1,this.textEditModalStateChange.emit(!1),this.mobileTextEditData=null,this.pdfPagesChange.emit(this.pdfPages),this.elementUpdated.emit(n),this.cdr.detectChanges()}onMobileTextCancel(){this.showMobileTextEditModal=!1,this.textEditModalStateChange.emit(!1),this.mobileTextEditData=null,this.cdr.detectChanges()}onMobileTextDelete(t){let e=this.pdfPages[this.currentPage-1];if(!e)return;let n=e.elements.findIndex(i=>i.id===t);n!==-1&&(e.elements.splice(n,1),this.showMobileTextEditModal=!1,this.mobileTextEditData=null,this.pdfPagesChange.emit(this.pdfPages),this.cdr.detectChanges())}calculateTextWidth(t,e,n,i="normal"){let d=document.createElement("canvas").getContext("2d");if(!d)return t.length*e*.8;d.font=`${i} ${e}px ${n}`;let _=d.measureText(t);return Math.ceil(_.width)+60}startTextResize(t,e,n){t.stopPropagation(),t.preventDefault();let i="touches"in t?t.touches[0].clientX:t.clientX;this.isResizingElement=!0,this.currentDragElement=e,this.resizeDirection=n,this.dragStartPosition.x=i,this.elementStartPosition.width=e.width,this.elementStartPosition.x=e.x}updateTextResize(t){if(!this.currentDragElement)return;let e=t-this.dragStartPosition.x,n=this.zoomLevel/100,i=e/n;if(this.resizeDirection==="right"){let s=Math.max(50,this.elementStartPosition.width+i);this.currentDragElement.width=s}else if(this.resizeDirection==="left"){let s=Math.max(50,this.elementStartPosition.width-i),d=this.elementStartPosition.width-s;this.currentDragElement.width=s,this.currentDragElement.x=this.elementStartPosition.x+d}this.cdr.detectChanges()}stopTextResize(){this.currentDragElement&&(this.pdfPagesChange.emit(this.pdfPages),this.elementUpdated.emit(this.currentDragElement)),this.isResizingElement=!1,this.resizeDirection="",this.currentDragElement=null,this.cdr.detectChanges()}startElementDrag(t,e){if(this.isPanMode||!["text","vector-path","image","shape","signature"].includes(e.type))return;t.stopPropagation();let i="touches"in t?t.touches[0].clientX:t.clientX,s="touches"in t?t.touches[0].clientY:t.clientY;this.isDraggingElement=!0,this.currentDragElement=e,this.dragStartPosition={x:i,y:s},this.elementStartPosition={x:e.x,y:e.y,width:e.width,height:e.height}}onCanvasContainerTouchStart(t){if(!this.isPanMode||!this.canvasContainerElement)return;let e=t.touches[0];this.isPanning=!0,this.panStartPos={x:e.clientX,y:e.clientY},this.scrollStartPos={x:this.canvasContainerElement.scrollLeft,y:this.canvasContainerElement.scrollTop}}updatePanPosition(t,e){if(!this.canvasContainerElement)return;let n=this.panStartPos.x-t,i=this.panStartPos.y-e;this.canvasContainerElement.scrollLeft=this.scrollStartPos.x+n,this.canvasContainerElement.scrollTop=this.scrollStartPos.y+i}stopPan(){this.isPanning=!1}updateElementPosition(t,e){if(!this.currentDragElement)return;let n=t-this.dragStartPosition.x,i=e-this.dragStartPosition.y;this.currentDragElement.x=this.elementStartPosition.x+n,this.currentDragElement.y=this.elementStartPosition.y+i,this.cdr.detectChanges()}stopElementDrag(){this.currentDragElement&&(this.pdfPagesChange.emit(this.pdfPages),this.elementUpdated.emit(this.currentDragElement)),this.isDraggingElement=!1,this.currentDragElement=null,this.cdr.detectChanges()}previousPage(){this.currentPage>1&&(this.currentPage--,this.cdr.detectChanges())}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.cdr.detectChanges())}goToPage(t){t>=1&&t<=this.totalPages&&(this.currentPageChange.emit(t),this.cdr.detectChanges())}static \u0275fac=function(e){return new(e||r)(V(fe))};static \u0275cmp=F({type:r,selectors:[["shared-pdf-editor-mobile"]],inputs:{config:"config",documentData:"documentData",pdfPages:"pdfPages",zoomLevel:"zoomLevel",isPanMode:"isPanMode",currentPage:"currentPage"},outputs:{documentCreated:"documentCreated",exportPdf:"exportPdf",close:"close",pdfPagesChange:"pdfPagesChange",currentPageChange:"currentPageChange",elementSelected:"elementSelected",elementUpdated:"elementUpdated",textEditModalStateChange:"textEditModalStateChange"},features:[Je],decls:5,vars:5,consts:[[1,"pdf-editor-mobile-container"],[3,"save","cancel","isVisible","textData"],[1,"creation-progress"],[1,"editor-content"],[1,"empty-state"],[1,"progress-content"],[1,"spinner"],[1,"progress-info"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"canvas-container",3,"touchstart"],[1,"page-wrapper"],[1,"page-canvas"],["title","\uC6CC\uD130\uB9C8\uD06C",1,"watermark-element",3,"selected","left","top","width","height","transform","opacity"],["title","\uBCA1\uD130 \uADF8\uB798\uD53D",1,"vector-path-element",3,"selected","left","top","width","height"],[1,"pdf-element",3,"ngClass","selected","left","top","width","height"],["title","\uC6CC\uD130\uB9C8\uD06C",1,"watermark-element",3,"touchstart","click"],[2,"width","100%","height","100%","display","flex","align-items","center","justify-content","center","font-weight","bold","white-space","nowrap","pointer-events","none"],["title","\uBCA1\uD130 \uADF8\uB798\uD53D",1,"vector-path-element",3,"touchstart","click"],["preserveAspectRatio","xMidYMid meet",2,"overflow","visible","display","block"],["stroke-linecap","round","stroke-linejoin","round","vector-effect","non-scaling-stroke"],[1,"pdf-element",3,"click","touchstart","ngClass"],[1,"text-element",3,"font-size","font-family","font-weight","font-style","color"],[1,"image-element",3,"src","width","height"],[1,"shape-element",3,"shape-circle","shape-rectangle","shape-line","width","height","backgroundColor","border","borderRadius"],[1,"form-checkbox-element"],[1,"form-radio-element"],[1,"form-dropdown-element"],[1,"form-date-element"],[1,"signature-element",3,"src","width","height"],[1,"svg-element",3,"width","height","innerHTML"],[1,"text-element",3,"click","touchstart","touchend","touchmove"],[1,"edit-icon-button",3,"click","touchstart"],["width","18","height","18","viewBox","0 0 24 24","fill","none"],["d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"resize-handle","resize-handle-left",3,"touchstart","mousedown"],[1,"resize-handle","resize-handle-right",3,"touchstart","mousedown"],[1,"image-element",3,"touchstart","click","src"],[1,"shape-element",3,"touchstart","click"],[1,"form-checkbox-element",3,"touchstart","click"],[1,"checkbox-box"],[1,"checkbox-label"],[1,"form-radio-element",3,"touchstart","click"],[1,"radio-circle"],["class","radio-dot",4,"ngIf"],[1,"radio-label"],[1,"radio-dot"],[1,"form-dropdown-element",3,"touchstart","click"],[1,"dropdown-label"],[1,"dropdown-field"],[1,"dropdown-value"],[1,"dropdown-icon"],[1,"form-date-element",3,"touchstart","click"],[1,"date-label"],[1,"date-field"],[1,"date-placeholder"],[1,"date-format"],[1,"signature-element",3,"touchstart","click","src"],[1,"svg-element",3,"touchstart","click","innerHTML"],[1,"empty-icon"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"app-mobile-text-edit-modal",1),u("save",function(s){return n.onMobileTextSave(s)})("cancel",function(){return n.onMobileTextCancel()}),a(),we(2,Ug,10,4,"div",2),we(3,ru,3,5,"div",3),we(4,au,7,0,"div",4),a()),e&2&&(l(),p("isVisible",n.showMobileTextEditModal)("textData",n.mobileTextEditData),l(),Se(n.isCreating?2:-1),l(),Se(!n.isCreating&&n.totalPages>0?3:-1),l(),Se(!n.isCreating&&n.totalPages===0?4:-1))},dependencies:[_e,Ze,B,ui,$o],styles:[".pdf-editor-mobile-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;background:#f5f5f5;position:relative;overflow:hidden;touch-action:none}.creation-progress[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:#fffffffa;display:flex;align-items:center;justify-content:center;z-index:1000}.creation-progress[_ngcontent-%COMP%]   .progress-content[_ngcontent-%COMP%]{text-align:center;padding:20px}.creation-progress[_ngcontent-%COMP%]   .progress-content[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:60px;height:60px;border:4px solid #e0e0e0;border-top-color:#2196f3;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}.creation-progress[_ngcontent-%COMP%]   .progress-content[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;color:#333;margin-bottom:12px}.creation-progress[_ngcontent-%COMP%]   .progress-content[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:240px;height:8px;background:#e0e0e0;border-radius:4px;overflow:hidden;margin:0 auto 10px}.creation-progress[_ngcontent-%COMP%]   .progress-content[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#2196f3,#1976d2);transition:width .3s ease}.creation-progress[_ngcontent-%COMP%]   .progress-content[_ngcontent-%COMP%]   .progress-info[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{font-size:14px;color:#666}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.editor-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}.canvas-container[_ngcontent-%COMP%]{flex:1;overflow:auto;-webkit-overflow-scrolling:touch;padding:16px;display:flex;justify-content:center;align-items:center}.canvas-container.pan-mode[_ngcontent-%COMP%]{cursor:grab}.canvas-container.pan-mode.panning[_ngcontent-%COMP%]{cursor:grabbing}.canvas-container.pan-mode[_ngcontent-%COMP%]   .pdf-element[_ngcontent-%COMP%], .canvas-container.pan-mode[_ngcontent-%COMP%]   .vector-path-element[_ngcontent-%COMP%], .canvas-container.pan-mode[_ngcontent-%COMP%]   .watermark-element[_ngcontent-%COMP%]{pointer-events:none}.canvas-container[_ngcontent-%COMP%]   .page-wrapper[_ngcontent-%COMP%]{position:relative}.canvas-container[_ngcontent-%COMP%]   .page-canvas[_ngcontent-%COMP%]{background:#fff;box-shadow:0 2px 8px #00000026;position:relative;margin:0 auto;border-radius:4px;transition:transform .2s ease;user-select:none;-webkit-user-select:none}.pdf-element[_ngcontent-%COMP%]{position:absolute;cursor:pointer;border:2px solid transparent;transition:border-color .2s;touch-action:none}.pdf-element.selected[_ngcontent-%COMP%]{border-color:#2196f3;z-index:10}.pdf-element[_ngcontent-%COMP%]   .resize-handles[_ngcontent-%COMP%]{display:none}.text-element[_ngcontent-%COMP%]{width:100%;height:100%;white-space:pre-wrap;word-wrap:break-word;pointer-events:none;padding:.1em .1em .5em;line-height:1.7}.pdf-element.element-text[_ngcontent-%COMP%]:active   .text-element[_ngcontent-%COMP%]{background:#2196f30d}.edit-icon-button[_ngcontent-%COMP%]{position:absolute;top:-32px;left:50%;transform:translate(-50%);width:32px;height:32px;border-radius:50%;background:#2196f3;border:2px solid white;box-shadow:0 2px 6px #00000040;cursor:pointer;z-index:11;pointer-events:auto;display:flex;align-items:center;justify-content:center;opacity:.95;transition:all .2s}.edit-icon-button[_ngcontent-%COMP%]:active{opacity:1;transform:translate(-50%) scale(1.15);box-shadow:0 3px 8px #00000059}.edit-icon-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px}.resize-handle[_ngcontent-%COMP%]{position:absolute;top:50%;transform:translateY(-50%);width:24px;height:24px;border-radius:50%;background:#2196f3;border:2px solid white;box-shadow:0 2px 4px #0003;cursor:ew-resize;z-index:10;pointer-events:auto;opacity:.9;transition:all .2s}.resize-handle[_ngcontent-%COMP%]:active{opacity:1;transform:translateY(-50%) scale(1.2);box-shadow:0 3px 6px #0000004d}.resize-handle.resize-handle-left[_ngcontent-%COMP%]{left:-12px}.resize-handle.resize-handle-right[_ngcontent-%COMP%]{right:-12px}.image-element[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain;pointer-events:none}.shape-element[_ngcontent-%COMP%]{pointer-events:none}.shape-element.shape-circle[_ngcontent-%COMP%]{border-radius:50%}.shape-element.shape-line[_ngcontent-%COMP%]{height:2px!important}.form-checkbox-element[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;width:100%;height:100%;font-family:Noto Sans KR,Arial,sans-serif;font-size:14px;color:#1f2937;pointer-events:none}.form-checkbox-element[_ngcontent-%COMP%]   .checkbox-box[_ngcontent-%COMP%]{border:2px solid #4b5563;border-radius:4px;display:flex;align-items:center;justify-content:center;color:#2563eb;background:#fff;transition:all .15s ease;min-width:18px;min-height:18px;pointer-events:none}.form-checkbox-element[_ngcontent-%COMP%]   .checkbox-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;line-height:1}.form-checkbox-element[_ngcontent-%COMP%]   .checkbox-box.checked[_ngcontent-%COMP%]{background:#2563eb;border-color:#2563eb;color:#fff;box-shadow:0 2px 6px #2563eb59}.form-checkbox-element[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]{flex:1;line-height:1.3;pointer-events:none}.form-radio-element[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;width:100%;height:100%;font-family:Noto Sans KR,Arial,sans-serif;font-size:14px;color:#1f2937;pointer-events:none}.form-radio-element[_ngcontent-%COMP%]   .radio-circle[_ngcontent-%COMP%]{border:2px solid #4b5563;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#fff;transition:all .15s ease;min-width:18px;min-height:18px}.form-radio-element[_ngcontent-%COMP%]   .radio-circle.selected[_ngcontent-%COMP%]{border-color:#2563eb;box-shadow:0 2px 6px #2563eb59}.form-radio-element[_ngcontent-%COMP%]   .radio-circle[_ngcontent-%COMP%]   .radio-dot[_ngcontent-%COMP%]{width:60%;height:60%;border-radius:50%;background:#2563eb}.form-radio-element[_ngcontent-%COMP%]   .radio-label[_ngcontent-%COMP%]{flex:1;line-height:1.3;pointer-events:none}.form-dropdown-element[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;width:100%;height:100%;font-family:Noto Sans KR,Arial,sans-serif;color:#1f2937;pointer-events:none}.form-dropdown-element[_ngcontent-%COMP%]   .dropdown-label[_ngcontent-%COMP%]{font-size:13px;color:#4b5563}.form-dropdown-element[_ngcontent-%COMP%]   .dropdown-field[_ngcontent-%COMP%]{flex:1;border:1.5px solid #d1d5db;border-radius:8px;padding:8px 12px;display:flex;align-items:center;justify-content:space-between;background:#fff}.form-dropdown-element[_ngcontent-%COMP%]   .dropdown-value[_ngcontent-%COMP%]{font-size:14px;color:#111827}.form-dropdown-element[_ngcontent-%COMP%]   .dropdown-icon[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.form-date-element[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;width:100%;height:100%;font-family:Noto Sans KR,Arial,sans-serif;color:#1f2937;pointer-events:none}.form-date-element[_ngcontent-%COMP%]   .date-label[_ngcontent-%COMP%]{font-size:13px;color:#4b5563}.form-date-element[_ngcontent-%COMP%]   .date-field[_ngcontent-%COMP%]{flex:1;border:1.5px solid #d1d5db;border-radius:8px;padding:8px 12px;display:flex;align-items:center;justify-content:space-between;background:#fff}.form-date-element[_ngcontent-%COMP%]   .date-placeholder[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.form-date-element[_ngcontent-%COMP%]   .date-format[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af}.signature-element[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:contain;pointer-events:none}.svg-element[_ngcontent-%COMP%]{width:100%;height:100%;pointer-events:none}.svg-element[_ngcontent-%COMP%]     svg{width:100%;height:100%}.watermark-element[_ngcontent-%COMP%]{position:absolute;pointer-events:auto;border:2px solid transparent;transition:border-color .2s}.watermark-element.selected[_ngcontent-%COMP%]{border-color:#2196f3}.vector-path-element[_ngcontent-%COMP%]{position:absolute;pointer-events:auto;border:2px solid transparent;transition:border-color .2s}.vector-path-element.selected[_ngcontent-%COMP%]{border-color:#2196f3}.empty-state[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:16px;opacity:.5}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;color:#333;margin-bottom:8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#666;max-width:300px}@media (max-width: 480px){.canvas-container[_ngcontent-%COMP%]{padding:8px}.mobile-page-nav[_ngcontent-%COMP%]{padding:8px;gap:12px}.mobile-page-nav[_ngcontent-%COMP%]   .nav-btn[_ngcontent-%COMP%]{min-width:40px;min-height:40px;font-size:16px}.mobile-page-nav[_ngcontent-%COMP%]   .page-info[_ngcontent-%COMP%]{font-size:14px;min-width:70px}}@media (orientation: landscape){.canvas-container[_ngcontent-%COMP%]   .page-canvas[_ngcontent-%COMP%]{max-width:90%;max-height:90%}}"],changeDetection:0})};function lu(r,t){if(r&1){let e=y();o(0,"div",18)(1,"button",19),u("click",function(){m(e);let i=g();return f(i.onZoomIn())}),h(2,"img",20),a(),o(3,"button",21),u("click",function(){m(e);let i=g();return f(i.onZoomOut())}),h(4,"img",22),a(),o(5,"button",23),u("click",function(){m(e);let i=g();return f(i.togglePanMode())}),h(6,"img",24),a(),o(7,"div",25),c(8),a()()}if(r&2){let e=g();l(5),k("active",e.isPanMode),l(3),S("",e.zoomLevel,"%")}}function cu(r,t){if(r&1){let e=y();o(0,"shared-pdf-thumbnail-strip",26),u("pageSelected",function(i){m(e);let s=g();return f(s.onThumbnailPageSelected(i))}),a()}if(r&2){let e=g();p("pdfSrc",e.pdfSrc)("totalPages",e.totalPages)("currentPage",e.currentPage)("visible",e.showThumbnails)}}function du(r,t){if(r&1){let e=y();o(0,"app-text-editor-modal",27),u("save",function(i){m(e);let s=g();return f(s.onTextEditorSave(i))})("cancel",function(){m(e);let i=g();return f(i.onTextEditorCancel())}),a()}if(r&2){let e=g();p("data",e.textEditorData)("pageWidth",595)("pageHeight",842)}}function pu(r,t){if(r&1){let e=y();o(0,"app-shared-shape-selection-modal",28),u("shapeSelected",function(i){m(e);let s=g();return f(s.onShapeSelect(i))})("cancel",function(){m(e);let i=g();return f(i.onCancelShapeModal())}),a()}}function gu(r,t){if(r&1){let e=y();o(0,"app-shared-signature-pad-modal",29),u("signatureCreated",function(i){m(e);let s=g();return f(s.onSignatureCreated(i))})("cancel",function(){m(e);let i=g();return f(i.onCancelSignatureModal())}),a()}}function uu(r,t){if(r&1){let e=y();o(0,"app-vector-path-drawer",30),u("pathsChanged",function(i){m(e);let s=g();return f(s.onVectorPathsChanged(i))})("close",function(){m(e);let i=g();return f(i.onCancelVectorPathDrawer())}),a()}r&2&&p("width",595)("height",842)}var mi=class r{constructor(t,e,n){this.router=t;this.route=e;this.dialog=n}pdfPages=[];fileName="";pdfSrc=null;pdfBlob=null;currentActiveTab="editor";currentPage=1;totalPages=0;selectedElement=null;zoomLevel=100;isTextEditModalOpen=!1;isPanMode=!1;isPanning=!1;panStartPos={x:0,y:0};scrollStartPos={x:0,y:0};showThumbnails=!0;showTextEditorModal=!1;showShapeModal=!1;showSignaturePadModal=!1;showVectorPathDrawer=!1;textEditorData={text:"\uC0C8 \uD14D\uC2A4\uD2B8",fontSize:16,fontFamily:"Noto Sans KR",color:"#000000",x:100,y:100,width:200,height:30};pdfAnalysisData=null;vectorData=null;imageData=null;toolsPanel;snackbar=P(G);documentService=P(Dt);editorStateService=P(It);pdfElementManager=P(Io);imageUploadService=P(To);shapeCreatorService=P(Ao);signatureService=P(Fo);vectorPathService=P(zo);cdr=P(fe);ngOnInit(){let t=this.editorStateService.getEditingDocument();t?this.loadStateFromService(t):(this.snackbar.showWarning("\uD3B8\uC9D1\uD560 \uBB38\uC11C\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),this.goBackToViewer())}loadStateFromService(t){this.pdfPages=t.pdfPages,this.fileName=t.fileName,this.pdfSrc=t.pdfSrc,this.pdfBlob=t.pdfBlob,this.currentPage=t.currentPage||1,this.totalPages=t.totalPages,this.pdfAnalysisData=t.pdfAnalysisData,this.vectorData=t.vectorData,this.imageData=t.imageData}toggleToolsPanel(){this.toolsPanel&&this.toolsPanel.toggleSheet()}toggleThumbnails(){this.showThumbnails=!this.showThumbnails}onThumbnailPageSelected(t){this.currentPage=t,this.cdr.detectChanges()}onCurrentPageChange(t){this.currentPage=t,this.cdr.detectChanges()}onElementSelected(t){this.selectedElement=t}onElementUpdated(t){}onTextEditModalStateChange(t){this.isTextEditModalOpen=t}onElementPropertyChange(t){if(!this.selectedElement||this.selectedElement.id!==t.elementId)return;this.applyPropertyChange(this.selectedElement,t.property,t.value);let e=this.pdfPages[this.currentPage-1];if(e){let n=e.elements.findIndex(i=>i.id===t.elementId);n!==-1&&this.applyPropertyChange(e.elements[n],t.property,t.value)}this.snackbar.showSuccess("\uC18D\uC131\uC774 \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}onDeleteElement(){if(!this.selectedElement)return;let t=this.pdfPages[this.currentPage-1];t&&(t.elements=t.elements.filter(e=>e.id!==this.selectedElement.id)),this.selectedElement=null,this.snackbar.showSuccess("\uC694\uC18C\uAC00 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}onDeselectElement(){this.selectedElement=null}onAddText(){this.textEditorData={text:"\uC0C8 \uD14D\uC2A4\uD2B8",fontSize:16,fontFamily:"Noto Sans KR",color:"#000000",x:100,y:100,width:200,height:30},this.showTextEditorModal=!0}onTextEditorSave(t){try{let e=this.pdfElementManager.createTextElement(t),n=this.currentPage-1;n>=0&&n<this.pdfPages.length&&(this.pdfPages=this.pdfElementManager.addElementToPage(this.pdfPages,n,e),this.selectedElement=e,this.snackbar.showSuccess("\uD14D\uC2A4\uD2B8\uAC00 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4."))}catch{this.snackbar.showError("\uD14D\uC2A4\uD2B8 \uCD94\uAC00 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}finally{this.showTextEditorModal=!1}}onTextEditorCancel(){this.showTextEditorModal=!1}onAddImage(){return C(this,null,function*(){try{let t=yield this.imageUploadService.uploadAndCreateImageElement({maxWidth:300,maxHeight:300,centerOnPage:!0,pageWidth:595,pageHeight:842});if(!t)return;let e=this.currentPage-1;e>=0&&e<this.pdfPages.length&&(this.pdfPages=this.pdfElementManager.addElementToPage(this.pdfPages,e,t),this.selectedElement=t,this.snackbar.showSuccess("\uC774\uBBF8\uC9C0\uAC00 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4."))}catch{this.snackbar.showError("\uC774\uBBF8\uC9C0 \uCD94\uAC00 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}onAddShape(){this.showShapeModal=!0}onShapeSelect(t){try{let e=this.shapeCreatorService.createShape(t,{centerOnPage:!0,pageWidth:595,pageHeight:842}),n=this.currentPage-1;if(n>=0&&n<this.pdfPages.length){this.pdfPages=this.pdfElementManager.addElementToPage(this.pdfPages,n,e),this.selectedElement=e;let i=this.shapeCreatorService.getShapeTypeName(t);this.snackbar.showSuccess(`${i}\uC774(\uAC00) \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}}catch{this.snackbar.showError("\uB3C4\uD615 \uCD94\uAC00 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}finally{this.showShapeModal=!1}}onCancelShapeModal(){this.showShapeModal=!1}onAddSignature(){this.showSignaturePadModal=!0}onSignatureCreated(t){try{let e=this.signatureService.createSignatureElement(t,{centerOnPage:!0,pageWidth:595,pageHeight:842}),n=this.currentPage-1;n>=0&&n<this.pdfPages.length&&(this.pdfPages=this.pdfElementManager.addElementToPage(this.pdfPages,n,e),this.selectedElement=e,this.snackbar.showSuccess("\uC11C\uBA85\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4."))}catch{this.snackbar.showError("\uC11C\uBA85 \uCD94\uAC00 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}finally{this.showSignaturePadModal=!1}}onCancelSignatureModal(){this.showSignaturePadModal=!1}onAddVectorPath(){this.showVectorPathDrawer=!0}onAddFormCheckbox(){if(!this.pdfPages||this.pdfPages.length===0){this.snackbar.showWarning("\uBA3C\uC800 \uD3B8\uC9D1\uD560 \uD398\uC774\uC9C0\uB97C \uBD88\uB7EC\uC640 \uC8FC\uC138\uC694.");return}let t=Math.max(0,Math.min(this.currentPage-1,this.pdfPages.length-1)),e=this.pdfPages[t];if(!e){this.snackbar.showWarning("\uD398\uC774\uC9C0\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=160,i=32,s=e.width||595,d=e.height||842,_=Math.max(32,(s-n)/2),v=Math.max(48,d*.3-i/2),M=`\uCCB4\uD06C\uBC15\uC2A4 ${e.elements.filter(E=>E.type==="form-checkbox").length+1}`,O=this.pdfElementManager.createFormCheckboxElement({x:_,y:v,width:n,height:i,size:20,label:M,checked:!1});this.pdfPages=this.pdfElementManager.addElementToPage(this.pdfPages,t,O),this.selectedElement=O,this.snackbar.showSuccess(`${M}\uAC00 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}onAddFormRadio(){if(!this.pdfPages||this.pdfPages.length===0){this.snackbar.showWarning("\uBA3C\uC800 \uD3B8\uC9D1\uD560 \uD398\uC774\uC9C0\uB97C \uBD88\uB7EC\uC640 \uC8FC\uC138\uC694.");return}let t=Math.max(0,Math.min(this.currentPage-1,this.pdfPages.length-1)),e=this.pdfPages[t];if(!e){this.snackbar.showWarning("\uD398\uC774\uC9C0\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=160,i=32,s=e.width||595,d=e.height||842,_=Math.max(32,(s-n)/2),v=Math.max(48,d*.3-i/2),w=e.elements.filter(D=>D.type==="form-radio").length+1,M=`\uB77C\uB514\uC624 \uC635\uC158 ${w}`,O=`radio-group-${t+1}`,E=this.pdfElementManager.createFormRadioElement({x:_,y:v,width:n,height:i,size:18,label:M,value:`option-${w}`,groupName:O,selected:!1});this.pdfPages=this.pdfElementManager.addElementToPage(this.pdfPages,t,E),this.selectedElement=E,this.snackbar.showSuccess(`${M}\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}onAddFormDropdown(){if(!this.pdfPages||this.pdfPages.length===0){this.snackbar.showWarning("\uBA3C\uC800 \uD3B8\uC9D1\uD560 \uD398\uC774\uC9C0\uB97C \uBD88\uB7EC\uC640 \uC8FC\uC138\uC694.");return}let t=Math.max(0,Math.min(this.currentPage-1,this.pdfPages.length-1)),e=this.pdfPages[t];if(!e){this.snackbar.showWarning("\uD398\uC774\uC9C0\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=260,i=44,s=e.width||595,d=e.height||842,_=Math.max(32,(s-n)/2),v=Math.max(56,d*.4-i/2),M=`\uB4DC\uB86D\uB2E4\uC6B4 ${e.elements.filter(E=>E.type==="form-dropdown").length+1}`,O=this.pdfElementManager.createFormDropdownElement({x:_,y:v,width:n,height:i,label:M,options:["\uC635\uC158 1","\uC635\uC158 2","\uC635\uC158 3"],selectedOption:"\uC635\uC158 1"});this.pdfPages=this.pdfElementManager.addElementToPage(this.pdfPages,t,O),this.selectedElement=O,this.snackbar.showSuccess(`${M}\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}onAddFormDateField(){if(!this.pdfPages||this.pdfPages.length===0){this.snackbar.showWarning("\uBA3C\uC800 \uD3B8\uC9D1\uD560 \uD398\uC774\uC9C0\uB97C \uBD88\uB7EC\uC640 \uC8FC\uC138\uC694.");return}let t=Math.max(0,Math.min(this.currentPage-1,this.pdfPages.length-1)),e=this.pdfPages[t];if(!e){this.snackbar.showWarning("\uD398\uC774\uC9C0\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=260,i=56,s=e.width||595,d=e.height||842,_=Math.max(32,(s-n)/2),v=Math.max(64,d*.45-i/2),M=`\uB0A0\uC9DC \uD544\uB4DC ${e.elements.filter(E=>E.type==="form-date").length+1}`,O=this.pdfElementManager.createFormDateElement({x:_,y:v,width:n,height:i,label:M,placeholder:"YYYY-MM-DD",dateFormat:"YYYY-MM-DD",defaultValue:""});this.pdfPages=this.pdfElementManager.addElementToPage(this.pdfPages,t,O),this.selectedElement=O,this.snackbar.showSuccess(`${M}\uC774 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}onVectorPathsChanged(t){!t||t.length===0||(t.forEach((e,n)=>{try{let i=this.vectorPathService.createVectorPathElement({pathData:e.d,strokeColor:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,fillOpacity:e.fillOpacity,strokeOpacity:e.strokeOpacity},{pageWidth:595,pageHeight:842}),s=this.currentPage-1;s>=0&&s<this.pdfPages.length&&(this.pdfPages=this.pdfElementManager.addElementToPage(this.pdfPages,s,i),n===t.length-1&&(this.selectedElement=i))}catch{}}),this.snackbar.showSuccess(`${t.length}\uAC1C\uC758 \uBCA1\uD130 \uD328\uC2A4\uAC00 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`),this.showVectorPathDrawer=!1)}onCancelVectorPathDrawer(){this.showVectorPathDrawer=!1}onAddPage(){let t=this.pdfPages.length+1;this.pdfPages.push({pageNumber:t,elements:[],width:595,height:842}),this.totalPages=this.pdfPages.length,this.snackbar.showSuccess("\uC0C8 \uD398\uC774\uC9C0\uAC00 \uCD94\uAC00\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}onDeletePage(){if(this.pdfPages.length<=1){this.snackbar.showWarning("\uB9C8\uC9C0\uB9C9 \uD398\uC774\uC9C0\uB294 \uC0AD\uC81C\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.pdfPages.splice(this.currentPage-1,1),this.pdfPages.forEach((t,e)=>{t.pageNumber=e+1}),this.totalPages=this.pdfPages.length,this.currentPage>this.totalPages&&(this.currentPage=this.totalPages),this.snackbar.showSuccess("\uD398\uC774\uC9C0\uAC00 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}onRotatePage(){this.snackbar.showInfo("\uD398\uC774\uC9C0 \uD68C\uC804 \uAE30\uB2A5 \uC900\uBE44 \uC911")}onPageSelect(t){let e=parseInt(t.toString(),10);e>=1&&e<=this.totalPages&&(this.currentPage=e)}onZoomIn(){this.zoomLevel=Math.min(this.zoomLevel+25,300)}onZoomOut(){this.zoomLevel=Math.max(this.zoomLevel-25,50)}togglePanMode(){this.isPanMode=!this.isPanMode,this.isPanMode&&this.snackbar.showInfo("\uD398\uC774\uC9C0\uB97C \uB4DC\uB798\uADF8\uD558\uC5EC \uC774\uB3D9\uD558\uC138\uC694")}onAddAnalyze(){this.snackbar.showInfo("\uD3B8\uC9D1\uAE30\uC5D0\uC11C\uB294 PDF \uBD84\uC11D\uC744 \uC0AC\uC6A9\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}onSaveDocument(){return C(this,null,function*(){try{let t=prompt("\uBB38\uC11C \uC81C\uBAA9\uC744 \uC785\uB825\uD558\uC138\uC694:",this.fileName||"\uC0C8\uBB38\uC11C.pdf");if(!t||t.trim()==="")return;this.snackbar.showInfo("\uBB38\uC11C\uB97C \uC800\uC7A5\uD558\uACE0 \uC788\uC2B5\uB2C8\uB2E4..."),yield this.documentService.saveDocumentSimple(t.trim(),this.pdfPages,"editor",this.pdfBlob||void 0,this.pdfSrc||void 0),this.fileName=t.trim()}catch{this.snackbar.showError("\uBB38\uC11C \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}goBackToViewer(){this.editorStateService.clearEditingDocument(),this.pdfSrc&&this.documentService.revokeBlobUrl(this.pdfSrc),this.router.navigate(["/ezm/home"])}ngOnDestroy(){this.pdfSrc&&this.documentService.revokeBlobUrl(this.pdfSrc)}applyPropertyChange(t,e,n){if(!t||!e)return;let i=e.split(".");if(i.length===1){t[i[0]]=n;return}let s=t;for(let d=0;d<i.length-1;d++){let _=i[d];(s[_]===void 0||s[_]===null)&&(s[_]={}),s=s[_]}s[i[i.length-1]]=n}static \u0275fac=function(e){return new(e||r)(V(N),V(et),V(Yt))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-editor"]],viewQuery:function(e,n){if(e&1&&$e(Ge,5),e&2){let i;He(i=We())&&(n.toolsPanel=i.first)}},standalone:!1,decls:19,vars:20,consts:[[1,"mobile-editor-container"],[1,"mobile-header"],[1,"header-back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C\uAC00\uAE30","width","20","height","20",1,"back-icon"],[1,"header-title"],[1,"header-actions"],["aria-label","\uC804\uCCB4 \uD398\uC774\uC9C0 \uBCF4\uAE30",1,"header-action-btn",3,"click"],["src","images/icons/btn-top-view.svg","alt","\uC378\uB124\uC77C","width","24","height","24"],["aria-label","\uB3C4\uAD6C \uBA54\uB274",1,"header-menu-btn",3,"click"],["src","images/icons/btn-top-more.svg","alt","\uB354\uBCF4\uAE30","width","24","height","24"],[3,"pdfPagesChange","elementSelected","elementUpdated","textEditModalStateChange","currentPageChange","pdfPages","pdfPages","currentPage","zoomLevel","isPanMode"],["class","floating-zoom-controls",4,"ngIf"],[3,"addText","addImage","addShape","addSignature","addVectorPath","addFormCheckbox","addFormRadio","addFormDropdown","addFormDateField","analyze","saveDocument","addPage","deletePage","rotatePage","pageSelect","zoomIn","zoomOut","elementPropertyChange","deleteElement","deselectElement","selectedElement","currentPage","totalPages","zoomLevel","pdfPages","isPdfViewer","isTextEditModalOpen","hideElementProperties"],[3,"pdfSrc","totalPages","currentPage","visible","pageSelected",4,"ngIf"],[3,"data","pageWidth","pageHeight","save","cancel",4,"ngIf"],[3,"shapeSelected","cancel",4,"ngIf"],[3,"signatureCreated","cancel",4,"ngIf"],[3,"width","height","pathsChanged","close",4,"ngIf"],[1,"floating-zoom-controls"],["aria-label","\uD655\uB300",1,"zoom-btn","zoom-in-btn",3,"click"],["src","images/icons/btn-search.svg","alt","\uD655\uB300","width","24","height","24"],["aria-label","\uCD95\uC18C",1,"zoom-btn","zoom-out-btn",3,"click"],["src","images/icons/btn-search.svg","alt","\uCD95\uC18C","width","24","height","24"],["aria-label","\uC190 \uB3C4\uAD6C",1,"zoom-btn","hand-tool-btn",3,"click"],["src","images/icons/btn-top-draw.svg","alt","\uC190 \uB3C4\uAD6C","width","24","height","24"],[1,"zoom-level-display"],[3,"pageSelected","pdfSrc","totalPages","currentPage","visible"],[3,"save","cancel","data","pageWidth","pageHeight"],[3,"shapeSelected","cancel"],[3,"signatureCreated","cancel"],[3,"pathsChanged","close","width","height"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"header",1)(2,"button",2),u("click",function(){return n.goBackToViewer()}),h(3,"img",3),a(),o(4,"h1",4),c(5),a(),o(6,"div",5)(7,"button",6),u("click",function(){return n.toggleThumbnails()}),h(8,"img",7),a(),o(9,"button",8),u("click",function(){return n.toggleToolsPanel()}),h(10,"img",9),a()()(),o(11,"shared-pdf-editor-mobile",10),$("pdfPagesChange",function(s){return U(n.pdfPages,s)||(n.pdfPages=s),s}),u("elementSelected",function(s){return n.onElementSelected(s)})("elementUpdated",function(s){return n.onElementUpdated(s)})("textEditModalStateChange",function(s){return n.onTextEditModalStateChange(s)})("currentPageChange",function(s){return n.onCurrentPageChange(s)}),a(),b(12,lu,9,3,"div",11),o(13,"shared-pdf-tools-panel-mobile",12),u("addText",function(){return n.onAddText()})("addImage",function(){return n.onAddImage()})("addShape",function(){return n.onAddShape()})("addSignature",function(){return n.onAddSignature()})("addVectorPath",function(){return n.onAddVectorPath()})("addFormCheckbox",function(){return n.onAddFormCheckbox()})("addFormRadio",function(){return n.onAddFormRadio()})("addFormDropdown",function(){return n.onAddFormDropdown()})("addFormDateField",function(){return n.onAddFormDateField()})("analyze",function(){return n.onAddAnalyze()})("saveDocument",function(){return n.onSaveDocument()})("addPage",function(){return n.onAddPage()})("deletePage",function(){return n.onDeletePage()})("rotatePage",function(){return n.onRotatePage()})("pageSelect",function(s){return n.onPageSelect(s)})("zoomIn",function(){return n.onZoomIn()})("zoomOut",function(){return n.onZoomOut()})("elementPropertyChange",function(s){return n.onElementPropertyChange(s)})("deleteElement",function(){return n.onDeleteElement()})("deselectElement",function(){return n.onDeselectElement()}),a(),b(14,cu,1,4,"shared-pdf-thumbnail-strip",13),a(),b(15,du,1,3,"app-text-editor-modal",14)(16,pu,1,0,"app-shared-shape-selection-modal",15)(17,gu,1,0,"app-shared-signature-pad-modal",16)(18,uu,1,2,"app-vector-path-drawer",17)),e&2&&(l(5),x(n.fileName||"PDF \uD3B8\uC9D1\uAE30"),l(6),p("pdfPages",n.pdfPages),j("pdfPages",n.pdfPages),p("currentPage",n.currentPage)("zoomLevel",n.zoomLevel)("isPanMode",n.isPanMode),l(),p("ngIf",n.pdfPages.length>0),l(),p("selectedElement",n.selectedElement)("currentPage",n.currentPage)("totalPages",n.totalPages)("zoomLevel",n.zoomLevel)("pdfPages",n.pdfPages)("isPdfViewer",!1)("isTextEditModalOpen",n.isTextEditModalOpen)("hideElementProperties",!0),l(),p("ngIf",n.pdfSrc&&n.showThumbnails),l(),p("ngIf",n.showTextEditorModal),l(),p("ngIf",n.showShapeModal),l(),p("ngIf",n.showSignaturePadModal),l(),p("ngIf",n.showVectorPathDrawer))},dependencies:[B,Vn,en,Ge,An,Fn,zn,Rn],styles:[".mobile-editor-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:content-box;overflow:hidden;background-color:#f5f5f5}.mobile-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background-color:#fff;border-bottom:1px solid #e0e0e0;box-shadow:0 2px 4px #0000001a;z-index:10}.header-back-btn[_ngcontent-%COMP%], .header-menu-btn[_ngcontent-%COMP%], .header-action-btn[_ngcontent-%COMP%]{padding:8px;background:none;border:none;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#333}.header-back-btn[_ngcontent-%COMP%]:active, .header-menu-btn[_ngcontent-%COMP%]:active, .header-action-btn[_ngcontent-%COMP%]:active{opacity:.6}.header-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.back-icon[_ngcontent-%COMP%]{display:block}.header-title[_ngcontent-%COMP%]{flex:1;margin:0 16px;font-size:18px;font-weight:600;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center}.floating-zoom-controls[_ngcontent-%COMP%]{position:fixed;right:16px;bottom:calc(60px + var(--android-navigation-bar-height, 0px));display:flex;flex-direction:column;gap:8px;z-index:900}.zoom-btn[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:#fff;border:none;box-shadow:0 2px 8px #00000026;cursor:pointer;display:flex;align-items:center;justify-content:center;color:#333;transition:all .2s ease}.zoom-btn[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0003;transform:scale(1.05)}.zoom-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#f0f0f0}.zoom-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px}.zoom-level-display[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:6px 12px;font-size:12px;font-weight:600;color:#333;text-align:center;box-shadow:0 2px 8px #00000026;min-width:48px}.hand-tool-btn.active[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.hand-tool-btn.active[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#fff}"]})};var fi=class r{indexedDbService=P(ee);snackbar=P(G);router=P(N);openPdf(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t.id);if(!e){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.router.navigate(["/ezm/viewer"],{state:{document:e}})}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}sharePdf(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t.id);if(!e){this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let n=e.pdfBase64||e.originalPdfBase64;if(!n){this.snackbar.showError("\uACF5\uC720\uD560 PDF \uB370\uC774\uD130\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let i=this.ensurePdfExtension(e.fileName||e.title||t.name||"document.pdf");if(this.tryNativeShare(i,n)){this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uACF5\uC720\uD588\uC2B5\uB2C8\uB2E4.");return}if(typeof navigator<"u"&&navigator.share){let s=this.base64ToBlob(n,"application/pdf"),d=[];try{d.push(new File([s],i,{type:"application/pdf"}))}catch{}let _={title:i,text:`${i} \uBB38\uC11C\uB97C \uACF5\uC720\uD569\uB2C8\uB2E4.`};d.length&&(typeof navigator.canShare!="function"||navigator.canShare({files:d}))&&(_.files=d),yield navigator.share(_),this.snackbar.showSuccess("\uBB38\uC11C\uB97C \uACF5\uC720\uD588\uC2B5\uB2C8\uB2E4.");return}this.downloadFile(i,n),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uB2E4\uC6B4\uB85C\uB4DC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch(e){if(e?.name==="AbortError")return;this.snackbar.showError("\uBB38\uC11C \uACF5\uC720\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}duplicatePdf(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t.id);if(!e)return this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),!1;let n=new Date().toISOString(),i=(e.title||e.fileName||t.name||"\uBB38\uC11C").replace(/\.pdf$/i,""),s=Z(K({},e),{id:this.generateDocumentId(),title:`${i} \uC0AC\uBCF8`,fileName:`${i}_\uC0AC\uBCF8.pdf`,createdAt:n,updatedAt:n});return yield this.indexedDbService.saveDocument(s),this.snackbar.showSuccess("\uC0AC\uBCF8\uC774 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),!0}catch{return this.snackbar.showError("\uD30C\uC77C\uC744 \uBCF5\uC81C\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),!1}})}renamePdf(t,e){return C(this,null,function*(){try{let n=yield this.indexedDbService.getDocumentById(t.id);if(!n)return this.snackbar.showError("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),!1;let i=e.replace(/\.pdf$/i,""),s=this.ensurePdfExtension(e);return n.title=i,n.fileName=s,yield this.indexedDbService.updateDocument(n),this.snackbar.showSuccess("\uD30C\uC77C \uC774\uB984\uC774 \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),!0}catch{return this.snackbar.showError("\uC774\uB984\uC744 \uBCC0\uACBD\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),!1}})}deletePdf(t){return C(this,null,function*(){try{return(yield xe(`"${t.name}" \uD30C\uC77C\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?`))?(yield this.indexedDbService.deleteDocument(t.id),this.snackbar.showSuccess("\uD30C\uC77C\uC774 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),!0):!1}catch{return this.snackbar.showError("\uD30C\uC77C \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),!1}})}tryNativeShare(t,e){if(typeof window<"u"&&window.parent!==window)try{return window.parent.postMessage({type:"share",fileName:t,data:e},"*"),!0}catch{}return window.ReactNativeWebView?(window.ReactNativeWebView.postMessage(JSON.stringify({type:"share",fileName:t,data:e})),!0):window.webkit?.messageHandlers?.shareFile?(window.webkit.messageHandlers.shareFile.postMessage({fileName:t,data:e}),!0):window.Android?.shareFile?(window.Android.shareFile(t,e),!0):!1}downloadFile(t,e){let n=this.base64ToBlob(e,"application/pdf"),i=URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)}ensurePdfExtension(t){let e=t.trim();return/\.pdf$/i.test(e)?e:`${e}.pdf`}base64ToBlob(t,e="application/pdf"){let n=t.includes(",")?t.split(",")[1]:t,i=atob(n),s=new Array(i.length);for(let _=0;_<i.length;_++)s[_]=i.charCodeAt(_);let d=new Uint8Array(s);return new Blob([d],{type:e})}generateDocumentId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac,providedIn:"root"})};function mu(r,t){if(r&1){let e=y();re(0),o(1,"div",4)(2,"button",5),u("click",function(){m(e);let i=g(2);return f(i.cancelRename())}),h(3,"img",6),a(),o(4,"h3",7),c(5,"\uC774\uB984 \uBCC0\uACBD"),a()(),o(6,"div",8)(7,"label",9),c(8,"\uC0C8 \uC774\uB984"),a(),o(9,"input",10),$("ngModelChange",function(i){m(e);let s=g(2);return U(s.renameValue,i)||(s.renameValue=i),f(i)}),a(),o(10,"p",11),c(11,".pdf \uD655\uC7A5\uC790\uB294 \uC790\uB3D9\uC73C\uB85C \uCD94\uAC00\uB429\uB2C8\uB2E4."),a(),o(12,"div",12)(13,"button",13),u("click",function(){m(e);let i=g(2);return f(i.cancelRename())}),c(14,"\uCDE8\uC18C"),a(),o(15,"button",14),u("click",function(){m(e);let i=g(2);return f(i.confirmRename())}),c(16,"\uC644\uB8CC"),a()()(),ae()}if(r&2){let e=g(2);l(9),j("ngModel",e.renameValue)}}function fu(r,t){if(r&1){let e=y();re(0),o(1,"div",15)(2,"h3",7),c(3),a()(),o(4,"div",16)(5,"button",17),u("click",function(){m(e);let i=g(2);return f(i.onAction("open"))}),h(6,"img",18),o(7,"span"),c(8,"PDF \uC5F4\uAE30"),a()(),o(9,"button",17),u("click",function(){m(e);let i=g(2);return f(i.onAction("share"))}),h(10,"img",19),o(11,"span"),c(12,"\uACF5\uC720"),a()(),o(13,"button",17),u("click",function(){m(e);let i=g(2);return f(i.onAction("rename"))}),h(14,"img",20),o(15,"span"),c(16,"\uC774\uB984\uBCC0\uACBD"),a()(),o(17,"button",17),u("click",function(){m(e);let i=g(2);return f(i.onAction("duplicate"))}),h(18,"img",21),o(19,"span"),c(20,"\uBCF5\uC81C"),a()(),o(21,"button",22),u("click",function(){m(e);let i=g(2);return f(i.onAction("delete"))}),h(22,"img",23),o(23,"span"),c(24,"\uC0AD\uC81C"),a()()(),ae()}if(r&2){let e=g(2);l(3),x(e.item.name)}}function hu(r,t){if(r&1&&(o(0,"div",2),b(1,mu,17,1,"ng-container",3)(2,fu,25,1,"ng-container",3),a()),r&2){let e=g();l(),p("ngIf",e.isRenameMode),l(),p("ngIf",!e.isRenameMode)}}var hi=class r{item=null;sheetState="collapsed";sheetStateChange=new W;actionComplete=new W;renameRequest=new W;isRenameMode=!1;renameValue="";pdfActions=P(fi);onSheetStateChange(t){this.sheetState=t,this.sheetStateChange.emit(t),t==="collapsed"&&this.closeSheet()}onAction(t){return C(this,null,function*(){if(!this.item)return;if(t==="rename"){this.openRenameMode();return}this.closeSheet();let e=!1;switch(t){case"open":yield this.pdfActions.openPdf(this.item),e=!0;break;case"share":yield this.pdfActions.sharePdf(this.item),e=!0;break;case"duplicate":e=yield this.pdfActions.duplicatePdf(this.item);break;case"delete":e=yield this.pdfActions.deletePdf(this.item);break}e&&this.actionComplete.emit(t)})}openRenameMode(){this.item&&(this.isRenameMode=!0,this.renameValue=this.item.name.replace(/\.pdf$/i,""),this.sheetState="full",this.sheetStateChange.emit("full"))}cancelRename(){this.isRenameMode=!1,this.renameValue="",this.sheetState="full",this.sheetStateChange.emit("full")}confirmRename(){return C(this,null,function*(){if(!this.item||!this.renameValue.trim())return;(yield this.pdfActions.renamePdf(this.item,this.renameValue.trim()))&&(this.renameRequest.emit(this.renameValue.trim()),this.closeSheet(),this.actionComplete.emit("rename"))})}closeSheet(){this.isRenameMode=!1,this.renameValue="",this.sheetState="collapsed",this.sheetStateChange.emit("collapsed")}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["app-pdf-action-sheet"]],inputs:{item:"item",sheetState:"sheetState"},outputs:{sheetStateChange:"sheetStateChange",actionComplete:"actionComplete",renameRequest:"renameRequest"},standalone:!1,decls:2,vars:2,consts:[[3,"sheetStateChange","sheetState"],["class","pdf-action-sheet",4,"ngIf"],[1,"pdf-action-sheet"],[4,"ngIf"],[1,"sheet-header","rename-mode"],["aria-label","\uC774\uB984 \uBCC0\uACBD \uCDE8\uC18C",1,"sheet-back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","20","height","20"],[1,"sheet-title"],[1,"rename-form"],["for","renameInput",1,"rename-label"],["id","renameInput","type","text","maxlength","80","placeholder","\uC0C8 \uC774\uB984\uC744 \uC785\uB825\uD558\uC138\uC694",1,"rename-input",3,"ngModelChange","ngModel"],[1,"rename-helper"],[1,"rename-actions"],["type","button",1,"rename-cancel",3,"click"],["type","button",1,"rename-confirm",3,"click"],[1,"sheet-header"],[1,"sheet-options"],[1,"sheet-option",3,"click"],["src","images/icons/ico-pdf.svg","alt","PDF \uC5F4\uAE30","width","24","height","24"],["src","images/icons/ico-share.svg","alt","\uACF5\uC720","width","24","height","24"],["src","images/icons/btn-top-edit.svg","alt","\uC774\uB984\uBCC0\uACBD","width","24","height","24"],["src","images/icons/ico-tool-copy.svg","alt","\uBCF5\uC81C","width","24","height","24"],[1,"sheet-option","danger",3,"click"],["src","images/icons/ico-tool-cut.svg","alt","\uC0AD\uC81C","width","24","height","24"]],template:function(e,n){e&1&&(o(0,"app-bottom-sheet",0),$("sheetStateChange",function(s){return U(n.sheetState,s)||(n.sheetState=s),s}),u("sheetStateChange",function(s){return n.onSheetStateChange(s)}),b(1,hu,3,2,"div",1),a()),e&2&&(j("sheetState",n.sheetState),l(),p("ngIf",n.item))},dependencies:[B,he,pe,Sn,ge,Pe],styles:[".pdf-action-sheet[_ngcontent-%COMP%]{display:flex;flex-direction:column}.sheet-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:20px 20px 16px;border-bottom:1px solid #f0f0f0}.sheet-header.rename-mode[_ngcontent-%COMP%]{padding:16px 20px}.sheet-back-btn[_ngcontent-%COMP%]{flex-shrink:0;width:32px;height:32px;padding:0;background:none;border:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background .2s}.sheet-back-btn[_ngcontent-%COMP%]:active{background:#0000000d}.sheet-title[_ngcontent-%COMP%]{flex:1;margin:0;font-size:18px;font-weight:600;color:#333;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sheet-options[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:8px 0}.sheet-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px 20px;background:none;border:none;width:100%;text-align:left;cursor:pointer;transition:background .2s;color:#333}.sheet-option[_ngcontent-%COMP%]:active{background:#f5f5f5}.sheet-option.danger[_ngcontent-%COMP%]{color:#f44336}.sheet-option[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;width:24px;height:24px}.sheet-option[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;font-size:16px;font-weight:400}.rename-form[_ngcontent-%COMP%]{padding:24px 20px}.rename-label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#666;margin-bottom:8px}.rename-input[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:1px solid #ddd;border-radius:8px;font-size:16px;color:#333;transition:all .2s}.rename-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;box-shadow:0 0 0 3px #2196f31a}.rename-input[_ngcontent-%COMP%]::placeholder{color:#999}.rename-helper[_ngcontent-%COMP%]{margin:8px 0 0;font-size:13px;color:#999}.rename-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:24px}.rename-cancel[_ngcontent-%COMP%], .rename-confirm[_ngcontent-%COMP%]{flex:1;padding:12px;border:none;border-radius:8px;font-size:16px;font-weight:500;cursor:pointer;transition:all .2s}.rename-cancel[_ngcontent-%COMP%]{background:#f5f5f5;color:#666}.rename-cancel[_ngcontent-%COMP%]:active{background:#e0e0e0}.rename-confirm[_ngcontent-%COMP%]{background:#2196f3;color:#fff}.rename-confirm[_ngcontent-%COMP%]:active{background:#1976d2}"]})};function Cu(r,t){if(r&1){let e=y();o(0,"button",13),u("click",function(){m(e);let i=g();return f(i.clearSearch())}),h(1,"img",14),a()}}function bu(r,t){if(r&1&&(o(0,"div",15),h(1,"img",16),o(2,"h3"),c(3,"\uAC80\uC0C9 \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4"),a(),o(4,"p"),c(5),a()()),r&2){let e=g();l(5),S('"',e.searchQuery,'"\uC5D0 \uB300\uD55C \uACB0\uACFC\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.')}}function vu(r,t){r&1&&(o(0,"div",17),h(1,"div",18),o(2,"p"),c(3,"\uAC80\uC0C9 \uC911..."),a()())}function xu(r,t){if(r&1&&h(0,"img",37),r&2){let e=g().$implicit,n=g(2);k("landscape",n.thumbnailOrientations[e.id]==="landscape"),p("src",e.thumbnail,ce)}}function Pu(r,t){r&1&&(o(0,"div",38),h(1,"img",39),a())}function Mu(r,t){r&1&&(o(0,"div",40),h(1,"img",41),a())}function yu(r,t){r&1&&(o(0,"div",42),h(1,"img",43),a())}function wu(r,t){r&1&&(o(0,"div",44),h(1,"img",45),a())}function Su(r,t){r&1&&(o(0,"div",46),h(1,"img",47),a())}function Ou(r,t){if(r&1&&(o(0,"span",48),c(1),a()),r&2){let e=g().$implicit;l(),S(" \xB7 ",e.size)}}function Eu(r,t){if(r&1){let e=y();o(0,"div",22),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.onResultClick(i))}),o(1,"div",23),b(2,xu,1,3,"img",24)(3,Pu,2,0,"div",25)(4,Mu,2,0,"div",26)(5,yu,2,0,"div",27)(6,wu,2,0,"div",28)(7,Su,2,0,"div",29),a(),o(8,"div",30)(9,"div",31),c(10),a(),o(11,"div",32)(12,"span",33),c(13),a(),b(14,Ou,2,1,"span",34),a()(),o(15,"button",35),u("click",function(i){let s=m(e).$implicit,d=g(2);return f(d.onMoreClick(s,i))}),h(16,"img",36),a()()}if(r&2){let e=t.$implicit;l(2),p("ngIf",e.thumbnail),l(),p("ngIf",!e.thumbnail&&(!e.documentType||e.documentType==="viewer")),l(),p("ngIf",e.documentType==="image"),l(),p("ngIf",e.documentType==="excel"),l(),p("ngIf",e.documentType==="word"),l(),p("ngIf",e.documentType==="ppt"),l(3),x(e.name),l(3),ue("",e.date," ",e.time),l(),p("ngIf",e.size),l(),Be("aria-label","\uB354\uBCF4\uAE30: "+e.name)}}function ku(r,t){if(r&1&&(o(0,"div",19)(1,"div",20),b(2,Eu,17,11,"div",21),a()()),r&2){let e=g();l(2),p("ngForOf",e.searchResults)}}function Du(r,t){r&1&&(o(0,"div",49),h(1,"img",16),o(2,"h3"),c(3,"\uD30C\uC77C \uAC80\uC0C9"),a(),o(4,"p"),c(5,"\uD30C\uC77C\uBA85\uC744 \uC785\uB825\uD558\uC5EC \uBB38\uC11C\uB97C \uCC3E\uC544\uBCF4\uC138\uC694"),a()())}var _i=class r{constructor(t){this.router=t}currentActiveTab="files";searchQuery="";searchResults=[];isSearching=!1;allDocuments=[];selectedFile=null;sheetState="collapsed";thumbnailOrientations={};indexedDbService=P(ee);snackbar=P(G);ngOnInit(){return C(this,null,function*(){yield this.loadAllDocuments()})}onBack(){this.router.navigate(["/ezm/home"])}loadAllDocuments(){return C(this,null,function*(){try{this.allDocuments=yield this.indexedDbService.getAllDocumentsMetadataOnly(),this.allDocuments.forEach((t,e)=>{})}catch{}})}loadRecentSearches(){}saveRecentSearch(t){}onSearchInput(){if(this.searchQuery.trim().length===0){this.searchResults=[];return}this.performSearch()}performSearch(){let t=this.searchQuery.trim();if(!t){this.searchResults=[];return}let e=t.normalize("NFC").toLowerCase();this.isSearching=!0,this.searchResults=this.allDocuments.filter(n=>{let i=(n.fileName||"").normalize("NFC").toLowerCase(),s=(n.title||"").normalize("NFC").toLowerCase(),d=i.includes(e),_=s.includes(e);return d||_}).map(n=>({id:n.id,name:n.fileName||n.title,date:this.formatDate(new Date(n.updatedAt).getTime()),time:this.formatTime(new Date(n.updatedAt).getTime()),size:this.calculateSize(n),thumbnail:n.thumbnail,documentType:n.documentType,pdfBase64:n.pdfBase64})).slice(0,50),this.searchResults.forEach(n=>{n.thumbnail&&this.detectThumbnailOrientation(n.id,n.thumbnail)}),this.isSearching=!1}detectThumbnailOrientation(t,e){let n=new Image;n.onload=()=>{this.thumbnailOrientations[t]=n.width>n.height?"landscape":"portrait"},n.src=e}formatDate(t){let e=new Date(t),n=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${n}.${i}.${s}`}formatTime(t){let e=new Date(t),n=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0"),s=String(e.getSeconds()).padStart(2,"0");return`${n}:${i}:${s}`}calculateSize(t){if(t.pdfBase64){let n=t.pdfBase64.length*3/4;return this.formatFileSize(n)}return""}formatFileSize(t){if(t===0)return"0mb";let e=t/(1024*1024);return Math.round(e)+"mb"}onRecentSearchClick(t){}clearRecentSearches(){}onResultClick(t){return C(this,null,function*(){try{let e=yield this.indexedDbService.getDocumentById(t.id);if(!e){this.snackbar.showWarning("\uBB38\uC11C\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.router.navigate(["/ezm/viewer"],{state:{document:e}})}catch{this.snackbar.showError("\uBB38\uC11C\uB97C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}clearSearch(){this.searchQuery="",this.searchResults=[]}onMoreClick(t,e){e.stopPropagation(),this.selectedFile={id:t.id,name:t.name,fileName:t.name,title:t.name},this.sheetState="full"}onActionComplete(t){(t==="delete"||t==="rename")&&this.performSearch()}onSheetClose(){this.selectedFile=null,this.sheetState="collapsed"}static \u0275fac=function(e){return new(e||r)(V(N))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-search"]],standalone:!1,decls:13,vars:8,consts:[[1,"header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"search-input-wrapper"],["src","images/icons/btn-search.svg","alt","\uAC80\uC0C9","width","20","height","20",1,"search-icon"],["type","text","placeholder","\uD30C\uC77C\uBA85 \uAC80\uC0C9...","autofocus","",1,"search-input",3,"ngModelChange","input","ngModel"],["class","clear-btn",3,"click",4,"ngIf"],[1,"main-content"],["class","empty-state",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","search-results",4,"ngIf"],["class","info-state",4,"ngIf"],[3,"sheetStateChange","actionComplete","item","sheetState"],[1,"clear-btn",3,"click"],["src","images/icons/ico-close.svg","alt","\uC9C0\uC6B0\uAE30","width","18","height","18"],[1,"empty-state"],["src","images/icons/btn-search.svg","alt","\uAC80\uC0C9","width","64","height","64"],[1,"loading-state"],[1,"spinner"],[1,"search-results"],[1,"files-list"],["class","file-item",3,"click",4,"ngFor","ngForOf"],[1,"file-item",3,"click"],[1,"file-icon"],["alt","PDF \uC378\uB124\uC77C","class","file-thumbnail-image",3,"src","landscape",4,"ngIf"],["class","file-type-icon pdf-icon",4,"ngIf"],["class","file-type-icon image-icon",4,"ngIf"],["class","file-type-icon excel-icon",4,"ngIf"],["class","file-type-icon word-icon",4,"ngIf"],["class","file-type-icon ppt-icon",4,"ngIf"],[1,"file-info"],[1,"file-name"],[1,"file-meta"],[1,"file-date"],["class","file-size",4,"ngIf"],[1,"more-btn",3,"click"],["src","images/icons/btn-top-more.svg","alt","\uB354\uBCF4\uAE30","width","20","height","20"],["alt","PDF \uC378\uB124\uC77C",1,"file-thumbnail-image",3,"src"],[1,"file-type-icon","pdf-icon"],["src","images/icons/ico-pdf.svg","alt","PDF","width","30","height","30"],[1,"file-type-icon","image-icon"],["src","images/icons/ico-img.svg","alt","\uC774\uBBF8\uC9C0","width","30","height","30"],[1,"file-type-icon","excel-icon"],["src","images/icons/ico-xlsx.svg","alt","\uC5D1\uC140","width","30","height","30"],[1,"file-type-icon","word-icon"],["src","images/icons/ico-word.svg","alt","\uC6CC\uB4DC","width","30","height","30"],[1,"file-type-icon","ppt-icon"],["src","images/icons/ico-ppt.svg","alt","PPT","width","30","height","30"],[1,"file-size"],[1,"info-state"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"button",1),u("click",function(){return n.onBack()}),h(2,"img",2),a(),o(3,"div",3),h(4,"img",4),o(5,"input",5),$("ngModelChange",function(s){return U(n.searchQuery,s)||(n.searchQuery=s),s}),u("input",function(){return n.onSearchInput()}),a(),b(6,Cu,2,0,"button",6),a()(),o(7,"div",7),b(8,bu,6,1,"div",8)(9,vu,4,0,"div",9)(10,ku,3,1,"div",10)(11,Du,6,0,"div",11),a(),o(12,"app-pdf-action-sheet",12),u("sheetStateChange",function(s){return n.sheetState=s})("actionComplete",function(s){return n.onActionComplete(s)}),a()),e&2&&(l(5),j("ngModel",n.searchQuery),l(),p("ngIf",n.searchQuery),l(2),p("ngIf",n.searchQuery&&n.searchResults.length===0&&!n.isSearching),l(),p("ngIf",n.isSearching),l(),p("ngIf",n.searchResults.length>0),l(),p("ngIf",!n.searchQuery),l(),p("item",n.selectedFile)("sheetState",n.sheetState))},dependencies:[oe,B,he,pe,ge,hi],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}[_nghost-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;background-color:#f5f5f5;min-height:100vh;display:flex;flex-direction:column;padding-top:var(--android-status-bar-height, 0px);padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:border-box}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;background:#fff;border-bottom:1px solid #f0f0f0;position:sticky;top:0;z-index:100}.header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0}.header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:active{opacity:.7}.header[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]{flex:1;position:relative;display:flex;align-items:center}.header[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{position:absolute;left:12px;color:#999;pointer-events:none}.header[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%;padding:10px 40px;border:1px solid #e0e0e0;border-radius:8px;font-size:15px;background:#f8f9fa;transition:all .2s}.header[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3;background:#fff}.header[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]::placeholder{color:#999}.header[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]{position:absolute;right:8px;background:none;border:none;padding:6px;cursor:pointer;color:#999;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:all .2s}.header[_ngcontent-%COMP%]   .search-input-wrapper[_ngcontent-%COMP%]   .clear-btn[_ngcontent-%COMP%]:active{background:#f0f0f0}.main-content[_ngcontent-%COMP%]{flex:1;background:#f5f5f5;padding:0 0 60px;max-height:calc(100vh - 116px);overflow-y:auto}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;background:#fff}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin:0}.section-header[_ngcontent-%COMP%]   .clear-all-btn[_ngcontent-%COMP%]{background:none;border:none;color:#f44336;font-size:14px;font-weight:500;cursor:pointer;padding:4px 8px}.section-header[_ngcontent-%COMP%]   .clear-all-btn[_ngcontent-%COMP%]:active{opacity:.7}.recent-searches[_ngcontent-%COMP%]{background:#fff;margin-bottom:12px}.recent-searches[_ngcontent-%COMP%]   .recent-search-list[_ngcontent-%COMP%]{padding:0 20px 12px}.recent-searches[_ngcontent-%COMP%]   .recent-search-list[_ngcontent-%COMP%]   .recent-search-item[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;gap:12px;padding:12px 0;background:none;border:none;border-bottom:1px solid #f0f0f0;cursor:pointer;text-align:left}.recent-searches[_ngcontent-%COMP%]   .recent-search-list[_ngcontent-%COMP%]   .recent-search-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.recent-searches[_ngcontent-%COMP%]   .recent-search-list[_ngcontent-%COMP%]   .recent-search-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;color:#999}.recent-searches[_ngcontent-%COMP%]   .recent-search-list[_ngcontent-%COMP%]   .recent-search-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;font-size:15px;color:#333}.recent-searches[_ngcontent-%COMP%]   .recent-search-list[_ngcontent-%COMP%]   .recent-search-item[_ngcontent-%COMP%]:active{background:#f8f9fa}.search-results[_ngcontent-%COMP%]{background:#fff}.files-list[_ngcontent-%COMP%]{padding:8px 0}.file-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;background:#fff;border-bottom:1px solid #f0f0f0;cursor:pointer;transition:background .2s;position:relative}.file-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.file-item[_ngcontent-%COMP%]:active{background:#f5f5f5}.file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;justify-content:center;width:70px;height:80px;border:1px solid #e8e8e8;border-radius:8px;background:#fafafa}.file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:30px;height:30px}.file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-thumbnail-image[_ngcontent-%COMP%]{max-width:58px;max-height:68px;width:auto;height:auto;object-fit:contain;border-radius:4px;box-shadow:0 1px 3px #0000001a}.file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-thumbnail-image.landscape[_ngcontent-%COMP%]{max-width:62px;max-height:45px}.file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-type-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.file-item[_ngcontent-%COMP%]   .file-icon[_ngcontent-%COMP%]   .file-type-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:30px;height:30px}.file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{flex:1;min-width:0}.file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-name[_ngcontent-%COMP%]{font-size:15px;font-weight:400;color:#333;margin:0 0 4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.file-item[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]   .file-meta[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:13px;color:#999}.file-item[_ngcontent-%COMP%]   .more-btn[_ngcontent-%COMP%]{flex-shrink:0;width:36px;height:36px;padding:0;background:#0000000d;border:none;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;color:#666;transition:all .2s;position:relative;z-index:3}.file-item[_ngcontent-%COMP%]   .more-btn[_ngcontent-%COMP%]:hover{background:#0000001a}.file-item[_ngcontent-%COMP%]   .more-btn[_ngcontent-%COMP%]:active{transform:scale(.95);background:#00000026}.file-item[_ngcontent-%COMP%]   .more-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.empty-state[_ngcontent-%COMP%], .info-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .info-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#ccc;margin-bottom:20px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .info-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0 0 8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .info-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#999;margin:0;line-height:1.5}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #f0f0f0;border-top-color:#2196f3;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:16px}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#999}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media (max-width: 375px){.header[_ngcontent-%COMP%]{padding:10px 12px}.main-content[_ngcontent-%COMP%]{padding:0 0 60px}}"]})};var Ci=class r{constructor(t,e,n){this.route=t;this.router=e;this.authService=n}message="\uB85C\uADF8\uC778 \uCC98\uB9AC \uC911...";ngOnInit(){return C(this,null,function*(){try{let t=new URLSearchParams(window.location.hash.substring(1)),e=t.get("access_token"),n=t.get("id_token"),i=t.get("error"),d=new URLSearchParams(window.location.search).get("code")||this.route.snapshot.queryParamMap.get("code");if(d==="test"){this.message="\uD14C\uC2A4\uD2B8 \uBAA8\uB4DC: \uB85C\uADF8\uC778 \uCC98\uB9AC \uC911...",setTimeout(()=>{this.message="\uD14C\uC2A4\uD2B8 \uB85C\uADF8\uC778 \uC131\uACF5! (\uC2E4\uC81C Google \uC778\uC99D \uC544\uB2D8)",setTimeout(()=>this.router.navigate(["/ezm"]),1500)},1e3);return}if(i){this.message="\uB85C\uADF8\uC778\uC774 \uCDE8\uC18C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",setTimeout(()=>this.router.navigate(["/ezm/login"]),2e3);return}if(e&&n){let _=this.parseJwt(n);(yield this.authService.loginWithGoogleToken(e,_))?(this.message="\uB85C\uADF8\uC778 \uC131\uACF5! \uBA54\uC778 \uD654\uBA74\uC73C\uB85C \uC774\uB3D9\uD569\uB2C8\uB2E4...",setTimeout(()=>this.router.navigate(["/ezm"]),1e3)):(this.message="\uB85C\uADF8\uC778\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.",setTimeout(()=>this.router.navigate(["/ezm/login"]),2e3));return}if(d){(yield this.authService.loginWithGoogle(d))?(this.message="\uB85C\uADF8\uC778 \uC131\uACF5! \uBA54\uC778 \uD654\uBA74\uC73C\uB85C \uC774\uB3D9\uD569\uB2C8\uB2E4...",setTimeout(()=>this.router.navigate(["/ezm"]),1e3)):(this.message="\uB85C\uADF8\uC778\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.",setTimeout(()=>this.router.navigate(["/ezm/login"]),2e3));return}this.message="\uC778\uC99D \uC815\uBCF4\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.",setTimeout(()=>this.router.navigate(["/ezm/login"]),2e3)}catch{this.message="\uB85C\uADF8\uC778 \uCC98\uB9AC \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.",setTimeout(()=>this.router.navigate(["/ezm/login"]),2e3)}})}parseJwt(t){try{let n=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(atob(n).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(i)}catch{return null}}static \u0275fac=function(e){return new(e||r)(V(et),V(N),V(Ce))};static \u0275cmp=F({type:r,selectors:[["ezm-google-login-callback"]],standalone:!1,decls:5,vars:1,consts:[[1,"callback-container"],[1,"loading-content"],[1,"loading-spinner"],[1,"message"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1),h(2,"div",2),o(3,"p",3),c(4),a()()()),e&2&&(l(4),x(n.message))},styles:[".callback-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100vh;background:linear-gradient(135deg,#667eea,#764ba2)}.loading-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:24px;padding:40px;background:#fff;border-radius:16px;box-shadow:0 10px 40px #0000001a}.loading-spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #f3f3f3;border-top:4px solid #667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.message[_ngcontent-%COMP%]{color:#333;font-size:16px;font-weight:500;text-align:center;margin:0}"]})};function Iu(r,t){if(r&1&&(o(0,"p",7),c(1),a()),r&2){let e=g();l(),x(e.subtitle)}}function Tu(r,t){if(r&1){let e=y();re(0),o(1,"div",8),h(2,"div",9),a(),o(3,"button",10),u("click",function(){m(e);let i=g();return f(i.onNavigateToFiles())}),c(4," \uD30C\uC77C\uB85C \uC774\uB3D9 "),a(),ae()}}var bi=class r{constructor(t,e,n){this.router=t;this.route=e;this.location=n}fileCount=1;fileName="";fileId="";fileIds=[];folderId=null;title="\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.";subtitle="";isProcessing=!0;ngOnInit(){let e=this.router.getCurrentNavigation()?.extras?.state||history.state;e?(this.fileId=e.fileId||e.fileIds&&e.fileIds[0]||"",this.fileIds=e.fileIds||(e.fileId?[e.fileId]:[]),this.fileName=e.fileName||"\uD30C\uC77C",this.fileCount=e.fileCount||this.fileIds.length||1,this.title=e.title||"\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.",this.subtitle=e.subtitle||"",this.folderId=e.folderId!==void 0?e.folderId:null,this.isProcessing=e.isProcessing!==void 0?e.isProcessing:!1):this.router.navigate(["/ezm/home"])}onNavigateToFiles(){this.folderId?this.router.navigate(["/ezm/myfiles",this.folderId]):this.router.navigate(["/ezm/myfiles","my-files"])}onClose(){this.location.back()}static \u0275fac=function(e){return new(e||r)(V(N),V(et),V(go))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-file-saved"]],standalone:!1,decls:8,vars:5,consts:[[1,"file-saved-page"],[1,"file-icon"],["src","images/icons/ico-pdf.svg","alt","\uD30C\uC77C","width","80","height","100"],[1,"message-container"],[1,"title"],["class","subtitle",4,"ngIf"],[4,"ngIf"],[1,"subtitle"],[1,"arrow-container"],[1,"arrow-line"],[1,"action-button",3,"click"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1),h(2,"img",2),a(),o(3,"div",3)(4,"h1",4),c(5),a(),b(6,Iu,2,1,"p",5),a(),b(7,Tu,5,0,"ng-container",6),a()),e&2&&(k("processing",n.isProcessing),l(5),x(n.title),l(),p("ngIf",n.subtitle),l(),p("ngIf",!n.isProcessing))},dependencies:[B],styles:['.file-saved-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;background-color:#f5f5f5;padding:40px 20px;position:relative;overflow:hidden}.file-saved-page.processing[_ngcontent-%COMP%]{background-color:#f5f5f5}.file-icon[_ngcontent-%COMP%]{margin-bottom:30px;animation:_ngcontent-%COMP%_icon-float .8s cubic-bezier(.175,.885,.32,1.275) both}.file-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{filter:drop-shadow(0 8px 16px rgba(0,0,0,.1))}@keyframes _ngcontent-%COMP%_icon-float{0%{transform:translateY(-50px);opacity:0}to{transform:translateY(0);opacity:1}}.message-container[_ngcontent-%COMP%]{text-align:center;margin-bottom:40px;animation:_ngcontent-%COMP%_message-fade .6s ease-out .3s both}.title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#212121;margin:0 0 12px;line-height:1.3}.subtitle[_ngcontent-%COMP%]{font-size:15px;font-weight:400;color:#757575;margin:0;line-height:1.5}@keyframes _ngcontent-%COMP%_message-fade{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.arrow-container[_ngcontent-%COMP%]{width:2px;height:80px;position:relative;margin-bottom:30px;overflow:hidden}.arrow-line[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(to bottom,#667eea,#764ba2);animation:_ngcontent-%COMP%_arrow-draw .8s ease-out .5s both}.arrow-line[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-8px;left:50%;transform:translate(-50%);width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-top:12px solid #764ba2;animation:_ngcontent-%COMP%_arrow-tip-appear .3s ease-out 1.2s both}@keyframes _ngcontent-%COMP%_arrow-draw{0%{height:0}to{height:100%}}@keyframes _ngcontent-%COMP%_arrow-tip-appear{0%{opacity:0;transform:translate(-50%) scale(0)}to{opacity:1;transform:translate(-50%) scale(1)}}.action-button[_ngcontent-%COMP%]{width:90%;max-width:320px;height:56px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;font-size:17px;font-weight:600;border:none;border-radius:28px;cursor:pointer;box-shadow:0 8px 24px #667eea59;transition:all .3s cubic-bezier(.4,0,.2,1);animation:_ngcontent-%COMP%_button-appear .6s cubic-bezier(.175,.885,.32,1.275) .8s both;position:relative;overflow:hidden}.action-button[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:50%;width:0;height:0;border-radius:50%;background:#fff3;transform:translate(-50%,-50%);transition:width .6s,height .6s}.action-button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 12px 28px #667eea73}.action-button[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 6px 20px #667eea4d}.action-button[_ngcontent-%COMP%]:active:before{width:300px;height:300px}@keyframes _ngcontent-%COMP%_button-appear{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 375px){.file-saved-page[_ngcontent-%COMP%]{padding:30px 16px}.title[_ngcontent-%COMP%]{font-size:22px}.subtitle[_ngcontent-%COMP%]{font-size:14px}.action-button[_ngcontent-%COMP%]{width:95%;height:52px;font-size:16px}}']})};var vi=class r{featureName="";router=P(N);snackbar=P(G);navigationHistory=P(Fe);ngOnInit(){let e=this.router.getCurrentNavigation()?.extras?.state||history.state;this.featureName=e?.featureName||"AI \uAE30\uB2A5"}onGoToSettings(){this.router.navigate(["/ezm/profile"])}onGoBack(){this.navigationHistory.goBack("/ezm/tools")}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-google-login-required"]],standalone:!1,decls:37,vars:2,consts:[[1,"google-login-required-container"],[1,"header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C\uAC00\uAE30","width","24","height","24"],[1,"header-title"],[1,"content"],[1,"icon-container"],["src","images/icons/ico-tooltip-info.svg","alt","\uC54C\uB9BC","width","80","height","80"],[1,"title"],[1,"description"],[1,"feature-info"],[1,"info-item"],["src","images/icons/ico-complete.svg","alt","\uCCB4\uD06C","width","20","height","20"],[1,"actions"],[1,"primary-btn",3,"click"],["src","images/icons/ico-tool-configuration.svg","alt","\uC124\uC815","width","20","height","20"],[1,"secondary-btn",3,"click"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),u("click",function(){return n.onGoBack()}),h(3,"img",3),a(),o(4,"div",4),c(5,"Google \uB85C\uADF8\uC778 \uD544\uC694"),a()(),o(6,"div",5)(7,"div",6),h(8,"img",7),a(),o(9,"h2",8),c(10),h(11,"br"),c(12,"Google \uB85C\uADF8\uC778\uC774 \uD544\uC694\uD569\uB2C8\uB2E4"),a(),o(13,"div",9)(14,"p"),c(15),a(),o(16,"p"),c(17,"Google \uACC4\uC815\uC73C\uB85C \uB85C\uADF8\uC778\uD558\uC2DC\uBA74 API \uD0A4\uAC00 \uC790\uB3D9\uC73C\uB85C \uC124\uC815\uB418\uC5B4 AI \uAE30\uB2A5\uC744 \uC0AC\uC6A9\uD558\uC2E4 \uC218 \uC788\uC2B5\uB2C8\uB2E4."),a()(),o(18,"div",10)(19,"div",11),h(20,"img",12),o(21,"span"),c(22,"\uBB34\uB8CC\uB85C \uC0AC\uC6A9 \uAC00\uB2A5"),a()(),o(23,"div",11),h(24,"img",12),o(25,"span"),c(26,"\uBE60\uB974\uACE0 \uC815\uD655\uD55C AI \uBD84\uC11D"),a()(),o(27,"div",11),h(28,"img",12),o(29,"span"),c(30,"\uC548\uC804\uD55C \uB370\uC774\uD130 \uCC98\uB9AC"),a()()(),o(31,"div",13)(32,"button",14),u("click",function(){return n.onGoToSettings()}),h(33,"img",15),c(34," \uB0B4\uC815\uBCF4\uC5D0\uC11C API \uD0A4 \uAC00\uC838\uC624\uAE30 "),a(),o(35,"button",16),u("click",function(){return n.onGoBack()}),c(36," \uB3CC\uC544\uAC00\uAE30 "),a()()()()),e&2&&(l(10),S("",n.featureName,"\uC744(\uB97C) \uC0AC\uC6A9\uD558\uB824\uBA74"),l(5),S("",n.featureName,"\uC740(\uB294) Google\uC758 Gemini AI\uB97C \uC0AC\uC6A9\uD569\uB2C8\uB2E4."))},styles:[".google-login-required-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:content-box;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;background:#ffffff1a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);position:sticky;top:0;z-index:10}.back-btn[_ngcontent-%COMP%]{background:none;border:none;color:#fff;cursor:pointer;padding:8px;display:flex;align-items:center;justify-content:center;transition:transform .2s}.back-btn[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.back-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.header-title[_ngcontent-%COMP%]{flex:1;text-align:center;font-size:18px;font-weight:600;margin-right:40px}.content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 24px;text-align:center}.icon-container[_ngcontent-%COMP%]{margin-bottom:24px;animation:_ngcontent-%COMP%_pulse 2s ease-in-out infinite}.icon-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#ffffffe6;filter:drop-shadow(0 4px 12px rgba(0,0,0,.2))}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.05);opacity:.8}}.title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;line-height:1.4;margin-bottom:24px;text-shadow:0 2px 8px rgba(0,0,0,.2)}.description[_ngcontent-%COMP%]{font-size:15px;line-height:1.6;margin-bottom:32px;color:#ffffffe6;max-width:400px}.description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 12px}.description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.feature-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:40px;width:100%;max-width:320px}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;background:#ffffff26;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:12px;font-size:14px;font-weight:500}.info-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.info-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;text-align:left}.actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;width:100%;max-width:320px}.primary-btn[_ngcontent-%COMP%], .secondary-btn[_ngcontent-%COMP%]{padding:16px 24px;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;transition:all .2s;border:none;display:flex;align-items:center;justify-content:center;gap:8px}.primary-btn[_ngcontent-%COMP%]:active, .secondary-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}.primary-btn[_ngcontent-%COMP%]{background:#fff;color:#667eea;box-shadow:0 4px 12px #00000026}.primary-btn[_ngcontent-%COMP%]:hover{box-shadow:0 6px 16px #0003;transform:translateY(-2px)}.primary-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.secondary-btn[_ngcontent-%COMP%]{background:#fff3;color:#fff;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.secondary-btn[_ngcontent-%COMP%]:hover{background:#ffffff40}@media (max-width: 375px){.title[_ngcontent-%COMP%]{font-size:20px}.description[_ngcontent-%COMP%]{font-size:14px}.content[_ngcontent-%COMP%]{padding:24px 20px}}"]})};function Au(r,t){r&1&&h(0,"img",32)}function Fu(r,t){if(r&1){let e=y();o(0,"button",30),u("click",function(){let i=m(e).$implicit,s=g();return f(s.selectColor(i))}),b(1,Au,1,0,"img",31),a()}if(r&2){let e=t.$implicit,n=g();q("background-color",e),k("selected",n.pageColor===e),l(),p("ngIf",n.pageColor===e)}}var xi=class r{constructor(t,e,n){this.router=t;this.indexedDbService=e;this.snackbar=n}pageOrientation="portrait";pageColor="#FFFFFF";pageCount=1;colorPalette=["#FFFFFF","#FF6B6B","#FF8E8E","#FFB4B4","#FFA07A","#FFB347","#FFC107","#FFD700","#FFEB3B","#FFFF00","#90EE90","#7CFC00","#00FF00","#00CED1","#00BFFF","#4169E1","#9370DB","#BA55D3","#FF69B4","#D3D3D3","#A9A9A9","#696969"];ngOnInit(){}goBack(){this.router.navigate(["/ezm/tools"])}selectOrientation(t){this.pageOrientation=t}selectColor(t){this.pageColor=t}incrementPageCount(){this.pageCount<100&&this.pageCount++}decrementPageCount(){this.pageCount>1&&this.pageCount--}onApply(){return C(this,null,function*(){try{this.snackbar.showInfo("\uBB38\uC11C\uB97C \uC0DD\uC131\uD558\uB294 \uC911...");let t=window.PDFLib;if(!t)throw new Error("PDFLib\uC774 \uB85C\uB4DC\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");let e=yield t.PDFDocument.create(),n=this.pageOrientation==="portrait"?595:842,i=this.pageOrientation==="portrait"?842:595,s=this.hexToRgb(this.pageColor);for(let z=0;z<this.pageCount;z++){let A=e.addPage([n,i]);this.pageColor!=="#FFFFFF"&&A.drawRectangle({x:0,y:0,width:n,height:i,color:t.rgb(s.r/255,s.g/255,s.b/255)}),A.drawText(" ",{x:10,y:i-20,size:1,color:t.rgb(1,1,1)})}let d=yield e.save(),_=e.getPageCount();this.pageCount;let v=this.uint8ArrayToBase64(d),w=new Date,O=`\uC0C8\uBB38\uC11C_${w.getHours().toString().padStart(2,"0")+w.getMinutes().toString().padStart(2,"0")+w.getSeconds().toString().padStart(2,"0")}.pdf`,E=`doc_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,D=[];for(let z=0;z<this.pageCount;z++)D.push({pageNumber:z+1,elements:[],width:n,height:i});let T={id:E,title:O,fileName:O,pdfBase64:v,thumbnail:"",pages:D,elementCount:0,version:"1.0",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),documentType:"viewer",folderId:"results"};yield this.indexedDbService.saveDocument(T);let I=yield this.indexedDbService.getDocumentById(E);this.router.navigate(["/ezm/file-saved"],{state:{fileId:E,fileName:O,fileCount:1,title:"PDF \uB9CC\uB4E4\uAE30 \uC644\uB8CC!",subtitle:`${O} \uD30C\uC77C\uC774 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,folderId:"results"}})}catch{this.snackbar.showError("\uBB38\uC11C \uC0DD\uC131 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}hexToRgb(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:255,g:255,b:255}}uint8ArrayToBase64(t){let n="";for(let i=0;i<t.length;i+=32768){let s=t.subarray(i,Math.min(i+32768,t.length));n+=String.fromCharCode(...Array.from(s))}return btoa(n)}static \u0275fac=function(e){return new(e||r)(V(N),V(ee),V(G))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-pdf-create"]],standalone:!1,decls:72,vars:14,consts:[["colorButton",""],[1,"pdf-create-container"],[1,"header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C\uAC00\uAE30","width","24","height","24"],[1,"header-title"],[1,"main-content"],[1,"preview-section"],[1,"preview-container"],[1,"preview-label"],[1,"settings-section"],[1,"setting-btn",3,"click"],[1,"setting-icon"],["src","images/icons/ico-pdf.svg","alt","\uC138\uB85C","width","24","height","24"],[1,"setting-label"],["src","images/icons/ico-pdf.svg","alt","\uAC00\uB85C","width","24","height","24",2,"transform","rotate(90deg)"],[1,"setting-btn","color-btn"],[1,"color-panel"],[1,"color-grid"],["class","color-item",3,"selected","background-color","click",4,"ngFor","ngForOf"],[1,"page-count-section"],[1,"page-count-label"],[1,"page-count-control"],[1,"count-btn",3,"click","disabled"],[1,"count-display"],[1,"action-section"],[1,"apply-btn",3,"click"],[1,"number-pad"],[1,"number-row"],[1,"number-btn"],[1,"color-item",3,"click"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","16","height","16",4,"ngIf"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","16","height","16"]],template:function(e,n){if(e&1){let i=y();o(0,"div",1)(1,"div",2)(2,"button",3),u("click",function(){return m(i),f(n.goBack())}),h(3,"img",4),a(),o(4,"div",5),c(5,"PDF \uB9CC\uB4E4\uAE30"),a()(),o(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),c(10,"\uBBF8\uB9AC\uBCF4\uAE30"),a()()(),o(11,"div",10)(12,"button",11),u("click",function(){return m(i),f(n.selectOrientation("portrait"))}),o(13,"div",12),h(14,"img",13),a(),o(15,"div",14),c(16,"\uC138\uB85C"),a()(),o(17,"button",11),u("click",function(){return m(i),f(n.selectOrientation("landscape"))}),o(18,"div",12),h(19,"img",15),a(),o(20,"div",14),c(21,"\uAC00\uB85C"),a()(),o(22,"button",16,0),h(24,"div",12),o(25,"div",14),c(26,"\uD398\uC774\uC9C0 \uC0C9"),a()()(),o(27,"div",17)(28,"div",18),b(29,Fu,2,5,"button",19),a()(),o(30,"div",20)(31,"div",21),c(32,"\uD398\uC774\uC9C0 (\uCD5C\uC18C 1, \uCD5C\uB300 100)"),a(),o(33,"div",22)(34,"button",23),u("click",function(){return m(i),f(n.decrementPageCount())}),c(35," - "),a(),o(36,"div",24),c(37),a(),o(38,"button",23),u("click",function(){return m(i),f(n.incrementPageCount())}),c(39," + "),a()()(),o(40,"div",25)(41,"button",26),u("click",function(){return m(i),f(n.onApply())}),c(42," \uC801\uC6A9 "),a()(),o(43,"div",27)(44,"div",28)(45,"button",29),c(46,"1"),a(),o(47,"button",29),c(48,"2"),a(),o(49,"button",29),c(50,"3"),a()(),o(51,"div",28)(52,"button",29),c(53,"4"),a(),o(54,"button",29),c(55,"5"),a(),o(56,"button",29),c(57,"6"),a()(),o(58,"div",28)(59,"button",29),c(60,"7"),a(),o(61,"button",29),c(62,"8"),a(),o(63,"button",29),c(64,"9"),a()(),o(65,"div",28)(66,"button",29),c(67,"."),a(),o(68,"button",29),c(69,"0"),a(),o(70,"button",29),c(71,"\u232B"),a()()()()()}e&2&&(l(8),q("background-color",n.pageColor),k("landscape",n.pageOrientation==="landscape"),l(4),k("active",n.pageOrientation==="portrait"),l(5),k("active",n.pageOrientation==="landscape"),l(7),q("background-color",n.pageColor),l(5),p("ngForOf",n.colorPalette),l(5),p("disabled",n.pageCount<=1),l(3),x(n.pageCount),l(),p("disabled",n.pageCount>=100))},dependencies:[oe,B],styles:[".pdf-create-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;padding-top:calc(56px + var(--android-status-bar-height, 0px));padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:border-box;background:#f5f5f5}.header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fff;border-bottom:1px solid #e0e0e0;display:flex;align-items:center;padding-left:16px;padding-right:16px;z-index:100;gap:12px;box-sizing:border-box}.back-btn[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:50%}.back-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}.header-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333}.main-content[_ngcontent-%COMP%]{flex:1;padding-top:calc(56px + var(--android-status-bar-height, 0px));overflow-y:auto;padding-bottom:calc(20px + var(--android-navigation-bar-height, 0px))}.preview-section[_ngcontent-%COMP%]{padding:20px;display:flex;justify-content:center;align-items:center;min-height:250px}.preview-container[_ngcontent-%COMP%]{width:180px;height:240px;background:#fff;border-radius:8px;box-shadow:0 4px 12px #0000001a;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.preview-container.landscape[_ngcontent-%COMP%]{width:240px;height:180px}.preview-label[_ngcontent-%COMP%]{font-size:14px;color:#999}.settings-section[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:12px;padding:0 20px 20px}.setting-btn[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;gap:8px;padding:16px;background:#fff;border:2px solid #e0e0e0;border-radius:12px;cursor:pointer;transition:all .2s}.setting-btn[_ngcontent-%COMP%]:active{transform:scale(.98)}.setting-btn.active[_ngcontent-%COMP%]{border-color:#2196f3;background:#e3f2fd}.setting-btn.active[_ngcontent-%COMP%]   .setting-icon[_ngcontent-%COMP%]{color:#2196f3}.setting-btn.active[_ngcontent-%COMP%]   .setting-label[_ngcontent-%COMP%]{color:#2196f3;font-weight:600}.setting-icon[_ngcontent-%COMP%]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;color:#666}.setting-icon[_ngcontent-%COMP%]:has(svg){border-radius:6px}.color-btn[_ngcontent-%COMP%]   .setting-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;border:2px solid #ddd}.setting-label[_ngcontent-%COMP%]{font-size:13px;color:#666}.color-panel[_ngcontent-%COMP%]{padding:0 20px 20px}.color-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(6,1fr);gap:12px;background:#fff;padding:16px;border-radius:12px}.color-item[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:8px;border:2px solid #ddd;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.color-item[_ngcontent-%COMP%]:active{transform:scale(.9)}.color-item.selected[_ngcontent-%COMP%]{border-color:var(--selection-color, #F44336);border-width:3px}.page-count-section[_ngcontent-%COMP%]{padding:0 20px 20px}.page-count-label[_ngcontent-%COMP%]{font-size:14px;color:#666;margin-bottom:12px;text-align:center}.page-count-control[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:20px;background:#fff;padding:16px;border-radius:12px}.count-btn[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;border:2px solid #e0e0e0;background:#fff;font-size:24px;font-weight:600;color:#333;cursor:pointer;display:flex;align-items:center;justify-content:center}.count-btn[_ngcontent-%COMP%]:active:not(:disabled){background:#f5f5f5;transform:scale(.95)}.count-btn[_ngcontent-%COMP%]:disabled{opacity:.3;cursor:not-allowed}.count-display[_ngcontent-%COMP%]{min-width:60px;text-align:center;font-size:32px;font-weight:600;color:#333}.action-section[_ngcontent-%COMP%]{padding:0 20px 20px}.apply-btn[_ngcontent-%COMP%]{width:100%;height:52px;background:#f44336;border:none;border-radius:12px;color:#fff;font-size:16px;font-weight:600;cursor:pointer;box-shadow:0 4px 12px #f443364d}.apply-btn[_ngcontent-%COMP%]:active{background:#d32f2f;transform:scale(.98)}.number-pad[_ngcontent-%COMP%]{padding:0 20px 20px;display:none}.number-row[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:8px}.number-btn[_ngcontent-%COMP%]{flex:1;height:56px;background:#fff;border:1px solid #e0e0e0;border-radius:8px;font-size:20px;color:#333;cursor:pointer}.number-btn[_ngcontent-%COMP%]:active{background:#f5f5f5}"]})};function zu(r,t){r&1&&(o(0,"div",18)(1,"div",19)(2,"div",20)(3,"h4"),c(4,"\uC804\uCCB4"),a(),o(5,"div",21)(6,"div",22)(7,"div",23),h(8,"img",24),a(),o(9,"span",25),c(10,"AI \uBC88\uC5ED"),a(),o(11,"span",26),c(12,"100P"),a()(),o(13,"div",22)(14,"div",23),h(15,"img",27),a(),o(16,"span",25),c(17,"PDF \uBCC0\uD658"),a(),o(18,"span",26),c(19,"50P"),a()(),o(20,"div",22)(21,"div",23),h(22,"img",28),a(),o(23,"span",25),c(24,"AI \uC694\uC57D"),a(),o(25,"span",26),c(26,"80P"),a()(),o(27,"div",22)(28,"div",23),h(29,"img",29),a(),o(30,"span",25),c(31,"\uBB38\uC11C \uD3B8\uC9D1"),a(),o(32,"span",26),c(33,"30P"),a()()()(),o(34,"div",20)(35,"h4"),c(36,"\uAD50\uD658\uD558\uAE30"),a(),o(37,"div",30),h(38,"img",31),o(39,"span"),c(40,"\uD3EC\uC778\uD2B8 \uAD50\uD658 \uAE30\uB2A5\uC740 \uC900\uBE44\uC911\uC785\uB2C8\uB2E4"),a()()()()())}function Ru(r,t){if(r&1&&(o(0,"div",35)(1,"div",36)(2,"span",37),c(3),a(),o(4,"span",38),c(5),L(6,"date"),a()(),o(7,"div",39),c(8),a()()),r&2){let e=t.$implicit,n=g(2);l(3),x(e.description),l(2),x(me(6,5,e.date,"yyyy.MM.dd HH:mm")),l(2),co(n.getTypeClass(e.type)),l(),S(" ",n.getPointText(e)," ")}}function Bu(r,t){r&1&&(o(0,"div",40),h(1,"img",41),o(2,"p"),c(3,"\uD3EC\uC778\uD2B8 \uB0B4\uC5ED\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"),a()())}function Vu(r,t){if(r&1&&(o(0,"div",18)(1,"div",32),b(2,Ru,9,8,"div",33)(3,Bu,4,0,"div",34),a()()),r&2){let e=g();l(2),p("ngForOf",e.pointHistory),l(),p("ngIf",e.pointHistory.length===0)}}var Pi=class r{constructor(t,e){this.router=t;this.navigationHistory=e}currentTab="use";totalPoints=0;todayPoints=0;maxDailyPoints=5;pointsService=P(Ue);totalPointsSubscription;todayPointsSubscription;pointHistory=[{id:"1",type:"earn",amount:1e3,description:"\uCD9C\uC11D \uCCB4\uD06C",date:new Date("2025-10-24T11:06:00"),balance:999999999},{id:"2",type:"use",amount:500,description:"AI \uBC88\uC5ED \uC0AC\uC6A9",date:new Date("2025-10-23T15:30:00"),balance:999998999},{id:"3",type:"earn",amount:2e3,description:"\uBB38\uC11C \uACF5\uC720",date:new Date("2025-10-22T09:15:00"),balance:999999499},{id:"4",type:"use",amount:300,description:"PDF \uBCC0\uD658",date:new Date("2025-10-21T14:20:00"),balance:999997499},{id:"5",type:"earn",amount:5e3,description:"\uCE5C\uAD6C \uCD94\uCC9C",date:new Date("2025-10-20T10:00:00"),balance:999997799}];ngOnInit(){this.totalPointsSubscription=this.pointsService.totalPoints$.subscribe(t=>this.totalPoints=t),this.todayPointsSubscription=this.pointsService.todayPoints$.subscribe(t=>this.todayPoints=t),this.maxDailyPoints=this.pointsService.getMaxDailyPoints()}ngOnDestroy(){this.totalPointsSubscription&&this.totalPointsSubscription.unsubscribe(),this.todayPointsSubscription&&this.todayPointsSubscription.unsubscribe()}onBack(){let t=this.navigationHistory.getPreviousUrl();t&&!t.includes("/ezm/points")?this.router.navigateByUrl(t):this.router.navigate(["/ezm/profile"])}switchTab(t){this.currentTab=t}refreshPoints(){console.log("\uD3EC\uC778\uD2B8 \uC0C8\uB85C\uACE0\uCE68")}getTypeClass(t){return t==="earn"?"earn":"use"}getPointText(t){return t.type==="earn"?`+${t.amount.toLocaleString()}P`:`-${t.amount.toLocaleString()}P`}static \u0275fac=function(e){return new(e||r)(V(N),V(Fe))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-points"]],standalone:!1,decls:34,vars:12,consts:[[1,"header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"header-title"],[1,"refresh-btn",3,"click"],["src","images/icons/ico-rotation.svg","alt","\uC0C8\uB85C\uACE0\uCE68","width","20","height","20"],[1,"main-content"],[1,"points-card"],[1,"points-header"],[1,"update-time"],[1,"points-info"],[1,"points-item","primary"],[1,"label"],[1,"amount"],[1,"points-item","secondary"],[1,"tab-menu"],[1,"tab-btn",3,"click"],["class","tab-content",4,"ngIf"],[1,"tab-content"],[1,"use-options"],[1,"use-category"],[1,"use-items"],[1,"use-item"],[1,"use-icon"],["src","images/icons/ico-tool-main-ai-translation.svg","alt","AI \uBC88\uC5ED","width","40","height","40"],[1,"use-label"],[1,"use-points"],["src","images/icons/ico-pdf.svg","alt","PDF \uBCC0\uD658","width","40","height","40"],["src","images/icons/ico-tool-main-ai-summary.svg","alt","AI \uC694\uC57D","width","40","height","40"],["src","images/icons/btn-top-edit.svg","alt","\uBB38\uC11C \uD3B8\uC9D1","width","40","height","40"],[1,"exchange-notice"],["src","images/icons/ico-tooltip-info.svg","alt","\uC54C\uB9BC","width","20","height","20"],[1,"history-list"],["class","history-item",4,"ngFor","ngForOf"],["class","history-empty",4,"ngIf"],[1,"history-item"],[1,"history-info"],[1,"history-desc"],[1,"history-date"],[1,"history-amount"],[1,"history-empty"],["src","images/icons/ico-tooltip-info.svg","alt","\uC54C\uB9BC","width","60","height","60"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"button",1),u("click",function(){return n.onBack()}),h(2,"img",2),a(),o(3,"h2",3),c(4,"\uD3EC\uC778\uD2B8"),a(),o(5,"button",4),u("click",function(){return n.refreshPoints()}),h(6,"img",5),a()(),o(7,"div",6)(8,"div",7)(9,"div",8)(10,"h3"),c(11,"\uD3EC\uC778\uD2B8 \uD604\uD669"),a(),o(12,"span",9),c(13,"2025.10.24 11:06"),a()(),o(14,"div",10)(15,"div",11)(16,"span",12),c(17,"\uC0AC\uC6A9 \uAC00\uB2A5"),a(),o(18,"span",13),c(19),L(20,"number"),a()(),o(21,"div",14)(22,"span",12),c(23,"\uC624\uB298\uC801\uB9BD"),a(),o(24,"span",13),c(25),L(26,"number"),a()()()(),o(27,"div",15)(28,"button",16),u("click",function(){return n.switchTab("use")}),c(29," \uC0AC\uC6A9\uD558\uAE30 "),a(),o(30,"button",16),u("click",function(){return n.switchTab("history")}),c(31," \uB0B4\uC5ED\uBCF4\uAE30 "),a()(),b(32,zu,41,0,"div",17)(33,Vu,4,2,"div",17),a()),e&2&&(l(19),S("",J(20,8,n.totalPoints),"P"),l(6),S("",J(26,10,n.todayPoints),"P"),l(3),k("active",n.currentTab==="use"),l(2),k("active",n.currentTab==="history"),l(2),p("ngIf",n.currentTab==="use"),l(),p("ngIf",n.currentTab==="history"))},dependencies:[oe,B,Te,Oe],styles:['.header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:56px;background:#fff;display:flex;align-items:center;justify-content:space-between;padding:0 16px;border-bottom:1px solid #e0e0e0;z-index:100;padding-top:var(--android-status-bar-height, 0px);height:calc(56px + var(--android-status-bar-height, 0px))}.back-btn[_ngcontent-%COMP%], .refresh-btn[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:#333;transition:background-color .2s;border-radius:50%}.back-btn[_ngcontent-%COMP%]:active, .refresh-btn[_ngcontent-%COMP%]:active{background-color:#0000000d}.back-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .refresh-btn[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.header-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0;flex:1;text-align:center}.main-content[_ngcontent-%COMP%]{margin-top:calc(56px + var(--android-status-bar-height, 0px));margin-bottom:var(--android-navigation-bar-height, 0px);padding:16px;min-height:calc(100vh - 56px - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));background:#f5f5f5}.points-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;margin-bottom:16px;box-shadow:0 2px 8px #00000014}.points-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.points-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin:0}.points-header[_ngcontent-%COMP%]   .update-time[_ngcontent-%COMP%]{font-size:12px;color:#999}.points-info[_ngcontent-%COMP%]{display:flex;gap:12px}.points-item[_ngcontent-%COMP%]{flex:1;padding:16px;border-radius:8px;display:flex;flex-direction:column;gap:8px}.points-item.primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f44,#f66)}.points-item.primary[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .points-item.primary[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{color:#fff}.points-item.secondary[_ngcontent-%COMP%]{background:#f8f9fa}.points-item.secondary[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666}.points-item.secondary[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{color:#333}.points-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:13px;font-weight:500}.points-item[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:20px;font-weight:700}.tab-menu[_ngcontent-%COMP%]{display:flex;background:#fff;border-radius:8px;margin-bottom:16px;overflow:hidden;box-shadow:0 2px 4px #0000000f}.tab-btn[_ngcontent-%COMP%]{flex:1;height:48px;background:#fff;border:none;font-size:15px;font-weight:500;color:#666;cursor:pointer;transition:all .2s;position:relative}.tab-btn.active[_ngcontent-%COMP%]{color:#f44;font-weight:600}.tab-btn.active[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;right:0;height:3px;background:#f44}.tab-btn[_ngcontent-%COMP%]:active{background:#f8f9fa}.tab-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;min-height:400px}.use-options[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.use-category[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#333;margin:0 0 12px}.use-items[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}.use-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;padding:12px 8px;border-radius:8px;cursor:pointer;transition:background-color .2s}.use-item[_ngcontent-%COMP%]:active{background-color:#f8f9fa}.use-item[_ngcontent-%COMP%]   .use-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;background:#f0f0f0;display:flex;align-items:center;justify-content:center}.use-item[_ngcontent-%COMP%]   .use-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#666;width:24px;height:24px}.use-item[_ngcontent-%COMP%]   .use-label[_ngcontent-%COMP%]{font-size:12px;color:#333;text-align:center}.use-item[_ngcontent-%COMP%]   .use-points[_ngcontent-%COMP%]{font-size:11px;color:#f44;font-weight:600}.exchange-notice[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:16px;background:#f8f9fa;border-radius:8px;color:#666;font-size:13px}.exchange-notice[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;color:#999}.history-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.history-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;background:#f8f9fa;border-radius:8px;transition:background-color .2s}.history-item[_ngcontent-%COMP%]:active{background-color:#f0f0f0}.history-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;flex:1}.history-info[_ngcontent-%COMP%]   .history-desc[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333}.history-info[_ngcontent-%COMP%]   .history-date[_ngcontent-%COMP%]{font-size:12px;color:#999}.history-amount[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.history-amount.earn[_ngcontent-%COMP%]{color:#4caf50}.history-amount.use[_ngcontent-%COMP%]{color:#f44}.history-empty[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px}.history-empty[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#ddd;margin-bottom:16px}.history-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#999;margin:0}']})};function Lu(r,t){if(r&1&&(o(0,"span",29),c(1),L(2,"number"),a()),r&2){let e=g(3);l(),S(" ",J(2,1,e.syncStatus.serverPoints),"P ")}}function Nu(r,t){r&1&&(o(0,"span",34),c(1," \uC870\uD68C\uC911... "),a())}function ju(r,t){if(r&1&&(o(0,"span",35),c(1),a()),r&2){let e=g(3);l(),S(" ",e.serverPointsError," ")}}function Uu(r,t){if(r&1&&(o(0,"div",27)(1,"span",28),c(2,"\uCC28\uC774"),a(),o(3,"span",29),c(4),a()()),r&2){let e=g(3);l(3),k("positive",e.syncStatus.difference>0)("negative",e.syncStatus.difference<0),l(),ue(" ",e.syncStatus.difference>0?"+":"","",e.syncStatus.difference,"P ")}}function $u(r,t){if(r&1&&(o(0,"div",27)(1,"span",28),c(2,"\uB9C8\uC9C0\uB9C9 \uB3D9\uAE30\uD654"),a(),o(3,"span",36),c(4),a()()),r&2){let e=g(3);l(4),x(e.formatTimestamp(e.syncStatus.lastSyncAt))}}function Hu(r,t){if(r&1&&(o(0,"div",24)(1,"div",17)(2,"span",18),c(3,"\u{1F504}"),a(),o(4,"span",19),c(5,"\uB3D9\uAE30\uD654 \uC0C1\uD0DC"),a(),o(6,"span",25),c(7),a()(),o(8,"div",26)(9,"div",27)(10,"span",28),c(11,"\uB85C\uCEEC"),a(),o(12,"span",29),c(13),L(14,"number"),a()(),o(15,"div",27)(16,"span",28),c(17,"\uC11C\uBC84"),a(),b(18,Lu,3,3,"span",30)(19,Nu,2,0,"span",31)(20,ju,2,1,"span",32),a(),b(21,Uu,5,6,"div",33)(22,$u,5,1,"div",33),a()()),r&2){let e=g(2);l(6),p("ngClass",e.getSyncStateClass(e.syncStatus.syncState)),l(),S(" ",e.getSyncStateLabel(e.syncStatus.syncState)," "),l(6),S("",J(14,8,e.syncStatus.localPoints),"P"),l(5),p("ngIf",e.syncStatus.serverPoints!==null),l(),p("ngIf",e.syncStatus.serverPoints===null&&e.isLoadingServerPoints),l(),p("ngIf",e.syncStatus.serverPoints===null&&e.serverPointsError),l(),p("ngIf",e.syncStatus.difference!==0),l(),p("ngIf",e.syncStatus.lastSyncAt)}}function Wu(r,t){if(r&1&&(o(0,"span",45),c(1),a()),r&2){let e=g().$implicit,n=g(2);k("positive",e.delta>0)("negative",e.delta<0),l(),S(" ",n.formatDelta(e.delta),"P ")}}function Ku(r,t){if(r&1&&(o(0,"div",37)(1,"div",38),c(2),a(),o(3,"div",39)(4,"div",40),c(5),a(),o(6,"div",41)(7,"span",42),c(8),a(),b(9,Wu,2,5,"span",43),a()(),o(10,"div",44),c(11),a()()),r&2){let e=t.$implicit,n=g(2);l(2),x(n.getSourceIcon(e.source)),l(3),x(e.message),l(3),x(n.formatTimestamp(e.timestamp)),l(),p("ngIf",e.delta),l(),k("success",e.success)("error",!e.success),l(),S(" ",e.success?"\u2713":"\u2717"," ")}}function Gu(r,t){r&1&&(o(0,"div",46),c(1," \uC544\uC9C1 \uAE30\uB85D\uB41C \uD65C\uB3D9\uC774 \uC5C6\uC2B5\uB2C8\uB2E4. "),a())}function Yu(r,t){if(r&1){let e=y();o(0,"div",10)(1,"div",11)(2,"div",12),c(3,"\uD604\uC7AC \uD3EC\uC778\uD2B8"),a(),o(4,"div",13),c(5),L(6,"number"),a(),o(7,"div",14),c(8),a()(),b(9,Hu,23,10,"div",15),o(10,"div",16)(11,"div",17)(12,"span",18),c(13,"\u{1F4CB}"),a(),o(14,"span",19),c(15,"\uCD5C\uADFC \uD65C\uB3D9"),a(),o(16,"button",20),u("click",function(){m(e);let i=g();return f(i.setTab("logs"))}),c(17,"\uC804\uCCB4 \uBCF4\uAE30"),a()(),o(18,"div",21),b(19,Ku,12,9,"div",22)(20,Gu,2,0,"div",23),a()()()}if(r&2){let e=g();l(5),S("",J(6,6,e.totalPoints),"P"),l(3),ue("\uC624\uB298 ",e.todayPoints,"/",e.maxDailyPoints," \uD68D\uB4DD"),l(),p("ngIf",e.syncStatus),l(10),p("ngForOf",e.logs.slice(0,5)),l(),p("ngIf",e.logs.length===0)}}function qu(r,t){if(r&1&&(o(0,"span"),c(1),L(2,"number"),a()),r&2){let e=g(2).$implicit;l(),S("\uC774\uC804: ",J(2,1,e.previousValue),"P")}}function Xu(r,t){if(r&1&&(o(0,"span"),c(1),L(2,"number"),a()),r&2){let e=g(2).$implicit;l(),S("\u2192 \uD604\uC7AC: ",J(2,1,e.newValue),"P")}}function Ju(r,t){if(r&1&&(o(0,"span",45),c(1),a()),r&2){let e=g(2).$implicit,n=g(2);k("positive",e.delta>0)("negative",e.delta<0),l(),S(" (",n.formatDelta(e.delta),"P) ")}}function Zu(r,t){if(r&1&&(o(0,"div",76),b(1,qu,3,3,"span",77)(2,Xu,3,3,"span",77)(3,Ju,2,5,"span",43),a()),r&2){let e=g().$implicit;l(),p("ngIf",e.previousValue!==void 0),l(),p("ngIf",e.newValue!==void 0),l(),p("ngIf",e.delta)}}function Qu(r,t){if(r&1&&(o(0,"span"),c(1),a()),r&2){let e=g(2).$implicit;l(),ue("(",e.documentInfo.page,"/",e.documentInfo.totalPages,"\uD398\uC774\uC9C0)")}}function em(r,t){if(r&1&&(o(0,"div",78),c(1),b(2,Qu,2,2,"span",77),a()),r&2){let e=g().$implicit;l(),S(" \u{1F4C4} ",e.documentInfo.name," "),l(),p("ngIf",e.documentInfo.page)}}function tm(r,t){if(r&1&&(o(0,"span",81),c(1),a()),r&2){let e=g(2).$implicit;l(),S("- ",e.apiResponse.errorMessage)}}function nm(r,t){if(r&1&&(o(0,"div",79),c(1),b(2,tm,2,1,"span",80),a()),r&2){let e=g().$implicit;l(),S(" \u{1F310} ",e.apiResponse.endpoint," "),l(),p("ngIf",e.apiResponse.errorMessage)}}function im(r,t){if(r&1&&(o(0,"div",37)(1,"div",67)(2,"span",38),c(3),a(),o(4,"span",68),c(5),a(),o(6,"span",69),c(7),a(),o(8,"span",70),c(9),a()(),o(10,"div",40),c(11),a(),b(12,Zu,4,3,"div",71)(13,em,3,2,"div",72)(14,nm,3,2,"div",73),o(15,"div",74)(16,"span",42),c(17),a(),o(18,"span",75),c(19),a()()()),r&2){let e=t.$implicit,n=g(2);k("error-item",!e.success),l(3),x(n.getSourceIcon(e.source)),l(2),x(n.getSourceLabel(e.source)),l(2),x(n.getActionLabel(e.action)),l(),k("success",e.success)("error",!e.success),l(),S(" ",e.success?"\uC131\uACF5":"\uC2E4\uD328"," "),l(2),x(e.message),l(),p("ngIf",e.previousValue!==void 0||e.newValue!==void 0),l(),p("ngIf",e.documentInfo),l(),p("ngIf",e.apiResponse),l(3),x(n.formatTimestamp(e.timestamp)),l(2),S("ID: ",e.id.substring(0,8))}}function om(r,t){r&1&&(o(0,"div",46),c(1," \uD544\uD130 \uC870\uAC74\uC5D0 \uB9DE\uB294 \uB85C\uADF8\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. "),a())}function rm(r,t){if(r&1){let e=y();o(0,"div",10)(1,"div",47)(2,"select",48),u("change",function(i){m(e);let s=g();return f(s.onSourceChange(i.target.value))}),o(3,"option",49),c(4,"\uBAA8\uB4E0 \uC18C\uC2A4"),a(),o(5,"option",50),c(6,"API"),a(),o(7,"option",51),c(8,"\uBDF0\uC5B4"),a(),o(9,"option",52),c(10,"\uB85C\uCEEC"),a(),o(11,"option",53),c(12,"Android"),a()(),o(13,"select",48),u("change",function(i){m(e);let s=g();return f(s.onActionChange(i.target.value))}),o(14,"option",49),c(15,"\uBAA8\uB4E0 \uC791\uC5C5"),a(),o(16,"option",54),c(17,"\uCD08\uAE30\uD654"),a(),o(18,"option",55),c(19,"\uC77D\uAE30"),a(),o(20,"option",56),c(21,"\uC870\uD68C"),a(),o(22,"option",57),c(23,"\uD68D\uB4DD"),a(),o(24,"option",58),c(25,"\uC0AC\uC6A9"),a(),o(26,"option",59),c(27,"\uB3D9\uAE30\uD654"),a(),o(28,"option",60),c(29,"\uC5D0\uB7EC"),a()(),o(30,"label",61)(31,"input",62),u("change",function(i){m(e);let s=g();return f(s.onErrorFilterChange(i.target.checked))}),a(),c(32," \uC5D0\uB7EC\uB9CC "),a()(),o(33,"div",63),b(34,im,20,16,"div",64)(35,om,2,0,"div",23),a(),o(36,"div",65)(37,"button",66),u("click",function(){m(e);let i=g();return f(i.clearLogs())}),c(38," \u{1F5D1}\uFE0F \uBAA8\uB4E0 \uB85C\uADF8 \uC0AD\uC81C "),a()()()}if(r&2){let e=g();l(31),p("checked",e.showOnlyErrors),l(3),p("ngForOf",e.filteredLogs),l(),p("ngIf",e.filteredLogs.length===0)}}function am(r,t){if(r&1&&(o(0,"div",83)(1,"div",84)(2,"div",85),c(3,"\u{1F4CA} \uC694\uC57D"),a(),o(4,"div",86)(5,"span"),c(6,"\uC804\uCCB4 \uB85C\uADF8"),a(),o(7,"span"),c(8),a()(),o(9,"div",86)(10,"span"),c(11,"\uC624\uB298 \uB85C\uADF8"),a(),o(12,"span"),c(13),a()(),o(14,"div",87)(15,"span"),c(16,"\uC5D0\uB7EC"),a(),o(17,"span"),c(18),a()()(),o(19,"div",88)(20,"div",85),c(21,"\u{1F4B0} \uD3EC\uC778\uD2B8 \uBCC0\uB3D9"),a(),o(22,"div",89)(23,"span"),c(24,"\uCD1D \uD68D\uB4DD"),a(),o(25,"span"),c(26),L(27,"number"),a()(),o(28,"div",90)(29,"span"),c(30,"\uCD1D \uC0AC\uC6A9"),a(),o(31,"span"),c(32),L(33,"number"),a()(),o(34,"div",91)(35,"span"),c(36,"\uC21C \uBCC0\uB3D9"),a(),o(37,"span"),c(38),L(39,"number"),a()()(),o(40,"div",92)(41,"div",85),c(42,"\u{1F4CC} \uC18C\uC2A4\uBCC4"),a(),o(43,"div",86)(44,"span"),c(45,"\u{1F310} API"),a(),o(46,"span"),c(47),a()(),o(48,"div",86)(49,"span"),c(50,"\u{1F4D6} \uBDF0\uC5B4"),a(),o(51,"span"),c(52),a()(),o(53,"div",86)(54,"span"),c(55,"\u{1F4BE} \uB85C\uCEEC"),a(),o(56,"span"),c(57),a()(),o(58,"div",86)(59,"span"),c(60,"\u{1F4F1} Android"),a(),o(61,"span"),c(62),a()()(),o(63,"div",93)(64,"div",85),c(65,"\u26A1 \uC791\uC5C5\uBCC4"),a(),o(66,"div",86)(67,"span"),c(68,"\u2795 \uD68D\uB4DD"),a(),o(69,"span"),c(70),a()(),o(71,"div",86)(72,"span"),c(73,"\u2796 \uC0AC\uC6A9"),a(),o(74,"span"),c(75),a()(),o(76,"div",86)(77,"span"),c(78,"\u{1F4E5} \uC870\uD68C"),a(),o(79,"span"),c(80),a()(),o(81,"div",86)(82,"span"),c(83,"\u{1F4D6} \uC77D\uAE30"),a(),o(84,"span"),c(85),a()(),o(86,"div",86)(87,"span"),c(88,"\u{1F501} \uB3D9\uAE30\uD654"),a(),o(89,"span"),c(90),a()(),o(91,"div",86)(92,"span"),c(93,"\u274C \uC5D0\uB7EC"),a(),o(94,"span"),c(95),a()()()()),r&2){let e=g(2);l(8),S("",e.stats.totalLogs,"\uAC74"),l(5),S("",e.stats.todayLogs,"\uAC74"),l(5),S("",e.stats.errorCount,"\uAC74"),l(8),S("+",J(27,21,e.stats.totalEarned),"P"),l(6),S("-",J(33,23,e.stats.totalUsed),"P"),l(5),k("positive",e.stats.totalEarned-e.stats.totalUsed>0)("negative",e.stats.totalEarned-e.stats.totalUsed<0),l(),ue(" ",e.stats.totalEarned-e.stats.totalUsed>0?"+":"","",J(39,25,e.stats.totalEarned-e.stats.totalUsed),"P "),l(9),S("",e.stats.bySource.api||0,"\uAC74"),l(5),S("",e.stats.bySource.viewer||0,"\uAC74"),l(5),S("",e.stats.bySource.local||0,"\uAC74"),l(5),S("",e.stats.bySource.android||0,"\uAC74"),l(8),S("",e.stats.byAction.earn||0,"\uAC74"),l(5),S("",e.stats.byAction.use||0,"\uAC74"),l(5),S("",e.stats.byAction.fetch||0,"\uAC74"),l(5),S("",e.stats.byAction.read||0,"\uAC74"),l(5),S("",e.stats.byAction.sync||0,"\uAC74"),l(5),S("",e.stats.byAction.error||0,"\uAC74")}}function sm(r,t){if(r&1&&(o(0,"div",10),b(1,am,96,27,"div",82),a()),r&2){let e=g();l(),p("ngIf",e.stats)}}var Mi=class r{currentTab="overview";totalPoints=0;todayPoints=0;maxDailyPoints=5;syncStatus=null;logs=[];filteredLogs=[];selectedSource="all";selectedAction="all";showOnlyErrors=!1;stats=null;isLoadingServerPoints=!1;serverPointsError=null;logsSubscription;syncStatusSubscription;pointsSubscription;todayPointsSubscription;pointsService=P(Ue);syncLogService=P(Jt);pointsApiService=P(st);navigationHistory=P(Fe);router=P(N);ngOnInit(){this.pointsSubscription=this.pointsService.totalPoints$.subscribe(t=>this.totalPoints=t),this.todayPointsSubscription=this.pointsService.todayPoints$.subscribe(t=>this.todayPoints=t),this.maxDailyPoints=this.pointsService.getMaxDailyPoints(),this.logsSubscription=this.syncLogService.logs$.subscribe(t=>{this.logs=t,this.applyFilters()}),this.syncStatusSubscription=this.syncLogService.syncStatus$.subscribe(t=>this.syncStatus=t),this.loadStats(),this.fetchServerPoints()}ngOnDestroy(){this.logsSubscription?.unsubscribe(),this.syncStatusSubscription?.unsubscribe(),this.pointsSubscription?.unsubscribe(),this.todayPointsSubscription?.unsubscribe()}setTab(t){this.currentTab=t,t==="stats"&&this.loadStats()}fetchServerPoints(){this.isLoadingServerPoints=!0,this.serverPointsError=null,this.pointsApiService.getTotalPoints().subscribe({next:t=>{this.isLoadingServerPoints=!1,this.syncLogService.updateSyncStatus(this.totalPoints,t),this.syncLogService.logApiFetch(!0,t)},error:t=>{this.isLoadingServerPoints=!1,this.serverPointsError=t?.message||"\uC11C\uBC84 \uC5F0\uACB0 \uC2E4\uD328",this.syncLogService.logApiFetch(!1,void 0,this.serverPointsError||void 0)}})}applyFilters(){let t={};this.selectedSource!=="all"&&(t.source=this.selectedSource),this.selectedAction!=="all"&&(t.action=this.selectedAction),this.showOnlyErrors&&(t.success=!1),this.filteredLogs=this.syncLogService.getFilteredLogs(t)}onSourceChange(t){this.selectedSource=t,this.applyFilters()}onActionChange(t){this.selectedAction=t,this.applyFilters()}onErrorFilterChange(t){this.showOnlyErrors=t,this.applyFilters()}loadStats(){this.stats=this.syncLogService.getStats()}getSourceLabel(t){return{api:"API",viewer:"\uBDF0\uC5B4",local:"\uB85C\uCEEC",android:"Android"}[t]||t}getSourceIcon(t){return{api:"\u{1F310}",viewer:"\u{1F4D6}",local:"\u{1F4BE}",android:"\u{1F4F1}"}[t]||"\u{1F4CC}"}getActionLabel(t){return{init:"\uCD08\uAE30\uD654",read:"\uC77D\uAE30",fetch:"\uC870\uD68C",earn:"\uD68D\uB4DD",use:"\uC0AC\uC6A9",sync:"\uB3D9\uAE30\uD654",reset:"\uB9AC\uC14B",error:"\uC5D0\uB7EC"}[t]||t}getActionIcon(t){return{init:"\u{1F504}",read:"\u{1F4D6}",fetch:"\u{1F4E5}",earn:"\u2795",use:"\u2796",sync:"\u{1F501}",reset:"\u{1F5D1}\uFE0F",error:"\u274C"}[t]||"\u{1F4CC}"}formatTimestamp(t){return new Date(t).toLocaleString("ko-KR",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}formatDelta(t){return t===void 0?"":t>0?`+${t}`:`${t}`}getSyncStateLabel(t){return{synced:"\uB3D9\uAE30\uD654\uB428",pending:"\uB300\uAE30\uC911",conflict:"\uCDA9\uB3CC",error:"\uC5D0\uB7EC"}[t]||t}getSyncStateClass(t){return{synced:"state-synced",pending:"state-pending",conflict:"state-conflict",error:"state-error"}[t]||""}clearLogs(){confirm("\uBAA8\uB4E0 \uB85C\uADF8\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?")&&(this.syncLogService.clearLogs(),this.loadStats())}goBack(){this.navigationHistory.goBack()}navigateToProfile(){this.router.navigate(["/ezm/profile"])}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-point-info"]],standalone:!1,decls:20,vars:12,consts:[[1,"point-info-container"],[1,"point-info-header"],[1,"back-btn",3,"click"],[1,"back-icon"],[1,"header-title"],[1,"refresh-btn",3,"click","disabled"],[1,"refresh-icon"],[1,"tab-menu"],[1,"tab-btn",3,"click"],["class","tab-content",4,"ngIf"],[1,"tab-content"],[1,"point-card"],[1,"point-label"],[1,"point-value"],[1,"point-sub"],["class","sync-status-card",4,"ngIf"],[1,"recent-logs-card"],[1,"card-header"],[1,"card-icon"],[1,"card-title"],[1,"view-all-btn",3,"click"],[1,"log-list","preview"],["class","log-item",4,"ngFor","ngForOf"],["class","empty-message",4,"ngIf"],[1,"sync-status-card"],[1,"sync-state",3,"ngClass"],[1,"sync-info-grid"],[1,"sync-info-item"],[1,"info-label"],[1,"info-value"],["class","info-value",4,"ngIf"],["class","info-value info-loading",4,"ngIf"],["class","info-value info-error",4,"ngIf"],["class","sync-info-item",4,"ngIf"],[1,"info-value","info-loading"],[1,"info-value","info-error"],[1,"info-value","info-time"],[1,"log-item"],[1,"log-icon"],[1,"log-content"],[1,"log-message"],[1,"log-meta"],[1,"log-time"],["class","log-delta",3,"positive","negative",4,"ngIf"],[1,"log-status"],[1,"log-delta"],[1,"empty-message"],[1,"filter-bar"],[1,"filter-select",3,"change"],["value","all"],["value","api"],["value","viewer"],["value","local"],["value","android"],["value","init"],["value","read"],["value","fetch"],["value","earn"],["value","use"],["value","sync"],["value","error"],[1,"error-filter"],["type","checkbox",3,"change","checked"],[1,"log-list","full"],["class","log-item",3,"error-item",4,"ngFor","ngForOf"],[1,"log-actions"],[1,"clear-logs-btn",3,"click"],[1,"log-header"],[1,"log-source"],[1,"log-action"],[1,"log-status-badge"],["class","log-details",4,"ngIf"],["class","log-document",4,"ngIf"],["class","log-api",4,"ngIf"],[1,"log-footer"],[1,"log-id"],[1,"log-details"],[4,"ngIf"],[1,"log-document"],[1,"log-api"],["class","api-error",4,"ngIf"],[1,"api-error"],["class","stats-grid",4,"ngIf"],[1,"stats-grid"],[1,"stat-card","summary"],[1,"stat-header"],[1,"stat-row"],[1,"stat-row","error"],[1,"stat-card","points"],[1,"stat-row","positive"],[1,"stat-row","negative"],[1,"stat-row","net"],[1,"stat-card","sources"],[1,"stat-card","actions"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"button",2),u("click",function(){return n.goBack()}),o(3,"span",3),c(4,"\u2190"),a()(),o(5,"h1",4),c(6,"\uD3EC\uC778\uD2B8 \uC815\uBCF4"),a(),o(7,"button",5),u("click",function(){return n.fetchServerPoints()}),o(8,"span",6),c(9,"\u21BB"),a()()(),o(10,"div",7)(11,"button",8),u("click",function(){return n.setTab("overview")}),c(12," \uAC1C\uC694 "),a(),o(13,"button",8),u("click",function(){return n.setTab("logs")}),c(14," \uB3D9\uAE30\uD654 \uB85C\uADF8 "),a(),o(15,"button",8),u("click",function(){return n.setTab("stats")}),c(16," \uD1B5\uACC4 "),a()(),b(17,Yu,21,8,"div",9)(18,rm,39,3,"div",9)(19,sm,2,1,"div",9),a()),e&2&&(l(7),p("disabled",n.isLoadingServerPoints),l(),k("spinning",n.isLoadingServerPoints),l(3),k("active",n.currentTab==="overview"),l(2),k("active",n.currentTab==="logs"),l(2),k("active",n.currentTab==="stats"),l(2),p("ngIf",n.currentTab==="overview"),l(),p("ngIf",n.currentTab==="logs"),l(),p("ngIf",n.currentTab==="stats"))},dependencies:[Ze,oe,B,Ve,Le,Te],styles:['.point-info-container[_ngcontent-%COMP%]{min-height:100vh;background:#f5f5f5;padding-bottom:80px}.point-info-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px;background:#fff;border-bottom:1px solid #e0e0e0;position:sticky;top:0;z-index:100}.point-info-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%], .point-info-header[_ngcontent-%COMP%]   .refresh-btn[_ngcontent-%COMP%]{width:40px;height:40px;border:none;background:transparent;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:20px;color:#333;transition:background .2s}.point-info-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:hover, .point-info-header[_ngcontent-%COMP%]   .refresh-btn[_ngcontent-%COMP%]:hover{background:#f0f0f0}.point-info-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]:disabled, .point-info-header[_ngcontent-%COMP%]   .refresh-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.point-info-header[_ngcontent-%COMP%]   .refresh-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}.point-info-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.tab-menu[_ngcontent-%COMP%]{display:flex;background:#fff;border-bottom:1px solid #e0e0e0}.tab-menu[_ngcontent-%COMP%]   .tab-btn[_ngcontent-%COMP%]{flex:1;padding:14px;border:none;background:transparent;font-size:14px;font-weight:500;color:#666;cursor:pointer;position:relative;transition:color .2s}.tab-menu[_ngcontent-%COMP%]   .tab-btn.active[_ngcontent-%COMP%]{color:#1976d2}.tab-menu[_ngcontent-%COMP%]   .tab-btn.active[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;right:0;height:2px;background:#1976d2}.tab-content[_ngcontent-%COMP%]{padding:16px}.point-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1976d2,#1565c0);border-radius:16px;padding:24px;color:#fff;text-align:center;margin-bottom:16px}.point-card[_ngcontent-%COMP%]   .point-label[_ngcontent-%COMP%]{font-size:14px;opacity:.9;margin-bottom:8px}.point-card[_ngcontent-%COMP%]   .point-value[_ngcontent-%COMP%]{font-size:36px;font-weight:700;margin-bottom:8px}.point-card[_ngcontent-%COMP%]   .point-sub[_ngcontent-%COMP%]{font-size:13px;opacity:.8}.sync-status-card[_ngcontent-%COMP%], .recent-logs-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;margin-bottom:16px;box-shadow:0 1px 3px #0000001a}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:12px}.card-header[_ngcontent-%COMP%]   .card-icon[_ngcontent-%COMP%]{font-size:18px}.card-header[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;flex:1}.card-header[_ngcontent-%COMP%]   .sync-state[_ngcontent-%COMP%]{font-size:12px;padding:4px 10px;border-radius:12px;font-weight:500}.card-header[_ngcontent-%COMP%]   .sync-state.state-synced[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.card-header[_ngcontent-%COMP%]   .sync-state.state-pending[_ngcontent-%COMP%]{background:#fff3e0;color:#f57c00}.card-header[_ngcontent-%COMP%]   .sync-state.state-conflict[_ngcontent-%COMP%]{background:#fce4ec;color:#c2185b}.card-header[_ngcontent-%COMP%]   .sync-state.state-error[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.card-header[_ngcontent-%COMP%]   .view-all-btn[_ngcontent-%COMP%]{font-size:13px;color:#1976d2;background:none;border:none;cursor:pointer;padding:4px 8px}.sync-info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.sync-info-grid[_ngcontent-%COMP%]   .sync-info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.sync-info-grid[_ngcontent-%COMP%]   .sync-info-item[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-size:12px;color:#666}.sync-info-grid[_ngcontent-%COMP%]   .sync-info-item[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#333}.sync-info-grid[_ngcontent-%COMP%]   .sync-info-item[_ngcontent-%COMP%]   .info-value.positive[_ngcontent-%COMP%]{color:#2e7d32}.sync-info-grid[_ngcontent-%COMP%]   .sync-info-item[_ngcontent-%COMP%]   .info-value.negative[_ngcontent-%COMP%]{color:#c62828}.sync-info-grid[_ngcontent-%COMP%]   .sync-info-item[_ngcontent-%COMP%]   .info-value.info-loading[_ngcontent-%COMP%]{color:#666;font-weight:400}.sync-info-grid[_ngcontent-%COMP%]   .sync-info-item[_ngcontent-%COMP%]   .info-value.info-error[_ngcontent-%COMP%]{color:#c62828;font-weight:400;font-size:13px}.sync-info-grid[_ngcontent-%COMP%]   .sync-info-item[_ngcontent-%COMP%]   .info-value.info-time[_ngcontent-%COMP%]{font-size:13px;font-weight:400}.log-list.preview[_ngcontent-%COMP%]   .log-item[_ngcontent-%COMP%]{padding:10px 0;border-bottom:1px solid #f0f0f0}.log-list.preview[_ngcontent-%COMP%]   .log-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.log-list.full[_ngcontent-%COMP%]   .log-item[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:12px;margin-bottom:8px;box-shadow:0 1px 2px #0000000d}.log-list.full[_ngcontent-%COMP%]   .log-item.error-item[_ngcontent-%COMP%]{border-left:3px solid #c62828}.log-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px}.log-item[_ngcontent-%COMP%]   .log-icon[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0}.log-item[_ngcontent-%COMP%]   .log-content[_ngcontent-%COMP%]{flex:1;min-width:0}.log-item[_ngcontent-%COMP%]   .log-content[_ngcontent-%COMP%]   .log-message[_ngcontent-%COMP%]{font-size:14px;color:#333;line-height:1.4;word-break:break-word}.log-item[_ngcontent-%COMP%]   .log-content[_ngcontent-%COMP%]   .log-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:4px}.log-item[_ngcontent-%COMP%]   .log-content[_ngcontent-%COMP%]   .log-meta[_ngcontent-%COMP%]   .log-time[_ngcontent-%COMP%]{font-size:12px;color:#999}.log-item[_ngcontent-%COMP%]   .log-content[_ngcontent-%COMP%]   .log-meta[_ngcontent-%COMP%]   .log-delta[_ngcontent-%COMP%]{font-size:12px;font-weight:600}.log-item[_ngcontent-%COMP%]   .log-content[_ngcontent-%COMP%]   .log-meta[_ngcontent-%COMP%]   .log-delta.positive[_ngcontent-%COMP%]{color:#2e7d32}.log-item[_ngcontent-%COMP%]   .log-content[_ngcontent-%COMP%]   .log-meta[_ngcontent-%COMP%]   .log-delta.negative[_ngcontent-%COMP%]{color:#c62828}.log-item[_ngcontent-%COMP%]   .log-status[_ngcontent-%COMP%]{font-size:14px;flex-shrink:0}.log-item[_ngcontent-%COMP%]   .log-status.success[_ngcontent-%COMP%]{color:#2e7d32}.log-item[_ngcontent-%COMP%]   .log-status.error[_ngcontent-%COMP%]{color:#c62828}.log-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.log-header[_ngcontent-%COMP%]   .log-source[_ngcontent-%COMP%], .log-header[_ngcontent-%COMP%]   .log-action[_ngcontent-%COMP%]{font-size:12px;padding:2px 6px;border-radius:4px;background:#f5f5f5;color:#666}.log-header[_ngcontent-%COMP%]   .log-status-badge[_ngcontent-%COMP%]{font-size:11px;padding:2px 8px;border-radius:10px;margin-left:auto}.log-header[_ngcontent-%COMP%]   .log-status-badge.success[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.log-header[_ngcontent-%COMP%]   .log-status-badge.error[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.log-details[_ngcontent-%COMP%], .log-document[_ngcontent-%COMP%], .log-api[_ngcontent-%COMP%]{font-size:13px;color:#666;margin-top:6px}.log-document[_ngcontent-%COMP%]{background:#f5f5f5;padding:6px 10px;border-radius:6px}.log-api[_ngcontent-%COMP%]   .api-error[_ngcontent-%COMP%]{color:#c62828}.log-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:8px;font-size:11px;color:#999}.filter-bar[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap}.filter-bar[_ngcontent-%COMP%]   .filter-select[_ngcontent-%COMP%]{flex:1;min-width:100px;padding:8px 12px;border:1px solid #ddd;border-radius:8px;font-size:13px;background:#fff;color:#333}.filter-bar[_ngcontent-%COMP%]   .error-filter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:13px;color:#666;padding:0 8px}.filter-bar[_ngcontent-%COMP%]   .error-filter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:16px;height:16px}.log-actions[_ngcontent-%COMP%]{margin-top:16px;text-align:center}.log-actions[_ngcontent-%COMP%]   .clear-logs-btn[_ngcontent-%COMP%]{padding:10px 20px;border:1px solid #ddd;border-radius:8px;background:#fff;color:#666;font-size:14px;cursor:pointer}.log-actions[_ngcontent-%COMP%]   .clear-logs-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5;border-color:#ccc}.stats-grid[_ngcontent-%COMP%]{display:grid;gap:12px}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;box-shadow:0 1px 3px #0000001a}.stat-card[_ngcontent-%COMP%]   .stat-header[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#333;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid #f0f0f0}.stat-card[_ngcontent-%COMP%]   .stat-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;font-size:14px;color:#666}.stat-card[_ngcontent-%COMP%]   .stat-row.positive[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:#2e7d32;font-weight:600}.stat-card[_ngcontent-%COMP%]   .stat-row.negative[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:#c62828;font-weight:600}.stat-card[_ngcontent-%COMP%]   .stat-row.error[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:#c62828}.stat-card[_ngcontent-%COMP%]   .stat-row.net[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-weight:700}.empty-message[_ngcontent-%COMP%]{text-align:center;padding:24px;color:#999;font-size:14px}@media (min-width: 600px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}']})};function lm(r,t){r&1&&h(0,"img",24)}function cm(r,t){if(r&1&&h(0,"img",25),r&2){let e=g().$implicit;p("src",e.thumbnail,ce)}}function dm(r,t){r&1&&h(0,"img",26)}function pm(r,t){if(r&1){let e=y();o(0,"div",14)(1,"div",15),b(2,lm,1,0,"img",16)(3,cm,1,1,"img",17)(4,dm,1,0,"img",18),a(),o(5,"div",19)(6,"span",20),c(7),a(),o(8,"span",21),c(9),a()(),o(10,"div",22),u("touchstart",function(i){let s=m(e).index,d=g();return f(d.onTouchStart(i,s))})("touchmove",function(i){m(e);let s=g();return f(s.onTouchMove(i))})("touchend",function(i){m(e);let s=g();return f(s.onTouchEnd(i))}),h(11,"img",23),a()()}if(r&2){let e=t.$implicit,n=t.index,i=g();k("dragging",i.draggingIndex===n)("drop-target",i.dropTargetIndex===n&&i.draggingIndex!==n),l(2),p("ngIf",e.isEncrypted),l(),p("ngIf",!e.isEncrypted&&e.thumbnail),l(),p("ngIf",!e.isEncrypted&&!e.thumbnail),l(3),x(e.fileName),l(2),ue("",e.createdAt," \xB7 ",e.fileSize)}}function gm(r,t){r&1&&(o(0,"span"),c(1,"\uBCD1\uD569\uD558\uAE30"),a())}function um(r,t){r&1&&(o(0,"span"),c(1,"\uCC98\uB9AC \uC911..."),a())}var yi=class r{files=[];isDragging=!1;draggingIndex=-1;dropTargetIndex=-1;touchStartY=0;touchCurrentY=0;dragThreshold=10;hasMoved=!1;dragPreviewElement=null;isProcessing=!1;isComplete=!1;isFailed=!1;processingTitle="\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.";processingSubtitle="";savedDocId="";savedFolderId=null;savedDocument=null;router=P(N);indexedDbService=P(ee);snackbar=P(G);toolActionService=P(le);pdfPasswordService=P(Ke);cdr=P(fe);constructor(){}ngOnInit(){return C(this,null,function*(){let t=this.toolActionService.getPendingAction();if(t&&t.data?.documents){let n=t.data.documents;if(n.length>=2){yield this.loadDocumentsFromData(n),this.toolActionService.clearPendingAction();return}}let e=history.state;if(e?.documentIds&&e.documentIds.length>=2){let n=e.documentIds;e.folderId&&(this.savedFolderId=e.folderId),yield this.loadDocuments(n),this.files.length<2&&(this.snackbar.showWarning("\uBCD1\uD569\uD560 \uD30C\uC77C\uC744 \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin())}else this.snackbar.showWarning("\uBCD1\uD569\uD560 \uD30C\uC77C\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694."),this.toolActionService.navigateToOrigin()})}loadDocumentsFromData(t){return C(this,null,function*(){try{this.files=t.map(e=>({docId:e.id,fileName:e.fileName||e.title||"\uD30C\uC77C\uBA85 \uC5C6\uC74C",fileSize:this.formatFileSize(e.pdfBase64?.length||0),createdAt:this.formatDate(e.createdAt),pageCount:e.pageCount||0,thumbnail:e.thumbnail,document:e,isEncrypted:e.isEncrypted===!0||!!e.encryptionMetadata})),t[0]?.folderId&&(this.savedFolderId=t[0].folderId),this.files.length<2&&(this.snackbar.showWarning("\uBCD1\uD569\uD560 \uD30C\uC77C\uC744 \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."),this.toolActionService.navigateToOrigin()),this.cdr.detectChanges()}catch(e){console.error("\uBB38\uC11C \uB85C\uB4DC \uC2E4\uD328:",e),this.snackbar.showError("\uD30C\uC77C\uC744 \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}ngOnDestroy(){this.cleanupDragPreview()}loadDocuments(t){return C(this,null,function*(){try{let e=yield Promise.all(t.map(n=>this.indexedDbService.getDocumentById(n)));this.files=e.filter(n=>n!==void 0).map(n=>({docId:n.id,fileName:n.fileName||n.title||"\uD30C\uC77C\uBA85 \uC5C6\uC74C",fileSize:this.formatFileSize(n.pdfBase64?.length||0),createdAt:this.formatDate(n.createdAt),pageCount:n.pageCount||0,thumbnail:n.thumbnail,document:n,isEncrypted:n.isEncrypted===!0||!!n.encryptionMetadata})),this.cdr.detectChanges()}catch(e){console.error("\uBB38\uC11C \uB85C\uB4DC \uC2E4\uD328:",e),this.snackbar.showError("\uD30C\uC77C\uC744 \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}})}formatFileSize(t){let e=Math.floor(t*.73);return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(2)} MB`}formatDate(t){try{let e=new Date(t),n=e.getFullYear(),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),d=String(e.getHours()).padStart(2,"0"),_=String(e.getMinutes()).padStart(2,"0"),v=String(e.getSeconds()).padStart(2,"0");return`${n}.${i}.${s} ${d}:${_}:${v}`}catch{return t}}goBack(){this.toolActionService.navigateToOrigin()}onTouchStart(t,e){this.files.length<=1||(t.preventDefault(),this.draggingIndex=e,this.touchStartY=t.touches[0].clientY,this.touchCurrentY=this.touchStartY,this.hasMoved=!1,this.createDragPreview(t,e))}onTouchMove(t){if(this.draggingIndex===-1)return;t.preventDefault();let e=t.touches[0];Math.abs(e.clientY-this.touchStartY)>this.dragThreshold&&(this.isDragging=!0,this.hasMoved=!0),this.isDragging&&(this.touchCurrentY=e.clientY,this.updateDragPreview(e.clientY),this.updateDropTarget(e.clientY))}onTouchEnd(t){if(this.draggingIndex!==-1){if(this.hasMoved&&this.dropTargetIndex!==-1&&this.dropTargetIndex!==this.draggingIndex){let[e]=this.files.splice(this.draggingIndex,1);this.files.splice(this.dropTargetIndex,0,e)}this.cleanupDragPreview(),this.isDragging=!1,this.draggingIndex=-1,this.dropTargetIndex=-1,this.hasMoved=!1,this.cdr.detectChanges()}}createDragPreview(t,e){let n=t.target.closest(".file-item");if(!n)return;let i=n.getBoundingClientRect();this.dragPreviewElement=n.cloneNode(!0),this.dragPreviewElement.classList.add("drag-preview"),this.dragPreviewElement.style.position="fixed",this.dragPreviewElement.style.width=`${i.width}px`,this.dragPreviewElement.style.left=`${i.left}px`,this.dragPreviewElement.style.top=`${i.top}px`,this.dragPreviewElement.style.zIndex="9999",this.dragPreviewElement.style.opacity="0.9",this.dragPreviewElement.style.boxShadow="0 8px 24px rgba(0,0,0,0.2)",this.dragPreviewElement.style.pointerEvents="none",this.dragPreviewElement.style.transition="none",document.body.appendChild(this.dragPreviewElement)}updateDragPreview(t){if(!this.dragPreviewElement)return;let e=t-this.touchStartY,n=parseFloat(this.dragPreviewElement.style.top)||0;this.dragPreviewElement.style.transform=`translateY(${e}px)`}updateDropTarget(t){let e=document.querySelectorAll(".file-item:not(.drag-preview)");for(let n=0;n<e.length;n++){if(n===this.draggingIndex)continue;let s=e[n].getBoundingClientRect(),d=s.top+s.height/2;if(t<d){this.dropTargetIndex=n;return}}this.dropTargetIndex=this.files.length-1}cleanupDragPreview(){this.dragPreviewElement&&(this.dragPreviewElement.remove(),this.dragPreviewElement=null)}executeMerge(){return C(this,null,function*(){if(console.log("\u{1F504} [Merge] executeMerge \uD638\uCD9C\uB428, files:",this.files.length),this.files.length<2){this.snackbar.showWarning("\uCD5C\uC18C 2\uAC1C \uC774\uC0C1\uC758 PDF\uAC00 \uD544\uC694\uD569\uB2C8\uB2E4.");return}let t=this.files.filter(e=>e.document.isEncrypted);if(t.length>0){console.log(`\u{1F510} [Merge] \uC554\uD638\uD654\uB41C \uD30C\uC77C ${t.length}\uAC1C \uBC1C\uACAC, \uC554\uD638 \uD655\uC778 \uC2DC\uC791`);let e=yield this.pdfPasswordService.verifyMultiplePasswords(t.map(n=>n.document));if(e.cancelled){this.snackbar.showInfo("\uBCD1\uD569\uC774 \uCDE8\uC18C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.");return}if(!e.allSuccess){let n=e.results.filter(i=>!i.success);this.snackbar.showError(`${n.length}\uAC1C \uD30C\uC77C\uC758 \uC554\uD638 \uD655\uC778\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.`);return}for(let n of e.results)if(n.decryptedBase64){let i=this.files.find(s=>s.docId===n.docId);i&&(i.document.pdfBase64=n.decryptedBase64,i.document.isEncrypted=!1,console.log(`\u2705 [Merge] ${n.fileName} \uBCF5\uD638\uD654 \uC644\uB8CC`))}}this.isProcessing=!0,this.isComplete=!1,this.isFailed=!1,this.processingTitle="\uD30C\uC77C\uC774 \uCC98\uB9AC\uB418\uACE0\uC788\uC2B5\uB2C8\uB2E4.",this.processingSubtitle=`${this.files.length}\uAC1C \uD30C\uC77C\uC744 \uBCD1\uD569 \uC911...`,this.cdr.detectChanges();try{console.log("\u{1F504} [Merge] pdf-lib \uB85C\uB4DC \uC2DC\uC791"),yield this.loadPdfLib();let e=window.PDFLib;if(!e)throw new Error("PDF \uB77C\uC774\uBE0C\uB7EC\uB9AC\uB97C \uBD88\uB7EC\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");console.log("\u2705 [Merge] pdf-lib \uB85C\uB4DC \uC644\uB8CC");let n=yield e.PDFDocument.create(),i=0;for(let M=0;M<this.files.length;M++){let O=this.files[M];console.log(`\u{1F504} [Merge] \uD30C\uC77C ${M+1}/${this.files.length} \uBCD1\uD569 \uC911: ${O.fileName}`);let E=O.document;if(!E.pdfBase64){console.warn(`\u26A0\uFE0F [Merge] \uD30C\uC77C ${O.fileName}\uC5D0 pdfBase64 \uC5C6\uC74C`);continue}let D=this.createBlobUrl(E.pdfBase64);try{let I=yield(yield fetch(D)).arrayBuffer(),z=yield e.PDFDocument.load(I),A=z.getPageCount();(yield n.copyPages(z,Array.from({length:A},(Q,te)=>te))).forEach(Q=>n.addPage(Q)),i+=A,console.log(`\u2705 [Merge] \uD30C\uC77C ${O.fileName}: ${A}\uD398\uC774\uC9C0 \uCD94\uAC00\uB428`)}finally{URL.revokeObjectURL(D)}}if(i===0)throw new Error("\uBCD1\uD569\uD560 \uD398\uC774\uC9C0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");console.log(`\u{1F504} [Merge] \uCD1D ${i}\uD398\uC774\uC9C0 \uBCD1\uD569 \uC644\uB8CC, PDF \uC800\uC7A5 \uC911...`);let s=yield n.save(),d=new Blob([s],{type:"application/pdf"}),_=yield this.blobToBase64(d),v=new Date().toISOString().slice(0,19).replace(/[:-]/g,"").replace("T","_"),w={id:`merged-${Date.now()}`,title:`PDF\uBCD1\uD569_${this.files.length}\uAC1C`,fileName:`PDF\uBCD1\uD569_${this.files.length}\uAC1C_${v}.pdf`,pdfBase64:_,pages:[],elementCount:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),version:"1.0",documentType:"viewer",folderId:this.savedFolderId,pageCount:i};yield this.indexedDbService.saveDocument(w),console.log("\u2705 [Merge] \uBB38\uC11C \uC800\uC7A5 \uC644\uB8CC:",w.id),this.savedDocId=w.id,this.savedDocument=w,this.isProcessing=!1,this.isComplete=!0,this.processingTitle="\uBB38\uC11C\uAC00 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",this.processingSubtitle=`${i}\uAC1C \uD398\uC774\uC9C0\uB85C \uAD6C\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`,this.cdr.detectChanges(),console.log("\u2705 [Merge] \uBCD1\uD569 \uC644\uB8CC!")}catch(e){console.error("\u274C [Merge] PDF \uBCD1\uD569 \uC2E4\uD328:",e),this.isProcessing=!1,this.isFailed=!0,this.processingTitle="\uBCD1\uD569\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.",this.processingSubtitle="\uB2E4\uC2DC \uC2DC\uB3C4\uD574 \uC8FC\uC138\uC694.",this.cdr.detectChanges()}})}loadPdfLib(){return C(this,null,function*(){if(!window.PDFLib)return new Promise((t,e)=>{let n=document.createElement("script");n.src="assets/libs/pdf-lib.min.js",n.onload=()=>{window.PDFLib?t():e(new Error("pdf-lib \uB85C\uB4DC \uC2E4\uD328"))},n.onerror=()=>e(new Error("pdf-lib \uC2A4\uD06C\uB9BD\uD2B8 \uB85C\uB4DC \uC2E4\uD328")),document.head.appendChild(n)})})}createBlobUrl(t){let e=t.includes(",")?t.split(",")[1]:t,n=atob(e),i=new Uint8Array(n.length);for(let d=0;d<n.length;d++)i[d]=n.charCodeAt(d);let s=new Blob([i],{type:"application/pdf"});return URL.createObjectURL(s)}blobToBase64(t){return new Promise((e,n)=>{let i=new FileReader;i.onloadend=()=>e(i.result),i.onerror=n,i.readAsDataURL(t)})}onNavigateToFile(){this.toolActionService.clearPendingAction(),this.savedDocument?this.router.navigate(["/ezm/viewer"],{state:{document:this.savedDocument,mode:"viewer"}}):this.toolActionService.navigateToOrigin()}onRetry(){this.isProcessing=!1,this.isComplete=!1,this.isFailed=!1,this.cdr.detectChanges()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-merge"]],standalone:!1,decls:19,vars:9,consts:[[3,"navigate","retry","isVisible","isComplete","isFailed","title","subtitle"],[1,"header"],[1,"header-left",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"header-center"],[1,"header-right"],[1,"main-content"],[1,"guide-section"],[1,"guide-text"],[1,"file-list"],["class","file-item",3,"dragging","drop-target",4,"ngFor","ngForOf"],[1,"action-section"],[1,"merge-btn",3,"click","disabled"],[4,"ngIf"],[1,"file-item"],[1,"file-thumbnail"],["src","images/icons/ico-tool-main-password.svg","alt","\uC554\uD638\uD654","width","40","height","50",4,"ngIf"],["alt","PDF \uC378\uB124\uC77C","class","thumbnail-image",3,"src",4,"ngIf"],["src","images/icons/ico-pdf.svg","alt","PDF","width","48","height","48",4,"ngIf"],[1,"file-info"],[1,"file-name"],[1,"file-meta"],[1,"drag-handle",3,"touchstart","touchmove","touchend"],["src","images/icons/btn-top-more.svg","alt","\uB4DC\uB798\uADF8","width","24","height","24"],["src","images/icons/ico-tool-main-password.svg","alt","\uC554\uD638\uD654","width","40","height","50"],["alt","PDF \uC378\uB124\uC77C",1,"thumbnail-image",3,"src"],["src","images/icons/ico-pdf.svg","alt","PDF","width","48","height","48"]],template:function(e,n){e&1&&(o(0,"app-processing-modal",0),u("navigate",function(){return n.onNavigateToFile()})("retry",function(){return n.onRetry()}),a(),h(1,"pdf-password-modal"),o(2,"div",1)(3,"button",2),u("click",function(){return n.goBack()}),h(4,"img",3),a(),o(5,"div",4)(6,"h2"),c(7,"PDF \uBCD1\uD569"),a()(),h(8,"div",5),a(),o(9,"div",6)(10,"div",7)(11,"p",8),c(12,"\uC544\uC774\uCF58\uC744 \uB04C\uC5B4\uB193\uAE30\uD558\uC5EC \uC21C\uC11C\uB97C \uBCC0\uACBD\uD574 \uBCF4\uC138\uC694."),a()(),o(13,"div",9),b(14,pm,12,10,"div",10),a()(),o(15,"div",11)(16,"button",12),u("click",function(){return n.executeMerge()}),b(17,gm,2,0,"span",13)(18,um,2,0,"span",13),a()()),e&2&&(p("isVisible",n.isProcessing||n.isComplete||n.isFailed)("isComplete",n.isComplete)("isFailed",n.isFailed)("title",n.processingTitle)("subtitle",n.processingSubtitle),l(14),p("ngForOf",n.files),l(2),p("disabled",n.files.length<2||n.isProcessing),l(),p("ngIf",!n.isProcessing),l(),p("ngIf",n.isProcessing))},dependencies:[oe,B,Ee,kt],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:flex;flex-direction:column;height:calc(100vh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));height:calc(100dvh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);padding-bottom:var(--android-navigation-bar-height, 0px);box-sizing:content-box;background-color:#f8f9fa;overflow:hidden}.header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:#fff;border-bottom:1px solid #e0e0e0;flex-shrink:0;z-index:100}.header-left[_ngcontent-%COMP%], .header-right[_ngcontent-%COMP%]{width:48px;display:flex;align-items:center;justify-content:center}.header-left[_ngcontent-%COMP%]{justify-content:flex-start}.header-left[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none!important;background-color:transparent!important;border:none!important;box-shadow:none!important;outline:none!important;padding:8px;margin:-8px;cursor:pointer;color:#333;display:flex;align-items:center;justify-content:center}.header-left[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, .header-left[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{background:none!important;background-color:transparent!important;border:none!important;box-shadow:none!important;outline:none!important}.header-center[_ngcontent-%COMP%]{flex:1;text-align:center}.header-center[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#333}.main-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px 16px 100px}.guide-section[_ngcontent-%COMP%]{margin-bottom:20px}.guide-text[_ngcontent-%COMP%]{font-size:14px;color:#666;margin:0;text-align:center}.file-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.file-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;background:#fff;border-radius:12px;box-shadow:0 1px 3px #00000014;transition:transform .2s ease,box-shadow .2s ease,opacity .2s ease;position:relative}.file-item.dragging[_ngcontent-%COMP%]{opacity:.4;transform:scale(.98)}.file-item.drop-target[_ngcontent-%COMP%]{border:2px dashed #F86D43;background:#fff5f2}.file-thumbnail[_ngcontent-%COMP%]{flex-shrink:0;width:48px;height:60px;display:flex;align-items:center;justify-content:center;border-radius:4px;overflow:hidden;background:#f5f5f5;position:relative}.thumbnail-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:4px}.file-info[_ngcontent-%COMP%]{flex:1;min-width:0;display:flex;flex-direction:column;gap:4px}.file-name[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.file-meta[_ngcontent-%COMP%]{font-size:12px;color:#999}.drag-handle[_ngcontent-%COMP%]{flex-shrink:0;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:grab;touch-action:none;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}.drag-handle[_ngcontent-%COMP%]:active{cursor:grabbing}[_ngcontent-%COMP%]:global(.drag-preview){background:#fff!important;border-radius:12px!important;box-shadow:0 8px 24px #0003!important}.action-section[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;padding:16px;padding-bottom:calc(16px + env(safe-area-inset-bottom));background:#fff;border-top:1px solid #e0e0e0;z-index:100}.merge-btn[_ngcontent-%COMP%]{width:100%;padding:16px;font-size:16px;font-weight:600;color:#fff;background:#f86d43;border:none;border-radius:12px;cursor:pointer;transition:background-color .2s ease,opacity .2s ease}.merge-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#e55a35}.merge-btn[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed;opacity:.7}.merge-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98)}.drop-indicator[_ngcontent-%COMP%]{position:absolute;left:16px;right:16px;height:3px;background:#f86d43;border-radius:2px;pointer-events:none;z-index:50}@media (max-width: 360px){.file-name[_ngcontent-%COMP%]{font-size:14px}.file-meta[_ngcontent-%COMP%]{font-size:11px}.merge-btn[_ngcontent-%COMP%]{padding:14px;font-size:15px}}']})};function mm(r,t){if(r&1){let e=y();o(0,"div",19)(1,"button",20),u("click",function(){m(e);let i=g();return f(i.goBack())}),h(2,"img",21),a(),o(3,"div",22),c(4),a(),o(5,"div",23)(6,"button",24),u("click",function(){m(e);let i=g();return f(i.enterSearchMode())}),h(7,"img",25),a()()()}if(r&2){let e=g();l(4),x(e.currentFolderName)}}function fm(r,t){if(r&1){let e=y();o(0,"button",32),u("click",function(){m(e);let i=g(2);return f(i.clearSearch())}),h(1,"img",33),a()}}function hm(r,t){if(r&1){let e=y();o(0,"div",26)(1,"button",20),u("click",function(){m(e);let i=g();return f(i.exitSearchMode())}),h(2,"img",21),a(),o(3,"div",27),h(4,"img",28),o(5,"input",29),u("input",function(i){m(e);let s=g();return f(s.onSearchInput(i.target.value))}),a(),b(6,fm,2,0,"button",30),a(),o(7,"button",31),u("click",function(){m(e);let i=g();return f(i.exitSearchMode())}),c(8,"\uCDE8\uC18C"),a()()}if(r&2){let e=g();l(5),p("value",e.searchQuery),l(),p("ngIf",e.searchQuery)}}function _m(r,t){if(r&1&&(o(0,"span",43),c(1),a()),r&2){let e=g(3);l(),S("(",e.selectedItems.size,"\uAC1C \uC120\uD0DD\uB428)")}}function Cm(r,t){if(r&1&&(o(0,"div",41)(1,"strong"),c(2,"\uBCD1\uD569\uD560 PDF\uB97C 2\uAC1C \uC774\uC0C1 \uC120\uD0DD"),a(),c(3,"\uD558\uC138\uC694 "),b(4,_m,2,1,"span",42),a()),r&2){let e=g(2);l(4),p("ngIf",e.selectedItems.size>0)}}function bm(r,t){if(r&1&&(o(0,"span",43),c(1),a()),r&2){let e=g(3);l(),S("(",e.selectedItems.size,"\uAC1C \uC120\uD0DD\uB428)")}}function vm(r,t){if(r&1&&(o(0,"div",41)(1,"strong"),c(2),a(),c(3,"\uC744 \uC704\uD55C PDF\uB97C \uC120\uD0DD\uD558\uC138\uC694 "),b(4,bm,2,1,"span",42),a()),r&2){let e=g(2);l(2),x(e.pendingAction.toolLabel),l(2),p("ngIf",e.selectedItems.size>0)}}function xm(r,t){if(r&1){let e=y();o(0,"div",34)(1,"div",35)(2,"div",36),h(3,"img",37),a(),b(4,Cm,5,1,"div",38)(5,vm,5,2,"div",38),o(6,"button",39),u("click",function(){m(e);let i=g();return f(i.onCancelSelection())}),h(7,"img",40),a()()()}if(r&2){let e=g();l(4),p("ngIf",e.pendingAction.action==="merge-pdf"),l(),p("ngIf",e.pendingAction.action!=="merge-pdf")}}function Pm(r,t){r&1&&h(0,"ez-shimmer-skeleton",44),r&2&&p("count",6)}function Mm(r,t){if(r&1&&(o(0,"div",45),c(1),a()),r&2){let e=g();l(),S(" \uAC80\uC0C9 \uACB0\uACFC ",e.searchResults.length,"\uAC74 ")}}function ym(r,t){r&1&&(o(0,"div",46)(1,"div",47),h(2,"img",48),a(),o(3,"h3",49),c(4,"\uD30C\uC77C \uAC80\uC0C9"),a(),o(5,"p",50),c(6,"\uD30C\uC77C\uBA85\uC744 \uC785\uB825\uD558\uC5EC \uBB38\uC11C\uB97C \uCC3E\uC544\uBCF4\uC138\uC694"),a()())}function wm(r,t){if(r&1&&(o(0,"div",46)(1,"div",47),h(2,"img",48),a(),o(3,"h3",49),c(4,"\uAC80\uC0C9 \uACB0\uACFC \uC5C6\uC74C"),a(),o(5,"p",50),c(6),a()()),r&2){let e=g();l(6),S("'",e.searchQuery,"'\uC5D0 \uB300\uD55C \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4")}}function Sm(r,t){r&1&&h(0,"img",70)}function Om(r,t){if(r&1&&(o(0,"div",67)(1,"div",68),b(2,Sm,1,0,"img",69),a()()),r&2){let e=g().$implicit,n=g(2);l(),k("checked",n.isItemSelected(e.id)),l(),p("ngIf",n.isItemSelected(e.id))}}function Em(r,t){r&1&&h(0,"img",71)}function km(r,t){r&1&&(o(0,"div",72),h(1,"img",73),a())}function Dm(r,t){if(r&1&&h(0,"img",74),r&2){let e=g().$implicit;p("src",e.thumbnail,ce)}}function Im(r,t){r&1&&(o(0,"div",75),h(1,"img",76),a())}function Tm(r,t){if(r&1&&(o(0,"span",77),c(1),a()),r&2){let e=g().$implicit;l(),S(" ",e.fileCount," ")}}function Am(r,t){if(r&1&&(o(0,"span",78),c(1),L(2,"date"),a()),r&2){let e=g().$implicit;l(),x(me(2,1,e.date,"yyyy.MM.dd HH:mm:ss"))}}function Fm(r,t){if(r&1&&(o(0,"span",79),c(1),a()),r&2){let e=g().$implicit,n=g(2);l(),S(" \xB7 ",n.formatFileSize(e.size))}}function zm(r,t){r&1&&(o(0,"div",80),h(1,"img",81),a())}function Rm(r,t){if(r&1){let e=y();o(0,"div",53),u("click",function(){let i=m(e).$implicit,s=g(2);return f(s.onItemClick(i))}),b(1,Om,3,3,"div",54),o(2,"div",55),b(3,Em,1,0,"img",56)(4,km,2,0,"div",57)(5,Dm,1,1,"img",58)(6,Im,2,0,"div",59),a(),o(7,"div",60)(8,"div",61),c(9),b(10,Tm,2,1,"span",62),a(),o(11,"div",63),b(12,Am,3,4,"span",64)(13,Fm,2,1,"span",65),a()(),b(14,zm,2,0,"div",66),a()}if(r&2){let e=t.$implicit,n=g(2);k("selected",n.isItemSelected(e.id)),l(),p("ngIf",e.type==="pdf"),l(),k("folder-icon",e.type==="folder"),l(),p("ngIf",e.type==="folder"),l(),p("ngIf",e.type==="pdf"&&e.isEncrypted),l(),p("ngIf",e.type==="pdf"&&!e.isEncrypted&&e.thumbnail),l(),p("ngIf",e.type==="pdf"&&!e.isEncrypted&&!e.thumbnail),l(3),S(" ",e.name," "),l(),p("ngIf",e.type==="folder"&&e.fileCount),l(2),p("ngIf",e.date),l(),p("ngIf",e.type==="pdf"&&e.size),l(),p("ngIf",e.type==="pdf"&&e.isFavorite)}}function Bm(r,t){if(r&1&&(o(0,"div",51),b(1,Rm,15,14,"div",52),a()),r&2){let e=g();l(),p("ngForOf",e.items)}}function Vm(r,t){r&1&&(o(0,"div",82),h(1,"img",83),o(2,"p",84),c(3,"\uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4"),a(),o(4,"p",85),c(5,"\uC6B0\uCE21 \uC0C1\uB2E8\uC758 '\uAC00\uC838\uC624\uAE30' \uBC84\uD2BC\uC744 \uB20C\uB7EC"),h(6,"br"),c(7,"\uD30C\uC77C\uC744 \uBA3C\uC800 \uCD94\uAC00\uD574\uC8FC\uC138\uC694"),a()())}function Lm(r,t){if(r&1&&(o(0,"span",90),c(1),a()),r&2){let e=g(2);l(),S(" (\uCD5C\uC18C ",e.pendingAction.minSelection,"\uAC1C) ")}}function Nm(r,t){if(r&1){let e=y();o(0,"div",86)(1,"div",87),c(2," \uC120\uD0DD\uB41C \uD30C\uC77C "),o(3,"strong"),c(4),a(),c(5,"\uAC1C "),b(6,Lm,2,1,"span",88),a(),o(7,"button",89),u("click",function(){m(e);let i=g();return f(i.onConfirmSelection())}),c(8),a()()}if(r&2){let e=g();l(4),x(e.selectedItems.size),l(2),p("ngIf",e.pendingAction.minSelection&&e.pendingAction.minSelection>1),l(),k("active",e.canConfirm),p("disabled",!e.canConfirm),l(),S(" ",e.confirmButtonLabel," ")}}var wi=class r{router=P(N);indexedDbService=P(ee);snackbar=P(G);toolActionService=P(le);pdfPasswordService=P(Ke);filePickerService=P(je);cdr=P(fe);pendingAction=null;pendingActionSubscription;selectedItems=new Set;isSearchMode=!1;searchQuery="";searchSubject=new be;searchSubscription;folders=[];documents=[];allDocuments=[];currentFolder=null;currentFolderName="\uD30C\uC77C \uC120\uD0DD";folderHistory=[];searchResults=[];isDataLoading=!1;shimmerStartTime=0;MIN_SHIMMER_DURATION=500;importSheetState="collapsed";isDestroyed=!1;ngOnInit(){this.pendingActionSubscription=this.toolActionService.pendingAction$.subscribe(t=>{if(this.pendingAction=t,!t){this.router.navigate(["/ezm/tools"]);return}this.cdr.detectChanges()}),this.searchSubscription=this.searchSubject.pipe(hn(300),_n()).subscribe(t=>{this.performSearch(t)}),this.loadInitialData()}ngOnDestroy(){this.isDestroyed=!0,this.pendingActionSubscription?.unsubscribe(),this.searchSubscription?.unsubscribe()}loadInitialData(){return C(this,null,function*(){this.isDataLoading=!0,this.shimmerStartTime=Date.now();try{let t=yield this.indexedDbService.getAllDocumentsMetadataOnly();this.allDocuments=t,this.folders=yield this.indexedDbService.getFolders(null);for(let n of this.folders){let i=yield this.indexedDbService.getFolderDocumentCount(n.id);n.fileCount=i}let e=yield this.indexedDbService.getFolderContentsMetadataOnly(null);this.documents=e}catch(t){console.error("\u274C \uB370\uC774\uD130 \uB85C\uB4DC \uC2E4\uD328:",t),this.snackbar.showError("\uD30C\uC77C \uBAA9\uB85D\uC744 \uBD88\uB7EC\uC624\uB294\uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}finally{let t=Date.now()-this.shimmerStartTime,e=Math.max(0,this.MIN_SHIMMER_DURATION-t);setTimeout(()=>{this.isDestroyed||(this.isDataLoading=!1,this.cdr.detectChanges())},e)}})}openFolder(t){return C(this,null,function*(){if(t.type==="folder"){this.currentFolder&&this.folderHistory.push(this.currentFolder),this.currentFolder=t.id,this.currentFolderName=t.name,this.isDataLoading=!0,this.shimmerStartTime=Date.now();try{if(t.folderType==="favorites"){let e=yield this.indexedDbService.getFavoriteDocuments();this.documents=e,this.folders=[]}else if(t.folderType==="recent-files"){let e=yield this.indexedDbService.getRecentFileEntries(30),n=[];for(let i of e){let s=yield this.indexedDbService.getDocumentById(i.documentId);s&&n.push(s)}this.documents=n,this.folders=[]}else{this.folders=yield this.indexedDbService.getFolders(t.id);let e=yield this.indexedDbService.getFolderContentsMetadataOnly(t.id);this.documents=e;for(let n of this.folders){let i=yield this.indexedDbService.getFolderDocumentCount(n.id);n.fileCount=i}}}catch(e){console.error("\u274C \uD3F4\uB354 \uB85C\uB4DC \uC2E4\uD328:",e),this.snackbar.showError("\uD3F4\uB354\uB97C \uC5F4 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.")}finally{let e=Date.now()-this.shimmerStartTime,n=Math.max(0,this.MIN_SHIMMER_DURATION-e);setTimeout(()=>{this.isDestroyed||(this.isDataLoading=!1,this.cdr.detectChanges())},n)}}})}goBack(){if(this.isSearchMode){this.exitSearchMode();return}if(this.folderHistory.length>0){let t=this.folderHistory.pop();this.navigateToFolder(t)}else this.currentFolder?(this.currentFolder=null,this.currentFolderName="\uD30C\uC77C \uC120\uD0DD",this.loadInitialData()):this.onCancelSelection()}navigateToFolder(t){return C(this,null,function*(){if(!t){this.currentFolder=null,this.currentFolderName="\uD30C\uC77C \uC120\uD0DD",this.loadInitialData();return}let e=yield this.indexedDbService.getFolderById(t);if(e){this.currentFolder=e.id,this.currentFolderName=e.name,this.isDataLoading=!0;try{this.folders=yield this.indexedDbService.getFolders(e.id);let n=yield this.indexedDbService.getFolderContentsMetadataOnly(e.id);this.documents=n}finally{this.isDataLoading=!1,this.cdr.detectChanges()}}})}onCancelSelection(){this.toolActionService.clearPendingAction(),this.router.navigate(["/ezm/tools"])}get items(){if(this.isSearchMode&&this.searchQuery)return this.searchResults.map(n=>this.documentToFileItem(n));let t=this.folders.map(n=>({id:n.id,name:n.name,type:"folder",date:this.safeParseDate(n.updatedAt)||this.safeParseDate(n.createdAt),fileCount:n.fileCount||0,folderType:"normal"})),e=this.documents.map(n=>this.documentToFileItem(n));return[...t,...e]}documentToFileItem(t){return{id:t.id,name:t.fileName||t.title,type:"pdf",date:this.safeParseDate(t.updatedAt)||this.safeParseDate(t.createdAt),size:t.fileSize||0,isFavorite:t.isFavorite,documentType:t.documentType,thumbnail:t.thumbnail,isEncrypted:t.isEncrypted}}safeParseDate(t){if(!t)return null;let e=new Date(t);return isNaN(e.getTime())?null:e}onItemClick(t){if(t.type==="folder"){this.openFolder(t);return}this.toggleSelection(t)}toggleSelection(t){if(t.type!=="pdf")return;let e=this.pendingAction?.selectionMode||"single",n=this.pendingAction?.maxSelection;if(this.selectedItems.has(t.id))this.selectedItems.delete(t.id);else{if(e==="single"&&this.selectedItems.clear(),n&&this.selectedItems.size>=n){this.snackbar.showError(`\uCD5C\uB300 ${n}\uAC1C\uAE4C\uC9C0 \uC120\uD0DD\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.`);return}this.selectedItems.add(t.id)}this.cdr.detectChanges()}isItemSelected(t){return this.selectedItems.has(t)}get canConfirm(){let t=this.pendingAction?.minSelection||1;return this.selectedItems.size>=t}get confirmButtonLabel(){return this.pendingAction?.confirmButtonLabel||"\uC120\uD0DD \uC644\uB8CC"}onConfirmSelection(){return C(this,null,function*(){if(console.log("[FilePicker] onConfirmSelection \uC2DC\uC791"),console.log("[FilePicker] canConfirm:",this.canConfirm),console.log("[FilePicker] pendingAction:",this.pendingAction),!this.canConfirm||!this.pendingAction){console.log("[FilePicker] \uC870\uAC74 \uBD88\uCDA9\uC871\uC73C\uB85C \uC885\uB8CC");return}console.log("[FilePicker] selectedItems:",this.selectedItems);let t=[];for(let e of this.selectedItems){let n=yield this.indexedDbService.getDocumentById(e);if(n)if(n.isEncrypted&&this.pendingAction.action!=="decrypt-pdf"){let i=yield this.pdfPasswordService.verifyPassword(n);if(!i.success){i.error&&this.snackbar.showError(i.error);return}i.decryptedBase64&&t.push(Z(K({},n),{pdfBase64:i.decryptedBase64,isEncrypted:!1}))}else t.push(n)}if(t.length===0){console.log("[FilePicker] \uC120\uD0DD\uB41C \uBB38\uC11C\uAC00 \uC5C6\uC74C"),this.snackbar.showError("\uC120\uD0DD\uB41C \uD30C\uC77C\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}console.log("[FilePicker] \uC120\uD0DD\uB41C \uBB38\uC11C\uB4E4:",t),console.log("[FilePicker] navigateToAction \uD638\uCD9C"),this.navigateToAction(t)})}navigateToAction(t){if(console.log("[FilePicker] navigateToAction \uC2DC\uC791"),console.log("[FilePicker] documents:",t),console.log("[FilePicker] pendingAction:",this.pendingAction),!this.pendingAction){console.log("[FilePicker] pendingAction \uC5C6\uC74C, \uC885\uB8CC");return}let e=this.pendingAction.action,n=t[0];console.log("[FilePicker] action:",e),console.log("[FilePicker] firstDoc:",n);let i=e.replace("-pdf","");switch(this.toolActionService.setPendingAction({toolId:i,toolLabel:this.pendingAction.toolLabel,action:e,requiresFileSelection:!1,data:{documentId:n.id,fromFilePicker:!0}}),console.log("[FilePicker] toolActionService\uC5D0 documentId \uC124\uC815:",n.id),e){case"merge-pdf":this.toolActionService.setPendingAction({toolId:"merge",toolLabel:this.pendingAction.toolLabel,action:e,requiresFileSelection:!1,data:{documents:t,fromFilePicker:!0}}),this.router.navigate(["/ezm/merge"]);break;case"split-pdf":this.router.navigate(["/ezm/split"]);break;case"rotate-pdf":this.router.navigate(["/ezm/rotate"]);break;case"encrypt-pdf":this.router.navigate(["/ezm/encrypt"]);break;case"decrypt-pdf":this.router.navigate(["/ezm/decrypt"]);break;case"organize-pdf":this.router.navigate(["/ezm/organize"]);break;case"add-page-numbers":this.router.navigate(["/ezm/page-number"]);break;case"add-watermark":this.router.navigate(["/ezm/watermark"]);break;case"ai-summary":this.router.navigate(["/ezm/ai-summary"]);break;case"ai-translate":this.router.navigate(["/ezm/ai-translate"]);break;case"edit":this.router.navigate(["/ezm/editor"]);break;default:this.router.navigate(["/ezm/viewer"])}console.log("[FilePicker] \uB77C\uC6B0\uD305 \uC644\uB8CC")}enterSearchMode(){this.isSearchMode=!0,this.searchQuery="",this.searchResults=[],this.cdr.detectChanges()}exitSearchMode(){this.isSearchMode=!1,this.searchQuery="",this.searchResults=[],this.cdr.detectChanges()}onSearchInput(t){this.searchQuery=t,this.searchSubject.next(t)}performSearch(t){if(!t.trim()){this.searchResults=[],this.cdr.detectChanges();return}let e=t.toLowerCase();this.searchResults=this.allDocuments.filter(n=>(n.fileName||n.title||"").toLowerCase().includes(e)),this.cdr.detectChanges()}clearSearch(){this.searchQuery="",this.searchResults=[],this.cdr.detectChanges()}onImportClick(){this.importSheetState="half"}onImportFile(){return C(this,null,function*(){this.importSheetState="collapsed";try{let t=yield this.filePickerService.pick({accept:"application/pdf",multiple:!1});t.success&&t.files.length>0&&(yield this.loadInitialData(),this.snackbar.showSuccess("\uD30C\uC77C\uC744 \uAC00\uC838\uC654\uC2B5\uB2C8\uB2E4."))}catch(t){console.error("\uD30C\uC77C \uAC00\uC838\uC624\uAE30 \uC2E4\uD328:",t),this.snackbar.showError("\uD30C\uC77C\uC744 \uAC00\uC838\uC624\uB294\uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}formatFileSize(t){return!t||t===0?"":t<1024?t+" B":t<1024*1024?(t/1024).toFixed(1)+" KB":(t/(1024*1024)).toFixed(2)+" MB"}onImportSheetStateChange(t){this.importSheetState=t}closeImportSheet(){this.importSheetState="collapsed"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-file-picker"]],standalone:!1,decls:22,vars:13,consts:[["class","header",4,"ngIf"],["class","header search-header",4,"ngIf"],["class","pending-action-banner",4,"ngIf"],[1,"main-content"],["type","file-myfiles",3,"count",4,"ngIf"],["class","search-result-count",4,"ngIf"],["class","search-empty-state",4,"ngIf"],["class","files-list",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","continue-bar",4,"ngIf"],[3,"sheetStateChange","close","sheetState"],[1,"import-sheet-content"],[1,"import-sheet-header"],[1,"import-sheet-title"],[1,"import-options"],[1,"import-option",3,"click"],[1,"import-option-icon"],["src","images/icons/ico-myfile.svg","alt","\uD30C\uC77C","width","32","height","32"],[1,"import-option-label"],[1,"header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"header-title"],[1,"header-actions"],[1,"header-btn","search-btn",3,"click"],["src","images/icons/btn-search.svg","alt","\uAC80\uC0C9","width","24","height","24"],[1,"header","search-header"],[1,"search-input-container"],["src","images/icons/btn-search.svg","alt","\uAC80\uC0C9","width","20","height","20",1,"search-icon"],["type","text","placeholder","\uD30C\uC77C\uBA85 \uAC80\uC0C9...","autofocus","",1,"search-input",3,"input","value"],["class","clear-btn",3,"click",4,"ngIf"],[1,"cancel-btn",3,"click"],[1,"clear-btn",3,"click"],["src","images/icons/ico-close.svg","alt","\uC9C0\uC6B0\uAE30","width","18","height","18"],[1,"pending-action-banner"],[1,"banner-content"],[1,"banner-icon"],["src","images/icons/ico-recently.svg","alt","\uC120\uD0DD","width","20","height","20"],["class","banner-text",4,"ngIf"],[1,"banner-close",3,"click"],["src","images/icons/ico-close.svg","alt","\uB2EB\uAE30","width","18","height","18"],[1,"banner-text"],["class","selection-count",4,"ngIf"],[1,"selection-count"],["type","file-myfiles",3,"count"],[1,"search-result-count"],[1,"search-empty-state"],[1,"search-empty-icon"],["src","images/icons/btn-search.svg","alt","\uAC80\uC0C9","width","64","height","64"],[1,"search-empty-title"],[1,"search-empty-text"],[1,"files-list"],["class","file-item",3,"selected","click",4,"ngFor","ngForOf"],[1,"file-item",3,"click"],["class","selection-checkbox",4,"ngIf"],[1,"file-icon"],["src","images/icons/ico-folder.svg","alt","\uD3F4\uB354","width","24","height","24",4,"ngIf"],["class","file-type-icon encrypted-file-icon",4,"ngIf"],["alt","PDF \uC378\uB124\uC77C","class","file-thumbnail-image",3,"src",4,"ngIf"],["class","file-type-icon pdf-icon",4,"ngIf"],[1,"file-info"],[1,"file-name"],["class","file-count",4,"ngIf"],[1,"file-meta"],["class","file-date",4,"ngIf"],["class","file-size",4,"ngIf"],["class","favorite-indicator",4,"ngIf"],[1,"selection-checkbox"],[1,"checkbox"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","16","height","16",4,"ngIf"],["src","images/icons/ico-complete.svg","alt","\uC120\uD0DD\uB428","width","16","height","16"],["src","images/icons/ico-folder.svg","alt","\uD3F4\uB354","width","24","height","24"],[1,"file-type-icon","encrypted-file-icon"],["src","images/icons/ico-tool-main-password.svg","alt","\uC554\uD638\uD654","width","32","height","40"],["alt","PDF \uC378\uB124\uC77C",1,"file-thumbnail-image",3,"src"],[1,"file-type-icon","pdf-icon"],["src","images/icons/ico-pdf.svg","alt","PDF","width","24","height","30"],[1,"file-count"],[1,"file-date"],[1,"file-size"],[1,"favorite-indicator"],["src","images/icons/btn-bookmark-on.svg","alt","\uC990\uACA8\uCC3E\uAE30","width","16","height","16"],[1,"empty-state"],["src","images/icons/ico-pdf.svg","alt","\uD30C\uC77C\uC5C6\uC74C","width","64","height","64",2,"opacity","0.5"],[1,"empty-text"],[1,"empty-subtext"],[1,"continue-bar"],[1,"selection-info"],["class","min-info",4,"ngIf"],[1,"continue-btn",3,"click","disabled"],[1,"min-info"]],template:function(e,n){e&1&&(b(0,mm,8,1,"div",0)(1,hm,9,2,"div",1)(2,xm,8,2,"div",2),o(3,"div",3),b(4,Pm,1,1,"ez-shimmer-skeleton",4)(5,Mm,2,1,"div",5)(6,ym,7,0,"div",6)(7,wm,7,1,"div",6)(8,Bm,2,1,"div",7)(9,Vm,8,0,"div",8),a(),b(10,Nm,9,6,"div",9),o(11,"app-bottom-sheet",10),u("sheetStateChange",function(s){return n.onImportSheetStateChange(s)})("close",function(){return n.closeImportSheet()}),o(12,"div",11)(13,"div",12)(14,"h3",13),c(15,"\uD30C\uC77C \uAC00\uC838\uC624\uAE30"),a()(),o(16,"div",14)(17,"button",15),u("click",function(){return n.onImportFile()}),o(18,"div",16),h(19,"img",17),a(),o(20,"span",18),c(21,"\uD30C\uC77C\uC5D0\uC11C \uAC00\uC838\uC624\uAE30"),a()()()()()),e&2&&(p("ngIf",!n.isSearchMode),l(),p("ngIf",n.isSearchMode),l(),p("ngIf",n.pendingAction&&!n.isSearchMode),l(),k("has-banner",n.pendingAction&&!n.isSearchMode),l(),p("ngIf",n.isDataLoading),l(),p("ngIf",n.isSearchMode&&n.searchQuery&&!n.isDataLoading),l(),p("ngIf",n.isSearchMode&&!n.searchQuery&&!n.isDataLoading),l(),p("ngIf",n.isSearchMode&&n.searchQuery&&n.searchResults.length===0&&!n.isDataLoading),l(),p("ngIf",!n.isDataLoading&&n.items.length>0&&!(n.isSearchMode&&!n.searchQuery)),l(),p("ngIf",!n.isDataLoading&&n.items.length===0&&!n.isSearchMode),l(),p("ngIf",n.pendingAction),l(),p("sheetState",n.importSheetState))},dependencies:[oe,B,Pe,tt,Oe],styles:[".header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;height:calc(56px + var(--android-status-bar-height, 0px));padding-top:var(--android-status-bar-height, 0px);background:#fff;border-bottom:1px solid #e0e0e0;display:flex;align-items:center;padding-left:8px;padding-right:12px;z-index:100;box-sizing:border-box}.back-btn[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;border-radius:50%}.back-btn[_ngcontent-%COMP%]:active{background:#0000000d}.header-title[_ngcontent-%COMP%]{flex:1;font-size:18px;font-weight:600;color:#333;text-align:center;margin-right:40px}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.header-btn[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;border-radius:50%}.header-btn[_ngcontent-%COMP%]:active{background:#0000000d}.search-header[_ngcontent-%COMP%]{gap:8px;padding-right:8px}.search-header[_ngcontent-%COMP%]   .header-title[_ngcontent-%COMP%]{display:none}.search-input-container[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;background:#f5f5f5;border-radius:8px;padding:0 12px;height:40px;gap:8px}.search-icon[_ngcontent-%COMP%]{opacity:.5}.search-input[_ngcontent-%COMP%]{flex:1;border:none;background:none;font-size:16px;color:#333;outline:none}.search-input[_ngcontent-%COMP%]::placeholder{color:#999}.clear-btn[_ngcontent-%COMP%]{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;opacity:.5}.clear-btn[_ngcontent-%COMP%]:active{opacity:1}.cancel-btn[_ngcontent-%COMP%]{padding:8px 12px;background:none;border:none;color:#007acc;font-size:16px;font-weight:500;cursor:pointer;white-space:nowrap}.cancel-btn[_ngcontent-%COMP%]:active{opacity:.7}.pending-action-banner[_ngcontent-%COMP%]{position:fixed;top:calc(56px + var(--android-status-bar-height, 0px));left:0;right:0;height:44px;background:linear-gradient(135deg,#e3f2fd,#bbdefb);border-bottom:1px solid #90CAF9;z-index:99;animation:_ngcontent-%COMP%_slideDown .3s ease-out}.banner-content[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 16px;gap:12px;height:100%}.banner-icon[_ngcontent-%COMP%]{flex-shrink:0;display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_pulse 2s ease-in-out infinite}.banner-text[_ngcontent-%COMP%]{flex:1;font-size:14px;color:#1565c0;line-height:1.4}.banner-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600;color:#0d47a1}.banner-text[_ngcontent-%COMP%]   .selection-count[_ngcontent-%COMP%]{color:#ff5722;font-weight:500}.banner-close[_ngcontent-%COMP%]{flex-shrink:0;width:32px;height:32px;padding:0;background:none;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;border-radius:50%}.banner-close[_ngcontent-%COMP%]:active{background:#0000001a}@keyframes _ngcontent-%COMP%_slideDown{0%{transform:translateY(-100%);opacity:0}to{transform:translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}.main-content[_ngcontent-%COMP%]{position:fixed;top:calc(56px + var(--android-status-bar-height, 0px));left:0;right:0;bottom:calc(120px + var(--android-navigation-bar-height, 0px));overflow-y:auto;-webkit-overflow-scrolling:touch;background:#fafafa}.main-content.has-banner[_ngcontent-%COMP%]{top:calc(100px + var(--android-status-bar-height, 0px))}.search-result-count[_ngcontent-%COMP%]{padding:12px 16px;font-size:14px;color:#666;background:#f5f5f5;border-bottom:1px solid #e0e0e0}.search-empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 24px;text-align:center}.search-empty-icon[_ngcontent-%COMP%]{opacity:.3;margin-bottom:20px}.search-empty-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px}.search-empty-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0 0 8px}.search-empty-text[_ngcontent-%COMP%]{font-size:14px;color:#666;margin:0}.files-list[_ngcontent-%COMP%]{background:#fff}.file-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 16px;gap:12px;border-bottom:1px solid #f0f0f0;cursor:pointer;transition:background .15s}.file-item[_ngcontent-%COMP%]:active{background:#f5f5f5}.file-item.selected[_ngcontent-%COMP%]{background:#fff3e0}.selection-checkbox[_ngcontent-%COMP%]{flex-shrink:0;width:24px;height:24px;display:flex;align-items:center;justify-content:center}.checkbox[_ngcontent-%COMP%]{width:22px;height:22px;border:2px solid #ccc;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#fff;transition:all .2s}.checkbox.checked[_ngcontent-%COMP%]{border-color:#ff5722;background:#ff5722}.file-icon[_ngcontent-%COMP%]{flex-shrink:0;width:48px;height:56px;display:flex;align-items:center;justify-content:center;background:#f8f8f8;border-radius:6px;overflow:hidden}.file-icon.folder-icon[_ngcontent-%COMP%]{background:#fff8e1;width:44px;height:44px}.file-thumbnail-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.file-type-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.file-type-icon.encrypted-file-icon[_ngcontent-%COMP%]{opacity:.6}.file-type-icon.pdf-icon[_ngcontent-%COMP%]{opacity:.8}.file-info[_ngcontent-%COMP%]{flex:1;min-width:0;overflow:hidden}.file-name[_ngcontent-%COMP%]{font-size:15px;font-weight:500;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:flex;align-items:center;gap:6px}.file-count[_ngcontent-%COMP%]{flex-shrink:0;font-size:12px;font-weight:500;color:#fff;background:#9e9e9e;padding:2px 6px;border-radius:10px}.file-meta[_ngcontent-%COMP%]{font-size:13px;color:#888;margin-top:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.favorite-indicator[_ngcontent-%COMP%]{flex-shrink:0;opacity:.6}.folder-arrow[_ngcontent-%COMP%]{flex-shrink:0;opacity:.4}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 24px;text-align:center}.empty-text[_ngcontent-%COMP%]{font-size:16px;font-weight:500;color:#666;margin:16px 0 8px}.empty-subtext[_ngcontent-%COMP%]{font-size:14px;color:#999;margin:0;line-height:1.5}.continue-bar[_ngcontent-%COMP%]{position:fixed;left:0;right:0;bottom:0;padding-bottom:var(--android-navigation-bar-height, 0px);background:#fff;border-top:1px solid #e0e0e0;box-shadow:0 -4px 12px #00000014;z-index:100;display:flex;flex-direction:column;padding:16px;padding-bottom:calc(16px + var(--android-navigation-bar-height, 0px));gap:12px}.selection-info[_ngcontent-%COMP%]{font-size:14px;color:#333}.selection-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#ff5722;font-weight:600}.selection-info[_ngcontent-%COMP%]   .min-info[_ngcontent-%COMP%]{color:#999;font-size:13px}.continue-btn[_ngcontent-%COMP%]{width:100%;padding:14px;background:#e0e0e0;color:#9e9e9e;border:none;border-radius:8px;font-size:16px;font-weight:600;cursor:not-allowed;transition:all .2s}.continue-btn.active[_ngcontent-%COMP%]{background:#ff5722;color:#fff;cursor:pointer}.continue-btn.active[_ngcontent-%COMP%]:active{background:#e64a19}.continue-btn[_ngcontent-%COMP%]:disabled{background:#e0e0e0;color:#9e9e9e;cursor:not-allowed}.import-sheet-content[_ngcontent-%COMP%]{padding:16px}.import-sheet-header[_ngcontent-%COMP%]{margin-bottom:16px}.import-sheet-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#333;margin:0}.import-options[_ngcontent-%COMP%]{display:flex;gap:16px}.import-option[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;gap:8px;padding:16px;background:#f8f8f8;border:1px solid #e0e0e0;border-radius:12px;cursor:pointer}.import-option[_ngcontent-%COMP%]:active{background:#f0f0f0}.import-option-icon[_ngcontent-%COMP%]{width:48px;height:48px;display:flex;align-items:center;justify-content:center}.import-option-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333}"]})};function jm(r,t){if(r&1){let e=y();o(0,"button",9),u("click",function(){m(e);let i=g();return f(i.logout())}),c(1,"\uB85C\uADF8\uC544\uC6C3"),a()}}function Um(r,t){if(r&1){let e=y();o(0,"div",10)(1,"div",11)(2,"span",12),c(3,"Code:"),a(),o(4,"code",13),c(5),a(),o(6,"button",14),u("click",function(){m(e);let i=g();return f(i.copyToClipboard(i.oauthCallback.code||""))}),c(7,"\uBCF5\uC0AC"),a()(),o(8,"div",11)(9,"span",12),c(10,"State:"),a(),o(11,"code",13),c(12),a()(),o(13,"div",11)(14,"span",12),c(15,"State (Decoded):"),a(),o(16,"pre",15),c(17),a()(),o(18,"div",11)(19,"span",12),c(20,"Scope:"),a(),o(21,"code",13),c(22),a()(),o(23,"div",11)(24,"span",12),c(25,"Error:"),a(),o(26,"code",13),c(27),a()(),o(28,"div",11)(29,"span",12),c(30,"Full URL:"),a(),o(31,"code",16),c(32),a(),o(33,"button",14),u("click",function(){m(e);let i=g();return f(i.copyToClipboard(i.oauthCallback.fullUrl))}),c(34,"\uBCF5\uC0AC"),a()(),o(35,"details",17)(36,"summary"),c(37,"\uC804\uCCB4 JSON \uBCF4\uAE30"),a(),o(38,"pre",15),c(39),a(),o(40,"button",14),u("click",function(){m(e);let i=g();return f(i.copyToClipboard(i.getOAuthCallbackJson()))}),c(41,"JSON \uBCF5\uC0AC"),a()(),o(42,"button",18),u("click",function(){m(e);let i=g();return f(i.clearCallback())}),c(43,"\uCF5C\uBC31 \uCD08\uAE30\uD654"),a()()}if(r&2){let e=g();l(5),S("",e.oauthCallback.code==null?null:e.oauthCallback.code.substring(0,40),"..."),l(7),x(e.oauthCallback.state),l(5),x(e.decodeState()),l(5),x(e.oauthCallback.scope),l(5),x(e.oauthCallback.error||"null"),l(5),x(e.oauthCallback.fullUrl),l(7),x(e.getOAuthCallbackJson())}}function $m(r,t){r&1&&(o(0,"div",19),c(1," OAuth \uCF5C\uBC31 \uB370\uC774\uD130\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4 "),a())}function Hm(r,t){if(r&1){let e=y();o(0,"div",10)(1,"div",11)(2,"code",13),c(3),a(),o(4,"button",14),u("click",function(){m(e);let i=g();return f(i.copyToClipboard(i.accessToken))}),c(5,"\uBCF5\uC0AC"),a()()()}if(r&2){let e=g();l(3),S("",e.accessToken.substring(0,60),"...")}}function Wm(r,t){r&1&&(o(0,"div",19),c(1," Access Token\uC774 \uC5C6\uC2B5\uB2C8\uB2E4 "),a())}function Km(r,t){if(r&1&&(o(0,"div",11)(1,"span",12),c(2,"Backend User ID:"),a(),o(3,"code",13),c(4),a()()),r&2){let e=g(2);l(4),x(e.userProfile.backendUserId)}}function Gm(r,t){if(r&1&&(o(0,"div",11)(1,"span",12),c(2,"Nickname:"),a(),o(3,"code",13),c(4),a()()),r&2){let e=g(2);l(4),x(e.userProfile.nickname)}}function Ym(r,t){if(r&1&&(o(0,"div",11)(1,"span",12),c(2,"Social Type:"),a(),o(3,"code",13),c(4),a()()),r&2){let e=g(2);l(4),x(e.userProfile.socialType)}}function qm(r,t){if(r&1&&(o(0,"div",11)(1,"span",12),c(2,"Referral Code:"),a(),o(3,"code",13),c(4),a()()),r&2){let e=g(2);l(4),x(e.userProfile.referralCode)}}function Xm(r,t){if(r&1&&(o(0,"div",11)(1,"span",12),c(2,"Linked Accounts:"),a(),o(3,"code",13),c(4),a()()),r&2){let e=g(2);l(4),S("",e.userProfile.linkedAccounts.length,"\uAC1C")}}function Jm(r,t){if(r&1){let e=y();o(0,"div",10),b(1,Km,5,1,"div",20),o(2,"div",11)(3,"span",12),c(4,"User ID:"),a(),o(5,"code",13),c(6),a()(),o(7,"div",11)(8,"span",12),c(9,"Email:"),a(),o(10,"code",13),c(11),a()(),b(12,Gm,5,1,"div",20),o(13,"div",11)(14,"span",12),c(15,"Name:"),a(),o(16,"code",13),c(17),a()(),b(18,Ym,5,1,"div",20),o(19,"div",11)(20,"span",12),c(21,"Login Type:"),a(),o(22,"code",13),c(23),a()(),b(24,qm,5,1,"div",20)(25,Xm,5,1,"div",20),o(26,"details",17)(27,"summary"),c(28,"\uC804\uCCB4 JSON \uBCF4\uAE30"),a(),o(29,"pre",15),c(30),a(),o(31,"button",14),u("click",function(){m(e);let i=g();return f(i.copyToClipboard(i.getUserProfileJson()))}),c(32,"JSON \uBCF5\uC0AC"),a()()()}if(r&2){let e=g();l(),p("ngIf",e.userProfile.backendUserId),l(5),x(e.userProfile.userId),l(5),x(e.userProfile.email),l(),p("ngIf",e.userProfile.nickname),l(5),x(e.userProfile.name),l(),p("ngIf",e.userProfile.socialType),l(5),x(e.userProfile.loginType),l(),p("ngIf",e.userProfile.referralCode),l(),p("ngIf",e.userProfile.linkedAccounts&&e.userProfile.linkedAccounts.length>0),l(5),x(e.getUserProfileJson())}}function Zm(r,t){r&1&&(o(0,"div",19),c(1," \uC0AC\uC6A9\uC790 \uD504\uB85C\uD544\uC774 \uC5C6\uC2B5\uB2C8\uB2E4 "),a())}function Qm(r,t){if(r&1){let e=y();o(0,"div",10)(1,"div",11)(2,"span",12),c(3,"\uC81C\uC870\uC0AC:"),a(),o(4,"code",13),c(5),a()(),o(6,"div",11)(7,"span",12),c(8,"\uBAA8\uB378:"),a(),o(9,"code",13),c(10),a()(),o(11,"div",11)(12,"span",12),c(13,"Android \uBC84\uC804:"),a(),o(14,"code",13),c(15),a()(),o(16,"div",11)(17,"span",12),c(18,"\uD654\uBA74 \uD06C\uAE30:"),a(),o(19,"code",13),c(20),a()(),o(21,"details",17)(22,"summary"),c(23,"\uC804\uCCB4 JSON \uBCF4\uAE30"),a(),o(24,"pre",15),c(25),a(),o(26,"button",14),u("click",function(){m(e);let i=g();return f(i.copyToClipboard(i.getDeviceInfoJson()))}),c(27,"JSON \uBCF5\uC0AC"),a()()()}if(r&2){let e=g();l(5),x(e.deviceInfo.manufacturer),l(5),x(e.deviceInfo.model),l(5),x(e.deviceInfo.androidVersion),l(5),ue("",e.deviceInfo.screenWidth," x ",e.deviceInfo.screenHeight),l(5),x(e.getDeviceInfoJson())}}function e0(r,t){r&1&&(o(0,"div",19),c(1," \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4 "),a())}var Si=class r{constructor(t,e){this.androidBridge=t;this.authService=e}deviceInfo=null;oauthCallback=null;isAuthenticated=!1;userProfile=null;accessToken=null;subscriptions=[];ngOnInit(){this.subscriptions.push(this.androidBridge.deviceInfo$.subscribe(t=>{this.deviceInfo=t,console.log("\u{1F50D} [Debug] \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4:",t)})),this.subscriptions.push(this.androidBridge.oauthCallback$.subscribe(t=>{this.oauthCallback=t,console.log("\u{1F50D} [Debug] OAuth \uCF5C\uBC31:",t)})),this.subscriptions.push(this.authService.isAuthenticated$.subscribe(t=>{this.isAuthenticated=t,console.log("\u{1F50D} [Debug] \uC778\uC99D \uC0C1\uD0DC:",t)})),this.subscriptions.push(this.authService.userProfile$.subscribe(t=>{this.userProfile=t,console.log("\u{1F50D} [Debug] \uC0AC\uC6A9\uC790 \uD504\uB85C\uD544:",t)})),this.checkStoredTokens()}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}checkStoredTokens(){let t=localStorage.getItem("gemini_api_keys");if(t)try{let s=JSON.parse(t);console.log("\u{1F50D} [Debug] \uC800\uC7A5\uB41C API \uD0A4:",s),s.length>0&&(this.accessToken=s[0].apiKey)}catch(s){console.error("API \uD0A4 \uD30C\uC2F1 \uC2E4\uD328:",s)}let e=sessionStorage.getItem("ez_reader_mobile_auth_token"),n=sessionStorage.getItem("ezm_user_profile"),i=sessionStorage.getItem("ezm_login_type");console.log("\u{1F50D} [Debug] \uC138\uC158 \uC815\uBCF4:",{authToken:e,loginType:i,userProfile:n})}getOAuthCallbackJson(){return this.oauthCallback?JSON.stringify(this.oauthCallback,null,2):"null"}getDeviceInfoJson(){return this.deviceInfo?JSON.stringify(this.deviceInfo,null,2):"null"}getUserProfileJson(){return this.userProfile?JSON.stringify(this.userProfile,null,2):"null"}decodeState(){if(!this.oauthCallback?.state)return"N/A";try{let t=atob(this.oauthCallback.state);return JSON.stringify(JSON.parse(t),null,2)}catch(t){return`\uB514\uCF54\uB529 \uC2E4\uD328: ${t}`}}copyToClipboard(t){navigator.clipboard.writeText(t).then(()=>{alert("\uD074\uB9BD\uBCF4\uB4DC\uC5D0 \uBCF5\uC0AC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!")}).catch(e=>{console.error("\uBCF5\uC0AC \uC2E4\uD328:",e)})}logout(){this.authService.logout(),this.checkStoredTokens()}clearCallback(){this.androidBridge.clearDebugInfo()}static \u0275fac=function(e){return new(e||r)(V(Ae),V(Ce))};static \u0275cmp=F({type:r,selectors:[["ez-reader-mobile-debug"]],standalone:!1,decls:33,vars:12,consts:[[1,"debug-container"],[1,"debug-header"],["routerLink","/ezm/home",1,"close-btn"],[1,"debug-content"],[1,"debug-section"],[1,"status-badge"],["class","action-btn",3,"click",4,"ngIf"],["class","data-card",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"action-btn",3,"click"],[1,"data-card"],[1,"data-item"],[1,"label"],[1,"value"],[1,"copy-btn",3,"click"],[1,"json-value"],[1,"value","small"],[1,"json-details"],[1,"action-btn","warning",3,"click"],[1,"empty-state"],["class","data-item",4,"ngIf"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"h2"),c(3,"\u{1F50D} Debug \uC815\uBCF4"),a(),o(4,"button",2),c(5,"\uB2EB\uAE30"),a()(),o(6,"div",3)(7,"div",4)(8,"h3"),c(9,"\u{1F510} \uC778\uC99D \uC0C1\uD0DC"),a(),o(10,"div",5),c(11),a(),b(12,jm,2,0,"button",6),a(),o(13,"div",4)(14,"h3"),c(15,"\u{1F4F1} OAuth \uCF5C\uBC31 \uB370\uC774\uD130"),a(),b(16,Um,44,7,"div",7)(17,$m,2,0,"div",8),a(),o(18,"div",4)(19,"h3"),c(20,"\u{1F511} Access Token"),a(),b(21,Hm,6,1,"div",7)(22,Wm,2,0,"div",8),a(),o(23,"div",4)(24,"h3"),c(25,"\u{1F464} \uC0AC\uC6A9\uC790 \uD504\uB85C\uD544"),a(),b(26,Jm,33,10,"div",7)(27,Zm,2,0,"div",8),a(),o(28,"div",4)(29,"h3"),c(30,"\u{1F4F1} \uB514\uBC14\uC774\uC2A4 \uC815\uBCF4"),a(),b(31,Qm,28,6,"div",7)(32,e0,2,0,"div",8),a()()()),e&2&&(l(10),k("authenticated",n.isAuthenticated),l(),S(" ",n.isAuthenticated?"\u2705 \uB85C\uADF8\uC778\uB428":"\u274C \uB85C\uADF8\uC778 \uC548\uB428"," "),l(),p("ngIf",n.isAuthenticated),l(4),p("ngIf",n.oauthCallback),l(),p("ngIf",!n.oauthCallback),l(4),p("ngIf",n.accessToken),l(),p("ngIf",!n.accessToken),l(4),p("ngIf",n.userProfile),l(),p("ngIf",!n.userProfile),l(4),p("ngIf",n.deviceInfo),l(),p("ngIf",!n.deviceInfo))},dependencies:[B,_o],styles:[".debug-container[_ngcontent-%COMP%]{min-height:calc(100vh - var(--android-status-bar-height, 0px) - var(--android-navigation-bar-height, 0px));padding-top:calc(20px + var(--android-status-bar-height, 0px));padding-bottom:calc(20px + var(--android-navigation-bar-height, 0px));padding-left:20px;padding-right:20px;background:#1a202c;color:#e2e8f0;font-family:Monaco,Courier New,monospace}.debug-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:2px solid #2d3748}.debug-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:24px;color:#4fd1c5}.debug-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{padding:8px 16px;background:#2d3748;color:#e2e8f0;border:none;border-radius:6px;cursor:pointer;font-size:14px}.debug-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{background:#4a5568}.debug-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.debug-section[_ngcontent-%COMP%]{background:#2d3748;border-radius:12px;padding:20px;border:1px solid #4a5568}.debug-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:18px;color:#4fd1c5}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:8px 16px;border-radius:6px;font-weight:600;background:#742a2a;color:#feb2b2;margin-bottom:12px}.status-badge.authenticated[_ngcontent-%COMP%]{background:#22543d;color:#9ae6b4}.data-card[_ngcontent-%COMP%]{background:#1a202c;border-radius:8px;padding:16px;border:1px solid #4a5568}.data-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-bottom:16px;padding-bottom:16px;border-bottom:1px solid #4a5568}.data-item[_ngcontent-%COMP%]:last-child{margin-bottom:0;padding-bottom:0;border-bottom:none}.data-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;color:#a0aec0;font-weight:600;text-transform:uppercase}.data-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{background:#2d3748;padding:8px 12px;border-radius:4px;font-size:13px;color:#48bb78;word-break:break-all;display:block}.data-item[_ngcontent-%COMP%]   .value.small[_ngcontent-%COMP%]{font-size:11px}.json-value[_ngcontent-%COMP%]{background:#2d3748;padding:12px;border-radius:4px;font-size:12px;color:#68d391;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word;margin:0}.json-details[_ngcontent-%COMP%]{margin-top:12px}.json-details[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{cursor:pointer;font-size:13px;color:#63b3ed;padding:8px;background:#2d3748;border-radius:4px;-webkit-user-select:none;user-select:none}.json-details[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]:hover{background:#4a5568}.json-details[_ngcontent-%COMP%]   .json-value[_ngcontent-%COMP%]{margin-top:8px}.copy-btn[_ngcontent-%COMP%]{padding:6px 12px;background:#4299e1;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:12px;margin-top:8px;align-self:flex-start}.copy-btn[_ngcontent-%COMP%]:hover{background:#3182ce}.copy-btn[_ngcontent-%COMP%]:active{background:#2c5282}.action-btn[_ngcontent-%COMP%]{padding:10px 20px;background:#4299e1;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;margin-top:12px}.action-btn[_ngcontent-%COMP%]:hover{background:#3182ce}.action-btn.warning[_ngcontent-%COMP%]{background:#e53e3e}.action-btn.warning[_ngcontent-%COMP%]:hover{background:#c53030}.empty-state[_ngcontent-%COMP%]{padding:20px;text-align:center;color:#718096;font-style:italic;background:#1a202c;border-radius:8px;border:1px dashed #4a5568}"]})};var t0=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:qn},{path:"login",component:ti},{path:"debug",component:Si},{path:"auth/google/callback",component:Ci},{path:"viewer",component:Xn},{path:"editor",component:mi},{path:"tools",component:Jn},{path:"myfiles",component:cn},{path:"myfiles/:folderId",component:cn},{path:"google-login-required",component:vi},{path:"profile",component:Qn},{path:"points",component:Pi},{path:"point-info",component:Mi},{path:"organize",component:ni},{path:"ai-summary",component:ii},{path:"ai-translate",component:oi},{path:"pdf-convert",component:ri},{path:"rotate",component:ai},{path:"split",component:si},{path:"page-number",component:ci},{path:"watermark",component:di},{path:"encrypt",component:pi},{path:"decrypt",component:gi},{path:"pdf-create",component:xi},{path:"search",component:_i},{path:"file-saved",component:bi},{path:"merge",component:yi},{path:"file-picker",component:wi}],Oi=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=Nt({type:r});static \u0275inj=Bt({imports:[Ai.forChild(t0),Ai]})};function n0(r,t){if(r&1&&(o(0,"div",9),h(1,"img",10),o(2,"h3"),c(3),a(),o(4,"div",11),h(5,"div",12),a(),o(6,"p",13),c(7),a()()),r&2){let e=g(2);l(3),x(e.currentStep),l(2),q("width",e.analysisProgress,"%"),l(2),S("",e.analysisProgress,"%")}}function i0(r,t){if(r&1&&(o(0,"div",24)(1,"div",25),h(2,"img",26),o(3,"span",27),c(4,"\uC774\uBBF8\uC9C0"),a()(),o(5,"div",28),c(6),a()()),r&2){let e=g(3);l(6),S(" \uCD1D ",e.analysisResult.summary.imageInfo.totalImages,"\uAC1C \uC774\uBBF8\uC9C0 ")}}function o0(r,t){if(r&1&&(o(0,"div",24)(1,"div",25),h(2,"img",29),o(3,"span",27),c(4,"\uBCA1\uD130 \uADF8\uB798\uD53D"),a()(),o(5,"div",28),c(6),a()()),r&2){let e=g(3);l(6),S(" \uCD1D ",e.analysisResult.vectorData.totalOperations,"\uAC1C \uBCA1\uD130 \uC791\uC5C5 ")}}function r0(r,t){if(r&1){let e=y();o(0,"div",14)(1,"div",15)(2,"h3"),c(3,"\u{1F4CA} \uBD84\uC11D \uC694\uC57D"),a(),o(4,"div",16)(5,"div",17)(6,"div",18),c(7,"\uD398\uC774\uC9C0"),a(),o(8,"div",19),c(9),a()(),o(10,"div",17)(11,"div",18),c(12,"\uD14D\uC2A4\uD2B8 \uD56D\uBAA9"),a(),o(13,"div",19),c(14),a()(),o(15,"div",17)(16,"div",18),c(17,"\uB2E8\uC5B4"),a(),o(18,"div",19),c(19),a()(),o(20,"div",17)(21,"div",18),c(22,"\uBB38\uC790"),a(),o(23,"div",19),c(24),a()()(),b(25,i0,7,1,"div",20)(26,o0,7,1,"div",20),a(),o(27,"div",21)(28,"button",22),u("click",function(){m(e);let i=g(2);return f(i.onCreateNewDocument())}),h(29,"img",23),o(30,"span"),c(31,"\uD3B8\uC9D1 \uBB38\uC11C \uB9CC\uB4E4\uAE30"),a()()()()}if(r&2){let e=g(2);l(9),x(e.analysisResult.summary.pageCount),l(5),x(e.analysisResult.summary.totalTextItems),l(5),x(e.analysisResult.summary.totalWords),l(5),x(e.analysisResult.summary.totalCharacters),l(),p("ngIf",e.analysisResult.summary.imageInfo&&e.analysisResult.summary.imageInfo.totalImages>0),l(),p("ngIf",(e.analysisResult.vectorData==null?null:e.analysisResult.vectorData.totalOperations)>0)}}function a0(r,t){if(r&1){let e=y();o(0,"div",1),u("click",function(){m(e);let i=g();return f(i.onClose())}),o(1,"div",2),u("click",function(i){return m(e),f(i.stopPropagation())}),o(2,"div",3)(3,"button",4),u("click",function(){m(e);let i=g();return f(i.onClose())}),h(4,"img",5),a(),o(5,"h2"),c(6,"PDF \uBD84\uC11D \uACB0\uACFC"),a(),o(7,"button",6),u("click",function(){m(e);let i=g();return f(i.onClose())}),c(8,"\xD7"),a()(),b(9,n0,8,4,"div",7)(10,r0,32,6,"div",8),a()()}if(r&2){let e=g();p("@fadeInOut",void 0),l(),p("@slideUp",void 0),l(8),p("ngIf",e.isAnalyzing),l(),p("ngIf",!e.isAnalyzing&&e.analysisResult)}}var Ei=class r{pdfSrc=null;fileName="";close=new W;analysisComplete=new W;createNewDocument=new W;isOpen=!1;isAnalyzing=!1;analysisProgress=0;currentStep="";analysisResult=null;pdfAnalysisManager=P(kn);snackbar=P(G);pageBuilder=P(Dn);steps=["\u{1F4C4} PDF \uD30C\uC77C \uB85C\uB529...","\u{1F50D} \uBB38\uC11C \uAD6C\uC870 \uBD84\uC11D...","\u{1F4DD} \uD14D\uC2A4\uD2B8 \uCD94\uCD9C \uC911...","\u{1F5BC}\uFE0F \uC774\uBBF8\uC9C0 \uAC10\uC9C0 \uC911...","\u{1F3A8} \uBCA1\uD130 \uBD84\uC11D \uC911...","\u2705 \uBD84\uC11D \uC644\uB8CC!"];ngOnInit(){this.open()}open(){this.isOpen=!0,this.startAnalysis()}startAnalysis(){return C(this,null,function*(){if(!this.pdfSrc){this.snackbar.showError("PDF \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.isAnalyzing=!0,this.analysisProgress=0,this.analysisResult=null;let t=0;this.currentStep=this.steps[t];let e=setInterval(()=>{t<this.steps.length-1&&(t++,this.currentStep=this.steps[t])},2e3);try{let n=yield this.pdfAnalysisManager.analyzePdf(this.pdfSrc,this.fileName,(i,s)=>{this.analysisProgress=i,s&&(this.currentStep=s)});clearInterval(e),this.analysisResult=n,this.analysisProgress=100,this.currentStep=this.steps[this.steps.length-1],this.analysisComplete.emit(n),this.snackbar.showSuccess("PDF \uBD84\uC11D\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4!")}catch{clearInterval(e),this.snackbar.showError("PDF \uBD84\uC11D \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."),this.isAnalyzing=!1}finally{this.isAnalyzing=!1}})}onClose(){this.isOpen=!1,this.isAnalyzing=!1,this.analysisProgress=0,this.analysisResult=null,this.close.emit()}onCreateNewDocument(){return C(this,null,function*(){if(!this.analysisResult){this.snackbar.showError("\uBD84\uC11D \uACB0\uACFC\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.");return}try{let t=this.pageBuilder.createPagesFromTextStream(this.analysisResult.textStreamData,[],()=>{});this.createNewDocument.emit(t),this.onClose()}catch{this.snackbar.showError("\uBB38\uC11C \uC0DD\uC131 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}onCreateNewFromDashboard(t){this.createNewDocument.emit(t),this.onClose()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["app-ez-reader-mobile-pdf-analysis"]],inputs:{pdfSrc:"pdfSrc",fileName:"fileName"},outputs:{close:"close",analysisComplete:"analysisComplete",createNewDocument:"createNewDocument"},decls:1,vars:1,consts:[["class","analysis-overlay",3,"click",4,"ngIf"],[1,"analysis-overlay",3,"click"],[1,"analysis-panel",3,"click"],[1,"analysis-header"],[1,"back-btn",3,"click"],["src","images/icons/ico-back.svg","alt","\uB4A4\uB85C","width","24","height","24"],[1,"close-btn",3,"click"],["class","analysis-progress",4,"ngIf"],["class","analysis-results",4,"ngIf"],[1,"analysis-progress"],["src","images/icons/btn-search.svg","alt","\uBD84\uC11D \uC911","width","48","height","48",1,"progress-icon"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"analysis-results"],[1,"summary-card"],[1,"summary-grid"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],["class","info-section",4,"ngIf"],[1,"analysis-actions"],[1,"btn-primary",3,"click"],["src","images/icons/btn-top-add.svg","alt","\uCD94\uAC00","width","20","height","20"],[1,"info-section"],[1,"info-header"],["src","images/icons/ico-img.svg","alt","\uC774\uBBF8\uC9C0","width","20","height","20",1,"info-icon"],[1,"info-title"],[1,"info-content"],["src","images/icons/btn-top-draw.svg","alt","\uBCA1\uD130","width","20","height","20",1,"info-icon"]],template:function(e,n){e&1&&b(0,a0,11,4,"div",0),e&2&&p("ngIf",n.isOpen)},dependencies:[_e,B],styles:['@charset "UTF-8";.analysis-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:9999;display:flex;align-items:flex-end;touch-action:none}.analysis-panel[_ngcontent-%COMP%]{background:#fff;width:100%;max-height:90vh;border-radius:20px 20px 0 0;box-shadow:0 -4px 20px #00000026;overflow-y:auto;-webkit-overflow-scrolling:touch}.analysis-panel[_ngcontent-%COMP%]   .analysis-header[_ngcontent-%COMP%]{position:sticky;top:0;background:#fff;padding:16px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #e0e0e0;z-index:10}.analysis-panel[_ngcontent-%COMP%]   .analysis-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{flex:1;text-align:center;font-size:18px;font-weight:600;margin:0;color:#333}.analysis-panel[_ngcontent-%COMP%]   .analysis-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:8px;color:#666;display:flex;align-items:center;justify-content:center;transition:color .2s}.analysis-panel[_ngcontent-%COMP%]   .analysis-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active{color:#007acc}.analysis-panel[_ngcontent-%COMP%]   .analysis-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]{font-size:20px}.analysis-panel[_ngcontent-%COMP%]   .analysis-header[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{font-size:28px;font-weight:300}.analysis-panel[_ngcontent-%COMP%]   .analysis-progress[_ngcontent-%COMP%]{padding:60px 24px;text-align:center;min-height:400px;display:flex;flex-direction:column;align-items:center;justify-content:center}.analysis-panel[_ngcontent-%COMP%]   .analysis-progress[_ngcontent-%COMP%]   .progress-icon[_ngcontent-%COMP%]{font-size:80px;margin-bottom:24px;animation:_ngcontent-%COMP%_pulse 1.5s infinite}.analysis-panel[_ngcontent-%COMP%]   .analysis-progress[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#333;margin:0 0 32px}.analysis-panel[_ngcontent-%COMP%]   .analysis-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{width:100%;max-width:300px;height:8px;background:#e0e0e0;border-radius:4px;overflow:hidden;margin-bottom:12px}.analysis-panel[_ngcontent-%COMP%]   .analysis-progress[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#007acc,#0098ff);border-radius:4px;transition:width .3s ease}.analysis-panel[_ngcontent-%COMP%]   .analysis-progress[_ngcontent-%COMP%]   .progress-text[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#007acc;margin:0}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]{padding:24px}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:12px;padding:20px;margin-bottom:20px}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin:0 0 16px;color:#333}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:16px}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:12px;text-align:center}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:12px;color:#666;margin-bottom:4px}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#007acc}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:12px;margin-top:12px}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-header[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{font-size:20px}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-header[_ngcontent-%COMP%]   .info-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#333}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]{font-size:14px;color:#666;padding-left:28px}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .dashboard-details[_ngcontent-%COMP%]{margin-bottom:20px}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .dashboard-details[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{cursor:pointer;font-size:14px;font-weight:600;color:#007acc;padding:12px;background:#f0f8ff;border-radius:8px;list-style:none;-webkit-user-select:none;user-select:none}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .dashboard-details[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]::-webkit-details-marker{display:none}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .dashboard-details[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]:before{content:"\\25b6";display:inline-block;margin-right:8px;transition:transform .2s}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .dashboard-details[open][_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]:before{transform:rotate(90deg)}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .dashboard-details[_ngcontent-%COMP%]   shared-pdf-analysis-dashboard[_ngcontent-%COMP%]{display:block;margin-top:12px}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .analysis-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{width:100%;padding:16px;background:#007acc;color:#fff;border:none;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:background .2s}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .analysis-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .analysis-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:active{background:#0066a8}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}@media (max-width: 480px){.analysis-panel[_ngcontent-%COMP%]   .analysis-results[_ngcontent-%COMP%]   .summary-card[_ngcontent-%COMP%]   .summary-grid[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:20px}}'],data:{animation:[vn("fadeInOut",[Kt(":enter",[ut({opacity:0}),Wt("300ms ease-out",ut({opacity:1}))]),Kt(":leave",[Wt("300ms ease-in",ut({opacity:0}))])]),vn("slideUp",[Kt(":enter",[ut({transform:"translateY(100%)"}),Wt("300ms ease-out",ut({transform:"translateY(0)"}))]),Kt(":leave",[Wt("300ms ease-in",ut({transform:"translateY(100%)"}))])])]}})};var tn=class r{apiConfig=P(rt);intercept(t,e){if(!this.isOurApiRequest(t.url))return e.handle(t);let n=this.apiConfig.getCommonHeadersAsRecord(),i=t.clone({setHeaders:K(K({},n),this.getExistingHeaders(t))});return Re&&console.log("\u{1F4CB} [HeaderInterceptor] \uACF5\uD1B5 \uD5E4\uB354 \uCD94\uAC00:",t.url),e.handle(i)}isOurApiRequest(t){return t.startsWith(ot)||t.startsWith("/")}getExistingHeaders(t){let e={};return t.headers.has("Content-Type")&&(e["Content-Type"]=t.headers.get("Content-Type")),t.headers.has("Authorization")&&(e.Authorization=t.headers.get("Authorization")),e}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac})};var nn=class r{tokenService=P(at);isRefreshing=!1;refreshTokenSubject=new de(null);intercept(t,e){if(!this.isOurApiRequest(t.url))return e.handle(t);if(t.headers.has("Authorization"))return e.handle(t).pipe(dt(i=>this.handleAuthError(i,t,e)));let n=this.tokenService.getAccessToken();return n&&(t=this.addTokenToRequest(t,n),Re&&console.log("\u{1F510} [AuthInterceptor] \uD1A0\uD070 \uCD94\uAC00:",t.url)),e.handle(t).pipe(dt(i=>this.handleAuthError(i,t,e)))}isOurApiRequest(t){return t.startsWith(ot)}addTokenToRequest(t,e){return t.clone({setHeaders:{Authorization:`Bearer ${e}`}})}handleAuthError(t,e,n){return t.status===401?this.handle401Error(e,n):ct(()=>t)}handle401Error(t,e){return this.isRefreshing?this.refreshTokenSubject.pipe(fn(i=>i!==null),Yi(1),Xi(i=>e.handle(this.addTokenToRequest(t,i)))):this.tokenService.getRefreshToken()?(this.isRefreshing=!0,this.refreshTokenSubject.next(null),console.warn("\u26A0\uFE0F [AuthInterceptor] \uD1A0\uD070 \uAC31\uC2E0 API \uBBF8\uAD6C\uD604 - \uC7AC\uB85C\uADF8\uC778 \uD544\uC694"),this.isRefreshing=!1,this.tokenService.clearTokens(),ct(()=>new an({error:{message:"\uC778\uC99D\uC774 \uB9CC\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uB2E4\uC2DC \uB85C\uADF8\uC778\uD574\uC8FC\uC138\uC694."},status:401}))):(console.warn("\u26A0\uFE0F [AuthInterceptor] Refresh Token \uC5C6\uC74C - \uC7AC\uB85C\uADF8\uC778 \uD544\uC694"),this.tokenService.clearTokens(),ct(()=>new an({error:{message:"\uC778\uC99D\uC774 \uB9CC\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uB2E4\uC2DC \uB85C\uADF8\uC778\uD574\uC8FC\uC138\uC694."},status:401})))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac})};var on=class r{intercept(t,e){return e.handle(t).pipe(dt(n=>(this.isOurApiRequest(t.url)&&(this.logError(t,n),this.handleGlobalError(n)),ct(()=>n))))}isOurApiRequest(t){return t.startsWith(ot)}logError(t,e){Re&&(console.error("\u274C [ErrorInterceptor] API \uC5D0\uB7EC \uBC1C\uC0DD"),console.error(`  URL: ${t.method} ${t.url}`),console.error(`  Status: ${e.status} ${e.statusText}`),e.error&&console.error("  Server Response:",e.error))}handleGlobalError(t){switch(t.status){case 0:console.warn("\u26A0\uFE0F [ErrorInterceptor] \uB124\uD2B8\uC6CC\uD06C \uC5F0\uACB0 \uD655\uC778 \uD544\uC694");break;case 401:break;case 403:console.warn("\u26A0\uFE0F [ErrorInterceptor] \uC811\uADFC \uAD8C\uD55C \uC5C6\uC74C");break;case 500:case 502:case 503:console.warn("\u26A0\uFE0F [ErrorInterceptor] \uC11C\uBC84 \uC624\uB958 \uBC1C\uC0DD");break}}static \u0275fac=function(e){return new(e||r)};static \u0275prov=H({token:r,factory:r.\u0275fac})};var $i=[{provide:bn,useClass:tn,multi:!0},{provide:bn,useClass:nn,multi:!0},{provide:bn,useClass:on,multi:!0}];var dn=class r{static forRoot(){return{ngModule:r,providers:[...$i,rt,at,St,st]}}static \u0275fac=function(e){return new(e||r)};static \u0275mod=Nt({type:r});static \u0275inj=Bt({providers:[rt,at,St,st],imports:[mo]})};var br=class r{constructor(t,e,n){this.resourceLoader=t;this.navigationHistory=e;this.userPreferences=n;console.log("\u{1F680} [Module] EzReaderMobileModule \uCD08\uAE30\uD654 \uC2DC\uC791"),this.userPreferences.applyAndroidLayoutToDOM(),console.log("\u{1F680} [Module] EzReaderMobileModule \uCD08\uAE30\uD654 \uC644\uB8CC"),this.resourceLoader.loadAllResources().catch(()=>{})}static \u0275fac=function(e){return new(e||r)(X(Go),X(Fe),X(Mt))};static \u0275mod=Nt({type:r});static \u0275inj=Bt({providers:[{provide:ko,useValue:"EzReaderMobilePdfCacheDB"},Ce,Dt,Zt,It,ft,Ne,Fe],imports:[_e,Qe,Ko,wo,Oi,Uo,Tn,Ho,en,Ge,An,Fn,zn,Rn,Pe,Nn,Ln,Ei,Wo,bt,Ee,vt,xt,tt,Pt,dn.forRoot()]})};export{br as EzReaderMobileModule};
